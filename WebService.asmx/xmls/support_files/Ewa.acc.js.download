function WacCurve(n,t,i,r,u,f){this.ID=n;this.type=t;this.x1=i;this.y1=r;this.x2=u;this.y2=f}function WacIntWrapper(n,t){this.value=n;this.contextId=t}function WacKeyFrame(n,t,i,r,u,f,e,o){this.type=n;this.curveID=t;this.startTime=i==null||i.value==undefined?new WacIntWrapper(i,null):i;this.endTime=r==null||r.value==undefined?new WacIntWrapper(r,null):r;this.startValue=u==null||u.value==undefined?new WacIntWrapper(u,null):u;this.endValue=f==null||f.value==undefined?new WacIntWrapper(f,null):f;this.relativeTo=e;this.operationType=o}function WacAnimation_ContextVariableManager(){}function WacAnim(n,t){this.ID=n;this.keyFrames=t}function WacAnimationEngine(){this.AnimationQueue=new Array(0);this.sharedTimer=null;this.sharedCancelTimer=null;this.resetInterval=5e3;this.sharedTimerRefs=0;this.conflictTable=new Array(0);this.currentAnimationIndex=-1;this.temporaryIDGenerator=0}function WacAnimation_State(){this.Index=0;this.Data=new Array(0);this.AnimateRight=!1}function WacAnimation_Object(n,t,i,r,u,f){this.Initialize(n,t,i,r,u,f)}function WacAnimationUnit(n,t,i,r,u,f){this.Initialize(n,t,i,r,u,f)}function WacAnimationTelemetry(){this.perfData=new Array(0);this.logData=new Array(0);this.animationStats=[];this.animationStatsIndex=0;this.perfDataIndex=0;this.logDataIndex=0;this.animationIndex=0;this.startTime=null;this.duration=null;this.numUnits=0;this.elementIds={};this.avgSessionFps=-1;this.countSessionFps=0;this.minSessionFps=-1;this.maxSessionFps=-1}function GetCurrentAttributeCssValue(n,t,i,r){IsNullOrUndef(r)&&(r=n.style.position=="relative");var u=0;switch(t){case 1:u=i?parseInt(r?n.style.marginRight.replace("px",""):n.style.right.replace("px","")):parseInt(r?n.style.marginLeft.replace("px",""):n.style.left.replace("px",""));break;case 2:u=parseInt(r?n.style.marginTop.replace("px",""):n.style.top.replace("px",""));break;case 3:u=parseInt(n.style.height.replace("px",""));break;case 4:u=parseInt(n.style.width.replace("px",""));break;case 5:u=GetCssOpacity(n);break;case 6:u=parseInt(n.scrollTop);break;case 7:u=parseInt(n.scrollLeft);break;case 8:u=GetCssRotation(n)}return u}function Bezier1(n){return n*n*n}function Bezier2(n){return 3*n*n*(1-n)}function Bezier3(n){return 3*n*(1-n)*(1-n)}function Bezier4(n){return(1-n)*(1-n)*(1-n)}function CalculateBezier(n,t,i,r,u){return 0*Bezier4(u)+t*Bezier3(u)+r*Bezier2(u)+1*Bezier1(u)}function IsArrayCheck(n){return typeof n=="object"&&n instanceof Array}function IsNullOrUndef(n){return n==null||n==undefined}function SetCssOpacity(n,t){document.body.style.opacity!=null?n.style.opacity=t:n.style.filter=t==1?"":"alpha(opacity="+String(t*100)+")"}function GetCssOpacity(n){var t,i;return document.body.style.opacity!=null?(t=n.style.opacity,t!=null&&t!=""?parseFloat(t):1):(i=n.style.filter,i!=null&&i!=""?parseInt(i.replace("alpha(opacity=","").replace(")",""))/100:1)}function SetCssRotation(n,t){var i="rotate("+t+"deg)";document.body.style.msTransform!=null?n.style.msTransform=i:document.body.style.webkitTransform!=null?n.style.webkitTransform=i:document.body.style.mozTransform!=null?n.style.mozTransform=i:document.body.style.oTransform!=null?n.style.oTransform=i:document.body.style.transform!=null&&(n.style.transform=i)}function GetCssRotation(n){var t;return(document.body.style.msTransform!=null?t=n.style.msTransform:document.body.style.webkitTransform!=null?t=n.style.webkitTransform:document.body.style.mozTransform!=null?t=n.style.mozTransform:document.body.style.oTransform!=null?t=n.style.oTransform:document.body.style.transform!=null&&(t=n.style.transform),!t)?0:(t=t.replace("rotate(",""),t=t.replace("deg)",""),parseFloat(t))}Type.registerNamespace("_Ewa");_Ewa.TX=function(){};_Ewa.zU=function(){};_Ewa.TY=function(){};_Ewa.TZ=function(){};_Ewa.TY.registerClass("_Ewa.TY");_Ewa.TZ.registerClass("_Ewa.TZ");Type.registerNamespace("Common.App.AltTextDialog");Common.App.AltTextDialog.c=function(n){Common.App.AltTextDialog.c.initializeBase(this);this.m=Common.App.AltTextDialog.c.a;this.ba(n)};Common.App.AltTextDialog.a=function(){this.d=Function.createDelegate(this,this.e);Common.App.AltTextDialog.a.initializeBase(this,[!1,!1,!1,!1]);this.p=Common.App.AltTextDialog.b.b();this.m="BaseAltTextDialogWithDescription"};Common.App.AltTextDialog.a.prototype={ba:function(n){var t={},i;t[Common.App.AltTextDialog.a.b]=this.R(n);t[Common.App.AltTextDialog.a.a]=this.X(n)||"";this.j($a.cq,this.d,t);i=document.getElementById(Common.App.AltTextDialog.a.b);i.focus();i.select()},bO:function(n){return n.c.id===Common.App.AltTextDialog.a.a?!1:CommonUI.c.prototype.bO.call(this,n)}};Common.App.AltTextDialog.b=function(){};Common.App.AltTextDialog.b.b=function(){return CommonUI.b.a(Common.App.AltTextDialog.b.a,$a.cr,$a.cp)};Common.App.AltTextDialog.a.registerClass("Common.App.AltTextDialog.a",CommonUI.b);Common.App.AltTextDialog.c.registerClass("Common.App.AltTextDialog.c",Common.App.AltTextDialog.a);Common.App.AltTextDialog.c.a="AAltTextDialogWithDescription";Common.App.AltTextDialog.a.b="titleText";Common.App.AltTextDialog.a.a="descriptionText";Common.App.AltTextDialog.b.a="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}<\/label> <\/div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> <\/div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}<\/label> <\/div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"><\/textarea> <\/div>";Type.registerNamespace("Common.App.NewAndOpen.Core");Common.App.NewAndOpen.Core.k=function(){};Common.App.NewAndOpen.Core.k.prototype={a:function(){return this.e},f:function(n){return Diag.a.a(5849616,202,50,"Changing event result state. {0}",{OldState:Common.dI.toString(this.e),NewState:Common.dI.toString(n)},"ResultType",this.j()),this.e=n,n},e:0};Common.App.NewAndOpen.Core.h=function(n,t){this.e=n;this.d=Common.App.NewAndOpen.Core.h.$$(this.$$gta["Common.App.NewAndOpen.Core.h"].T).a++;this.f=t};Common.App.NewAndOpen.Core.h.$$=function(n){var u=Common.App.NewAndOpen.Core.__tc=Common.App.NewAndOpen.Core.__tc||{},i="h$"+n.getName().replace(/\./g,"_"),t,o,f,e,r;if(!u[i]){t=u[i]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.NewAndOpen.Core.h.apply(this,t)};t.registerClass("Common.App.NewAndOpen.Core.__tc."+i,null,Common.jq.$$(n));o={"Common.App.NewAndOpen.Core.h":{T:n},ctor:Common.App.NewAndOpen.Core.h};t.prototype.$$gta=o;f=Common.App.NewAndOpen.Core.h.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(t.prototype[r.key]=r.value);t.a=0}return u[i]};Common.App.NewAndOpen.Core.h.prototype={e:null,f:null,d:0,c:function(){return this.d},b:function(n,t){this.f(n,t)},a:function(n,t){return this.e.a(n,t?this:null)}};Common.App.NewAndOpen.Core.f=function(){this.g={}};Common.App.NewAndOpen.Core.f.$$=function(n){var u=Common.App.NewAndOpen.Core.__tc=Common.App.NewAndOpen.Core.__tc||{},t="f$"+n.getName().replace(/\./g,"_"),i,o,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.NewAndOpen.Core.f.apply(this,t)};i.registerClass("Common.App.NewAndOpen.Core.__tc."+t,null,Common.jp.$$(n));o={"Common.App.NewAndOpen.Core.f":{T:n},ctor:Common.App.NewAndOpen.Core.f};i.prototype.$$gta=o;f=Common.App.NewAndOpen.Core.f.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.NewAndOpen.Core.f.prototype={C:function(n){this.g[n.c().toString()]=n},D:function(n){var i=this.g,t,r,u;for(t in i)r={key:t,value:i[t]},u=r.value,u.b(n,!1);this.g={}},a:function(n,t){return t&&this.C(t),this.E(n,t)},k:function(n){this.D(n)},r:function(n,t){n.b(t,!0)}};Common.App.NewAndOpen.Core.g=function(){this.g=Function.createDelegate(this,this.j);this.f=Function.createDelegate(this,this.h)};Common.App.NewAndOpen.Core.g.prototype={d:null,a:function(){return"Common.App.NewAndOpen.Core"},c:function(n){var t,i,r;this.d=n;t=this;n.b(Common.cg).a().b(function(){return Common.App.NewAndOpen.Core.d.a()});i=this;n.b(Common.jp.$$(Common.bq)).a().b(function(){return Common.App.NewAndOpen.Core.c.b()});r=this;n.b(Common.jp.$$(Common.cH)).a().b(function(){return Common.App.NewAndOpen.Core.a.a()})},b:function(){var n=this;Common.a.a.h(function(){n.k()})},k:function(){var n,t;this.d.a(Common.cg);this.d.a(Common.jp.$$(Common.bq));this.d.a(Common.jp.$$(Common.cH));n=!1;Common.App.NewAndOpen.Core.d.a().A();Common.a.bs&&(n=!0);Common.a.cs&&(Common.App.NewAndOpen.Core.a.a().N(),Common.a.cp>0&&this.h(),this.l(),n=!0);Common.a.cv&&n&&Common.App.NewAndOpen.Core.c.b().m();Common.a.dm&&(t=Common.App.NewAndOpen.Core.a.a(),t.R(),t.Q(),this.m())},l:function(){Common.App.NewAndOpen.Core.b.a().i(Common.App.NewAndOpen.Core.a.a().w);Common.App.NewAndOpen.Core.b.a().i(this.f);Common.App.NewAndOpen.Core.b.a().m(this.g)},m:function(){Common.App.NewAndOpen.Core.b.a().m(Common.App.NewAndOpen.Core.a.a().y);Common.App.NewAndOpen.Core.b.a().i(Common.App.NewAndOpen.Core.a.a().x)},j:function(){Common.M.a().b(this.i())},h:function(){Common.M.a().a(this.i())},i:function(){return this.e||(this.e=new Common.Q(4,2,Common.a.cp,Common.App.NewAndOpen.Core.a.a().v,109,null,!1,0))},e:null,dispose:function(){}};Common.App.NewAndOpen.Core.i=function(){Common.App.NewAndOpen.Core.i.initializeBase(this);this.f(0);this.h=!1;this.k=!1};Common.App.NewAndOpen.Core.i.prototype={i:null,b:function(){return this.i},g:null,c:function(){return this.g},h:!1,d:function(){return this.h},k:!1,j:function(){return"GetMoreInfo Result"}};Common.App.NewAndOpen.Core.c=function(n,t){Common.App.NewAndOpen.Core.c.initializeBase(this);this.e=n;this.c=new Common.App.NewAndOpen.Core.e(t,this.d().f(),"GetMoreInfo");this.b=new Common.App.NewAndOpen.Core.i};Common.App.NewAndOpen.Core.c.b=function(){return Common.App.NewAndOpen.Core.c.a||(Common.App.NewAndOpen.Core.c.a=Common.App.NewAndOpen.Core.c.d())};Common.App.NewAndOpen.Core.c.d=function(){return new Common.App.NewAndOpen.Core.c(new($$sc.y.$$(Common.cg))(function(){return Common.App.NewAndOpen.Core.d.a()}),new($$sc.y.$$(String))(function(){return Common.a.dd}))};Common.App.NewAndOpen.Core.c.c=function(n){if(!n)return Diag.a.a(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;var t=n.toLowerCase();return t.startsWith("https://")?!0:(Diag.a.a(5849625,202,10,"StorageUrl has invalid scheme."),!1)};Common.App.NewAndOpen.Core.c.prototype={e:null,c:null,b:null,m:function(){this.f("Document opened",!1)},l:function(n){var t=this;return function(){t.f(n,!0)}},E:function(n,t){return Diag.a.a(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{Trigger:n}),this.b.e===3?(t&&this.r(t,this.b),Diag.a.a(5849619,202,50,"GetMoreInfo already populated. {0}",{Trigger:n})):this.f(n,!1),this.b},f:function(n,t){if(this.c.b(!t),this.b.e===1){Diag.a.a(5849620,202,50,"Not starting new request, because one is already in progress {0}",{Trigger:n,RetryIndex:this.c.a});return}Diag.a.a(5849621,202,50,"Making GetMoreInfo request {0}",{Trigger:n,RetryIndex:this.c.a});this.b.f(1);var i=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.d().e(),Common.a.j),r=this.d().d().d(i,1,null,null,["PersonalFileStorageUrl","StorageServiceDisplayName"],!1,4,this.j(n),this.i(n),null,null,!1,null,null,null,null,!1,null,!1,null,null)},j:function(){var n=this;return function(t){var f=!1,e=!1,o=!1,s=null,h,c,i,r,u,l;Common.a.a.a("GetMoreInfoDataFromResponseBody")&&(t.b.a?(c=Common.bv.a(Object,t.b.a,h={val:s}),s=h.val,c)?(i=s,i?(o=!0,n.b.g=i.StorageServiceDisplayName,n.b.i=Common.App.NewAndOpen.Core.c.c(i.PersonalFileStorageUrl)?i.PersonalFileStorageUrl:""):Diag.a.a(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers")):Diag.a.a(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):Diag.a.a(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));o||(r=t.b.d,r?(n.b.g=(r.StorageServiceDisplayName||"").toString(),u=(r.PersonalFileStorageUrl||"").toString(),n.b.i=Common.App.NewAndOpen.Core.c.c(u)?u:"",f=u===""&&n.b.g!==""):(Diag.a.a(5849622,202,50,"Null response headers received."),e=!0));l=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",n.c.a,e,f,o);n.d().b("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",t.b,l);n.h(3,f,e)}},i:function(n){var t=this;return function(i){t.d().b("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",i.b,"Failure");t.h(2,!1,!1);t.c.h(t.l(n))}},h:function(n,t,i){this.b.f(n);this.b.h=t;this.b.k=i;this.k(this.b)},d:function(){return this.e.a()}};Common.App.NewAndOpen.Core.l=function(){};Common.App.NewAndOpen.Core.l.prototype={PersonalFileStorageUrl:null,StorageServiceDisplayName:null};Common.App.NewAndOpen.Core.b=function(n,t,i,r,u){this.k=Function.createDelegate(this,this.p);this.f=n;this.b=t;this.e=i;this.g=r;this.a=new Common.W;u&&this.q();this.d=this.b()};Common.App.NewAndOpen.Core.b.a=function(){return Common.App.NewAndOpen.Core.b.b||(Common.App.NewAndOpen.Core.b.b=Common.App.NewAndOpen.Core.b.c())};Common.App.NewAndOpen.Core.b.c=function(){return new Common.App.NewAndOpen.Core.b(new($$sc.y.$$(Common.dS))(function(){return Common.M.a()}),function(){return Common.a.dz.getTime()},function(){return(new Date).getTime()},new($$sc.y.$$(Number))(function(){return Common.a.dk}),!0)};Common.App.NewAndOpen.Core.b.prototype={l:6e4,d:0,f:null,b:null,e:null,g:null,a:null,j:"inactive",h:"active",c:!0,i:function(n){this.a.l(this.h,n)},m:function(n){this.a.l(this.j,n)},q:function(){var n=new Common.Q(4,2,this.l,this.k,108,null,!1,0);this.o().a(n)},p:function(){var n=this.b(),i=this.e(),t=i-n;t>this.n()&&this.c&&(Diag.a.a(5849626,202,50,"User went inactive {0}",{TimeSinceLastActive:t}),this.c=!1,this.a.k(this.j,null,null));n-this.d>this.n()&&(this.c=!0,this.a.k(this.h,null,null));this.d=n},o:function(){return this.f.a()},n:function(){return this.g.a()}};Common.App.NewAndOpen.Core.j=function(){Common.App.NewAndOpen.Core.j.initializeBase(this);this.f(0);this.d=!1};Common.App.NewAndOpen.Core.j.prototype={g:null,b:function(){return this.g},h:0,c:function(){return this.h},d:!1,j:function(){return"MruActor Result"}};Common.App.NewAndOpen.Core.a=function(n,t,i,r,u){this.t=Function.createDelegate(this,this.J);this.s=Function.createDelegate(this,this.I);this.u=Function.createDelegate(this,this.K);this.A=Function.createDelegate(this,this.U);this.z=Function.createDelegate(this,this.S);this.v=Function.createDelegate(this,this.L);this.x=Function.createDelegate(this,this.O);this.y=Function.createDelegate(this,this.P);this.w=Function.createDelegate(this,this.M);Common.App.NewAndOpen.Core.a.initializeBase(this);this.m=n;this.l=t;this.e=new Common.App.NewAndOpen.Core.e(i,this.b().f(),"Read");this.f=new Common.App.NewAndOpen.Core.e(r,this.b().f(),"Write");this.h=u;this.c={};this.d=new Common.App.NewAndOpen.Core.j};Common.App.NewAndOpen.Core.a.a=function(){return Common.App.NewAndOpen.Core.a.d||(Common.App.NewAndOpen.Core.a.d=Common.App.NewAndOpen.Core.a.f())};Common.App.NewAndOpen.Core.a.f=function(){return new Common.App.NewAndOpen.Core.a(new($$sc.y.$$(Common.cg))(function(){return Common.App.NewAndOpen.Core.d.a()}),new($$sc.y.$$(String))(function(){return Common.d.b(Common.a.m).a}),new($$sc.y.$$(String))(function(){return Common.a.a.i.MruServerReadRetryIntervalsInMs}),new($$sc.y.$$(String))(function(){return Common.a.a.i.MruServerWriteRetryIntervalsInMs}),Common.a.a.a("MruWriteFileIdInHeader"))};Common.App.NewAndOpen.Core.a.prototype={m:null,l:null,h:!1,d:null,e:null,f:null,c:null,o:"RenameMruEntry",p:"UpdateMruEntry",R:function(){var n=this.b().h();n.a(3502386740,2147483648,this.z)},S:function(n,t,i,r,u){var f=u;return f?f.b?f.c?f.a?(this.c[Common.App.NewAndOpen.Core.a.c]=this.c[Common.App.NewAndOpen.Core.a.c]||Common.e.a(f.a),this.c[Common.App.NewAndOpen.Core.a.b]=Common.e.a(f.b),this.c[Common.App.NewAndOpen.Core.a.e]=Common.e.a(f.c),Diag.a.a(5849669,202,50,"Starting rename of MRU entry {0}",{Trigger:"Rename"}),this.q("Rename",this.o,!1)):(Diag.a.a(5849668,202,15,"Failure to rename MRU entry {0}",{Error:"Null CurrentDocumentDAVUrl"}),8):(Diag.a.a(5849667,202,15,"Failure to rename MRU entry {0}",{Error:"Null NewFileName"}),8):(Diag.a.a(5849666,202,15,"Failure to rename MRU entry {0}",{Error:"Null NewDocumentDAVUrl"}),8):32},Q:function(){this.n("File Opened")},P:function(){this.n("Inactivity")},O:function(){this.n("Back from Inactivity")},n:function(n){Diag.a.a(5849670,202,50,"Starting update of MRU entry {0}",{Trigger:n});this.q(n,this.p,!1)},q:function(n,t,i){var r,u;return this.b().a()===4&&!Common.a.bc?2:(this.c[Common.App.NewAndOpen.Core.a.b]&&this.c[Common.App.NewAndOpen.Core.a.c]!==this.c[Common.App.NewAndOpen.Core.a.b]?r=this.o:(r=this.p,delete this.c[Common.App.NewAndOpen.Core.a.b]),Diag.a.a(5849673,202,50,"Writing to MRU {0}",{Trigger:n,IntendedActionType:t,ActualActionType:r}),this.f.b(!i),u=String.format(this.b().e()+"MruServiceHandler.ashx?action={0}&app={1}&lc={2}",r,this.b().a(),this.B()),this.h?this.c["X-FileId"]=Common.a.j:u+=String.format("&{0}",Common.a.j),this.b().d().a(u,2,null,this.c,!0,4,this.A,this.G(t),null,null,!1,null,null,"4",null,!1,null,!1,null))},U:function(n){this.b().b("MruActor.WriteMruEntryOnServerSuccessCallback",n.b,"Success");this.f.b(!0);var t=(n.b.e.get_headers()[Common.App.NewAndOpen.Core.a.b]||"").toString();t!==""&&(this.c[Common.App.NewAndOpen.Core.a.c]=t)},G:function(n){var t=this;return function(i){t.b().b("MruActor.WriteMruEntryOnServerFailureCallback",i.b,"Failure");i.b.c!==403&&t.f.h(t.H(n))}},H:function(n){var t=this;return function(){t.q("Retry",n,!0)}},L:function(){this.i("Polling",!1)},J:function(){this.i("Retry",!0)},N:function(){this.i("Open",!1)},M:function(){this.i("Activity",!1)},i:function(n,t){Diag.a.a(5849674,202,50,"Making GetMru request {0}",{Trigger:n});this.e.b(!t);this.F(this.u,this.s,"getmru")},K:function(n){var i=n.b.a,t;Common.a.b()&&Common.a.b().a().e()&&Common.I.a()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(i,!0));this.e.b(!0);t=null;i&&(t=this.T(i));t?(this.j(3,t,!1),this.b().b("MruActor.GetMruFromServerSuccessCallback",n.b,"Success")):(this.b().b("MruActor.GetMruFromServerSuccessCallback",n.b,"Failure: Invalid JSON"),this.j(3,null,!0));this.k(this.d)},I:function(n){this.b().b("MruActor.GetMruFromServerFailureCallback",n.b,"Failure");this.j(2,null,!1);var t=this.e.h(this.t);t||this.e.b(!0);this.k(this.d);Common.a.b()&&Common.a.b().a().e()&&Common.I.a()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1))},j:function(n,t,i){(this.d.e!==3||n===3)&&(this.d.g=t,this.d.f(n),this.d.d=i,this.d.h=this.b().g()())},E:function(n,t){return Diag.a.a(6029918,202,50,"MRU result requested {0}",{Trigger:n,ResultState:this.d.e}),t&&this.d.e===3&&this.r(t,this.d),this.d},F:function(n,t,i){this.j(1,null,!1);var u=String.format(this.b().e()+"MruServiceHandler.ashx?action={0}&app={1}&lc={2}",i,this.b().a(),this.B()),r=null;this.h?(r={},r["X-FileId"]=Common.a.j):u+=String.format("&{0}",Common.a.j);this.b().d().a(u,1,null,r,!0,4,n,t,null,null,!1,null,null,null,null,!1,null,!1,null)},T:function(n){var t;try{t=JSON.parse(n)}catch(i){t=null;Diag.a.a(5849675,202,10,"MruActor.TryDeserializeJson: Exception thrown from JsonSerializer.SecureDeserialize Exception: {0}",i)}return t},b:function(){return this.m.a()},B:function(){return this.l.a()}};Common.App.NewAndOpen.Core.e=function(n,t,i){this.g=n;this.f=t;this.e=i};Common.App.NewAndOpen.Core.e.prototype={c:null,g:null,d:null,e:"",f:null,b:function(n){this.c&&(this.f.b(this.c),this.c=null);n&&(this.a=0)},h:function(n){var t=this.j(),i=t>=0;return i?(this.a++,this.b(!1),this.c=new Common.Q(4,1,t,n,107,null,!1,0),this.f.a(this.c)):(this.b(!0),Diag.a.a(5849676,202,50,"Retries exhausted {0}",{Action:this.e})),i},a:0,j:function(){return this.a>=this.i().length?-1:this.i()[this.a]},i:function(){var t,n,i;if(!this.d)for(t=(this.g.a()||"0").split(","),this.d=[],n=0;n<t.length;n++)i=parseInt(t[n]),isNaN(i)?Diag.a.a(5849677,202,15,"Retry interval list contains non-number element {0}",{Action:this.e,Entry:t[n]}):Array.add(this.d,i);return this.d}};Common.App.NewAndOpen.Core.d=function(n,t,i,r,u,f,e,o){this.r=Function.createDelegate(this,this.x);this.t=Function.createDelegate(this,this.z);this.s=Function.createDelegate(this,this.y);this.u=Function.createDelegate(this,this.w);this.k=n;this.n=t;this.l=i;this.m=r;this.q=u;this.j=f;this.o=e;this.p=o};Common.App.NewAndOpen.Core.d.a=function(){return Common.App.NewAndOpen.Core.d.b||(Common.App.NewAndOpen.Core.d.b=Common.App.NewAndOpen.Core.d.c())};Common.App.NewAndOpen.Core.d.c=function(){return new Common.App.NewAndOpen.Core.d(new($$sc.y.$$(Common.fj))(function(){return Common.a.c()}),new($$sc.y.$$(Common.er))(function(){return Common.a.d}),new($$sc.y.$$(Common.fk))(function(){return Common.a.b()}),new($$sc.y.$$(Common.bF))(function(){return Common.a.b().a().c()}),new($$sc.y.$$(Common.dS))(function(){return Common.a.i()}),function(){return(new Date).getTime()},new($$sc.y.$$(String))(function(){return Common.a.b().a().n()}),new($$sc.y.$$(Boolean))(function(){return Common.a.cv}))};Common.App.NewAndOpen.Core.d.prototype={k:null,n:null,l:null,m:null,q:null,j:null,o:null,p:null,A:function(){this.h().a(1959943459,2147483648,this.u);this.h().a(1813655452,2147483648,this.s);this.h().a(2155708348,2147483648,this.t);Common.a.bN?this.v():this.h().b(1169404878,2147483648,this.r,96)},w:function(n,t,i,r,u){var e=u,f,c;if(u&&e.MenuItemId){Diag.a.a(5849678,202,50,"Opening new tab {0}",{Id:e.SourceControlId,AppType:Common.bF.toString(this.a())});var o=e.MenuItemId.toString(),s=Common.a.a.a("WacInTabOpenMRUIsEnabledForUiHost"),h=Common.a.a.a("UiHostSupportsDocRebootFeatures");Diag.a.a(51517595,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",s,h);s&&h?(f={},f.rebootMode="1",f.documentUrl=o,Diag.a.a(51247010,202,50,"Send PostMessage to the Ui host to reboot a document"),c=this,Common.a.G().a(function(n){n.a("App_DocReboot",f,"")})):window.open(o,"_blank")}return 32},z:function(n,t,i,r,u){var e=u,o,s,h,f,c;return u&&e.MenuItemId&&(o=Common.a.a.a("WacInTabOpenMRUIsEnabledForUiHost"),s=Common.a.a.a("UiHostSupportsDocRebootFeatures"),Diag.a.a(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",o,s),o&&s?(Diag.a.a(592237458,202,50,"Opening new tab {0}",{Id:e.SourceControlId,AppType:Common.bF.toString(this.a())}),h=e.MenuItemId.toString(),f={},f.rebootMode="1",f.documentUrl=h,Diag.a.a(592237460,202,50,"Send PostMessage to the Ui host to reboot a document"),c=this,Common.a.G().a(function(n){n.a("App_DocReboot",f,"")})):this.w(n,t,i,r,u)),32},y:function(n,t,i,r,u){var f=u,e;return u&&f.MenuItemId&&(Diag.a.a(592295263,202,50,"Opening new tab {0}",{Id:f.SourceControlId,AppType:Common.bF.toString(this.a())}),e=f.MenuItemId.toString(),window.open(e,"_blank")),32},x:function(){return this.v(),32},b:function(n,t,i){if(t&&t.h){var u=Common.ci.toString(t.b),r=t.h.getTime(),f=this.j()-r;Diag.a.a(5849679,202,50,"Making request to the WAC server {0}",{Caller:n,RequestStatus:u,ElapsedMs:f,StartTime:r,Notes:i})}else Diag.a.a(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{Caller:n})},v:function(){var i=Common.a.a.a("QPGVCI"),f=Common.k.c(document.URL,"wdNewAndOpenCt",i),t;if(f){var n=parseInt(f),r=Common.k.c(document.URL,"wdPreviousSession",i),u=Common.k.c(document.URL,"wdPreviousCorrelation",i),e=Common.a.a.a("NAOPLP");if(!Common.a.bN){Diag.a.a(5849681,202,e?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{ClickTimestamp:n,SessionId:r,Correlation:u});return}t=Common.a.bN.getTime();!n||n>t?Diag.a.a(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{ClickTimestamp:n,DocumentLoadedTime:t,SessionId:r,Correlation:u}):Diag.a.a(5849683,202,e?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{ClickToLoadTime:t-n,ClickTimestamp:n,SessionId:r,Correlation:u})}},h:function(){return this.k.a()},d:function(){return this.n.a()},i:function(){return this.l.a()},a:function(){return this.m.a()},f:function(){return this.q.a()},g:function(){return this.j},e:function(){return this.o.a()},c:function(){return this.p.a()}};Common.App.NewAndOpen.Core.m=function(){};Common.App.NewAndOpen.Core.m.a=function(){Common.App.a.a().a(new Common.App.NewAndOpen.Core.g,0,!1)};Common.App.NewAndOpen.Core.k.registerClass("Common.App.NewAndOpen.Core.k",null,Common.jr);Common.App.NewAndOpen.Core.g.registerClass("Common.App.NewAndOpen.Core.g",null,Common.App.i,Common.Utils.s,Sys.IDisposable);Common.App.NewAndOpen.Core.i.registerClass("Common.App.NewAndOpen.Core.i",Common.App.NewAndOpen.Core.k,Common.bq,Common.jr);Common.App.NewAndOpen.Core.c.registerClass("Common.App.NewAndOpen.Core.c",Common.App.NewAndOpen.Core.f.$$(Common.bq));Common.App.NewAndOpen.Core.j.registerClass("Common.App.NewAndOpen.Core.j",Common.App.NewAndOpen.Core.k,Common.cH,Common.jr);Common.App.NewAndOpen.Core.a.registerClass("Common.App.NewAndOpen.Core.a",Common.App.NewAndOpen.Core.f.$$(Common.cH));Common.App.NewAndOpen.Core.c.a=null;Common.App.NewAndOpen.Core.b.b=null;Common.App.NewAndOpen.Core.a.c="CurrentDocumentDAVUrl";Common.App.NewAndOpen.Core.a.b="NewDocumentDAVUrl";Common.App.NewAndOpen.Core.a.e="NewFileName";Common.App.NewAndOpen.Core.a.d=null;Common.App.NewAndOpen.Core.d.b=null;Common.App.NewAndOpen.Core.m.a();Type.registerNamespace("Common.App.SessionExpiration");Common.App.SessionExpiration.j=function(){};Common.App.SessionExpiration.e=function(){};Common.App.SessionExpiration.e.registerInterface("Common.App.SessionExpiration.e");Common.App.SessionExpiration.k=function(){};Common.App.SessionExpiration.l=function(){};Common.App.SessionExpiration.m=function(){};Common.App.SessionExpiration.c=function(){};Common.App.SessionExpiration.a=function(){};Common.App.SessionExpiration.d=function(){};Common.App.SessionExpiration.i=function(){var n,t;(this.p=Function.createDelegate(this,this.y),this.o=Function.createDelegate(this,this.x),n=Common.a.p,n<=0)||(this.m=n,t=new Date,Diag.a.a(17581890,217,50,"Initializing SessionExpirationManager. {0}",{AccessTokenTtl:this.m,NowGetTime:t.getTime(),BootTime:Common.a.I}),Common.be.a().j(this.o),Common.be.a().i(this.p))};Common.App.SessionExpiration.i.prototype={n:!1,q:!1,m:0,x:function(){Common.be.a().m(this.o);Diag.a.a(19247381,217,50,"SessionExpiredDetected");this.w()},y:function(){Common.be.a().l(this.p);this.q||this.n||(Diag.a.a(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.q=!0,this.u())},w:function(){this.n||(Common.a.R(28,null),this.n=!0,this.t())}};Common.App.SessionExpiration.f=function(n){this.l=Function.createDelegate(this,this.p);this.f={};this.e={};this.n=new Date;this.g=new Date;this.i=n;this.h=new Common.Q(2,2,this.j*6e4,this.l,135,"SessionLogger",!1,0);this.i.a(this.h);this.q()};Common.App.SessionExpiration.f.prototype={j:15,h:null,m:!1,i:null,p:function(){Diag.a.a(41964821,217,50,Diag.a.g({Aggregate:this.e,Current:this.f}))},q:function(){this.e.RequestGroups=0;this.e.Requests=0;this.e.Responses=0;this.e.Status="Initialized";this.e.FirstActivity=new Date;this.e.SessionDuration=0;this.e.ActivityDuration=0;this.e.SessionDuration=0;this.f.SessionDuration=0;this.e.ActivityDuration=0;this.f.ActivityDuration=0},o:function(n,t){var i=n[t],r=i?i:0;r++;n[t]=r;this.k(n)},k:function(n){var t=new Date;n.ActivityDuration=t-this.g;this.g=t;n.SessionDuration=this.g-this.n;n.LastActivity=this.g},a:function(n,t){this.f[n]=t;this.k(this.f)},c:function(n,t){this.f[n]=t;this.k(this.f)},b:function(n){this.o(this.f,n);this.o(this.e,n)},d:function(){this.m||(this.e.Status=this.f.Status,this.p(this.h),this.i.d(this.h,this.j*6e4))}};Common.App.SessionExpiration.b=function(n,t){this.d=n;this.c=t};Common.App.SessionExpiration.b.prototype={d:null,b:function(){return this.d},c:null,a:function(){return this.c}};Common.App.SessionExpiration.g=function(n,t,i,r){this.q=Function.createDelegate(this,this.u);this.p=Function.createDelegate(this,this.s);this.o=new($$sc.u.$$(Common.App.SessionExpiration.c));this.h=new($$sc.u.$$(Common.App.SessionExpiration.a));this.k=n;this.m=t;var u=this;this.m.a(function(n){n.b("Host_RefreshSessionInfo",u.p)});this.e=i;this.n=new DiagUse.a("WebServiceCall","TokenRefresh");this.d=r||new Common.App.SessionExpiration.f(n)};Common.App.SessionExpiration.g.prototype={k:null,m:null,e:null,j:0,g:null,f:null,i:null,n:null,l:!1,d:null,s:function(n){var e,i,t,o,r,f,u,s;if(n.MessageId!=="Host_RefreshSessionInfo"){Diag.b.a(39408099,306,15,"Unexpected message.");return}for(e=new($$sc.u.$$(Common.App.SessionExpiration.c)),i=new($$sc.u.$$(Common.App.SessionExpiration.a)),this.d.b("Responses"),t=n.Values.Tokens,(!t||t.length<=0)&&(Diag.b.a(40122317,306,15,"Found no tokens in the dictionary"),t=n.Values),Diag.b.a(40122318,306,100,"The Tokens array contains {0} tokens",t.length),this.d.a("Correlation",n.CorrelationId),o=0;o<t.length;o++)(this.d.c("Tokens",t.length),r=t[o],f=r,f&&f.Name)&&(this.d.b(f.Name),u=r,u&&u.Value?(Diag.b.a(39408128,306,100,"Received token with name: {0}",u.Name),e.b(u),this.o.b(u),this.d.a("Status","Success")):(Diag.b.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",f.Name,JSON.stringify(r),this.f),i.b(r),this.h.b(r),this.d.a("Error",JSON.stringify(r)),this.d.a("Status","Failed")));if(Diag.b.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",e.e.length,i.e.length,n.CorrelationId,this.f),i.e.length>0&&!this.a(i)){s=this.e.e(i);s!==this.e.b()&&(this.d.c("RetryOverride",s),this.k.d(this.g,s));return}this.d.d();this.g&&(Diag.b.a(39408131,306,100,"Deleting task {0} from task manager",this.g.g),this.k.b(this.g));this.i&&this.i.b(new Common.App.SessionExpiration.b(e,i))},u:function(){var e,n,t,i,r,u,f,o;if(this.j>=this.e.c()){for(Diag.b.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.f),e=new($$sc.u.$$(Common.App.SessionExpiration.a)),n=0;n<this.e.a().length;n++)r=(i=new Common.App.SessionExpiration.a,i.Name=this.e.a()[n],i.Errors=[(t=new Common.App.SessionExpiration.d,t.Id="TOO_MANY_ATTEMPTS",t.Details="We did not receive a new token from the host after the maximum allowed number of attempts",t)],i),e.b(r),this.h.b(r);this.k.b(this.g);this.d.a("Errors",JSON.stringify(this.h));this.d.a("Status","Failed");this.i&&this.i.b(new Common.App.SessionExpiration.b(new($$sc.u.$$(Common.App.SessionExpiration.c)),this.h));return}u={};u.Tokens=this.e.a();f=Common.A.a().a;Diag.b.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.e.a()),this.j+1,f,this.f);o=this;this.m.a(function(n){n.a("App_RefreshSessionInfo",u,f)});this.j++;this.d.b("Requests")},c:function(n){return this.n.d(),this.l=n,this.f=Common.A.a().a,Diag.b.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.f,this.l),this.j=0,this.h.g(),this.o.g(),this.i=new($$sc.C.$$(Common.App.SessionExpiration.e)),this.g=new Common.Q(this.e.d(),2,this.e.b(),this.q,98,"App_RefreshSessionInfo",!0,0),this.k.a(this.g),this.i.a},b:function(n){this.n.a();var t=this.r(n.a().a());return(Diag.a.a(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7},RefreshTokenDurationInMS:{8}",!t,this.f,this.l,this.j,this.h.e.length,n.a().a().e.length>0?n.a().a().a(0).Name:"",n.a().a().e.length>0&&n.a().a().a(0).Errors.length>0?n.a().a().a(0).Errors[0].Id:"",n.a().a().e.length>0&&n.a().a().a(0).Errors.length>0?n.a().a().a(0).Errors[0].Details:""),!t)?this.t(n.a().b()):!1},a:function(n){return this.e.f(n)},t:function(n){for(var t,r,i=0;i<n.e.length;i++)t=n.a(i),t.Name==="AccessToken"&&(r=(new Date).getTime(),t.Expiry>Common.a.p?(Diag.a.a(39706827,217,50,"Updating AccessToken: {0}",{AccessTokenTtl:t.Expiry,NowGetTime:r,BootTime:Common.a.I},"PreviousAccessTokenTtl",Common.a.p),Common.a.fL(t.Value),Common.a.cT(Math.floor(t.Expiry)),Common.a.cA=r,Common.a.bz=Math.floor(t.Expiry)):Diag.a.a(39706828,217,50,"Ignoring AccessToken because it expires sooner than the current one: {0}",{AccessTokenTtl:t.Expiry,NowGetTime:r,BootTime:Common.a.I},"PreviousAccessTokenTtl",Common.a.p));return!0},r:function(n){for(var i,r=!1,t=0;t<n.e.length;t++)r=!0,i=n.a(t),Diag.a.a(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",i.Name,JSON.stringify(i.Errors),this.f);return r}};Common.App.SessionExpiration.h=function(){this.h=Common.a.dr;this.j=Common.a.dp;this.l=Common.a.dt;this.m=Common.a.bK;this.k=Common.a.bM;this.i=this.n();this.g=Common.a.dq};Common.App.SessionExpiration.h.prototype={i:null,g:null,h:0,b:function(){return this.h},j:0,c:function(){return this.j},l:null,a:function(){return this.l},m:0,k:0,d:function(){return this.k},f:function(n){var u=JSON.stringify(n),i;if(this.g&&this.g.length>0)for(var r=this.g,f=r.length,t=0;t<f;++t)if(i=r[t],i.length>0&&u.indexOf(i)>=0)return!0;return!1},e:function(n){var t,i,u;try{if(n)for(t=n.$$lge();t.$$mn();)if(i=t.$$cu(),i.Errors)for(var f=i.Errors,e=f.length,r=0;r<e;++r)if(u=f[r],u.Id in this.i)return Number.parseInvariant(this.i[u.Id].toString())}catch(o){Diag.a.a(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",o.toString())}return this.h},n:function(){var n={},i;try{if(!Common.a.bv||Common.a.bv.length<=0||Common.a.bv[0]==="")return n;for(var r=Common.a.bv,u=r.length,t=0;t<u;++t)i=r[t],i.length>0&&(n[i]=Common.a.ds)}catch(f){Diag.a.a(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",f.toString())}return n}};Common.App.SessionExpiration.m.registerClass("Common.App.SessionExpiration.m");Common.App.SessionExpiration.c.registerClass("Common.App.SessionExpiration.c",Common.App.SessionExpiration.m);Common.App.SessionExpiration.a.registerClass("Common.App.SessionExpiration.a",Common.App.SessionExpiration.m);Common.App.SessionExpiration.i.registerClass("Common.App.SessionExpiration.i");Common.App.SessionExpiration.b.registerClass("Common.App.SessionExpiration.b",null,Common.App.SessionExpiration.e);Type.registerNamespace("_Ewa");_Ewa.bef=function(){};_Ewa.bef.a=function(){Common.G.a('.ewr-selection-draghandle{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-top{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-bottom{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-left{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right{top:0;right:-2px;bottom:0;width:5px}.ms-core-needIEFilter .ewr-selection-draghandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:DRAGDRAGBORDER_ZINDEX;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:default}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ms-core-needIEFilter .ewr-selection-resizemarqueehandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}')};_Ewa.bef.a();Type.registerNamespace("_Ewa");_Ewa.beE=function(){};_Ewa.beE.a=function(){Common.G.a('.ewa-stb-ltr,.ewa-stb-rtl{position:absolute;right:0;bottom:0;left:0;background-color:#f6f6f6;color:#444;height:27px;padding:0;margin:0;-webkit-touch-callout:none;cursor:default}.ewa-stb-flex{display:flex;flex-flow:row nowrap}.ewa-stb-uir{background-color:#f3f2f1;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f3f2f1}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:absolute;top:0;border:0;height:27px;width:81px;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea{height:32px;width:96px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}.ewa-stb-flex .ewa-stb-navarea{position:relative;flex-shrink:0}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.InternetExplorer.v8 .ewa-stb-navbutton.cui-disabled .cui-img-container{-ms-filter:"alpha(opacity=30)"}.ewa-stb-navareaextra{position:absolute;top:0;border:0;height:27px;width:81px;padding:0;margin:0;overflow:hidden}.ewa-stb-flex .ewa-stb-navareaextra{position:relative;flex-shrink:0}.ewa-stb-contentarea{position:absolute;top:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-flex .ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%}.ewa-stb-ltr .ewa-stb-contentarea{left:82px;right:0}.ewa-stb-rtl .ewa-stb-contentarea{left:0;right:82px}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir.ewa-stb-ltr .ewa-stb-contentarea{left:97px;right:0}.ewa-stb-uir.ewa-stb-rtl .ewa-stb-contentarea{left:0;right:97px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-flex.ewa-stb-ltr .ewa-stb-contentarea{left:0;right:0}.ewa-stb-flex.ewa-stb-rtl .ewa-stb-contentarea{left:0;right:0}.ewa-stb-tabarea{position:absolute;top:0;height:27px;left:0;right:0}.ewa-stb-flex .ewa-stb-tabarea{position:relative}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f3f2f1;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}.ewa-stb-rtl.ewa-stb-ie8 .ewa-stb-tabs .tab-active{margin-left:1px}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:attr(sheet-title);position:absolute;display:inline-block;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}.ewa-stb-uir .tab-active .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{height:14px;top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa_nsv_margin{margin-left:4px !important}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none;-ms-overflow-style:none}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-progressbar-container{height:4px;top:11.5px;position:absolute}.ewa-stb-progressbar-outer-container-flex{flex:0 0 22%;height:4px;margin-top:11.5px}.ewa-stb-progressbar-inner-container-flex{height:4px;position:relative}.ewa-stb-ltr .ewa-stb-progressbar-outer-container-flex{margin-left:auto;margin-right:16px}.ewa-stb-rtl .ewa-stb-progressbar-outer-container-flex{margin-left:16px;margin-right:auto}.ewa-stb-progressbar-separator{height:27px;position:relative;bottom:10px}.ewa-stb-progressbar-message{display:none}.ewa-stb-ltr .ewa-stb-progressbar-container{right:16px}.ewa-stb-rtl .ewa-stb-progressbar-container{left:16px}.ewa-stb-ltr .ewa-stb-progressbar-separator{border-left:1px solid #e1e1e1;float:left;padding-right:8px}.ewa-stb-rtl .ewa-stb-progressbar-separator{border-right:1px solid #e1e1e1;float:right;padding-left:8px}.ewa-stb-progressbar{bottom:5.5px;position:relative;display:inline-block;width:16px;height:16px;border:2px solid #f3f2f1;border-top-color:#217346;border-radius:50%;animation:ms-Spinner-spin .8s infinite linear}@media screen and (min-width:560px){.ewa-stb-progressbar-message{display:block;position:relative;bottom:8.7px}.ewa-stb-ltr .ewa-stb-progressbar-message{float:left;padding-right:16px}.ewa-stb-rtl .ewa-stb-progressbar-message{float:right;padding-left:16px}}@media screen and (min-width:640px){.ewa-stb-progressbar-container{width:22%}.ewa-stb-progressbar{background-image:linear-gradient(90deg,#217346 30%,#e5eeeb,#217346 70%);background-size:300% 300%;position:relative;overflow:hidden;border-radius:100px;height:100%;border:none;bottom:0;width:auto;display:block}.ewa-stb-ltr .ewa-stb-progressbar{animation:loadingGradientAnimation 2.5s linear infinite reverse}.ewa-stb-rtl .ewa-stb-progressbar{animation:loadingGradientAnimation 2.5s linear infinite}}@media screen and (max-width:640px){.ewa-stb-progressbar-outer-container-flex{flex:0 0 calc(30px + 30px)}}@media screen and (max-width:560px){.ewa-stb-progressbar-outer-container-flex{flex:0 0 30px}}@keyframes loadingGradientAnimation{0%{background-position:0% 50%}100%{background-position:100% 50%}}@-webkit-keyframes loadingGradientAnimation{0%{background-position:0% 50%}100%{background-position:100% 50%}}@media screen and (-ms-high-contrast:active){.ewa-stb-progressbar{border:2px solid window;border-top-color:windowText}}@media screen and (-ms-high-contrast:active) and (min-width:640px){.ewa-stb-progressbar{background-image:linear-gradient(90deg,window 30%,windowText,window 70%);border:1px solid windowText}}@media screen and (prefers-reduced-motion:reduce){.ewa-stb-progressbar{display:none}.ewa-stb-progressbar-separator{display:none}}@media screen and (prefers-reduced-motion:reduce) and (min-width:560px){.ewa-stb-progressbar{animation:none;display:inline-block}.ewa-stb-progressbar-separator{display:block}}@media screen and (prefers-reduced-motion:reduce) and (min-width:640px){.ewa-stb-progressbar{background-size:100% 100%;background-image:linear-gradient(90deg,#217346 55%,#e5eeeb,#217346 95%);display:block}}@media screen and (prefers-reduced-motion:reduce) and (min-width:640px) and (-ms-high-contrast:active){.ewa-stb-progressbar{background-image:linear-gradient(90deg,window 55%,windowText,window 95%);display:block}}')};_Ewa.beE.a();Type.registerNamespace("_Ewa");_Ewa.bfh=function(){};_Ewa.bfh.a=function(){Common.G.a(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active){.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}")};_Ewa.bfh.a();Type.registerNamespace("_Ewa");_Ewa.Mc=function(){_Ewa.Mc.initializeBase(this);this.j()};_Ewa.Mc.prototype={b:function(){this.i(new Common.App.NewAndOpen.Core.g)}};_Ewa.Mc.registerClass("_Ewa.Mc",_Ewa.qc.$$(Sys.IDisposable));Type.registerNamespace("_Ewa");_Ewa.bcn=function(){};_Ewa.bcn.a=function(){_Ewa.j.a(function(n){n.b().b(_Ewa.bbq.$$(Sys.IDisposable),164,new _Ewa.Mc)})};_Ewa.bcn.a();Type.registerNamespace("_Ewa");_Ewa.Nu=function(n){this.l=Function.createDelegate(this,this.o);this.j=Function.createDelegate(this,this.p);_Ewa.Nu.initializeBase(this);this.c=n;this.a=document.createElement("div");this.a.className="ewr-msg-ctr";this.k=n.cm()&&n.isChangeGateEnabled("OfficeVSO:3474874_Qos2.0")};_Ewa.Nu.prototype={c:null,e:null,a:null,d:null,g:0,f:!1,h:!1,b:null,k:!1,dispose:function(){System.a.a(this.b);this.b=null;this.m();this.c=null;this.e=null;_Ewa.a.g(this.a);this.a=null},i:function(n,t,i,r,u,f,e){t!==this.e&&(this.e=t,_Ewa.a.b(this.a,!1,!0));n.appendChild(this.a);this.n(i,r,u,f,e)},n:function(n,t,i,r,u){if(!this.f&&n){var f=this;this.b=_Ewa.y.a().a(function(){f.q(i,r,u)},t,_Ewa.m.s,!0,!1)}else this.f&&!n&&(this.e.style.cssText="",_Ewa.a.b(this.a,!1,!0),System.a.a(this.b),this.b=null);this.f=n},q:function(n,t,i){var r,u;System.a.a(this.b);this.b=null;r=_Ewa.Q.a(this.c);!this.f||_Ewa.lg.a(r.b())||this.c.c().l()||_Ewa.bn.a(this.c)||this.n(!1,0,0,t,i);this.f&&this.e&&(this.h=this.c.a(1),!this.h&&this.c.a(18)&&_Ewa.lg.a(r.b())&&(this.h=this.c.h().r()),u=new Common.bQ(this.e),u.b(Common.g.k(this.e)/100,n),_Ewa.dY.a(_Ewa.bm.a()).a(u,"Shared_BasicClass","Shared_BasicClass",null,null),this.g=0,Diag.a.a(41993228,0,50,"BlockingUIProgressMessage.ShowProgressUI: showing progress message final-opacity [{0}] caller [{1}] details [{2}]",n,t,i),this.o())},p:function(){_Ewa.i.o(this.c.d().a(),null,null,null)},o:function(){if(System.a.a(this.b),this.b=null,this.f&&this.a){var n=[1104,1105];(this.g<0||this.g>=n.length)&&(this.g=0);this.m();this.a.innerHTML=String.format(this.h?"<span align='absmiddle'>{0}<\/span><br><a id='cancelAnchor' style='text-decoration:none;color:white;' href='#' role='link'>{1}<\/a>":"<span align='absmiddle'>{0}<\/span>",_Ewa.ClientStringManager.a().a(n[this.g++]),_Ewa.ClientStringManager.a().a(5));Diag.a.a(41993230,0,15,"BlockingUIProgressMessage.ShowProgressMsg: showing progress message");this.k&&Common.t.a().recordQosError("WorkingOnIt",["WorkingOnIt"],!0,!0,!0,!1,null);this.h&&(this.d=_Ewa.ha.a(_Ewa.a.a(this.a,"cancelAnchor")),this.d.a(this.j));_Ewa.a.b(this.a,!0,!0);this.d&&_Ewa.a.c(this.d.dA,!1);this.b=_Ewa.y.a().a(this.l,7e3,_Ewa.m.r,!0,!1)}},m:function(){this.d&&(this.d.b(this.j),System.a.a(this.d),this.d=null)}};_Ewa.Nv=function(){_Ewa.Nv.initializeBase(this)};_Ewa.Nv.prototype={a:null,b:!1,dispose:function(){System.a.a(this.a);this.a=null},i:function(n,t,i,r,u,f,e,o){if(i&&!this.b)if(r>0){var s=this;this.a=_Ewa.y.a().a(function(){s.c(n,t,f,e,o)},r,_Ewa.m.bO,!0,!1)}else this.c(n,t,f,e,o);else i||(System.a.a(this.a),this.a=null,this.d(n,t))},c:function(n,t,i,r,u){if(System.a.a(this.a),this.a=null,t&&n)n.innerText=u,_Ewa.a.b(t,!0,!0);else{Diag.a.a(42076105,0,15,"ProgressBarProgressMessage.ShowProgressBar: failed to show progress bar because {0} was null. caller [{1}] details [{2}]",t?"messageElement":"uiElement",i,r);return}this.b=!0;Diag.a.a(41993231,0,50,"ProgressBarProgressMessage.ShowProgressBar: showing progress bar. caller [{0}] details [{1}]",i,r)},d:function(n,t){if(t&&n)_Ewa.a.b(t,!1,!0),n.innerText="";else{Diag.a.a(42076106,0,15,"ProgressBarProgressMessage.HideProgressBar: failed to hide progress bar because {0} was null.",t?"messageElement":"uiElement");return}this.b=!1}};_Ewa.bdq=function(){};_Ewa.bdq.a=function(){_Ewa.j.a(function(n){n.b().b(_Ewa.jY,319,new _Ewa.Nu(n));n.b().b(_Ewa.jY,318,new _Ewa.Nv)})};_Ewa.Nu.registerClass("_Ewa.Nu",_Ewa.jY,Sys.IDisposable);_Ewa.Nv.registerClass("_Ewa.Nv",_Ewa.jY,Sys.IDisposable);_Ewa.bdq.a();Type.registerNamespace("_Ewa");_Ewa.Om=function(n,t,i){var r,u;this.o=Function.createDelegate(this,this.t);this.l=n;r=document.createElement("div");r.setAttribute("aria-hidden","true");r.className="ewa-gridReader";t.insertBefore(r,i);this.k=r;this.p=_Ewa.ClientStringManager.a().b(2);u=document.createElement("div");u.setAttribute("role","alert");u.setAttribute("aria-live","assertive");u.className="ewa-gridReader";t.insertBefore(u,r);this.m=u;this.u();this.l.b().b(_Ewa.cG,211,this)};_Ewa.Om.prototype={l:null,m:null,k:null,p:null,c:function(){return this.p},j:function(){return!0},r:function(){return _Ewa.b.a(this.l).e(null)},dispose:function(){this.l&&this.v();_Ewa.a.g(this.m);_Ewa.a.g(this.k);this.l=null;this.m=null;this.k=null},b:function(n){n?(this.k.setAttribute("aria-live","polite"),this.k.setAttribute("role","alert"),this.k.setAttribute("aria-hidden","false"),this.k.removeAttribute("aria-hidden"),this.k.innerHTML+=" "):(this.k.removeAttribute("aria-live"),this.k.removeAttribute("role"),this.k.setAttribute("aria-hidden","true"))},a:function(n){this.n(_Ewa.cu.a(n))},e:function(n,t){if(t<1||!n||!n.length){Diag.a.b(18219406,0,!1,"Skiping listbox description readout");return}var i=new Sys.StringBuilder,r=String.format(_Ewa.ClientStringManager.a().c(28),t,n);_Ewa.bw.a(i,r);_Ewa.bw.a(i,_Ewa.ClientStringManager.a().a(753));this.n(_Ewa.cu.a(i.toString()))},g:function(n,t,i){if(i<1||t<1||t>i||!n||!n.length){Diag.a.b(18219407,0,!1,"Skipping listbox item readout");return}var r=new Sys.StringBuilder;_Ewa.bw.a(r,n);r.append(String.format(_Ewa.ClientStringManager.a().c(49),t,i));this.n(_Ewa.cu.a(r.toString()))},f:function(n){var t=this.s(n);this.n(t)},n:function(n){var t=n?n.a():null;t&&(_Ewa.e.b(this.k.innerHTML,t,!1)&&(t=t+_Ewa.cu.e()),this.k.innerHTML=t)},d:function(n,t){this.m.getAttribute("aria-live")!==t&&this.m.setAttribute("aria-live",t);var i=n?_Ewa.cu.a(n).a():"";this.m.innerHTML=i},h:function(n,t,i,r){var u=_Ewa.ClientStringManager.a().c(48),f;Diag.a.b(19674567,0,!isNullOrUndefined(n),null);Diag.a.b(19674568,0,!isNullOrUndefined(t),null);Diag.a.b(19674569,0,!isNullOrUndefined(i),null);Diag.a.b(19674570,0,!isNullOrUndefined(r),null);Diag.a.b(19674571,0,!isNullOrUndefined(u),null);f=String.format(u,n||"",t||"",i||"",r||"");this.a(f)},i:function(n){var r=this.k.style,i,t;n?(i=_Ewa.bW.e(n.a(),r),t=i.a,t.top=t.left=t.bottom=t.right=null,i.b()):r.cssText=""},s:function(n){var t,i,r;switch(n){case-1985798686:return _Ewa.cu.b(11);case-911352779:return _Ewa.cu.b(10);case 237279923:return _Ewa.cu.b(12);case-1502853784:return _Ewa.cu.d(74);case-111689794:return _Ewa.cu.d(71);case-287251124:return t=this,this.q(1147,function(n){return n.n()});case-1925065947:return i=this,this.q(1148,function(n){return n.s()});case 1764140053:return r=this,this.q(1149,function(n){return n.t()})}return null},u:function(){Diag.a.b(18458268,0,!!this.l,"Can't register to ewaControl's events");this.l&&(Diag.a.b(18458269,0,!!this.l.g(),"Can't register to CommandHandlerManager's event"),this.l.g()&&this.l.g().l(this.o))},v:function(){this.l&&this.l.g().k(this.o)},t:function(n,t){this.f(t.a.a)},q:function(n,t){var i=this.r(),r;return i?(r=t(i)?6:7,_Ewa.cu.h(r,_Ewa.cu.b(n))):null}};_Ewa.xy=function(n){_Ewa.xy.initializeBase(this);this.h=n;this.j()};_Ewa.xy.a=function(n){n.b().b(_Ewa.bbq.$$(_Ewa.cG),212,new _Ewa.xy(n))};_Ewa.xy.prototype={h:null,b:function(){this.i(this.h.b().a(_Ewa.cG,211,!1)||new _Ewa.Om(this.h,this.h.bT(),this.h.N()))}};_Ewa.On=function(n,t,i){this.d=Function.createDelegate(this,this.f);this.c=t;this.b=n;this.e=new _Ewa.xB(n,t);this.a=i.c(this.c);this.a.a(this.d)};_Ewa.On.prototype={c:null,e:null,b:null,a:null,dispose:function(){this.a&&this.a.b(this.d);this.c=null;this.b=null;this.a=null},f:function(){this.e.c();this.b.b(!0)}};_Ewa.fg=function(n,t){this.e=t;this.f(n);this.g();_Ewa.s.d(n)&&n.b().b(_Ewa.kb,244,this)};_Ewa.fg.b=function(){if(!(_Ewa.fg.a!=null)){_Ewa.fg.a=!1;var n=Common.c.m()||Common.c.b();n&&(_Ewa.fg.a=!0,Diag.a.a(22115012,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on"))}return _Ewa.fg.a};_Ewa.fg.c=function(n){_Ewa.fg.b()&&n.b().b(_Ewa.fg,244,new _Ewa.fg(n,_Ewa.b.a(n).l().a().f()))};_Ewa.fg.prototype={b:null,d:null,c:null,e:null,j:function(){return!!this.e&&document.activeElement===this.e},a:function(n){this.b.setAttribute("aria-label",n);this.d.setAttribute("aria-label",n);this.h()},dispose:function(){this.c&&this.c.parentNode&&this.c.parentNode.removeChild(this.c);this.e=null;this.c=null;this.b=null;this.d=null},f:function(n){var r=n.n()+"readoutElementWrapper",u=n.n()+"readoutElement1",f=n.n()+"readoutElement2",i,t;this.c=document.getElementById(r);this.c||(this.c=document.createElement("div"),this.c.id=r,this.b=document.createElement("label"),this.b.id=u,this.d=document.createElement("label"),this.d.id=f,this.b.style.width="0px",this.b.style.height="0px",this.d.style.width="0px",this.d.style.height="0px",this.b.tabIndex=-1,this.d.tabIndex=-1,this.c.appendChild(this.b),this.c.appendChild(this.d),i=n.n()+"contentAreaDiv",t=document.getElementById(i),Diag.a.b(22115013,3,!!t,"FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: {0}",i),t&&t.appendChild(this.c))},g:function(){this.e&&this.b&&this.d&&(this.e.setAttribute("aria-activedescendant",this.b.id),this.e.setAttribute("aria-owns",String.format("{0} {1}",this.b.id,this.d.id)))},h:function(){var n,t;this.j()?(n="",_Ewa.a.D(this.e,"aria-activedescendant")&&(n=this.e.getAttribute("aria-activedescendant").toString()),t=n===this.b.id?this.d.id:this.b.id,this.e.setAttribute("aria-activedescendant",t)):Diag.a.b(22115014,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}};_Ewa.xz=function(n){_Ewa.xz.initializeBase(this);this.h=n;this.j()};_Ewa.xz.a=function(n){n.b().b(_Ewa.bbq.$$(_Ewa.kb),315,new _Ewa.xz(n))};_Ewa.xz.prototype={h:null,b:function(){if(_Ewa.fg.b()){var n=this;_Ewa.b.a(this.h).l().a().s(function(){var t=n.h.b().a(_Ewa.kb,244,!1)||new _Ewa.fg(n.h,_Ewa.b.a(n.h).l().a().f());n.i(t)})}else this.i(null)}};_Ewa.cu=function(n){this.b=n||""};_Ewa.cu.i=function(){return _Ewa.cu.c||(_Ewa.cu.c=new _Ewa.cu(""))};_Ewa.cu.e=function(){return _Ewa.cu.f||(_Ewa.cu.f=_Ewa.cu.d(2).a())};_Ewa.cu.a=function(n){var t=Common.e.b(n||"");return new _Ewa.cu(t)};_Ewa.cu.b=function(n){return _Ewa.cu.a(_Ewa.ClientStringManager.a().a(n))};_Ewa.cu.d=function(n){return new _Ewa.cu(_Ewa.ClientStringManager.a().b(n))};_Ewa.cu.h=function(n){for(var i=[],t=1;t<arguments.length;++t)i[t-1]=arguments[t];return _Ewa.cu.g.apply(null,[_Ewa.ClientStringManager.a().c(n)].concat(i))};_Ewa.cu.g=function(n){for(var u,f,t,r=[],i=1;i<arguments.length;++i)r[i-1]=arguments[i];for(u=r.length,f=new Array(u),t=0;t<u;t++)f[t]=(r[t]||_Ewa.cu.i()).a();return new _Ewa.cu(String.format.apply(null,[n].concat(f)))};_Ewa.cu.prototype={b:null,a:function(){return this.b}};_Ewa.bw=function(){};_Ewa.bw.a=function(n,t){!t||!t.length||(n.append(t),n.append(_Ewa.cu.e()))};_Ewa.SelectionReadoutHandler=function(n,t,i,r,u){this.f=Function.createDelegate(this,this.C);this.n=Function.createDelegate(this,this.B);this.p=Function.createDelegate(this,this.A);this.d=t;this.k=n;this.m=r;this.i=i;this.e=new _Ewa.SelectionReadoutHandler.c;this.l=_Ewa.fg.b();this.l&&(this.h=_Ewa.s.d(t)?u:t.b().a(_Ewa.kb,244,!1),Diag.a.b(21866445,0,!!this.h,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),_Ewa.SelectionReadoutHandler.b=700);this.j=_Ewa.y.a().a(this.p,_Ewa.SelectionReadoutHandler.b,_Ewa.m.bV,!1,!1);this.D()};_Ewa.SelectionReadoutHandler.h=function(n){var t=n.f(),i;switch(_Ewa.a.o(t,"_link","")){case"ext":return String.format(_Ewa.ClientStringManager.a().c(13),n.c(),t.href);case"int":return i=_Ewa.a.o(t,"_goto",""),String.format(_Ewa.ClientStringManager.a().c(12),n.c(),_Ewa.dK.i(i));default:return""}};_Ewa.SelectionReadoutHandler.d=function(n,t){return String.format(_Ewa.ClientStringManager.a().c(t),_Ewa.SelectionReadoutHandler.a(n.C,n.v,n.k),n.v)};_Ewa.SelectionReadoutHandler.g=function(n){var t=n.bk();return _Ewa.ClientStringManager.a().a(t?728:729)};_Ewa.SelectionReadoutHandler.a=function(n,t,i){return n&&n.length||t&&t.length?n:i};_Ewa.SelectionReadoutHandler.f=function(n){var u=n.b().a(),i=u.a(),t=i.g,f=t.ChartTitle,e=i.C,r=i.v,o=!!(t.Attributes&4),s=u.bH();return s?s:t.DataRangeForDisplay?String.format(_Ewa.ClientStringManager.a().c(o?43:41),_Ewa.SelectionReadoutHandler.a(e,r,i.k),r,f,_Ewa.ClientStringManager.a().a(_Ewa.ra.a(t.ChartCategory)),t.DataRangeForDisplay):String.format(_Ewa.ClientStringManager.a().c(o?44:42),_Ewa.SelectionReadoutHandler.a(e,r,i.k),r,f,_Ewa.ClientStringManager.a().a(_Ewa.ra.a(t.ChartCategory)))};_Ewa.SelectionReadoutHandler.j=function(n,t){return t.a(127)&&(n.bf()||n.be())};_Ewa.SelectionReadoutHandler.e=function(n,t){var r;if(!t.R()){Diag.a.b(41165275,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");return}if(t.bf())r=t.R().e().toString(),_Ewa.bw.a(n,String.format(_Ewa.ClientStringManager.a().c(22),r));else if(t.be()){var i=t.R().u(),u=(i.LastColumn-i.FirstColumn+1).toString(),f=(i.LastRow-i.FirstRow+1).toString();_Ewa.bw.a(n,String.format(_Ewa.ClientStringManager.a().c(23),u,f))}};_Ewa.SelectionReadoutHandler.i=function(n,t,i){if(n.k()||!i.a(179))return!1;var r=i.b().a(_Ewa.fq,271,!1);return r?r.x(t):!1};_Ewa.SelectionReadoutHandler.prototype={d:null,k:null,m:null,i:null,h:null,l:!1,j:null,g:null,r:function(){return _Ewa.b.a(this.d).e(null)},e:null,dispose:function(){this.d&&this.E();System.a.a(this.j);this.j=null;this.d=null;this.m=null},c:function(n,t,i){var f,r,l,u,a,y,o,w,s,b,k,h,c;if(!n)return"";f=this.d.b();r=new Sys.StringBuilder;this.u(r,n,t);l=n.O()?_Ewa.SelectionReadoutHandler.h(n):n.c();_Ewa.bw.a(r,l);u=this.d.W();this.e.b!==u&&(_Ewa.bw.a(r,u),this.e.b=u);a=t.length===1?_Ewa.g.g(t).j()?"":_Ewa.ClientStringManager.a().a(749):String.format(_Ewa.ClientStringManager.a().c(25),t.length);_Ewa.bw.a(r,a);for(var v=t,d=v.length,e=0;e<d;++e)y=v[e],_Ewa.bw.a(r,_Ewa.dK.d(y));if(this.d.a(723)){var p=n.a(),g=p.W(),nt=p.I(),tt=this.y(g,nt);_Ewa.bw.a(r,tt)}return this.t(r,n),i&&(n.C()?_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(730)):n.z()&&_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(731))),n.J()&&(this.v(r,n),i&&_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(733))),this.d.a(743)&&_Ewa.ev.b(this.d,n.b())&&_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(744)),this.s(r,n),o=f.a(_Ewa.gi,14,!1),w=o?o.c():"",_Ewa.bw.a(r,w),n.k()&&(s=_Ewa.b.a(this.d).b().e(n.b(),!1),_Ewa.SelectionReadoutHandler.j(n,this.d)?_Ewa.SelectionReadoutHandler.e(r,n):this.d.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&s&&s.S()?_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(735)):_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(734))),n.L()&&(_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(736)),b=n.bz(),_Ewa.bw.a(r,b)),n.N()&&(r.append(_Ewa.ClientStringManager.a().a(737)),k=n.bi(),k&&r.append(n.bi()),_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(738))),this.z(n)&&_Ewa.bw.a(r,_Ewa.SelectionReadoutHandler.g(n)),h=f.a(_Ewa.ng,231,!1),h&&_Ewa.bw.a(r,h.a(t,!0)),t.length===1&&t[0].j()&&_Ewa.SelectionReadoutHandler.i(n,t[0],this.d)&&(c=this.d.b().a(_Ewa.fq,271,!1),c&&_Ewa.bw.a(r,c.u())),this.d.isChangeGateEnabled("OfficeVSO:4072267_NarratorForTooltipError")&&n.bF()&&!_Ewa.e.a(n.bj())&&_Ewa.bw.a(r,n.bj()),r.toString()},a:function(n){this.g=this.e;var t;this.e=(t=new _Ewa.SelectionReadoutHandler.c,t.b=this.g.b,t.c=n?this.g.c:!1,t.a=n?this.g.a:"",t)},b:function(){this.g&&(this.e=this.g,this.g=null)},y:function(n,t){return n===2||t===2?_Ewa.ClientStringManager.a().a(769):n===1||t===1?_Ewa.ClientStringManager.a().a(770):""},C:function(){_Ewa.b.a(this.d).m()||this.j.b()},u:function(n,t,i){var r,u,f,e;if(i&&i.length===1&&i[0].j()){if(r="",u=this.i.d(t.b()),u){r=u.x;this.o(n,r);this.q(n,!0,r,u.O?_Ewa.ClientStringManager.a().a(725):"");_Ewa.bw.a(n,this.i.r(u,t.b())?_Ewa.ClientStringManager.a().a(727):"");_Ewa.bw.a(n,this.i.q(u,t.b())?_Ewa.ClientStringManager.a().a(726):"");return}if(f=this.i.b(t.b()),f){e=_Ewa.b.a(this.d).f().a(t.b(),!1);r=e?e.a:"";this.o(n,r);this.q(n,!1,r,"");_Ewa.bw.a(n,this.i.g(f,t.b())?_Ewa.ClientStringManager.a().a(726):"");return}this.o(n,r);this.e.a=""}},o:function(n,t){t===this.e.a||_Ewa.e.a(this.e.a)||(n.append(_Ewa.ClientStringManager.a().a(this.e.c?724:723)),_Ewa.bw.a(n," "+this.e.a))},q:function(n,t,i,r){i!==this.e.a&&(n.append(_Ewa.ClientStringManager.a().a(t?722:721)),_Ewa.bw.a(n," "+i),_Ewa.bw.a(n,r),this.e.a=i,this.e.c=t)},D:function(){var n,t;Diag.a.b(19265428,0,!!this.d,"Can't register to ewaControl's events");this.d&&(n=_Ewa.b.a(this.d),Diag.a.b(19265429,0,!!n,"Can't register to grid's events"),n&&(n.g().c(this.n),n.b().d(this.f),n.K(this.f),t=n.a(),Diag.a.b(19265430,0,!!t,"Can't register to selectionManager's events"),t&&(t.g(this.f),t.i(this.f),t.b().f(this.f))))},E:function(){var n,t;this.d&&(n=_Ewa.b.a(this.d),n&&(n.g().d(this.n),n.b().f(this.f),n.L(this.f),t=n.a(),t&&(t.h(this.f),t.j(this.f),t.b().h(this.f))))},A:function(){if(!_Ewa.b.a(this.d).a().b().o()){var n,t,i,r=(i=this.w(t={val:n}),n=t.val,i);this.l&&this.h&&this.h.j()?this.h.a(r):(this.k.a(r),this.k.i(n))}},B:function(){var n=this.r();n&&n.M()&&!_Ewa.b.a(this.d).cK()||this.j.a()},w:function(n){var t,r,o,u,s,h;if(n.val=null,t=_Ewa.b.a(this.d).a(),t.e()!==1&&!t.b().a())return Diag.a.a(40632717,0,15,"selectionManager.CommandSelectionMode={0} and selectionManager.SelectedFloatingObjectControl is null",t.e()),"";switch(t.e()){case 2:return this.x(t);case 64:var i=t.b().a().a(),f="",e=t.b().a().g()||t.b().a().j();return e&&(r=e.firstChild,f=r?_Ewa.a.H(r):""),String.format(_Ewa.ClientStringManager.a().c(47),_Ewa.SelectionReadoutHandler.a(i.C,i.v,i.k),f,i.v);case 4:return o=t.b().a().a(),_Ewa.SelectionReadoutHandler.d(o,46);case 8:return u=t.b().a().a(),s=u?u.k:"",String.format(_Ewa.ClientStringManager.a().c(45),s);case 1:return n.val=this.r(),h=this.d.a(462)?t.d().a():[t.a()],this.c(n.val,h,!0)}return""},x:function(n){var t=new Sys.StringBuilder,i,r;return t.append(_Ewa.SelectionReadoutHandler.f(n)),i=this.d.b().a(_Ewa.ng,231,!1),i&&(r=n.b().a().a(),_Ewa.bw.a(t,i.a(r,!1))),t.toString()},z:function(n){var t=n.bk(),i=!1;return this.e.d!==t&&(this.e.d=t,i=!0),i},t:function(n,t){var i,r,u;t.bc()&&(i=this.m.b(t),i?(r=_Ewa.ClientStringManager.a().a(_Ewa.Qa.a(i.t)),_Ewa.bw.a(n,String.format(_Ewa.ClientStringManager.a().c(21),r)),u=String.format(_Ewa.ClientStringManager.a().c(20),_Ewa.dK.d(i.q)),_Ewa.bw.a(n,u)):(Diag.a.a(20821025,0,15,"No sparkline range was found on a cell with sparkline."),_Ewa.bw.a(n,String.format(_Ewa.ClientStringManager.a().c(21),""))))},v:function(n,t){switch(t.a().bi()){case 1:_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(745));break;case 6:_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(745));_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(747));break;case 7:_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(745));_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(748));break;case 2:_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(746));_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(747));break;case 3:_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(746));_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(748));break;default:_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(746))}},s:function(n,t){var u=this.d.b().a(_Ewa.eL,65,!1),i=u?u.J(t.b()):null,f="",r=$$as(_Ewa.jq,i);i&&(f=this.d.isChangeGateEnabled("OfficeVSO:3940516_SetTaskFlagOnExcelThreadedComment")&&!i.B()&&r&&r.N()?String.format(_Ewa.ClientStringManager.a().c(24),r.O()):String.format(_Ewa.ClientStringManager.a().c(19),i.R()));_Ewa.bw.a(n,f)}};_Ewa.SelectionReadoutHandler.c=function(){};_Ewa.SelectionReadoutHandler.c.prototype={b:null,d:!1,a:null,c:!1};_Ewa.xA=function(n){_Ewa.xA.initializeBase(this);this.h=n;this.j()};_Ewa.xA.a=function(n){n.b().b(_Ewa.bbq.$$(_Ewa.iL),227,new _Ewa.xA(n))};_Ewa.xA.prototype={h:null,b:function(){var n=this.h.b(),r=_Ewa.l.b(_Ewa.cG,n,211,212,this.l),u=_Ewa.l.b(_Ewa.dq,n,66,134,this.l),f=_Ewa.l.b(_Ewa.kh,n,240,239,this.l),t=$$sc.a.a(_Ewa.kb,null),i;_Ewa.s.d(this.h)&&(t=_Ewa.l.b(_Ewa.kb,n,244,315,this.l));i=this;_Ewa.f.cw(_Ewa.f.ws([r,u,f,t],this.dD(),3),function(){var e=n.a(_Ewa.iL,226,!1)||new _Ewa.SelectionReadoutHandler(r.a(),i.h,u.a(),f.a(),t.a());i.i(e)},this.h.i(),3)}};_Ewa.xB=function(n,t){this.a=t;this.b=n};_Ewa.xB.prototype={a:null,b:null,c:function(){var n=this.d();this.b.d(n,"assertive")},d:function(){var n=new Sys.StringBuilder;return this.a.l()&&_Ewa.bw.a(n,this.a.l().WorkbookFileName),_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(751)),_Ewa.bw.a(n,this.f()),_Ewa.bw.a(n,this.e()),_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(752)),n.toString()},f:function(){return this.a.k()?_Ewa.ClientStringManager.a().a(756):_Ewa.ClientStringManager.a().a(757)},e:function(){var i=this.g(),n=this.a.f().a(),r=i!==1?String.format(_Ewa.ClientStringManager.a().c(26),i):_Ewa.ClientStringManager.a().a(750),t=new Sys.StringBuilder(r);return n&&!_Ewa.e.a(n.c())&&(t.append(_Ewa.cu.e()),t.append(String.format(_Ewa.ClientStringManager.a().c(27),n.c()))),t.toString()},g:function(){for(var r,t=0,i=this.a.f().j(),u=i.length,n=0;n<u;++n)r=i[n],r.o()&&t++;return t}};_Ewa.Oq=function(n,t){this.a=Function.createDelegate(this,this.g);this.d=!1;this.b=t.ba();this.c=n;this.e=new _Ewa.xB(n,t);this.b&&this.b.be()?this.f():this.h()};_Ewa.Oq.prototype={b:null,e:null,c:null,d:!1,dispose:function(){this.i();this.b=null;this.c=null;this.d=!0},h:function(){if(!this.b){Diag.a.a(20235935,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events");return}this.b.t(this.a);this.b.b().d(this.a);this.b.K(this.a);var n=$$as(_Ewa.eu,this.b);n&&(n.g().c(this.a),n.a().g(this.a),n.a().i(this.a),n.a().b().f(this.a))},i:function(){if(this.b){this.b.b().f(this.a);this.b.L(this.a);var n=$$as(_Ewa.eu,this.b);n&&(n.g().d(this.a),n.a().h(this.a),n.a().j(this.a),n.a().b().h(this.a))}},g:function(){this.d||this.f()},f:function(){this.e.c();this.c.b(!0);this.dispose()}};_Ewa.xC=function(n){_Ewa.xC.initializeBase(this);this.h=n;this.j()};_Ewa.xC.a=function(n){n.b().b(_Ewa.bbq.$$(Sys.IDisposable),229,new _Ewa.xC(n))};_Ewa.xC.prototype={h:null,b:function(){var u=this.h.b(),n=_Ewa.l.b(_Ewa.cG,u,211,212,this.l),t,i,r;this.h.bU()?(t=_Ewa.l.a(_Ewa.cX,this.h.b(),12,this.h.i(),this.l),i=this,_Ewa.f.cw(_Ewa.f.ws([n,t],this.h.i(),3),function(){var r=new _Ewa.On(n.a(),i.h,t.a());i.i(r)},this.h.i(),3)):(r=this,_Ewa.f.cw(n,function(n){var t=new _Ewa.Oq(n.a(),r.h);r.i(t)},this.h.i(),3))}};_Ewa.xy.registerClass("_Ewa.xy",_Ewa.qc.$$(_Ewa.cG));_Ewa.On.registerClass("_Ewa.On",null,Sys.IDisposable);_Ewa.fg.registerClass("_Ewa.fg",null,_Ewa.kb,Sys.IDisposable);_Ewa.xz.registerClass("_Ewa.xz",_Ewa.qc.$$(_Ewa.kb));_Ewa.SelectionReadoutHandler.registerClass("_Ewa.SelectionReadoutHandler",null,_Ewa.iL,Sys.IDisposable);_Ewa.SelectionReadoutHandler.c.registerClass("_Ewa.SelectionReadoutHandler.c");_Ewa.xA.registerClass("_Ewa.xA",_Ewa.qc.$$(_Ewa.iL));_Ewa.Oq.registerClass("_Ewa.Oq",null,Sys.IDisposable);_Ewa.xC.registerClass("_Ewa.xC",_Ewa.qc.$$(Sys.IDisposable));_Ewa.fg.a=null;_Ewa.cu.c=null;_Ewa.cu.f=null;_Ewa.SelectionReadoutHandler.b=500;Type.registerNamespace("_Ewa");_Ewa.bed=function(){};_Ewa.bed.a=function(){_Ewa.j.a(function(n){_Ewa.xy.a(n);_Ewa.s.d(n)?_Ewa.xz.a(n):_Ewa.fg.c(n);_Ewa.xA.a(n);_Ewa.xC.a(n)})};_Ewa.bed.a();Type.registerNamespace("_Ewa");_Ewa.Lk=function(n,t){this.sheetName=n;this.newSheetIndex=t};_Ewa.Lk.prototype={sheetName:null,newSheetIndex:0};_Ewa.beD=function(){};_Ewa.qh=function(n,t,i,r){this.c=Function.createDelegate(this,this.h);this.e=Function.createDelegate(this,this.i);_Ewa.qh.initializeBase(this,[document.createElement("a"),null]);this.b=t;this.f=r;this.a=i?"ewa-stb-insert-new-uir":"ewaboot-stb-insert-new";this.d=_Ewa.kf.a(this.cl(),_Ewa.ClientStringManager.a().a(459),0,this.a,_Ewa.ClientStringManager.a().a(460),i,r);n.appendChild(this.cl());var u=this;this.cr().a("contextmenu",function(n){_Ewa.D.a(n,!0)},!1);i||(this.cr().a("mouseover",this.e,!1),this.cr().a("mouseout",this.e,!1));Common.i.a().a("click",this.cl(),this.c);this.g=Common.h.a().c(this.cl(),this.c,13,32)};_Ewa.qh.prototype={a:null,b:null,d:null,f:!1,g:null,dispose:function(){Common.i.a().b("click",this.cl(),this.c);Common.h.a().d(this.cl(),this.g);this.d=null;this.b=null;_Ewa.VA.prototype.dispose.call(this)},h:function(n){return this.f||this.b.C(-1935155518,n.b,0,null),!0},i:function(n){var t=n.type==="mouseover"||n.type==="focus";_Ewa.k.A(this.d,this.a,this.a+"-hover",t&&!_Ewa.b.a(this.b).B())}};_Ewa.Pv=function(n,t,i){this.c=Function.createDelegate(this,this.g);this.e=Function.createDelegate(this,this.h);_Ewa.Pv.initializeBase(this,[document.createElement("a"),null]);this.b=t;this.a=t.a(850)?"ewa-stb-insert-new-uir":"ewaboot-stb-insert-new";this.d=_Ewa.kf.a(this.cl(),_Ewa.ClientStringManager.a().a(461),0,this.a,_Ewa.ClientStringManager.a().a(462),i,!1);n.appendChild(this.cl());var r=this;this.cr().a("contextmenu",function(n){_Ewa.D.a(n,!0)},!1);this.cr().a("mouseover",this.e,!1);this.cr().a("mouseout",this.e,!1);Common.i.a().a("click",this.cl(),this.c);this.f=Common.h.a().c(this.cl(),this.c,13,32)};_Ewa.Pv.prototype={a:null,b:null,d:null,f:null,dispose:function(){Common.i.a().b("click",this.cl(),this.c);Common.h.a().d(this.cl(),this.f);this.d=null;this.b=null;_Ewa.VA.prototype.dispose.call(this)},g:function(n){return this.b.C(-684145703,n.b,0,null),!0},h:function(n){var t=n.type==="mouseover"||n.type==="focus";_Ewa.k.A(this.d,this.a,this.a+"-hover",t&&!_Ewa.b.a(this.b).B())}};_Ewa.Pw=function(n,t){this.k=t;this.l=n;this.m=_Ewa.ClientStringManager.a().a(1611)};_Ewa.Pw.prototype={k:!1,l:null,m:null,b:function(){return this.l.m()},i:function(){return this.l.T()},e:function(){return this.k?"ewa-stb-lock-uir":this.b()?"ewa-stb-lock-active":"ewa-stb-lock"},d:function(){return null},f:function(){return this.k?"ewa-stb-locked-sheet":null},j:function(){return null},a:function(){return null},h:function(){return 0},g:function(){return this.m},c:function(){return!0}};_Ewa.yb=function(n,t,i){this.k=n;this.l=_Ewa.ClientStringManager.a().a(1611);this.n=t;this.m=i};_Ewa.yb.prototype={k:null,n:null,l:null,m:null,b:function(){return this.k.m()},i:function(){return this.k.e.c()},d:function(){return this.b()?"ewa-stb-nsv-active":"ewa-stb-nsv-inactive"},e:function(){return!this.b()&&this.m()?"ewamenu_namedSheetViewSheetTabWhite":"ewamenu_namedSheetViewSheetTabBlack"},f:function(){return"ewa_nsv_margin"},j:function(){return this.k.e.f()},a:function(){return this.n},h:function(){return 8},g:function(){return this.l},c:function(){return!1}};_Ewa.nr=function(n,t){this.m=Function.createDelegate(this,this.r);this.n=Function.createDelegate(this,this.s);this.d=n;this.b=t};_Ewa.nr.prototype={b:null,c:null,h:null,d:null,j:null,k:!1,f:null,e:null,g:null,i:function(){return this.h||(this.h=_Ewa.bP.a().a(this.a))},p:function(){if(this.j)return this.j;var n=new($$sc.C.$$(Boolean)),t=this;return this.d.X(function(i){_Ewa.f.cw(i.c(),function(){n.b(!0)},t.d.i(),3)}),this.j=n.a},a:null,u:function(){var n,t,i;this.a&&this.c&&(n=this.b.e(),this.f!==n&&(this.l(this.c,this.f,n),this.f=n),t=this.b.d(),this.e!==t&&(this.l(this.c,this.e,t),this.e=t),i=this.b.f(),this.g!==i&&(this.l(this.a,this.g,i),this.g=i),this.b.a()&&!this.b.b()&&this.o())},t:function(n,t,i){this.q(n,t,i);_Ewa.a.b(this.a,this.b.i(),!0)},o:function(){var n=this;_Ewa.f.cw(this.p(),function(){dialogControls.clearToolTip(n.b.a())},this.d.i(),3)},q:function(n,t,i){if(this.a&&this.k!==n&&(this.a.parentNode.removeChild(this.a),this.a=null,this.f=null,this.e=null,this.g=null,this.b.a()&&(this.i().b("mouseover",!0),this.i().b("mouseout",!0))),!this.a){this.a=document.createElement("span");Sys.UI.DomElement.addCssClass(this.a,"cui-img-container");Sys.UI.DomElement.addCssClass(this.a,"clip16x16");this.d.a(850)?n===this.b.c()?t.appendChild(this.a):t.insertBefore(this.a,i):n?t.insertBefore(this.a,i):t.appendChild(this.a);this.c=document.createElement("img");this.c.tabIndex=-1;this.c.alt=this.b.g();this.a.appendChild(this.c);var r=this.b.h();this.c.src=_Ewa.q.a(r);this.b.a()&&(this.i().a("mouseover",this.n,!0),this.i().a("mouseout",this.m,!0));this.k=n}},l:function(n,t,i){t&&Sys.UI.DomElement.removeCssClass(n,t);i&&Sys.UI.DomElement.addCssClass(n,i)},dispose:function(){System.a.a(this.h)},s:function(){if(this.b.b()){var n=this;_Ewa.f.cw(this.p(),function(){dialogControls.renderToolTip(n.b.a(),"SheetIconTooltip",n.b.j(),n.a,10,!1,!1,1)},this.d.i(),3)}},r:function(){this.b.b()&&this.o()}};_Ewa.kf=function(n,t){var i,r;this.bQ=Function.createDelegate(this,this.ed);this.bR=Function.createDelegate(this,this.ee);this.V=Function.createDelegate(this,this.dK);this.bO=Function.createDelegate(this,this.dZ);this.E=Function.createDelegate(this,this.dJ);this.by=Function.createDelegate(this,this.df);this.cu=Function.createDelegate(this,this.dP);this.bG=Function.createDelegate(this,this.dN);this.co=Function.createDelegate(this,this.dM);this.bE=Function.createDelegate(this,this.dF);this.bP=Function.createDelegate(this,this.cT);this.bF=Function.createDelegate(this,this.dL);this.bB=Function.createDelegate(this,this.dC);this.bA=Function.createDelegate(this,this.dB);this.bM=Function.createDelegate(this,this.dU);this.bN=Function.createDelegate(this,this.dY);this.bL=Function.createDelegate(this,this.dT);this.bK=Function.createDelegate(this,this.dS);this.bJ=Function.createDelegate(this,this.dR);this.bH=Function.createDelegate(this,this.dQ);this.bD=Function.createDelegate(this,this.dE);this.bC=Function.createDelegate(this,this.dD);this.dd=_Ewa.ClientStringManager.a().a(633);this.dc=_Ewa.ClientStringManager.a().a(635);this.g=[];this.s=new Array(6);this.bu=new Array(6);this.S=-1;this.bl=-1;_Ewa.kf.initializeBase(this,[t,null]);this.f=n;this.bg=this.f.c();this.k=this.f.a(687);this.A=this.f.a(816);this.bs=this.f.isChangeGateEnabled("OfficeVSO:4031755_AdjustSheetTabBarToVirtualKeyboard")&&this.f.P()&&this.A;this.j=this.f.a(850);this.k&&(this.O=this.f.isChangeGateEnabled("OfficeVSO:4150659_ReorderSheetsWithTouch")&&this.j&&!Common.c.g(),this.bX=this.f.isChangeGateEnabled("OfficeVSO:4142600_EndSheetTabButtonDragOnDispose"),this.bW=this.f.isChangeGateEnabled("OfficeVSO:4176547_DisableMultipleSheetTabBarReorders"));this.cb=this.f.e().SheetTabNavigateButtonLongKeyPressPeriodMS;this.ca=this.f.e().SheetTabNavigateButtonIntervalPeriodMS;this.H=-1;this.G=-1;this.X=!1;this.bp=new _Ewa.fL(this.cl(),3,null);Common.c.i()&&Sys.UI.DomElement.addCssClass(this.cl(),"ewa-stb-ie8");this.A&&Sys.UI.DomElement.addCssClass(this.cl(),"ewa-stb-flex");this.j&&Sys.UI.DomElement.addCssClass(this.cl(),"ewa-stb-uir");this.dk();this.di();this.j||this.dl();this.dn();this.cY(!0);this.cT(null,null);i=this.f.f();i.c(this.bC);i.s(this.bD);i.k(this.bH);i.n(this.bJ);i.t(this.bK);i.K(this.bL);i.p(this.bN);i.H(this.bM);i.J(this.bA);i.A(this.bB);i.B(this.bF);this.f.E(this.bP);this.f.R(this.bE);_Ewa.bq.a(this.f).a(this);this.f.b().b(_Ewa.eD,32,this);this.bi=this.cq.a(this.cl());this.bi.a("keydown",this.co,!1);Common.J.a().a(Common.v.a(),this.cl(),this.bG);this.bj=this.cq.a(this.h);this.bj.a("scroll",this.cu,!1);r=this;this.cj=_Ewa.mF.a(function(){r.u()},200,this.f.i(),_Ewa.m.cb,!0,!1);this.bs&&_Ewa.cE.a().g()&&_Ewa.cE.a().g().i(this.by)};_Ewa.kf.a=function(n,t,i,r,u,f,e){var s,o;return n.removeAttribute("Href"),n.setAttribute("role","button"),n.className="ewa-stb-navbutton",n.title=t,n.tabIndex=0,s=document.createElement("span"),s.className=f?"clip12x12":"clip16x16",Sys.UI.DomElement.addCssClass(s,"cui-img-container"),e&&Sys.UI.DomElement.addCssClass(n,"cui-disabled"),s.tabIndex=-1,n.appendChild(s),o=document.createElement("img"),o.src=_Ewa.q.a(i),o.className=r,o.alt=u,o.tabIndex=-1,s.appendChild(o),o};_Ewa.kf.b=function(n,t,i,r){n<i.val?(t>i.val&&i.val--,t>r.val&&r.val--):n>r.val?(t<i.val&&i.val++,t<r.val&&r.val++):t<i.val&&i.val++};_Ewa.kf.prototype={cj:null,k:!1,A:!1,bs:!1,j:!1,cb:0,ca:0,f:null,bg:null,bp:null,h:null,bk:null,J:null,I:null,bh:null,r:null,R:null,l:!1,i:0,n:0,bf:!1,Y:!1,bi:null,bj:null,H:0,G:0,X:!1,C:0,bX:!1,bW:!1,L:null,w:null,t:null,p:null,m:0,bb:0,U:null,F:null,bc:0,B:0,T:0,be:0,D:function(){return this.cl()},bt:function(){return this.cs()},bd:function(){return"STB"},o:!1,v:null,e:function(n){return this.v=n,n},P:null,bo:null,a:function(){return this.bo},bS:null,b:function(){return this.bS},W:null,O:!1,bm:null,bn:!1,bY:function(){return this.j?this.f.J()?["ewa-stb-last","ewa-stb-next-uir","ewa-stb-prev-uir","ewa-stb-first","ewa-stb-more","ewa-stb-more"]:["ewa-stb-first","ewa-stb-prev-uir","ewa-stb-next-uir","ewa-stb-last","ewa-stb-more","ewa-stb-more"]:this.f.J()?["ewa-stb-last","ewa-stb-next","ewa-stb-prev","ewa-stb-first","ewa-stb-more","ewa-stb-more"]:["ewa-stb-first","ewa-stb-prev","ewa-stb-next","ewa-stb-last","ewa-stb-more","ewa-stb-more"]},Z:function(){if(this.l){if(Common.c.l())return 0;if(Common.c.b())return-1*(this.h.scrollWidth-this.h.clientWidth);if(Common.c.g())return this.h.scrollWidth-this.h.clientWidth;Diag.a.a(594915794,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0},ba:function(){if(this.l){if(Common.c.l())return this.h.scrollWidth-this.h.clientWidth;if(Common.c.b()||Common.c.g())return 0;Diag.a.a(594915793,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.h.scrollWidth-this.h.clientWidth},dispose:function(){var n,t,i;if(this.f&&(n=this.f.f(),n.e(this.bC),n.w(this.bD),n.l(this.bH),n.o(this.bJ),n.x(this.bK),n.R(this.bL),n.z(this.bN),n.O(this.bM),n.Q(this.bA),n.E(this.bB),n.F(this.bF),this.f.G(this.bP),this.f.S(this.bE),Common.J.a().b(Common.v.a(),this.cl(),this.bG),this.bs&&_Ewa.cE.a().g()&&_Ewa.cE.a().g().k(this.by)),System.a.b(this.bu),this.bu=null,this.s)for(t=0;t<this.s.length;t++)i=_Ewa.a.Z(this.s[t],this.cl(),!1,"a"),i&&Common.j.e(i);System.a.a(this.bp);System.a.a(this.bi);System.a.a(this.bj);this.bp=null;this.r=null;this.R=null;this.bi=null;this.bj=null;this.f&&this.k&&(this.bX?this.y(!1):this.bx(!1));this.w=null;this.cg(null,"Dispose");this.L=null;this.p=null;this.U=null;this.bU();this.bg=null;this.f=null;this.s=null;this.h=null;this.bk=null;this.J=null;this.I=null;_Ewa.VA.prototype.dispose.call(this)},x:function(n,t){var i,f;if(!t){if(Diag.a.b(2472137,0,this.g.length>0,"There is no sheet tab button."),!this.g.length)return!1;i=null;for(var u=this.g,e=u.length,r=0;r<e;++r)if(f=u[r],i=f.be(),i)break;if(!i)return Diag.a.b(18661726,0,!1,"There is no focusable tab element."),!1;_Ewa.a.c(i,!1)}return!t},dy:function(n){return _Ewa.a.h(this.D(),n)},cw:function(){},bI:function(){},d:function(n,t,i){var u,r;this.v&&this.v!==n&&(u=this.v.f,this.ea(this.v,n,t),r=n?n.f-1:t?this.f.f().d()-1:0,u!==r&&(this.dA(u,r,i),this.dr(this.v.a,r)))},dQ:function(n,t){this.cR(t.a)},dS:function(n,t){for(var r,u=this.f.f().a().f,i=0,f=this.g.length;i<f;i++)if(r=this.q(i),r.c.innerText===t.b){r.V(t.a);this.u();i===u&&this.z(6);break}},dU:function(n,t){var i=this.Q(t.a);i&&i.y()},dY:function(n,t){t.b?(this.N(!1),this.cS(t.a)):this.cR(t.a)},c:function(n){var t=this.K(n);return t!==-1&&this.i<=t&&t<=this.n?this.g[t].cl():null},dX:function(n,t){var i=_Ewa.b.a(this.f),f=i.m(),r=i.B();f&&!r&&_Ewa.b.a(this.f).bM(!0,"SheetTabBar.OnSheetTabMouseDown");var e=t.a,o=t.b===2&&!e.button,u=this.O&&t.b===3;!(o||u)||r||this.bW&&this.o||(u&&n.bp(),this.S=t.get_clientPoint().x,this.dh(n,t.get_clientPoint().x))},dV:function(n){!this.k&&this.o&&this.ch(n.b,!1)},dW:function(n){this.k||(this.o&&this.d(n.b,!1,!0),this.y(!0));this.u()},cD:function(){return this.f.k()&&!(this.f.x()&16384)},df:function(n,t){var r=t.b,u=t.c,f=t.a,i=t.d;switch(r){case 2:this.cl().style.left=i[0].width+"px";this.cl().style.right="";break;case 3:this.cl().style.left="";this.cl().style.right=i[1].width+"px";break;default:this.cl().style.left="";this.cl().style.right=""}},u:function(){var n=this,t=_Ewa.k.x(function(){var t,i,r,u;if(!n.A){for(n.I.style.width=n.T.toString()+"px",n.J&&(n.J.style.left=(n.l?0:n.T+81+n.be+1).toString()+"px"),t=6,i=0;i<n.g.length;i++){if(r=n.q(i),!r)break;u=r.cl();t+=u.offsetWidth}(Common.c.b()||Common.c.a())&&(t+=(n.n-n.i+1)/2);t=Math.min(t,n.T);n.I.style.width=t.toString()+"px";n.J&&(n.J.style.left=(n.l?n.T-t+n.be:t+81+1).toString()+"px")}n.ek();n.j&&n.eg();n.ef()});Diag.a.a(51446688,0,50,"SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = {0}",t)},eg:function(){var n=!this.i,t=this.n===this.g.length-1;_Ewa.a.f(this.I,this.f.J()?"ewa-stb-right-scrollable":"ewa-stb-left-scrollable",!n);_Ewa.a.f(this.I,this.f.J()?"ewa-stb-left-scrollable":"ewa-stb-right-scrollable",!t)},ef:function(){var n=!this.i,t=this.n===this.g.length-1;this.da(4,this.dd,!n);this.da(5,this.dc,!t);this.bw(0,n);this.bw(1,n);this.bw(2,t);this.bw(3,t)},da:function(n,t,i){var r=this.s[n],u;r&&(_Ewa.a.b(r,i,!0),u=r.parentNode.parentNode,u.title=r.alt=this.g.length>0&&i?t:"",u.tabIndex=i?0:-1)},bw:function(n,t){var r=this.s[n],i;r&&((i=r.parentNode.parentNode,isNullOrUndefined(i))||(!this.g.length||t?(Sys.UI.DomElement.addCssClass(i,"cui-disabled"),i.setAttribute("aria-disabled","true")):(Sys.UI.DomElement.removeCssClass(i,"cui-disabled"),i.setAttribute("aria-disabled","false"))))},N:function(n){var i=this.f.J()?0:this.g.length-1,r=this.f.J()?this.g.length-1:0,t=this.cJ(i);(t&&(t.borderRightWidth=n?"1px":"0"),this.i!==this.n)&&(t=this.cJ(r),t&&(t.borderRightWidth="0"))},cC:function(n,t){this.g||(this.g=[]);t===-1?Array.add(this.g,n):Array.insert(this.g,t,n)},cG:function(n,t){var i=-1,u=null,r;t||(i=this.dw(n.f),i!==-1&&(u=this.M(i)));r=new _Ewa.gq(this.f,this.h,u,n,this,this.j);this.cC(r,i);_Ewa.a.b(r.cl(),!0,!0)},ch:function(n,t){var u=this.Q(n),i,r,f;u&&(this.bm=n,this.bn=t,i=u.cl(),r=this.l?i.offsetLeft+(this.h.scrollWidth-this.h.clientWidth-this.h.scrollLeft):i.offsetLeft-this.h.scrollLeft,f=!this.l&&t||this.l&&!t,f&&(r+=i.offsetWidth),this.bh.style.left=r-4+"px",_Ewa.a.b(this.bh,!0,!0))},cL:function(){_Ewa.a.b(this.bh,!1,!0)},z:function(n){var t=this,i=_Ewa.k.x(function(){switch(n){case 0:t.bv(0);break;case 1:t.bv(t.i-1);break;case 2:t.bv(t.i+1);break;case 3:t.cV(t.g.length-1);break;case 4:t.i&&t.g.length>=1&&(t.cz(t.i-1),t.cf());break;case 5:t.n!==t.g.length-1&&t.g.length>=1&&(t.cz(t.n+1),t.cf());break;case 6:t.cf()}});Diag.a.a(51446689,0,50,"SheetTabBarControl.ScrollSheetTabs: operation = {0}, duration = {1}",n,i)},cz:function(n){var t=this.q(n);t&&t.O(0,!1)},dv:function(n){var i,r,t,f,u;if(!n.h)for(i=this.f.f(),r=0,t=0,f=i.d();t<f;t++){if(u=$$as(_Ewa.G,i.g(t)),u===n)return r;u.h||r++}return-1},dt:function(n){for(var i,r=this.f.f(),t=n.f+1,u=r.d();t<u;t++)if(i=$$as(_Ewa.G,r.g(t)),!i.h)return i;return null},K:function(n){for(var i,t=0;t<this.g.length;t++)if(i=this.q(t),this.f.isChangeGateEnabled("OfficeVSO:4176763_SafeKeepSheetTabButtonsArrayInSync")&&!i)Diag.a.a(592189569,0,15,"SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[{0}] is null even though index is not out of bounds!",t);else if(i.b===n)return t;return-1},Q:function(n){var t=this.K(n);return this.q(t)},dA:function(n,t,i){var r={};r.a=this.f.e().UserSessionId;r.b=i;r.c=this.Y;r.d=n;r.e=t;r.f=this.f.f().d();_Ewa.z.a().a(2,r,i)},ea:function(n,t,i){var f=$$as(_Ewa.cp,this.f.f()),u,r;t?(r=t.f,u=n.f<r?r-1:r):u=i?f.V()-1:0;f.bG(n,u,!0)},cZ:function(n){_Ewa.b.a(this.f).r().b(n)},dh:function(n){var t,i;this.bf||(t=this.cl().ownerDocument.body,this.k?(Common.f.a().a("msospPointerMove",document.documentElement,this.E),this.O&&(Common.l.a().a("touchmove",document.documentElement,this.E),Common.l.a().a("touchmove",this.cl(),this.bO))):(Common.f.a().a("msospPointerMove",t,this.E),Common.l.a().a("touchmove",t,this.E)),Common.f.a().a("msospPointerUp",document.documentElement,this.V),Common.l.a().a("touchend",t,this.V),this.bf=!0);this.v=n.b;this.Y=!1;this.k?(this.p=null,this.L=n,this.w=n.cl(),this.cg(_Ewa.a.i(this.w),"BeginSheetTabButtonDrag")):(Diag.a.a(595100060,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),i="pointer",Sys.UI.DomElement.addCssClass(this.cl(),"ewa-stb-drag"),this.cl().style.cursor="",this.cZ(i))},y:function(n){if(this.bf){this.cZ("default");var t=this.cl().ownerDocument.body;this.k?(Common.f.a().b("msospPointerMove",document.documentElement,this.E),this.O&&(Common.l.a().b("touchmove",document.documentElement,this.E),Common.l.a().b("touchmove",this.cl(),this.bO))):(Common.f.a().b("msospPointerMove",t,this.E),Common.l.a().b("touchmove",t,this.E));Common.f.a().b("msospPointerUp",document.documentElement,this.V);Common.l.a().b("touchend",t,this.V);this.o=this.bf=!1}this.Y=!1;this.v=null;this.bm=null;this.k?(this.w&&(this.w.style.visibility="visible",this.w=null),this.L=null,this.cg(null,"EndSheetTabButtonDrag"),this.p&&(this.p.parentNode&&this.p.parentNode.removeChild(this.p),this.p=null),this.ec(n)):(Sys.UI.DomElement.removeCssClass(this.cl(),"ewa-stb-drag"),this.cL())},ec:function(n){this.bx(n);this.S=-1;this.m=-1},dr:function(n,t){var i=this.f.d(),r=i?i.a():null,e=this,u=function(){return new _Ewa.Lk(n,t)},o=this,f=function(i,u){return _Ewa.Pz.a(r,n,t,i,u,null,null)};this.f.h().a(new _Ewa.be(557,0,f,0,u),null)},q:function(n){return n>=0&&n<this.g.length?this.g[n]:null},cI:function(n){var t=this.q(n);return t?t.b:null},M:function(n){var t=this.q(n);return t?t.cl():null},cJ:function(n){var t=this.M(n);return t?t.style:null},dw:function(n){for(var u=this.f.f(),i=n+1,t=-1,f=this.g?this.g.length:0,r;i<u.d();){if(r=$$as(_Ewa.G,u.g(i)),!r.h){for(t=0;t<f;t++)if(this.cI(t)===r)break;break}i++}return t===-1||t===f?-1:t},cR:function(n){var i=this.Q(n),t,r;i&&(this.k&&this.o&&(Diag.a.a(594625671,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),this.y(!0)),this.h.removeChild(i.cl()),t=Array.indexOf(this.g,i),Array.removeAt(this.g,t),this.u(),r=!this.l&&t===this.g.length||this.l&&!t,r&&this.N(!0),this.z(6))},cS:function(n){var i=$$as(_Ewa.G,n),t;(this.k&&this.o&&(Diag.a.a(594625669,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),this.f.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.y(!0)),i.h)||(this.N(!1),t=this.K(n),t===-1&&(Diag.a.a(592189568,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.cG(i,!1),t=this.K(n)),this.cK(t,!0,!0))},eb:function(n,t){var u=this.Q(n),o,s;if(u){this.k&&this.o&&!t&&(Diag.a.a(592740950,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),this.f.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.y(!0));var e=!1,i=-1,f=-1;if(i=Array.indexOf(this.g,u),f=this.dv($$as(_Ewa.G,n)),e=i!==f||this.k,e){this.N(!1);_Ewa.kf.b(i,f,o={val:this.i},s={val:this.n});this.i=o.val;this.n=s.val;this.h.removeChild(u.cl());Array.removeAt(this.g,i);var c=this.dt(n),r=this.K(c),l=this.M(r),h=new _Ewa.gq(this.f,this.h,l,$$as(_Ewa.G,n),this,this.j);this.cC(h,r);r=this.K(n);this.cK(r,!1,!this.j);!this.f.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.f.isChangeGateEnabled("OfficeVSO:4176019_MoveSetTabColorsCallAfterReorder")&&this.k&&t&&h.U()}}},ds:function(){for(var t,i,r=this.g?this.g.length:0,u=this.i,f=this.n,n=0;n<r;n++)t=this.q(n),i=n>=u,t&&(t.e.tabIndex=i&&n<=f?0:-1)},ei:function(){var i,n,t;if(this.f.a(902))for(i=this.g?this.g.length:0,n=0;n<i;n++)t=this.q(n),t&&t.y()},cK:function(n,t,i){t&&n<=this.i&&this.i++;this.ds();this.N(!0);this.u();i&&this.z(6)},cY:function(n){var i=this.f.J(),t;for((n||this.l!==i)&&(this.l=i,this.A||this.j?(Sys.UI.DomElement.removeCssClass(this.cl(),this.l?"ewa-stb-ltr":"ewa-stb-rtl"),Sys.UI.DomElement.addCssClass(this.cl(),this.l?"ewa-stb-rtl":"ewa-stb-ltr")):this.cl().className=this.l?"ewa-stb-rtl":"ewa-stb-ltr",this.cl().dir=this.l?"rtl":"ltr",this.ei()),n||this.N(!0),t=0;t<this.s.length;t++)t&&t!==3&&(this.j&&(t===4||t===5)||this.db(t))},dk:function(){var n=this.bk=document.createElement("div");n.className="ewa-stb-navarea";this.cl().appendChild(n);this.bq(n,1,628,627);this.bq(n,2,630,629);this.j||this.bq(n,4,634,633)},dl:function(){var n=this.J=document.createElement("div"),t,i;n.className="ewa-stb-navareaextra";this.cl().appendChild(n);this.bq(n,5,636,635);this.f.a(645)?(this.br(0,t={val:this.r}),this.r=t.val,this.br(1,i={val:this.R}),this.R=i.val):this.cE()},dn:function(){var t,n,r,i,u;this.A?(t=document.createElement("div"),n=document.createElement("div"),t.className="ewa-stb-progressbar-outer-container-flex",n.className="ewa-stb-progressbar-inner-container-flex"):(t=n=document.createElement("div"),t.className="ewa-stb-progressbar-container");_Ewa.a.b(n,!1,!0);r=document.createElement("div");r.className="ewa-stb-progressbar-separator";i=document.createElement("div");i.className="ewa-stb-progressbar-message";u=document.createElement("div");u.className="ewa-stb-progressbar";n.appendChild(r);n.appendChild(i);n.appendChild(u);this.A?(t.appendChild(n),this.cl().appendChild(t),this.bo=n):(this.cl().appendChild(t),this.bo=t);this.bS=i},db:function(n){var t=this.s[n];t&&(t.className=this.bY()[n])},di:function(){var n=this.I=document.createElement("div");n.className="ewa-stb-contentarea";this.cl().appendChild(n);this.dp(n)},dp:function(n){var t=document.createElement("div");t.className="ewa-stb-tabarea";Sys.UI.DomElement.addCssClass(t,"ewa-stb-disable-scrollbar");this.f.bi()||Sys.UI.DomElement.addCssClass(t,"ewr-grddisableprint");n.appendChild(t);this.h=document.createElement("ul");_Ewa.a.j(this.h,"tablist",null,null,null);this.h.className="ewa-stb-tabs";t.appendChild(this.h);this.dj();this.f.a(371)&&(this.P=document.createElement("div"),this.P.id="SheetIconTooltipContainer",t.appendChild(this.P))},dj:function(){var n=document.createElement("div"),t=_Ewa.q.g("ewaboot-stb-reorder-indicator",0,"55_16_N","");n.innerHTML=String.format("<div class='clip8x5'>{0}<\/div>",t);n.className="ewa-stb-sheettabmoveindicator";_Ewa.a.b(n,!1,!0);this.bh=n;this.h.appendChild(n)},bV:function(){for(var n,i=this.f.f(),t=0,r=i.d();t<r;t++)n=$$as(_Ewa.G,i.g(t)),n.h||(this.cG(n,!0),n.m()&&n.g(!1))},bU:function(){System.a.b(this.g);this.g=[];this.i=0;this.n=0},bq:function(n,t,i,r){var u=document.createElement("a"),l,f,h,a,v,y,s,c;n.appendChild(u);this.s[t]=_Ewa.kf.a(u,_Ewa.ClientStringManager.a().a(r),0,this.bY()[t],_Ewa.ClientStringManager.a().a(i),this.j,!1);(t===5||t===4)&&(l=_Ewa.a.Z(this.s[t],u,!1,"span"),l.style.marginTop="10px");this.db(t);f=this.bu[t]=this.cq.a(u);h=this;Common.f.a().a("msospPointerDown",u,function(n){return n.i()&&h.dI(t)?!0:h.cO(t)});a=this;Common.f.a().a("msospPointerUp",u,function(){return a.cP()});v=this;Common.l.a().a("touchend",u,function(){return v.cP()});y=this;Common.f.a().a("msospPointerOut",u,function(){return y.bT()});s=this;Common.h.a().a("keydown",u,function(n){return(n.a.keyCode===13||n.a.keyCode===32)&&!s.X?(s.X=!0,s.cO(t)):!1});c=this;Common.h.a().a("keyup",u,function(n){return n.a.keyCode===13||n.a.keyCode===32?(c.X=!1,c.bT()):!1});var p=this.cD(),e=this,o=function(n){n.type==="mouseup"&&e.k&&e.o||_Ewa.D.a(n,!0);Sys.UI.DomElement.containsCssClass(u,"cui-disabled")||(p?e.dO(n,t):e.j||e.cQ(n,t))};f.a("mouseover",o,!1);f.a("mouseout",o,!1);f.a("focus",o,!1);f.a("blur",o,!1);p&&f.a("mouseup",o,!1)},cM:function(n){var t=!1,i=document.getElementById(this.f.n()+"gridDiv");return i&&(t=Common.g.c(_Ewa.a.i(i),n.get_clientPoint())),t},cN:function(n){return Common.g.c(_Ewa.a.i(this.cl()),n.get_clientPoint())||this.cM(n)},du:function(n,t){var r=null,f=n.get_clientPoint(),i=this.i,u;if(this.cN(n))for(i=this.i;i<=this.n;i++)if(r=this.q(i),r&&(u=_Ewa.a.i(r.cl()),!this.l&&f.x<u.x+u.width||this.l&&f.x>u.x))break;return t.val=i>this.n,r},dJ:function(n){return this.F=n,this.ej(),!0},dZ:function(n){return n.a.preventDefault(),!1},ej:function(){var o,s,t,f,h,c,e;if(this.k){if(!this.p){if(Diag.a.a(595100061,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop."),this.p=this.w.cloneNode(!0),!this.cU(this.p,this.w,!0,"UpdateDragAndDropState"))return;this.w.style.visibility="hidden";Sys.UI.DomElement.addCssClass(this.p,"ewa-stb-tabs-ghost");this.p.style.borderRightWidth="";this.bb=this.F.get_clientPoint().x-this.t.width/2;this.p.style.left=this.bb+"px";this.m=this.K(this.v);this.m<0&&Diag.a.a(592189539,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}var i=_Ewa.a.i(this.h),r=i.x,u=i.x+i.width,n=this.F.get_clientPoint().x-this.t.width/2;n=Math.min(n,u-this.t.width);n=Math.max(n,r);o=Math.abs(n-this.bb);this.p.style.transform="translateX("+o*(this.bb<n?1:-1)+"px)";s=this.F.get_clientPoint().x>this.S;t=this.F.get_clientPoint().x;n>=u-this.t.width?(t=u-this.t.width/2,this.ce()||this.B||(Diag.a.a(595100059,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.bc=this.h.scrollLeft,this.B=window.requestAnimationFrame(this.bR))):n<=r?(t=r+this.t.width/2,this.cd()||this.B||(Diag.a.a(595100058,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.bc=this.h.scrollLeft,this.B=window.requestAnimationFrame(this.bQ))):this.B&&(Diag.a.a(592189591,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.bx(!0));this.F.get_clientPoint().x!==this.S&&(this.ci(s,t),this.S=this.F.get_clientPoint().x)}else e=(c=this.du(this.F,h={val:f}),f=h.val,c),e?this.ch(e.b,f):this.cL();this.o=!0;return},ci:function(n,t){for(var i,r,u;u=this.dq(t,n,r={val:i}),i=r.val,u;)this.U=i,this.dg(n)},dg:function(n){var e,i,t,r,u,s,h,o,f,c;this.U&&(e=(n?1:-1)*this.t.width,n&&!this.f.J()||!n&&this.f.J()?(i=this.w,t=this.m+1,r=!0):(u=this.q(this.m+1),i=u?u.cl():null,t=this.m-1,r=!1),s=this,h=function(n){return n?String.format("Node ID: {0} , Node class: {1}, Node name: {2},",n.id,n.className,n.nodeName):null},this.cU(this.U,i,r,"AnimateSheetSwap"))&&(Diag.a.a(592189590,0,50,"SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index {0} and other sheet-index {1}. amount of sheets in the bar: {2} isMovingRight: {3}",this.m,t,this.g.length,n),!this.f.isChangeGateEnabled("OfficeVSO:4176763_SafeKeepSheetTabButtonsArrayInSync")||this.m>=0&&this.m<this.g.length&&t>=0&&t<this.g.length?(o=this.g[t],this.g[t]=this.g[this.m],this.g[this.m]=o):(Diag.a.a(592189538,0,15,"SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: {0}, ghostIndex: {1}, swappedSheetIndex: {2}",this.g.length,this.m,t),this.y(!0)),this.m=t,f=this.U,f.style.transform="translateX("+e+"px)",c=this,window.requestAnimationFrame(function(){f.style.transform="translateX(0px)"}))},cU:function(n,t,i,r){var s=this,u=function(n){return n?String.format("Node ID: {0} , Node class: {1}, Node name: {2},",n.id,n.className,n.nodeName):null},f,e;try{return this.h.insertBefore(n,t),!0}catch(o){return f=this.Q(this.v),e=f?f!==this.L?"Changed":"NoChange":"Removed",Diag.a.a(594871898,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",e,r,u(t),u(t.parentNode),u(this.h),i,this.m,this.g.length,o),this.y(!0),!1}},dq:function(n,t,i){var u,r;return(u=this.f.J()===t?this.q(this.m-1):this.q(this.m+1),!u)?(i.val=null,!1):(i.val=u.cl(),r=_Ewa.a.i(i.val),!this.t)?(Diag.a.a(592189589,0,10,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),this.y(!0),!1):t?n+this.t.width/2>=r.x+r.width*.5:n-this.t.width/2<=r.x+r.width*.5},ee:function(n){this.cW(n,!0)},ed:function(n){this.cW(n,!1)},cW:function(n,t){var r,o,i;if(r=t?this.bR:this.bQ,this.bl===-1){this.bl=n;this.B=window.requestAnimationFrame(r);return}var s=n-this.bl,u=Math.floor(s/1e3*300),f=this.ba()>this.Z()?1:-1,e;(e=t?this.bc+u*f:this.bc-u*f,o=Math.abs(this.h.scrollLeft-e),this.cc(o*(t?-1:1)),i=this.cH("ScrollStep"),i)&&(this.ci(t,i.x+i.width/2),(!t||this.ce())&&(t||this.cd())?(Diag.a.a(592189588,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),this.bx(!0)):this.B=window.requestAnimationFrame(r))},ce:function(){var n=this.ba()>this.Z();return n&&this.C>=this.ba()||!n&&this.C<=this.ba()},cd:function(){var n=this.ba()>this.Z();return n&&this.C<=this.Z()||!n&&this.C>=this.Z()},bx:function(n){this.h&&(this.C=this.h.scrollLeft);window.cancelAnimationFrame(this.B);this.B=0;this.bl=-1;n&&this.u()},dK:function(n){var t,i;return this.o&&(this.k||this.cN(n))&&(this.Y=this.cM(n),this.k?(t=(i=this.q(this.m+1))?i.b:null,this.d(t,this.m+1===this.g.length,!0),this.f.isChangeGateEnabled("OfficeVSO:4176019_MoveSetTabColorsCallAfterReorder")||this.f.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")||!this.L||this.L.U()):(t=this.bn?null:this.bm,this.d(t,this.bn,!0))),this.y(!0),!0},cg:function(n,t){n||Diag.a.a(592189587,0,50,"SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by {0}",t);this.t=n},dI:function(n){return n===2?(this.z(3),!0):n===1?(this.z(0),!0):!1},cO:function(n){Diag.a.b(50385695,0,this.H===-1&&this.G===-1,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");this.H!==-1&&(window.clearTimeout(this.H),this.H=-1);this.G!==-1&&(window.clearInterval(this.G),this.G=-1);this.z(n);var t=this;return this.H=window.setTimeout(function(){t.eh(n)},this.cb),!0},eh:function(n){var t=this;this.G=window.setInterval(function(){t.z(n)},this.ca)},cP:function(){return this.bT(),!this.k||!this.o},bT:function(){return window.clearTimeout(this.H),window.clearInterval(this.G),this.H=-1,this.G=-1,!0},cQ:function(n,t){var i=this.bY()[t],r=n.type==="mouseover"||n.type==="focus";_Ewa.k.A(this.s[t],i,i+"-hover",r)},dO:function(n,t){var r=this.dz(t),i=t===5,u;n.type==="mouseup"?(i||t===4)&&(r||this.d(null,i,!1),this.y(!0)):!this.k&&this.o?(r||(u=this.cI(i?this.n:this.i),this.ch(u,i)),this.z(i?2:1)):this.j||this.cQ(n,t)},dz:function(n){var t=_Ewa.a.ba(this.s[n],"a",!1);return!!t.title},dD:function(n,t){t.b&&this.cm(t.b);this.cY(!1);this.u();t.a&&(this.cm(t.a),this.z(6),this.bg.J())},ck:function(n){this.cm(n);this.u()},dB:function(n,t){this.ck(t.a)},dC:function(n,t){this.ck(t.a)},dL:function(n,t){this.ck(t.a)},cm:function(n){var t=this.Q(n);t&&t.y()},dE:function(){this.bU()},cf:function(){var t=this.f.f(),n,i;if(t.a()&&(!_Ewa.bn.b(this.f)||t.d())){if(n=this.K(t.a()),n===-1){Diag.a.a(36766555,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");return}i=this.M(n);n<this.i?this.bv(n):n>this.i&&!this.bZ(i)&&this.cV(n)}},ek:function(){var t,n,i,u,r;for(this.i=0,this.n=this.g.length-1,t=!1,n=0;n<this.g.length;n++){if(i=this.q(n),!i)break;if(u=i.cl(),r=this.bZ(u),i.e.tabIndex=r?0:-1,!t&&r)this.i=n,t=!0;else if(t&&!r){this.n=n-1;break}}},bv:function(n){var r=this.f.f(),t,i;r.d()&&(this.g.length||this.bV(),t=Math.max(0,Math.min(n,this.g.length-1)),i=this.M(t),this.cX(i),this.u())},cV:function(n){var f,i,r,o,u,s;if(Diag.a.b(51446690,0,n>=this.i,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!"),f=this.f.f(),f.d()){this.g.length||this.bV();var h=Math.max(0,Math.min(n,this.g.length-1)),e=this.M(h),t=this.M(this.i);if(!this.bZ(e)){for(i=_Ewa.a.i(e),r=_Ewa.a.i(this.I),o=this.l?r.x-i.x:i.x+i.width-(r.x+r.width),u=0;t&&u<o;)s=_Ewa.a.i(t),u+=s.width,t=t.nextSibling;t?this.cX(t):Diag.a.a(50345676,0,15,"SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = {0}, lastVisibleSheetTabIndex = {1}, scroll to index: {2}",this.i,this.n,n)}this.u()}},cX:function(n){var t=_Ewa.a.i(this.h),i=_Ewa.a.i(n),r;this.l?(r=Math.floor(t.x+t.width-(i.x+i.width+.5)),this.cc(r)):this.cc(Math.ceil(t.x-i.x-.5))},cc:function(n){(n<0&&this.ce()||n>0&&this.cd())&&Diag.a.a(594915792,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");var t=this.h.scrollLeft;if(this.l){if(Common.c.l()||Common.c.b()){this.h.scrollLeft=this.C=t-n;return}if(Common.c.n()||Common.c.m()){this.h.scrollLeft=this.C=t+n;return}Diag.a.a(594915791,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.h.scrollLeft=this.C=t-n},bZ:function(n){var t=_Ewa.a.i(n),i=_Ewa.a.i(this.I);return!t||!i?(Diag.a.a(50345677,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1):t.x>=i.x-1&&t.x+t.width<=i.x+i.width+1},cE:function(){var t=this.f.f(),n=this.j?this.bk:this.J;this.f.k()&&t.d()?(!this.r||this.j)&&(System.a.a(this.r),this.r=this.f.x()&16384?new _Ewa.yd(n,this.f,this.j):new _Ewa.qh(n,this.f,this.j,!1)):this.j?(System.a.a(this.r),this.r=new _Ewa.qh(n,this.f,this.j,!0)):(System.a.a(this.r),this.r=null)},br:function(n,t){var r=this.f.f(),i;if(this.f.k()&&r.d()){if(!t.val)if(i=this.j?this.bk:this.J,this.f.x()&16384)t.val=new _Ewa.yd(i,this.f,this.j);else switch(n){case 0:t.val=new _Ewa.qh(i,this.f,this.j,!1);break;case 1:t.val=new _Ewa.Pv(i,this.f,this.j);break;default:Diag.a.a(50954334,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}}else System.a.a(t.val),t.val=null},cT:function(){var n,t;this.cp(!this.bg.b());this.A||this.de();this.bU();this.bV();this.f.a(645)?(this.br(0,n={val:this.r}),this.r=n.val,this.br(1,t={val:this.R}),this.R=t.val):this.cE();this.u();this.N(!0);this.z(6)},dF:function(){this.cs()&&(this.A||this.de(),this.u(),this.z(6))},dT:function(n,t){this.eb(t.b,t.a)},dR:function(n,t){this.cS(t.a)},dM:function(n){if(n.keyCode===9){var t=this.cl().querySelectorAll("input,button,select,submit,a,textarea"),i=_Ewa.a.p(t),r=_Ewa.a.u(t);_Ewa.a.F(n,i,r)}},dP:function(){this.h.scrollLeft!==this.C&&this.cj()},dx:function(){var n=this.cl().offsetWidth;return n>640?n*.22+16:n>560?136:46},de:function(){this.be=this.dx();this.T=Math.max(0,this.cl().offsetWidth-162-this.be)},dN:function(n){if(n.i()||n.t())return!1;if(this.h.scrollLeft+=Math.floor(n.h*30),this.k&&this.o){var t=this.cH("OnMouseWheel");t&&this.ci(n.h>0,t.x+t.width/2)}return!0},cH:function(n){var t=_Ewa.a.i(this.p);return t||(Diag.a.a(592740949,0,50,"SheetTabBarControl.{0}: GetBoundingClientRect returned null for the dragged sheet.",n),this.y(!0)),t}};_Ewa.gq=function(n,t,i,r,u,f){var o,e,s;this.M=Function.createDelegate(this,this.bl);this.N=Function.createDelegate(this,this.bm);this.F=Function.createDelegate(this,this.bq);this.l=Function.createDelegate(this,this.bo);this.D=Function.createDelegate(this,this.bk);this.C=Function.createDelegate(this,this.bj);this.z=Function.createDelegate(this,this.bf);this.B=Function.createDelegate(this,this.bi);this.A=Function.createDelegate(this,this.bh);this.E=Function.createDelegate(this,this.bn);_Ewa.gq.initializeBase(this,[document.createElement("li"),null]);this.t=new _Ewa.Px(this,n);this.H=n.a(902);this.h=f;this.J=_Ewa.s.r(n);this.h?(this.K=n.e().SheetDragReorderDelayInMilliseconds,this.L=n.e().SheetDragReorderDelayInMillisecondsForTouch,this.u=18,this.v=20):(this.u=19,this.v=22);this.a=n;this.b=r;this.f=u;this.q=u.cD();this.bb();this.ba();this.n=n.o().b("UserAction",this.c.innerText);this.o=!1;_Ewa.a.j(this.cl(),"presentation",null,null,null);this.cl().appendChild(this.e);this.e.appendChild(this.d);this.i=new($$sc.u.$$(_Ewa.nr));o=new _Ewa.Pw(this.b,this.h);this.i.b(new _Ewa.nr(this.a,o));this.a.a(371)&&!this.a.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&(e=this,s=new _Ewa.yb(this.b,this.f.P,function(){return e.g?_Ewa.gq.b(e.g):!1}),this.k=new _Ewa.nr(this.a,s),this.i.b(this.k));this.r=this.f.O;this.y();this.br();this.s=new _Ewa.fL(this.cl(),1,null);t.insertBefore(this.cl(),i)};_Ewa.gq.c=function(n){var t=Common.U.b(n);return t||(Common.U.a(n,"true",390),t=Common.U.b(n)),t};_Ewa.gq.a=function(n,t){if(t>1||t<-1)return n;var i=n.c,r=n.b,u=n.a;return t>0?(i=i*(1-t)+t*255,r=r*(1-t)+t*255,u=u*(1-t)+t*255):(i=i*(1+t),r=r*(1+t),u=u*(1+t)),_Ewa.bv.b(Math.round(i),Math.round(r),Math.round(u))};_Ewa.gq.b=function(n){var t=(n.c*222+n.b*707+n.a*71)/1e3;return t<=128};_Ewa.gq.prototype={h:!1,J:!1,q:!1,K:0,L:0,u:0,v:0,r:!1,x:!1,w:!1,s:null,c:null,i:null,k:null,d:null,G:null,g:null,I:!1,f:null,p:!1,t:null,a:null,n:null,o:!1,H:!1,bc:function(){return this.G||(this.G=_Ewa.N.a("#F3F2F1",null))},V:function(n){return this.c&&(this.c.innerText=n,this.X(),this.a.isChangeGateEnabled("OfficeVSO:4010960_SheetTabBarResizeSheetBugfix")?this.Y():this.e.setAttribute("sheet-title",n)),n},b:null,e:null,be:function(){return _Ewa.a.T(this.e)?this.e:null},dispose:function(){var n,t;if(this.w&&(Common.f.a().b("msospPointerDown",this.cl(),this.E),Common.h.a().b("keydown",this.cl(),this.A),Common.h.a().b("keypress",this.cl(),this.B),Common.i.a().b("click",this.cl(),this.z),Common.f.a().b("msospPointerEnter",this.cl(),this.C),Common.f.a().b("msospPointerLeave",this.cl(),this.D),this.q&&(Common.f.a().b("msospPointerUp",this.cl(),this.l),this.r&&(Common.l.a().b("touchend",this.cl(),this.l),Common.l.a().b("touchmove",this.cl(),this.F))),this.w=!1),System.a.b([this.t,this.s]),this.t=null,this.s=null,this.f=null,this.e=null,this.d=null,this.c=null,this.i){for(n=this.i.$$lge();n.$$mn();)t=n.$$cu(),t.dispose();this.i=null}this.b=null;this.g=null;this.a=null;_Ewa.VA.prototype.dispose.call(this)},W:function(n){if(_Ewa.A.a().i()&&this.a.a(670)){this.R();var i=_Ewa.l.b(_Ewa.ix,this.a.b(),322,323,-2),t=this;_Ewa.f.cw(i,function(i){var r=function(){Common.UISurfaces.c().then(function(t){var r=i.a();return r.b(t),r.c(n),null},function(n){return Diag.a.a(595194386,0,15,"SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: {0}",n),null})};t.a.isChangeGateEnabled("OfficeVSO:3994938_RemoveRedundantCallToInitUISurfacesAPI")?r():t.a.X(function(n){n.a(r,!1)})},this.bz(),3)}},P:function(){var n,t,u,f,i,r;this.b.m()&&this.a.bc()&&(n=this.a.bc(),this.b.e.c()?(this.k||(t=this,u=new _Ewa.yb(this.b,this.f.P,function(){return t.g?_Ewa.gq.b(t.g):!1}),this.k=new _Ewa.nr(this.a,u),this.i.b(this.k)),Sys.UI.DomElement.addCssClass(n,"ewr-namedsheetview"),f=_Ewa.gq.c("NamedSheetViewTeachingUICookie"),i=_Ewa.gq.c("NamedSheetViewTeachingUITempViewCookie"),f==="true"&&i==="true"?this.a.c().bV()&&this.a.c().by()&&(this.b.e.d()?(r=1,Common.U.a("NamedSheetViewTeachingUITempViewCookie","false",390),this.a.c().bB(!1)):r=0,Common.U.a("NamedSheetViewTeachingUICookie","false",390),this.a.c().ce(!1),this.W(r)):this.b.e.d()&&i==="true"&&this.a.c().by()&&(Common.U.a("NamedSheetViewTeachingUITempViewCookie","false",390),this.a.c().bB(!1),this.W(2))):(this.R(),Sys.UI.DomElement.removeCssClass(n,"ewr-namedsheetview")))},R:function(){if(this.a.a(670)&&this.a.cZ()){var n=_Ewa.l.b(_Ewa.ix,this.a.b(),322,323,-2),t=this;_Ewa.f.cw(n,function(n){var t=n.a();t.a()},this.a.i(),3)}},y:function(){this.V(this.b.a);this.cl().className=this.b.m()||this.T()?"tab-active":"tab-inactive";Sys.UI.DomElement.addCssClass(this.c.parentNode,"leave-size-fixed-on-tab-hover");this.Y();var n=this.a.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon");this.a.a(371)&&n&&this.P();this.bu();this.bw();this.X();this.a.a(371)&&!n&&this.P()},bp:function(){this.x=!0;this.j(!0,!0,"OnSheetReorderStarted")},U:function(){this.x=!1;this.j(!1,!1,"OnSheetReorderEnded")},O:function(n,t){if(!this.Q()){this.b.g(!1);t&&_Ewa.b.a(this.a).p();var i={InputMethod:Common.j.b.toString(n),AppMode:this.a.s()};_Ewa.bs.a(this.a).a("SheetActivated",i,null)}},bg:function(n){n.w();n.p();this.b.g(!1)},Z:function(n){var t=new _Ewa.R(-1876836819,n,this.a.s(),30,null);return this.a.g().b(t,{SNTA:this.b.a},null)},Y:function(){this.c.parentNode.setAttribute("sheet-title",this.c.innerText)},X:function(){var t=this.bd(),n;this.e.setAttribute("aria-label",t);n=this.b.m().toString();this.e.setAttribute("aria-selected",n)},bd:function(){var n=this.a.a(371),t=n&&this.b.e.c(),i=n?this.b.e.f():"",r=this.b.T();return t&&r?String.format(_Ewa.ClientStringManager.a().c(18),this.c.innerText,i):t?String.format(_Ewa.ClientStringManager.a().c(17),this.c.innerText,i):r?String.format(_Ewa.ClientStringManager.a().c(16),this.c.innerText):this.c.innerText},bh:function(n){return n.a.keyCode===13?(this.m(1),!0):!1},bi:function(n){return n.a.charCode===32?(this.m(1),!0):!1},bm:function(){this.f.dV(this);this.f.o||this.j(!0,!1,"OnMouseOver")},bl:function(){this.j(!1,!1,"OnMouseOut")},bj:function(){return this.f.o||(this.bv(),this.b.C&&(_Ewa.b.a(this.a).cR(this.b.a),this.b.C=!1)),!1},bk:function(){return this.S(!1),!1},bf:function(n){var t=_Ewa.b.a(this.a),i=!this.b.m()&&n.b===3;return i?(!(_Ewa.s.q(this.a)||this.J)||t.m()||t.H()||t.cH(),this.m(n.b)):this.h?this.m(n.b):_Ewa.s.p(this.a)&&t.p(),!this.a.isChangeGateEnabled("OfficeVSO:4106406_ShowContextualUIOnTouchEnd")||n.b!==3},bn:function(n){var r,u,t,f,i;return this.S(!0),_Ewa.b.a(this.a).B()&&Diag.a.a(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula)."),u=n.b===2,t=n.b===3,(u||t&&this.r)&&(this.h?(this.j(!0,!t,"OnPointerDown"),f=this,r=this.a.isChangeGateEnabled("OfficeVSO:4122076_AddDelayToSheetTabButtonMouseDownToReorder")?$$sc.a.b(t?this.L:this.K).CWR(Boolean,function(){return!0}):$$sc.a.a(Boolean,!0)):r=this.m(n.b),this.q&&(this.p=!0,i=this,this.f.W=_Ewa.f.cw(r,function(){i.p&&i.f.dX(i,n)},this.bz(),11))),!1},bo:function(n){var i=this.f.o&&!this.a.a(687),t;return this.p=!1,this.h&&this.j(n.b===2,!1,"OnPointerUp"),this.f.W&&(t=this,_Ewa.f.cw(this.f.W,function(){t.f.dW(t)},this.bz(),11),this.f.W=null),i},m:function(n){return _Ewa.s.p(this.a)?this.a.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.Q()?$$sc.a.a(Boolean,!1):(_Ewa.cO.a().a("ActivateSheet"),this.b.g(!1),$$sc.a.a(Boolean,!0)):this.Z(n)},bw:function(){var n=this.b.z;this.g=!n||!n.length?this.bc():_Ewa.N.a(n,null);this.I=_Ewa.gq.b(this.g);this.j(!1,!1,"UpdateTabColor")},j:function(n,t,i){var e,s;if(!this.b){Diag.a.a(592192463,0,15,"SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: {0}",i);return}var r=this.b.m(),u=this.T(),f=!_Ewa.e.a(this.b.z),o=_Ewa.N.b(r||u?_Ewa.bv.c():this.g);for(this.d.style.background="",r||u?(f?this.h?this.bt():this.bs():this.h||(this.d.style.backgroundColor=o),this.d.style.height=this.u.toString()+"px"):(this.d.style.filter="",this.d.style.backgroundColor=o,this.d.style.height=this.v.toString()+"px"),this.c.className=r?"tab-active-text":u?"dark":this.I?"light":"dark",e=this.i.$$lge();e.$$mn();)s=e.$$cu(),s.u();this.h&&(n&&!f&&(this.d.style.backgroundColor="#E1DFDD"),_Ewa.a.f(this.cl(),"tab-hover",n),t?(f||(this.d.style.backgroundColor="#BEBBB8"),this.cl().style.backgroundColor="#BEBBB8"):(f||(this.d.style.backgroundColor=""),this.cl().style.backgroundColor=""));this.c.style.fontWeight=r||u||!this.h&&n?this.h?"600":"bold":""},bt:function(){var n=this.d.style,t=_Ewa.N.b(_Ewa.gq.a(this.g,.5));n.background=t},bs:function(){var t=this.d.style,i=_Ewa.N.b(_Ewa.gq.a(this.g,1)),r=_Ewa.N.b(_Ewa.gq.a(this.g,.5)),n="";if(Common.c.q())n="-webkit-";else if(Common.c.b())n="-moz-";else if(Common.c.a()){if(n="-ms-",!Common.c.u()){t.filter=String.format("progid:DXImageTransform.Microsoft.gradient(startColorstr={0}, endColorstr={1})",i,r);return}}else Common.c.P()&&(n="-o-");t.background=String.format("{0}linear-gradient({1}, {2})",n,i,r)},ba:function(){this.e=document.createElement("a");this.e.removeAttribute("Href");this.e.className="tab-anchor-text";_Ewa.a.j(this.e,"tab",null,null,null);this.e.tabIndex=-1},bb:function(){this.d=document.createElement("span");this.d.className="tab-content-container";this.c=document.createElement("span");this.c.className="tab-text";this.c.dir=this.b.Z()?"rtl":"ltr";this.d.appendChild(this.c)},bu:function(){for(var i=this.a.J(),n=this.i.$$lge(),t;n.$$mn();)t=n.$$cu(),t.t(this.H?i:this.b.Z(),this.d,this.c)},T:function(){return _Ewa.b.a(this.a).cW(this.b)},bv:function(){this.n.d();this.o=!0},S:function(n){if(this.o){this.n.a();var t={"Sheet index":this.b.f,"Active Sheet":this.b.m(),"Hovering time":this.n.b(),"Has been clicked":n};Diag.a.a(39195022,0,50,JSON.stringify(t));this.o=!1}},br:function(){Common.f.a().a("msospPointerDown",this.cl(),this.E);Common.h.a().a("keydown",this.cl(),this.A);Common.h.a().a("keypress",this.cl(),this.B);this.cr().a("mouseover",this.N,!1);this.cr().a("mouseout",this.M,!1);Common.f.a().a("msospPointerEnter",this.cl(),this.C);Common.f.a().a("msospPointerLeave",this.cl(),this.D);this.q&&(Common.f.a().a("msospPointerUp",this.cl(),this.l),this.r&&(Common.l.a().a("touchend",this.cl(),this.l),Common.l.a().a("touchmove",this.cl(),this.F)));Common.i.a().a("click",this.cl(),this.z);this.w=!0},bq:function(){return this.p=!1,this.x||this.j(!1,!1,"OnTouchMove"),!1},Q:function(){var n=this.a.b().a(_Ewa.eL,65,!1),t,i;return n&&n.j()?(t=this,i=this,n.m().invokeModalConfirmationDialog(function(){t.bg(n)},function(){n.n(!1,!1)},n.x()),!0):!1}};_Ewa.yd=function(n,t,i){_Ewa.yd.initializeBase(this,[document.createElement("a"),null]);this.a=t.a(850)?"ewa-stb-insert-new-uir":"ewaboot_stb-structurelock";_Ewa.kf.a(this.cl(),_Ewa.ClientStringManager.a().a(624),0,this.a,_Ewa.ClientStringManager.a().a(624),i,!0);n.appendChild(this.cl());var r=this;this.cr().a("contextmenu",function(n){_Ewa.D.a(n,!0)},!1)};_Ewa.yd.prototype={a:null};_Ewa.Px=function(n,t){this.e=Function.createDelegate(this,this.i);this.c=Function.createDelegate(this,this.g);this.d=Function.createDelegate(this,this.h);_Ewa.Px.initializeBase(this,[n.cl(),null]);this.a=n;this.b=t;Common.i.a().a("dblclick",n.cl(),this.d);Common.bc.a().a(n.cl(),this.c);this.dI().a("keydown",this.e,!1)};_Ewa.Px.prototype={b:null,a:null,dispose:function(){this.a&&(Common.i.a().b("dblclick",this.a.cl(),this.d),Common.bc.a().c(this.a.cl(),this.c),this.a=null);this.b=null;_Ewa.gK.prototype.dispose.call(this)},i:function(n){n.keyCode===121&&n.shiftKey&&(this.f(new Sys.UI.Point(0,0),1,this.a.e),_Ewa.D.a(n,!0))},h:function(n){return this.b.k()?(this.j(!1,n.b),!0):!1},g:function(n){return this.f(n.get_clientPoint(),n.b,n.c)},f:function(n,t,i){this.a.O(t,_Ewa.s.p(this.b));var u=new _Ewa.R(-1075099431,t,this.b.s(),30,null),r;return!_Ewa.ch.b(r=this.b.g().b(u,{ClientPoint:n,Sheet:this.a.b,Target:i},null))&&(r.b!==6||r.a())},j:function(n,t){this.b.C(817296323,t,n?19:0,null)}};_Ewa.yc=function(n){_Ewa.yc.initializeBase(this);this.h=n;this.j()};_Ewa.yc.a=function(n){n.b().b(_Ewa.bbq.$$(_Ewa.eD),33,new _Ewa.yc(n))};_Ewa.yc.prototype={h:null,b:function(){var t=this.h.n(),n;_Ewa.br.a(this.h.e(),1)||(n=document.getElementById(t+"m_sheetTabBar"),n)&&this.i(this.h.b().a(_Ewa.eD,32,!1)||new _Ewa.kf(this.h,n))}};_Ewa.Pz=function(){};_Ewa.Pz.a=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.sheetName=t,o.newSheetIndex=i,_Ewa.i.a(n,"ReorderSheets",o,r,u,f,0,null)};_Ewa.Lk.registerClass("_Ewa.Lk");_Ewa.qh.registerClass("_Ewa.qh",_Ewa.VA);_Ewa.Pv.registerClass("_Ewa.Pv",_Ewa.VA);_Ewa.nr.registerClass("_Ewa.nr",null,Sys.IDisposable);_Ewa.kf.registerClass("_Ewa.kf",_Ewa.VA,_Ewa.eD,Sys.IDisposable,_Ewa.vi);_Ewa.gq.registerClass("_Ewa.gq",_Ewa.VA);_Ewa.yd.registerClass("_Ewa.yd",_Ewa.VA);_Ewa.Px.registerClass("_Ewa.Px",_Ewa.gK);_Ewa.yc.registerClass("_Ewa.yc",_Ewa.qc.$$(_Ewa.eD));Type.registerNamespace("_Ewa");_Ewa.beF=function(){};_Ewa.beF.a=function(){_Ewa.j.a(_Ewa.yc.a)};_Ewa.beF.a();Type.registerNamespace("_Ewa");_Ewa.PZ=function(n,t){_Ewa.PZ.resolveInheritance();this.a=this.Q;this.c=this.K;_Ewa.PZ.initializeBase(this,[n]);t.b(_Ewa.kh,240,this)};_Ewa.PZ.prototype={b:function(n){for(var i,r=this.x,u=r.length,t=0;t<u;++t)if(i=r[t],n.b().i(i))return i;return null},G:function(n){return n.Sparklines}};_Ewa.yv=function(n){_Ewa.yv.initializeBase(this);this.h=n;this.j()};_Ewa.yv.a=function(n){n.b().b(_Ewa.bbq.$$(_Ewa.kh),239,new _Ewa.yv(n))};_Ewa.yv.prototype={h:null,k:null,b:function(){this.i(this.k||(this.k=new _Ewa.PZ(_Ewa.b.a(this.h),this.h.b())))}};_Ewa.PZ.registerClass("_Ewa.PZ",_Ewa.bfm,_Ewa.kh);_Ewa.yv.registerClass("_Ewa.yv",_Ewa.qc.$$(_Ewa.kh));Type.registerNamespace("_Ewa");_Ewa.beZ=function(){};_Ewa.beZ.a=function(){_Ewa.j.a(_Ewa.yv.a)};_Ewa.beZ.a();Type.registerNamespace("_Ewa");_Ewa.Lo=function(n){this.tableName=n};_Ewa.Lo.prototype={tableName:null};_Ewa.Lr=function(n){this.originalRange=n};_Ewa.Lr.prototype={originalRange:null};_Ewa.Lq=function(n,t){this.oldName=n;this.newName=t};_Ewa.Lq.prototype={oldName:null,newName:null};_Ewa.mT=function(n,t,i,r){_Ewa.mT.initializeBase(this,[t,n]);this.styleIndex=i;this.isCreation=r};_Ewa.mT.prototype={styleIndex:0,isCreation:!1};_Ewa.vR=function(n,t){this.tableRange=n;this.styleIndex=t};_Ewa.vR.prototype={tableRange:null,styleIndex:0};_Ewa.Lu=function(n,t){this.tableRange=n;this.optionType=t};_Ewa.Lu.prototype={tableRange:null,optionType:0};_Ewa.Lt=function(n,t){this.sheetRange=n;this.headerRow=t};_Ewa.Lt.prototype={sheetRange:null,headerRow:!1};_Ewa.Qr=function(n){if(this.T=Function.createDelegate(this,this.I),this.N=Function.createDelegate(this,this.bd),this.M=Function.createDelegate(this,this.Y),this.L=Function.createDelegate(this,this.P),this.O=Function.createDelegate(this,this.be),this.l=this.Q,this.v=this.K,_Ewa.Qr.resolveInheritance(),this.c=this.bf,_Ewa.Qr.initializeBase(this,[_Ewa.b.a(n)]),this.w=n,this.w.b().b(_Ewa.dq,66,this),this.w.a(538)&&(this.z={},this.P(null,null),this.w.f()&&this.w.f().c(this.O),this.k(this.L)),this.w.a(743)){var t=this;this.w.X(function(n){t.w.isChangeGateEnabled("OfficeVSO:3994938_RemoveRedundantCallToInitUISurfacesAPI")?n.b(!1).then(t.M):n.a(t.M,!1)})}};_Ewa.Qr.prototype={B:null,w:null,D:null,A:null,C:null,k:function(n){this.dE("lrc",n)},u:function(n){this.dF("lrc",n)},j:function(n){this.dE("tce",n)},t:function(n){this.dF("tce",n)},z:null,H:null,o:function(){return this.H},a:function(){var n=_Ewa.b.a(this.w);return n.f().a(n.a().c(),!1)},e:function(){var n=_Ewa.b.a(this.w);return n.f().a(this.H,!1)},f:function(n){return!!this.R(n)},b:function(n){return this.ba(this.V(n))},h:function(n){if(!n){Diag.a.a(594130058,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved");return}this.C?this.C!==n&&(System.a.a(this.A),this.A=null,this.C=n):this.C=n;this.A||(this.A=_Ewa.bP.a().a(this.C));_Ewa.s.a()?this.A.c("focusin",!1)||this.A.a("focusin",this.N,!1):this.A.c("focus",!1)||this.A.a("focus",this.N,!1)},g:function(n,t){return n?n.q&&n.a===t.a:(Diag.a.b(20821026,0,!!n,"autofilterRange can't be null"),!1)},d:function(n){var t=this.B?_Ewa.g.C(n,this.B,!1):this.y.C(n);return t.length>0&&_Ewa.co.isInstanceOfType(t[0])?t[0]:null},q:function(n,t){return n?!n.O&&!!n.w&&n.w.h(t):(Diag.a.b(20821027,0,!!n,"Pivot table can't be null"),!1)},r:function(n,t){return n?!n.O&&!!n.B&&n.B.h(t):(Diag.a.b(20821056,0,!!n,"Pivot table can't be null"),!1)},Q:function(n){var t,i;if(_Ewa.bfm.prototype.Q.call(this,n),t=n.Ranges,t&&t.length>0)for(this.B=new Array(t.length),i=0;i<t.length;i++)this.B[i]=_Ewa.en.a(t[i])},K:function(){_Ewa.bfm.prototype.K.call(this);this.B=null},m:function(n,t){var i=!1,r,u;return u=this.n(n,t,r={val:i}),i=r.val,u},n:function(n,t,i){var r,u,f;return(i.val=!1,!n||!t)?!1:(r=n.f(),r.c=r.c+1,r.b=r.c,!r.A())?!1:r.a<t.i().b&&(u=r.f(),u.d>=t.i().b&&(u.d=t.i().b-1),!this.U(u,t,i))?!1:r.d>=t.i().b&&(f=r.f(),f.a<=t.i().b&&(f.a=t.i().b),!this.U(f,t,i))?!1:!0},i:function(n){var t=this.b(n.e()),i;t&&t.toString()in this.z&&(i=this.z[t.toString()],i.o=!1)},s:function(){this.dC("tce",null,null)},p:function(n,t){var i,r;if(!this.D)return!1;switch(t){case-569786022:case 541421805:return this.D.k&&(i=document.getElementById("TableTotalRowDropDownIconButtonId"),i&&(r=this,_Ewa.y.a().a(function(){_Ewa.a.Q(i,null)},0,_Ewa.m.cn,!0,!0))),!0;default:return!1}},dispose:function(){this.w.a(538)&&(this.I(null,null),this.u(this.L),this.w.f().e(this.O),this.w.I(this.T),this.z=null,this.w.a(743)&&(this.D=null),this.w.a(593)&&this.A&&(System.a.a(this.A),this.A=null),_Ewa.bfm.prototype.dispose.call(this))},G:function(n){return n.Autofilters},P:function(){var r,e,n,t,u;if(this.w.a(538)){Diag.a.a(42078492,0,50,"TableManager.AttachTableResizeBehavior - Will Update Range for {0}",this.x.length);var i={},o=this.bb(),f=o;for(r in f)if(e={key:r,value:f[r]},n=e.value,n){if(n.toString()in this.z&&(t=this.z[n.toString()],t.j())){t.a.g(n)||(t.a=n);delete this.z[n.toString()];i[n.toString()]=t;continue}u=_Ewa.lF.b(_Ewa.b.a(this.w),n,this.Z(),this);u?(Diag.a.a(42078494,0,50,"TableManager.AttachTableResizeBehavior - Added Grippie for Range {0}",n.D(!1)),i[n.toString()]=u):Diag.a.a(42078495,0,15,"TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range {0}",n.D(!1))}this.I(null,null);this.z=i;Diag.a.a(42078496,0,50,"TableManager.AttachTableResizeBehavior - Completed AttachTableResizeBehavior")}},I:function(){var r,t,i,n;if(this.w.a(538)){Diag.a.a(42078497,0,50,"TableManager.ClearAllActiveTableBehaviors - Clearing Active Behaviors");r=this.z;t=r;for(i in t)(n={key:i,value:t[i]},n.value)&&(n.value.dispose(),delete this.z[n.key]);this.z={}}},U:function(n,t,i){var e,r;i.val=!1;var u=t.i().c(n),o=t.n(u),f=o.q();if(!f)return Diag.a.a(40640599,0,15,"TableManager.CouldExpandImpl - loadedRange is null. PaneType={0}",u),!1;if(e=f.m(n),!e)return!0;r=t.u("TableManager.CouldExpandImpl",n,2,!0);try{while(r.$$mn()){if(!_Ewa.e.a(r.$$cu().c()))return i.val=!0,!1;if(r.$$cu().e())return!1}}finally{r&&r.dispose()}return!0},ba:function(n){var i,r,u,t;if(!n)return null;for(i=new _Ewa.nU(n.a,n.b,n.d,n.c,null,null,null,null,n.z,n.q),i.t=n.t,r=0,u=this.x.length;r<u;r++)t=this.x[r],t.z===n.z&&t!==n&&this.bc(t)&&(i.G(t),t.t&&(i.t=!0));return i},bc:function(n){return!!_Ewa.b.a(this.w).f().a(n,!1)},Z:function(){for(var r,u,t=[],i=this.x,f=i.length,n=0;n<f;++n)r=i[n],u=new _Ewa.cY(this.b(r.e()),_Ewa.B.b(this.w.j())),t.push(u);return t},bb:function(){for(var n,i,r={},u=this.x,f=u.length,t=0;t<f;++t)(n=u[t],n)&&(i=this.b(n.e()),i)&&(r[i.toString()]=this.b(n.e()));return r},be:function(){this.I(null,null);this.P(null,null)},bd:function(){this.H=_Ewa.b.a(this.w).a().c()},Y:function(){this.D=_Ewa.df.c(this.w);this.D?Diag.a.a(51513354,0,50,"TableManager.AttachTotalRowOptions - Initialized TotalRow Dropdown"):Diag.a.a(51513355,0,15,"TableManager.AttachTotalRowOptions - Failed to Initialize TotalRow Dropdown")}};_Ewa.bfn=function(){};_Ewa.bfn.a=function(){_Ewa.j.a(function(n){n.b().b(_Ewa.bbq.$$(_Ewa.dq),134,new _Ewa.Qs(n));n.b().b(_Ewa.bbq.$$(_Ewa.hM),330,new _Ewa.Qu(n))})};_Ewa.lF=function(n,t,i,r){this.t=Function.createDelegate(this,this.P);this.w=Function.createDelegate(this,this.S);this.x=Function.createDelegate(this,this.U);this.z=Function.createDelegate(this,this.X);this.y=Function.createDelegate(this,this.W);this.n=Function.createDelegate(this,this.V);this.u=Function.createDelegate(this,this.Q);this.v=Function.createDelegate(this,this.R);this.m=Function.createDelegate(this,this.T);this.D=[6];this.C=[26];_Ewa.lF.initializeBase(this,[n,null]);this.c=t;this.d=t.c();this.r=r;this.q=t.a();this.h=t.k();this.i=n;this.N();Common.c.d()||Common.c.v()||Common.f.a().a("msospPointerDown",this.e,this.m);this.a=i;this.o=!1;this.f=!1;this.c.g().c(this.v);this.c.g().f(this.u);Diag.a.a(42078498,0,50,"TableResizeBehavior - New behavior registered")};_Ewa.lF.b=function(n,t,i,r){var u,f,e;return n.c().a(538)?t?(u=n.k(),u.d(i,[27],!0,null,!0),u.c(_Ewa.lF.a,null,null),f=n.i().c(t.p()),e=u.e(27,f,_Ewa.lF.c(t,i)).a,new _Ewa.lF(e,n,t,r)):null:null};_Ewa.lF.c=function(n,t){for(var i=0;i<t.length;i++)if(t[i]&&t[i].a&&t[i].a.g(n))return i;return 0};_Ewa.lF.prototype={h:null,q:null,c:null,d:null,r:null,g:null,p:!1,l:!1,j:function(){return this.l||this.p},o:!1,a:null,e:null,i:null,b:null,f:!1,dispose:function(){if(this.k(),this.c.g()&&(this.c.g().d(this.v),this.c.g().g(this.u)),this.f||Common.c.d()||Common.c.v()||Common.f.a().b("msospPointerDown",this.e,this.m),this.j()){_Ewa.bQ.b(this.d,!1);try{this.J()}catch(n){Diag.a.a(42078529,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",n)}}this.i&&this.i.contains(this.e)&&this.i.removeChild(this.e);this.i=null;this.e=null;_Ewa.gK.prototype.dispose.call(this)},F:function(n){var t=n.c-this.a.e().c+1,i=n.d-this.a.e().d-1;return t>=0&&i>=0&&n.d>=this.a.a&&n.c>=this.a.b?new _Ewa.n(this.a.a,this.a.b,n.d,n.c,!1,!1):this.b},A:function(n){this.s([this.b],6,n);this.h.c(this.D,null,null)},H:function(n){this.h.a(this.D);this.s([null],6,n)},B:function(n){this.h.a(this.C);this.s([null],26,n)},O:function(n){var t=this.bb();t.length>0&&(this.s(t,26,n),this.h.c(this.C,null,null))},bb:function(){var n=[];return this.a.i(this.b)&&(this.a.c!==this.b.c&&n.push(new _Ewa.n(this.a.a,this.b.c+1,this.b.d,this.a.c,!1,!1)),this.a.d!==this.b.d&&n.push(new _Ewa.n(this.b.d+1,this.a.b,this.a.d,this.a.c,!1,!1))),n},T:function(n){var u,t,i,r;return this.d.g().d()!==1&&this.d.isChangeGateEnabled("OfficeVSO:4101665_tableResizeForCellsOnly")?!0:(n=_Ewa.x.a(this.d).a(n),Diag.a.a(42078530,0,50,"TableResizeBehavior.OnPointerDown - Starting OnPointerDown"),this.d.isChangeGateEnabled("OfficeVSO:4074157_TableResizeWithTouch")&&this.j())?(Diag.a.a(592557913,0,50,"TableResizeBehavior.OnPointerDown - Table Resize operation already in progress"),!0):(u=_Ewa.L.a(this.d).o()||_Ewa.L.a(this.d).b(),this.o||u)?(Diag.a.a(42321986,0,50,"TableResizeBehavior.OnPointerDown - Table resize in progress in server or ignored due to ui state"),this.k(),!0):(this.b=this.a,this.B(!0),this.A(!0),t=n.b===2&&!n.f,i=this.d.isChangeGateEnabled("OfficeVSO:4074157_TableResizeWithTouch")&&n.b===3,(t||i)&&(r=this.q.m(n.get_clientPoint(),n.c,4,!1,!0,!0),r||(r=this.b),this.l=t,this.p=i,this.b=this.F(r),this.A(!0),t?this.Y():i&&this.Z(),_Ewa.bQ.b(this.d,!0)),Diag.a.a(42078533,0,50,"TableResizeBehavior.OnPointerDown - Succesfully Completed OnPointerDown"),!0)},V:function(n){var i,t;return(n=_Ewa.x.a(this.d).a(n),!this.j())?!1:(Diag.a.a(42078535,0,50,"TableResizeBehavior.OnPointerMove - Starting OnPointerMove"),i=this.l?this.q.m(n.get_clientPoint(),n.c,4,!1,!0,!0):this.q.m(n.get_clientPoint(),n.c,4,!0,!1,!0),i&&(t=this.F(this.L(i)),this.M(t.p()),this.b.g(t)||(this.b=t,this.H(!1),this.B(!1),this.A(!1),this.O(!1),this.h.f(!1,!0)),this.be(this.b)),Diag.a.a(42078536,0,50,"TableResizeBehavior.OnPointerMove - Completed OnPointerMove"),!0)},W:function(n){return(n=_Ewa.x.a(this.d).a(n),!this.j())?!1:(Diag.a.a(42078538,0,50,"TableResizeBehavior.OnPointerUp - Starting OnPointerUp"),this.I(),this.k(),!0)},X:function(n){return(n=_Ewa.x.a(this.d).a(n),!this.j())?(Diag.a.b(592557912,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1):(Diag.a.a(592557911,0,50,"TableResizeBehavior.OnTouchUp - Starting OnTouchUp"),this.I(),this.k(),!0)},I:function(){if(!this.b.g(this.a)){var n=new _Ewa.n(this.a.a,this.a.b,this.b.d,this.b.c,!1,!1);this.bc(n);this.o=!0}},U:function(n){return n=_Ewa.x.a(this.d).a(n),Diag.a.a(50344140,0,50,"TableResizeBehavior.OnPointerLeave - Unregister due to Pointer Leave"),this.k(),!0},S:function(n){return n=_Ewa.x.a(this.d).a(n),!0},P:function(){Diag.a.a(50344141,0,50,"TableResizeBehavior.OnCancelEditTable - End Table Edit");this.k()},R:function(){this.f||Common.c.d()||Common.c.v()||(this.k(),Common.f.a().b("msospPointerDown",this.e,this.m),_Ewa.a.f(this.e,"ewr-table-resize-default-cursor",!0),this.e.disabled=!0,this.f=!0,Diag.a.a(50344142,0,50,"TableResizeBehavior.OnEditCellStarted - EditCell Started"))},Q:function(){this.f&&(Common.c.d()||Common.c.v()||(Common.f.a().a("msospPointerDown",this.e,this.m),_Ewa.a.f(this.e,"ewr-table-resize-default-cursor",!1),this.e.disabled=!1,this.f=!1,Diag.a.a(50344143,0,50,"TableResizeBehavior.OnEditCellEnded - EditCell Ended")),this.f=!1)},N:function(){var n=document.createElement("div"),t,i;n.className="ewr-table-resize-handle";t=document.createElement("div");t.className="ewr-table-resize-fillhandle-higher";i=document.createElement("div");i.className="ewr-table-resize-fillhandle-broader";n.appendChild(t);n.appendChild(i);this.e=n;this.i.appendChild(this.e)},M:function(n){var h=this.b.i(n),e=5,t=n.a,i=n.d,r=n.b,u=n.c,f=null,o,s;(h?(t=Math.max(1,n.d-e),r=Math.max(1,n.c-e),i=t,u=r,f=new _Ewa.n(t,r,t,r,!1,!1)):(i=n.d+e,u=n.c+e,t=i,r=u,f=new _Ewa.n(i,u,i,u,!1,!1)),this.c.bb(f))||(this.g?this.g.c()||(s=this,this.g=_Ewa.y.a().a(function(){s.c.I(f,60,_Ewa.C.l,!1,null)},40,_Ewa.m.h,!0,!1)):(o=this,this.g=_Ewa.y.a().a(function(){o.c.I(f,60,_Ewa.C.l,!1,null)},40,_Ewa.m.h,!0,!1)))},L:function(n){var t=n,r,u,i;if(this.c.i().l()){if(r=this.c.e(n.e()),!r){u=this.b.a!==n.a?1:2;i=this.c.u("TableResizeBehavior.AdjustHiddenRowColumns",this.c.M(),u,!0);try{i.c(this.b.a<n.a||this.b.b<n.b);i.b(n.e(),!0);t=i.$$cu().b()}finally{i&&i.dispose()}}t.c=t.b+n.o()-1;t.d=t.a+n.l()-1}return t},s:function(n,t,i){for(var e,u=[],f=n,o=f.length,r=0;r<o;++r)e=f[r],u.push(new _Ewa.cY(e,_Ewa.B.b(this.d.j())));this.h.d(u,[t],!0,null,i)},Y:function(){for(var i,t=this.c.G(),r=t.length,n=0;n<r;++n)i=t[n],Common.f.a().a("msospPointerMove",i.j(),this.n);Common.f.a().a("msospPointerUp",document.documentElement,this.y);this.E()},Z:function(){for(var i,t=this.c.G(),r=t.length,n=0;n<r;++n)i=t[n],Common.l.a().a("touchmove",i.j(),this.n);Common.l.a().a("touchend",document.documentElement,this.z);this.E()},J:function(){if(!this.d.isChangeGateEnabled("OfficeVSO:4074157_TableResizeWithTouch")){this.K();return}this.l&&this.K();this.p&&this.bd()},K:function(){for(var i,t=this.c.G(),r=t.length,n=0;n<r;++n)i=t[n],Common.f.a().b("msospPointerMove",i.j(),this.n);Common.f.a().b("msospPointerUp",document.documentElement,this.y);this.G()},bd:function(){for(var i,t=this.c.G(),r=t.length,n=0;n<r;++n)i=t[n],Common.l.a().b("touchmove",i.j(),this.n);Common.l.a().b("touchend",document.documentElement,this.z);this.G()},E:function(){Common.f.a().a("msospPointerLeave",document.documentElement,this.x);this.c.l().n(!0);Common.h.a().h("keydown",document.documentElement,this.w,!0);this.r.j(this.t)},G:function(){Common.f.a().b("msospPointerLeave",document.documentElement,this.x);this.c.l().n(!1);Common.h.a().b("keydown",document.documentElement,this.w);this.r.t(this.t)},bc:function(n){var t={ResizeTableRange:n,OriginalTableRange:this.a};this.d.C(-1400250766,_Ewa.E.a,30,t)},be:function(n){var i,u;if(!this.a.i(n)){i=this.ba();for(var r=i,f=r.length,t=0;t<f;++t)if(u=r[t],this.r.f(u)){this.c.r().b("not-allowed");return}}this.c.d()?this.c.r().b("nesw-resize"):this.c.r().b("nwse-resize")},k:function(){if(this.j()){_Ewa.bQ.b(this.d,!1);try{this.J()}catch(n){Diag.a.a(42321987,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",n)}Diag.a.a(50344144,0,50,"TableResizeBehavior.ResetAndCleanState - Operation was InProgress and unregistered handlers")}this.g&&(this.g.a(),this.g.dispose());this.l=!1;this.p=!1;this.H(!0);this.B(!0);_Ewa.bQ.b(this.d,!1);this.c.r().b("default");Diag.a.a(42321988,0,50,"TableResizeBehavior.ResetAndCleanState - Completed")},ba:function(){var n=[];return this.a.c!==this.b.c&&n.push(new _Ewa.n(this.a.a,this.a.c+1,this.b.d,this.b.c,!1,!1)),this.a.d!==this.b.d&&n.push(new _Ewa.n(this.a.d+1,this.a.b,this.b.d,this.a.c,!1,!1)),n}};_Ewa.bp=function(){};_Ewa.bp.f=function(n,t){var e=_Ewa.bp.c(n,t),i,r,u,f,o,s;if(!e)return Diag.a.a(50366154,0,50,"TableStyleManager.BuildTableStyleIcon TablePreviewStyles is null"),"";for(i='<div class="PreviewStyleContainer" aria-hidden="true" style="display:table-cell; text-align:center; vertical-align:middle;"><table class="TableStylePreview"  style="border-collapse: collapse; font-size: 5px; width: 64px; height: 48px">',r=0,u=0;u<5;u++){for(i+="<tr>",f=0;f<5;f++)o='<td style="{0}">',s=Common.e.ba(e[r]),i+=String.format(o,s),r++,i+="&#x2014;",i+="<\/td>";i+="<\/tr>"}return i+"<\/table><\/div>"};_Ewa.bp.n=function(n,t){var i=t.Type,r=n.Type;return _Ewa.bp.h[r]-_Ewa.bp.h[i]};_Ewa.bp.g=function(n,t){try{return appChrome.buildTableStyleGalleryIconNew(5,5,n,t)}catch(i){return null}};_Ewa.bp.l=function(n){if(n&&"MenuItemId"in n){var t=n.MenuItemId;if(!(!t||!t.length))return _Ewa.e.h(t,"preview")}return!1};_Ewa.bp.d=function(n){for(var s,f,e,r,t=[],i=0,o=n,h=o.length,u=0;u<h;++u){s=o[u];t[i]={};t[i].backgroundColor="white";t[i].color="black";f=s;for(e in f){r={key:e,value:f[e]};switch(r.key){case"background-color":t[i].backgroundColor=r.value;break;case"color":t[i].color=r.value;break;case"font-size":t[i].fontSize=r.value;break;case"border-bottom":t[i].borderBottom=r.value;break;case"border-right":t[i].borderRight=r.value;break;case"border-left":t[i].borderLeft=r.value;break;case"border-top":t[i].borderTop=r.value}}i++}return t};_Ewa.bp.c=function(n,t){var i=[],o,r,u,f,e;if(n&&n.TableStyleElementsList)for(o=!n.Category,r=0;r<5;r++)i.push.apply(i,_Ewa.bp.r(n,t,o,r));else{if(_Ewa.bp.e)return _Ewa.bp.e;for(u={},u.color="black",u["background-color"]="white",f=0;f<5;f++)for(e=0;e<5;e++)i.push(u);_Ewa.bp.e=i}return i};_Ewa.bp.s=function(n,t){var r,i;if(!n.TableStyleElementsList)return"";r="";for(var f=n.TableStyleElementsList,e=f.length,u=0;u<e;++u)if(i=f[u],!(!i.BackgroundColor||!i.BackgroundColor.length)&&i.BackgroundColor!=="#000000")switch(i.Type){case 0:r=i.BackgroundColor;break;case 5:case 7:(t.f||t.b)&&(r=i.BackgroundColor);break;case 3:case 4:(t.d||t.e)&&(r=i.BackgroundColor);break;case 2:t.c&&(r=i.BackgroundColor);break;case 1:t.a&&(r=i.BackgroundColor)}return r};_Ewa.bp.p=function(n){var t=parseInt("0x"+n.substr(1,2)),i=parseInt("0x"+n.substr(3,2)),r=parseInt("0x"+n.substr(5,2)),u=new _Ewa.bv(t,i,r);return _Ewa.gf.a(u)};_Ewa.bp.k=function(n,t){if(!n||!t)return"";var i,r=_Ewa.bp.s(n,t);i=r&&r.length?_Ewa.bp.p(r)+", ":_Ewa.ClientStringManager.a().a(1734)+", ";switch(n.Index){case 0:return i+_Ewa.ClientStringManager.a().a(1674);case 1:return i+_Ewa.ClientStringManager.a().a(1675);case 2:return i+_Ewa.ClientStringManager.a().a(1676);case 3:return i+_Ewa.ClientStringManager.a().a(1677);case 4:return i+_Ewa.ClientStringManager.a().a(1678);case 5:return i+_Ewa.ClientStringManager.a().a(1679);case 6:return i+_Ewa.ClientStringManager.a().a(1680);case 7:return i+_Ewa.ClientStringManager.a().a(1681);case 8:return i+_Ewa.ClientStringManager.a().a(1682);case 9:return i+_Ewa.ClientStringManager.a().a(1683);case 10:return i+_Ewa.ClientStringManager.a().a(1684);case 11:return i+_Ewa.ClientStringManager.a().a(1685);case 12:return i+_Ewa.ClientStringManager.a().a(1686);case 13:return i+_Ewa.ClientStringManager.a().a(1687);case 14:return i+_Ewa.ClientStringManager.a().a(1688);case 15:return i+_Ewa.ClientStringManager.a().a(1689);case 16:return i+_Ewa.ClientStringManager.a().a(1690);case 17:return i+_Ewa.ClientStringManager.a().a(1691);case 18:return i+_Ewa.ClientStringManager.a().a(1692);case 19:return i+_Ewa.ClientStringManager.a().a(1693);case 20:return i+_Ewa.ClientStringManager.a().a(1694);case 21:return i+_Ewa.ClientStringManager.a().a(1695);case 22:return i+_Ewa.ClientStringManager.a().a(1696);case 23:return i+_Ewa.ClientStringManager.a().a(1697);case 24:return i+_Ewa.ClientStringManager.a().a(1698);case 25:return i+_Ewa.ClientStringManager.a().a(1699);case 26:return i+_Ewa.ClientStringManager.a().a(1700);case 27:return i+_Ewa.ClientStringManager.a().a(1701);case 28:return i+_Ewa.ClientStringManager.a().a(1702);case 29:return i+_Ewa.ClientStringManager.a().a(1703);case 30:return i+_Ewa.ClientStringManager.a().a(1704);case 31:return i+_Ewa.ClientStringManager.a().a(1705);case 32:return i+_Ewa.ClientStringManager.a().a(1706);case 33:return i+_Ewa.ClientStringManager.a().a(1707);case 34:return i+_Ewa.ClientStringManager.a().a(1708);case 35:return i+_Ewa.ClientStringManager.a().a(1709);case 36:return i+_Ewa.ClientStringManager.a().a(1710);case 37:return i+_Ewa.ClientStringManager.a().a(1711);case 38:return i+_Ewa.ClientStringManager.a().a(1712);case 39:return i+_Ewa.ClientStringManager.a().a(1713);case 40:return i+_Ewa.ClientStringManager.a().a(1714);case 41:return i+_Ewa.ClientStringManager.a().a(1715);case 42:return i+_Ewa.ClientStringManager.a().a(1716);case 43:return i+_Ewa.ClientStringManager.a().a(1717);case 44:return i+_Ewa.ClientStringManager.a().a(1718);case 45:return i+_Ewa.ClientStringManager.a().a(1719);case 46:return i+_Ewa.ClientStringManager.a().a(1720);case 47:return i+_Ewa.ClientStringManager.a().a(1721);case 48:return i+_Ewa.ClientStringManager.a().a(1722);case 49:return i+_Ewa.ClientStringManager.a().a(1723);case 50:return i+_Ewa.ClientStringManager.a().a(1724);case 51:return i+_Ewa.ClientStringManager.a().a(1725);case 52:return i+_Ewa.ClientStringManager.a().a(1726);case 53:return i+_Ewa.ClientStringManager.a().a(1727);case 54:return i+_Ewa.ClientStringManager.a().a(1728);case 55:return i+_Ewa.ClientStringManager.a().a(1729);case 56:return i+_Ewa.ClientStringManager.a().a(1730);case 57:return i+_Ewa.ClientStringManager.a().a(1731);case 58:return i+_Ewa.ClientStringManager.a().a(1732);case 59:return i+_Ewa.ClientStringManager.a().a(1733);default:return!n.Name||!n.Name.length?"":n.Name}};_Ewa.bp.b=function(n,t,i){return!n&&i&&i.length?String.format("{0}, {1}, -version, {2}","TableStyleIcon",i,t.toString()):String.format("{0}, {1}, -version, {2}","TableStyleIcon",n.Index.toString(),t.toString())};_Ewa.bp.r=function(n,t,i,r){for(var f=[],u=0;u<5;u++)f.push(_Ewa.bp.q(n,t,i,r,u));return f};_Ewa.bp.q=function(n,t,i,r,u){var c=n.TableStyleElementsList,f=new _Ewa.zU,k=new Array(4),o={},a,s,h,e;if(!c)return o;for(var y=c,w=y.length,l=0;l<w;++l)if(a=y[l],!a.Type){f=a;break}s=!(!f.BackgroundColor||!f.BackgroundColor.length);h="";i||f.TableStyleBorderFromatList&&f.TableStyleBorderFromatList.length>0&&(h=f.TableStyleBorderFromatList[0].Color);o["background-color"]=s?f.BackgroundColor:"#FFFFFF";f.FontColor&&f.FontColor.length||(f.FontColor="#000000");o.color=f.FontColor;_Ewa.bp.j(r,u,o,f,h,i,s);for(var p=c,b=p.length,v=0;v<b;++v)(e=p[v],e&&e.Type)&&(e.Type!==2||s||(e.BackgroundColor=f.BackgroundColor),_Ewa.bp.u(e,r,u,t)&&(!e.BackgroundColor||!e.BackgroundColor.length||(o["background-color"]=e.BackgroundColor),o.color=!e.FontColor||!e.FontColor.length?f.FontColor:e.FontColor,_Ewa.bp.j(r,u,o,e,h,i,s)));return o};_Ewa.bp.a=function(n,t,i,r,u,f){if(i){!i.Color||!i.Color.length||i.Style||(i.Style=1);!i.Style||i.Color&&i.Color.length||(i.Color=u?"#000000":r&&r.length?r:f?"#FFFFFF":"#000000");var e=_Ewa.bp.m[i.Style];t[_Ewa.bp.i[n]]="1px "+e+" "+i.Color}};_Ewa.bp.u=function(n,t,i,r){return n.Type===-1?!1:_Ewa.bp.w(n,t,i,r)||_Ewa.bp.v(n,t,i,r)||_Ewa.bp.x(n,t,i,r)};_Ewa.bp.v=function(n,t,i,r){return!t&&r.a||t===4&&r.c?!1:t%2==1&&n.Type===5&&r.b&&r.a||t>1&&!!((t-1)%(n.BandSize+1))&&n.Type===6&&r.b&&r.a||!(t%2)&&n.Type===5&&r.b&&!r.a||!!(t%(n.BandSize+1))&&n.Type===6&&r.b&&!r.a||!(i%2)&&n.Type===7&&r.f||!!(i%(n.BandSize+1))&&n.Type===8&&r.f};_Ewa.bp.x=function(n,t,i,r){return t===4&&n.Type===2&&r.c||i===4&&t===4&&n.Type===12&&r.c&&r.e||!i&&t===4&&n.Type===11&&r.c&&r.d||i===4&&n.Type===4&&r.e};_Ewa.bp.w=function(n,t,i,r){return!t&&n.Type===1&&r.a||!i&&n.Type===3&&r.d||!i&&!t&&n.Type===9&&r.a&&r.d||i===4&&!t&&n.Type===10&&r.a&&r.e};_Ewa.bp.j=function(n,t,i,r,u,f,e){var o;if(r.TableStyleBorderFromatList)for(var h=r.TableStyleBorderFromatList,c=h.length,s=0;s<c;++s)if(o=h[s],o.Style)switch(o.Position){case 0:n&&r.Type!==12&&r.Type!==11&&r.Type!==2&&r.Type!==5&&r.Type!==6||_Ewa.bp.a(0,i,o,u,f,e);break;case 1:(n===4||r.Type===1||r.Type===10||r.Type===9||r.Type===5||r.Type===6)&&_Ewa.bp.a(1,i,o,u,f,e);break;case 2:t&&r.Type!==12&&r.Type!==10&&r.Type!==7&&r.Type!==8&&r.Type!==4||_Ewa.bp.a(2,i,o,u,f,e);break;case 3:(t===4||r.Type===9||r.Type===11||r.Type===3||r.Type===7||r.Type===8)&&_Ewa.bp.a(3,i,o,u,f,e);break;case 5:t===4||r.Type===3||r.Type===4||r.Type===7||r.Type===8||_Ewa.bp.a(3,i,o,u,f,e);break;case 6:n===4||r.Type===2||r.Type===1||r.Type===5||r.Type===6||_Ewa.bp.a(1,i,o,u,f,e)}};_Ewa.bp.t=function(){var n=new Array(12);return n[0]=0,n[7]=1,n[8]=2,n[5]=3,n[6]=4,n[4]=5,n[3]=6,n[1]=7,n[2]=8,n[9]=9,n[10]=10,n[11]=11,n[12]=13,n};_Ewa.bp.o=function(n,t,i,r,u,f){this.a=n;this.c=t;this.d=i;this.e=r;this.b=u;this.f=f};_Ewa.bp.o.prototype={a:!1,c:!1,d:!1,e:!1,f:!1,b:!1,g:function(n){return n?this.a===n.a&&this.c===n.c&&this.d===n.d&&this.e===n.e&&this.f===n.f&&this.b===n.b:!1}};_Ewa.Qt=function(n,t,i,r){this.N=Function.createDelegate(this,this.Q);this.O=Function.createDelegate(this,this.Y);this.G=Function.createDelegate(this,this.ba);this.F=Function.createDelegate(this,this.Z);this.E=Function.createDelegate(this,this.f);this.T={height:"100%"};this.L={};this.K=new Date;this.m=-1;this.x={};this.l={};this.n={};_Ewa.Qt.initializeBase(this,[!1]);this.j=n;this.r=t;this.p=i;this.j.b().b(_Ewa.hM,329,this);this.o=r;this.v=this.w();n.a(435)&&!n.isChangeGateEnabled("OfficeVSO:3770811_DeferredGetTableStylesCall")&&(this.j.c().bu()?this.c("tableStyleManagerInitialization"):this.j.c().T(this.E));n.isChangeGateEnabled("OfficeVSO:3876926_Remove_TableStyles_Server_call_onModeCapabilitiesChanged_Event")||this.j.ch(this.F);this.j.g().g(this.G)};_Ewa.Qt.prototype={r:null,j:null,p:null,C:0,q:0,t:null,k:null,v:null,o:null,y:null,J:!1,D:!1,s:!1,u:!1,z:null,I:!1,h:function(n){var t,i,r;if(!this.j.a(436)||(t=this.p.a(),!t))return!1;if(i=n.MenuItemId,!i||!i.length)return Diag.a.a(42821666,0,10,"TableStyleManager.HandleTableStyleOptionQueryCommand optionId is null"),!1;r=Number.parseInvariant(i);switch(r){case 0:return _Ewa.bS.c(t);case 1:return _Ewa.bS.g(t);case 2:return _Ewa.bS.b(t);case 3:return _Ewa.bS.h(t);case 4:return _Ewa.bS.i(t);case 5:return _Ewa.bS.f(t);case 6:return t.y}return!1},d:function(n,t,i){var w,c,l,a;if(!this.j.a(435))return!1;if(Common.P.a(this.l))return Diag.a.a(42821667,0,50,"TableStyleManager.PopulatePopOutMenuForTableStyleGallery, tableStylesDictionary is empty"),!0;if(t!=="PopulateTableMoreStylesMenu")return Diag.a.a(42821696,0,50,"TableStyleManager.PopulatePopOutMenuForTableStyleGallery, Command is Not PopulateTableMoreStylesMenu"),!1;this.u=!0;var e=this.r.c("TableStylesMenu"),s=this.o()?"Size48by48":"Size64by48",v=this.r.f("Ribbon.TableTools.TableStyles.Gallery.Custom",7,s,null),y=this.r.f("Ribbon.TableTools.TableStyles.Gallery.Dark",7,s,null),p=this.r.f("Ribbon.TableTools.TableStyles.Gallery.Medium",7,s,null),h=this.r.f("Ribbon.TableTools.TableStyles.Gallery.Light",7,s,null),f=-123538519,u;!i.MenuId||!i.MenuId.length||(_Ewa.e.c(i.MenuId,"FormatAsTable",!0)?(Diag.a.a(51709704,0,50,"TableStyleManager.PopulatePopOutMenuForTableStyleGallery, Starting Populate Menu for Table Style Gallery from FormatAsTable Menu"),f=753331043,this.s=!0):(Diag.a.a(42821697,0,50,"TableStyleManager.PopulatePopOutMenuForTableStyleGallery, Starting Populate Menu for Table Style Gallery from Table Design Tab"),u=_Ewa.ClientStringManager.a().a(1673),w=_Ewa.bp.b(null,1,"-1"),this.j.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?h.a("-1",f,"QueryTableStyle",0,"-1",w,null,null,u,null):h.a("-1",f,"QueryTableStyle",0,"-1",null,null,null,u,null),this.s=!1));c=0;l=this.l;for(a in l){var b={key:a,value:l[a]},r=b.value,o="";if(u=_Ewa.bp.k(r,this.w()),this.j.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")&&this.o()?o=_Ewa.bp.b(r,this.q,""):this.o()&&!this.D&&this.s&&(o=_Ewa.bp.b(r,this.q,"")),r)switch(r.Category){case 0:v.a(r.Index.toString(),f,"QueryTableStyle",0,r.Index.toString(),o,null,null,u,null);c++;break;case 3:y.a(r.Index.toString(),f,"QueryTableStyle",0,r.Index.toString(),o,null,null,u,null);break;case 2:p.a(r.Index.toString(),f,"QueryTableStyle",0,r.Index.toString(),o,null,null,u,null);break;case 1:h.a(r.Index.toString(),f,"QueryTableStyle",0,r.Index.toString(),o,null,null,u,null);break;default:Diag.a.a(42821698,0,10,"TableStyleManager.PopulateMenu Unmapped Category found, Category encountered - {0}",r.Category)}else Diag.a.a(42821699,0,10,"TableStyleManager.PopulatePopOutMenuForTableStyleGallery, Item is null")}return c>0&&(this.A(e,v,1663),Diag.a.a(42821700,0,50,"TableStyleManager.PopulatePopOutMenuForTableStyleGallery, Number Custom Styles present - {0}",c)),this.A(e,h,1664),this.A(e,p,1665),this.A(e,y,1666),this.o()?i.MenuItems=e.b():i.PopulationXML=this.r.e(e),this.D||(this.D=!0),!0},i:function(n){var t,o,i,f;if(!this.j.a(435))return!1;var e=_Ewa.v.a().b().m,r=0,u=0;return(n[CommandUI.Controls.a.On]=!1,t=n.MenuItemId,!t||!t.length)?(Diag.a.a(42821703,0,10,"TableStyleManager.HandleTableStyleQueryCommand MenuItemIdKey is null"),!0):Common.P.a(this.l)?(o=this.k?10:50,Diag.a.a(42821704,0,o,"TableStyleManager.HandleTableStyleQueryCommand, tableStylesDictionary is empty"),!0):(this.s=_Ewa.e.c(n.ParentMenuId,"FormatAsTable",!0)?!0:!1,this.s||this.V(),_Ewa.bp.l(n)&&(t=this.g(t).toString()),i=this.w(),n.Alt=t==="-1"?_Ewa.ClientStringManager.a().a(1673):_Ewa.bp.k(this.B(t),i),t in this.n&&i.g(this.v))?(this.o()?this.S(n,t,i,!0):this.R(n,t,i,!0),r=_Ewa.v.a().b().m,u=r-e,Diag.a.a(42821705,0,50,"TableStyleManager.HandleTableStyleQueryCommand: Got style from the Cache for tableStyleIndex - {0}. Total Time taken to complete operation is {1} milliseconds",t,u),!0):(this.y&&(!this.y||this.y.c())||(this.x={},f=this,this.y=_Ewa.y.a().a(function(){f.U(!1);f.v=f.w()},0,_Ewa.m.co,!0,!0)),this.bb(i,n,t),r=_Ewa.v.a().b().m,u=r-e,Diag.a.a(51709705,0,50,"TableStyleManager.HandleTableStyleQueryCommand: Got updated style {0}. Total Time taken for complete operation is {1} milliseconds",t,u),!0)},P:function(n){var t=-1;return!n||!n.length||Common.P.a(this.l)?t:n in this.l?this.l[n].Index:(Diag.a.a(595175367,0,50,"TableStyleManager.GetTableStyleIndexFromName: GetTableStyleWebServiceCall called."),this.c("getTableStyleIndexFromName"),t)},a:function(){return!!this.k},g:function(n){return(this.t||this.H(),!(n in this.t))?-1:this.t[n]},c:function(n){var t,i;this.j.k()&&(t=new Date,(_Ewa.bZ.b(this.K,t)>30||Common.P.a(this.l))&&(Diag.a.a(595075412,0,50,"TableStyleManager.GetTableStyleWebServiceCall: Called from {0}",n),i=this.j.d().a().b(!1),this.K=t,_Ewa.i.D(this.j.d().a(),this.O,this.N,null,i)))},f:function(){this.k?this.j.c().ba(this.E):this.c("tableStyleManagerInitialization")},dispose:function(){this.l=null;this.k=null;this.n=null;this.t=null;this.j.isChangeGateEnabled("OfficeVSO:3876926_Remove_TableStyles_Server_call_onModeCapabilitiesChanged_Event")||this.j.cu(this.F);this.j.g().i(this.G);_Ewa.cq.prototype.dispose.call(this)},e:function(n){this.dE("RefreshTableStyleGallery",n)},Y:function(n,t,i){var o=!1,b,r,k,v,s,h,p,g,u,nt,tt,l,w,a,f,c,e;if(_Ewa.T.a(n)){b=n.Errors[0].MessageId;b!==-315732528&&(Diag.a.a.apply(null,[42821707,0,10,"TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : {0}"].concat(n.Errors)),this.Q(null,t,i));return}if(Diag.a.a(42821708,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),r=n.Result,!r){Diag.a.a(42821709,0,10,"TableStyleManager.OnGetTableStyleSuccess - Null results");return}if(!r.TableStyleItems.length){Diag.a.a(42821710,0,10,"TableStyleManager.OnGetTableStyleSuccess - Empty results");return}if(k=r.TableStyleItems.length>60,v=!1,this.k)for(h=0;h<60;++h)for(p=r.TableStyleItems[h],g=this.k.TableStyleItems[h],u=0;u<9;u++){if(u>=p.TableStyleElementsList.length)break;if(nt=p.TableStyleElementsList[u],tt=g.TableStyleElementsList[u],!_Ewa.e.b(nt.BackgroundColor,tt.BackgroundColor,!1)){v=!0;o=!0;break}}else{this.q=0;for(var d=r.TableStyleItems,it=d.length,y=0;y<it;++y)s=d[y],s.TableStyleElementsList&&s.TableStyleElementsList.sort(_Ewa.bp.n),this.l[s.Name]=s}if(v)for(l=0;l<60;++l)w=r.TableStyleItems[l],this.l[w.Name]=w;if(k&&this.k)for(o=!0,a=60;a<r.TableStyleItems.length;++a)f=r.TableStyleItems[a],f.Name in this.l||f.TableStyleElementsList&&f.TableStyleElementsList.sort(_Ewa.bp.n),this.l[f.Name]=f;if($$sc.h.a(this.l).length!==r.TableStyleItems.length)for(o=!0,c=60,e=60;e<this.k.TableStyleItems.length;)c>=r.TableStyleItems.length?delete this.l[this.k.TableStyleItems[e].Name]:c>=r.TableStyleItems.length||!_Ewa.e.b(r.TableStyleItems[c].Name,this.k.TableStyleItems[e].Name,!1)?delete this.l[this.k.TableStyleItems[e].Name]:++c,++e;this.k=r;this.U(o);o&&this.H();this.J||(this.X()&&this.j.A(),this.J=!0);this.C=0;this.u||this.I||(this.dC("RefreshTableStyleGallery",null,null),this.I=!0)},Q:function(){if(Diag.a.a(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed"),this.C++,this.C<5){var n=this;_Ewa.y.a().a(function(){n.c("getTableStylesFailed")},1e3,_Ewa.m.i,!0,!0)}else Diag.a.a(42821713,0,50,"TableStyleManager.OnGetTableStyleFailed - Retry count expired")},H:function(){var t={},n,i;for(this.p.a()&&(this.m=this.P(this.p.a().z)),n=1;n<=7;n++)i="preview"+n,t[i]=this.W(n);this.t=t},W:function(n){var t=n,r=this.k.TableStyleItems.length,i=Math.ceil(7/2);return t=this.m<=i?this.m+n-1:this.m>i&&this.m<r-i?n===i?this.m:Math.floor(this.m+n-i):this.m+n-1,t===-1||t.toString()in this.n||(t=n-3),t},V:function(){var t,n,i,r,u;if(this.p.a()){if(t=!1,n=this.P(this.p.a().z),n===this.m)return;if(this.t){i=this.t;for(r in i)u={key:r,value:i[r]},u.value===n&&(t=!0)}this.m=n;t||Common.P.a(this.n)||this.H()}},A:function(n,t,i){var r=this.r.b();r.b("Thin");r.c(_Ewa.ClientStringManager.a().a(i));r.a().push(t);n.a().push(r)},w:function(){var n=this.p.a();return this.s||!n?new _Ewa.bp.o(!0,!1,!1,!1,!0,!1):new _Ewa.bp.o(_Ewa.bS.c(n),_Ewa.bS.b(n),_Ewa.bS.g(n),_Ewa.bS.h(n),_Ewa.bS.i(n),_Ewa.bS.f(n))},U:function(n){var i={},u={},r=this.w(),f,e,h,t,o,s;if(!Common.P.a(this.l)&&(this.p.a()&&this.V(),!r.g(this.v)||n||Common.P.a(this.n))){this.q=(this.q+1)%5;f=this.l;for(e in f)h={key:e,value:f[e]},t=h.value,this.o()?(o=_Ewa.bp.b(t,this.q,""),i[t.Index.toString()]=_Ewa.bp.g(_Ewa.bp.d(_Ewa.bp.c(t,r)),o),u[o]=i[t.Index.toString()],this.M(u)):i[t.Index.toString()]=_Ewa.bp.f(t,r);this.o()?(s=_Ewa.bp.b(null,this.q,"-1"),i["-1"]=_Ewa.bp.g(_Ewa.bp.d(_Ewa.bp.c(null,r)),s),u[s]=i["-1"],this.M(u)):this.n["-1"]=_Ewa.bp.f(null,r);_Ewa.dc.a(this.n,i,!1)}},X:function(){var n=_Ewa.cP.a(this.j);return n?n.a().b()===(this.o()?"Table":this.j.n()+"Ribbon.Table.Design"):!1},bc:function(n,t){this.p.a()&&(n[CommandUI.Controls.a.On]=t)},bb:function(n,t,i){var r=Number.parseInvariant(i);i==="-1"&&_Ewa.e.c(t.ParentMenuId,"FormatAsTable",!0)||(this.o()?this.S(t,i,n,!1):this.R(t,i,n,!1))},R:function(n,t,i,r){var f=Number.parseInvariant(t),u;r||(u=this.B(t),this.n[t]=_Ewa.bp.f(u,i));n[CommandUI.Controls.a.InnerHTML]=this.n[t];_Ewa.e.c(n.ParentMenuId,"FormatAsTable",!0)||this.bc(n,this.m===f)},S:function(n,t,i,r){var f=_Ewa.bp.b(null,this.q,t),o,u,e,s,c,h;_Ewa.bp.l(n)?(o=[],f in this.x?o=this.x[f]:(o=_Ewa.bp.d(_Ewa.bp.c(this.B(t),i)),this.x[f]=o),n[CommandUI.Controls.a.GalleryButtonProps]=(u=new Common.hO,u.Command="-123538519",u.QueryCommand="QueryTableStyle",u.Id=f,u.Alt=n.Alt,u.MenuItemId=t,u.TableCellStyles=o,u.TableStyles=this.T,u)):(n[CommandUI.p.Icon]=f,n[CommandUI.Controls.a.GalleryButtonProps]=(e=new Common.dJ,e.Command="-123538519",e.QueryCommand="QueryTableStyle",e.Id=f,e.Alt=n.Alt,e.MenuItemId=t,e),r||(s=[],c=this.B(t),t==="-1"||_Ewa.e.c(n.ParentMenuId,"FormatAsTable",!0)||(s=_Ewa.bp.c(this.k.TableStyleItems[Number.parseInvariant(t)],i)),this.n[t]=_Ewa.bp.g(_Ewa.bp.d(s),f),h={},h[f]=this.n[t]))},M:function(n){var f,t,r,u,i,e;if(this.u){f=this;this.z=function(){f.M(n)};return}this.z=null;t=[];r=n;for(u in r)i={key:u,value:r[u]},i.key in this.L?t.push(i.key):this.L[i.key]=!0;try{t.length>0&&appChrome.api.unregisterIcons(t);Common.P.a(n)||(e=this,appChrome.api.registerIconProvider(function(){return n}))}catch(o){}},B:function(n){var t=Number.parseInvariant(n),i,r;if(t===-1||!this.k)return null;if(t>60)for(i=60;i<this.k.TableStyleItems.length;++i)if(r=this.k.TableStyleItems[i],r.Index===t)return r;return this.k.TableStyleItems[t]},Z:function(){if(!this.k){var n=this;Common.App.AppLifecycleManager.get_instance().a(5,function(){n.c("modeCapabilitiesChanged")},3)}},ba:function(){if(this.u){this.u=!1;this.z&&this.z();var n=this;_Ewa.y.a().a(function(){n.c("galleryMenuClosed")},1e3,_Ewa.m.i,!0,!0)}}};_Ewa.Qs=function(n){_Ewa.Qs.initializeBase(this);this.h=n;this.j()};_Ewa.Qs.prototype={k:null,h:null,b:function(){this.i(this.k||(this.k=new _Ewa.Qr(this.h)))}};_Ewa.Qu=function(n){_Ewa.Qu.initializeBase(this);this.h=n;this.j()};_Ewa.Qu.prototype={k:null,h:null,b:function(){var t=_Ewa.l.a(_Ewa.dE,this.h.b(),102,this.dD(),-2),i=_Ewa.l.b(_Ewa.dq,this.h.b(),66,134,this.l),n=this;_Ewa.f.cw($$sc.a.WAA(t,i),function(){n.i(n.k||(n.k=new _Ewa.Qt(n.h,t.a(),i.a(),function(){return _Ewa.s.a()})))},this.h.i(),8)}};_Ewa.df=function(n){this.m=Function.createDelegate(this,this.H);this.s=Function.createDelegate(this,this.Q);this.p=Function.createDelegate(this,this.N);this.q=Function.createDelegate(this,this.O);this.r=Function.createDelegate(this,this.P);this.o=Function.createDelegate(this,this.M);this.n=Function.createDelegate(this,this.K);this.v=Function.createDelegate(this,this.L);_Ewa.df.initializeBase(this,[document.createElement("div"),null]);this.b=n;this.a=_Ewa.b.a(this.b);this.d=this.cl();this.d.className="ewa-ttrd-buttonarea";this.f=this.a.A();this.cp(!1);this.I();this.B();this.b.c().j()?this.x():this.b.c().x(this.v);Diag.a.a(595195099,0,50,"TableTotalRowOptions - React Component Created ");_Ewa.ev.b(this.b,this.a.a().c())?(this.e=!0,this.c(!0),this.w(),this.A(!1)):(this.c(!1),this.e=!1)};_Ewa.df.c=function(n){return _Ewa.df.b||(_Ewa.df.b=new _Ewa.df(n)),_Ewa.df.b};_Ewa.df.prototype={g:!1,t:!1,e:!1,k:!1,h:!1,b:null,a:null,l:null,f:null,d:null,c:function(n){return this.k!==n&&(this.cp(n),this.k=n),n},y:function(){return!!(this.b.r()&16)},D:function(){var n=this.a.a().c();return n.c===n.r},j:function(){var n=this.a.e(null);return!n||!this.a.bb(n.b())?(n&&Diag.a.a(594890818,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null):this.F(n)},C:function(){return this.j()?this.j().height:0},dispose:function(){this.b&&(this.a&&(this.a.a()&&(this.a.a().j(this.n),this.a.b().b(this.o)),this.a.y(this.r),this.a.l().d(this.q),this.a.l().g(this.p),this.T()),this.f&&this.f.contains(this.d)&&this.f.removeChild(this.d));this.f=null;this.d=null;this.a=null;this.b=null;_Ewa.VA.prototype.dispose.call(this)},E:function(n){var t=this.G(this.a.e(null).b());return t?String.format("=SUBTOTAL({0},{1})",n,t):null},G:function(n){var i=_Ewa.b.a(this.b).f().a(n,!1),t;return i?(t=_Ewa.bS.a(i,!1),t.c=t.b=n.b,t.toString()):null},I:function(){_Ewa.df.a={};_Ewa.df.a["100"]=_Ewa.ClientStringManager.a().a(943);_Ewa.df.a["101"]=_Ewa.ClientStringManager.a().a(946);_Ewa.df.a["102"]=_Ewa.ClientStringManager.a().a(945);_Ewa.df.a["103"]=_Ewa.ClientStringManager.a().a(950);_Ewa.df.a["104"]=_Ewa.ClientStringManager.a().a(947);_Ewa.df.a["105"]=_Ewa.ClientStringManager.a().a(948);_Ewa.df.a["109"]=_Ewa.ClientStringManager.a().a(944);_Ewa.df.a["107"]=_Ewa.ClientStringManager.a().a(951);_Ewa.df.a["110"]=_Ewa.ClientStringManager.a().a(953);_Ewa.df.a["111"]=_Ewa.ClientStringManager.a().a(997)},R:function(){var t=this.a.e(null),n,r,i;if(t){if(n=t.k()?t.d():null,n)if(r=n.substring(0,10),r==="=SUBTOTAL("){if(i=n.substring(10,13),i in _Ewa.df.a)return i}else return"111";return"100"}return"100"},B:function(){this.a.b().c(this.o);this.a.a().i(this.n);this.a.t(this.r);this.a.l().c(this.q);this.a.l().f(this.p)},i:function(n){if(this.A(n),this.y()){if(this.S(),!this.j()){Diag.a.a(51513356,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined");this.c(!1);return}this.t||this.w();this.h?this.c(!1):(this.c(!0),this.u())}},u:function(){var n=this;appChrome.renderTableTotalRowOptions(this.d,_Ewa.df.a,_Ewa.df.a[this.R()].toString(),this.C(),function(t){if(Diag.a.a(51513357,0,50,"TableTotalRowOptions.CreateDropdownButton - Selected Option : {0}",t),t==="111")return n.J(),!0;if(t!=="100"){if(n.l=n.E(t),!n.l)return Diag.a.a(594113797,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;n.z(n.l)}else n.z("");return _Ewa.a.c(n.a.g().a().cl(),!1),!0})},J:function(){Diag.a.a(594056920,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");var n=new _Ewa.R(753860909,0,this.b.k()?2:1,19,null);this.b.g().b(n,null,null)},F:function(n){var t,i,u,r,f,e,o,s;if(!n)return null;if(i=this.a.l().a().cl(),u=_Ewa.a.bb(i)>0&&_Ewa.a.C(i)>0&&i.offsetTop>=0&&i.offsetLeft>=0,u?t=_Ewa.a.P(i,this.a.A()):(r=this.a.Q(n.a()),f=_Ewa.a.i(this.a.A()),t=new Sys.UI.Bounds(r.x-f.x,r.y-f.y,r.width,r.height)),t)if(u)t.height>2&&t.height>2&&(t.x+=1,t.y+=1,t.height-=2,t.width-=2);else if(e=_Ewa.b.a(this.b).R(n.a()),e)o=e.c(),s=_Ewa.e.b(_Ewa.bW.b(n.a(),this.a.d()),"right",!0),this.a.d()&&s&&(t.x=t.x+t.width-o),n.p()&&this.a.d()===s&&(t.width=o);else return null;return t},A:function(n){var t=this.j(),i,r;if(!t){this.c(!1);return}i=t.height<=17?t.y:t.y+t.height-19;this.d.style.top=i+"px";r=this.D()?this.a.d()?t.x:t.x+t.width-(t.height>17?17:t.height):this.a.d()?t.x-(t.height>17?17:t.height):t.x+t.width;this.d.style.left=r+"px";n&&this.c(this.a.bq(new _Ewa.M(r,i)))},x:function(){if(this.y())try{this.u()}catch(n){Diag.a.a(51513358,0,10,"TableTotalRowOptions.CreateDropdownButton - AppChrome Undefined")}},w:function(){this.f.insertBefore(this.d,this.f.firstChild);this.t=!0},S:function(){this.g||(this.a.h().d(this.s),this.g=!0)},T:function(){this.g&&(this.a.h().b(this.s),this.g=!1)},z:function(n){var r=this.a.g(),t=this.a.e(null),i;t&&(i=127,this.a.X(n,t.b(),0,i,null),r.i(!0,"TableTotalRowOptions.SetCellContent",0,null))},L:function(){this.x()},K:function(){_Ewa.ev.b(this.b,this.a.a().c())?(this.e=!0,this.i(!1)):(this.e=!1,this.c(!1))},Q:function(){this.e?this.i(!0):this.c(!1)},O:function(){this.h=!0;this.e&&this.c(!1)},P:function(){_Ewa.ev.b(this.b,this.a.a().c())&&(this.e=!0,this.i(!1))},N:function(){this.h=!1;this.e?this.i(!1):this.c(!1)},M:function(n,t){if(this.e){var i=this.a.bO(t.a.a.n.Information.BlockCachePosition.PaneType).N(t.a.b);i&&(i.g(this.m),i.h(this.m))}},H:function(){this.u()}};_Ewa.Lo.registerClass("_Ewa.Lo");_Ewa.Lr.registerClass("_Ewa.Lr");_Ewa.Lq.registerClass("_Ewa.Lq");_Ewa.mT.registerClass("_Ewa.mT",_Ewa.Lp);_Ewa.vR.registerClass("_Ewa.vR");_Ewa.Lu.registerClass("_Ewa.Lu");_Ewa.Lt.registerClass("_Ewa.Lt");_Ewa.Qr.registerClass("_Ewa.Qr",_Ewa.bfm,_Ewa.dq,Sys.IDisposable);_Ewa.lF.registerClass("_Ewa.lF",_Ewa.gK);_Ewa.Qt.registerClass("_Ewa.Qt",_Ewa.cq,_Ewa.hM,Sys.IDisposable);_Ewa.Qs.registerClass("_Ewa.Qs",_Ewa.qc.$$(_Ewa.dq));_Ewa.Qu.registerClass("_Ewa.Qu",_Ewa.qc.$$(_Ewa.hM));_Ewa.df.registerClass("_Ewa.df",_Ewa.VA,Sys.IDisposable);_Ewa.lF.a=[27];_Ewa.bp.m=[null,"solid","dashed","dotted","dashed","dotted","dashed","double"];_Ewa.bp.i=["border-top","border-bottom","border-left","border-right"];_Ewa.bp.h=_Ewa.bp.t();_Ewa.bp.e=null;_Ewa.df.b=null;_Ewa.df.a=null;_Ewa.bfn.a();Type.registerNamespace("_Ewa");_Ewa.qr=function(){};_Ewa.qr.b=function(){return CommonUI.b.a(_Ewa.qr.a,_Ewa.ClientStringManager.a().a(647))};_Ewa.Qn=function(n,t,i){this.d=t;this.a=n;this.b=this.a.o().b("UserAction","ConvertToRangeManager");this.e=i};_Ewa.Qn.prototype={a:null,d:null,b:null,e:null,c:!1,j:function(){this.b.d();var n=this.a.d().a().b(!1),t=this;return _Ewa.dW.g(this.a.d().a(),this.d,function(n){t.k(n)},null,null,n)},k:function(n){return new _Ewa.Qn.a(this,n)},f:function(){var n={};return n.IsQueryTable=this.c,n.Range=this.d,n},h:function(){var t=this.a.d().a(),n;Diag.a.a(41461400,0,50,"Convert To Range initiated for Query Table");n=this;this.g(194,function(i,r){return _Ewa.dW.f(t,n.f(),i,r,null,null)},null);Diag.a.a(41461401,0,50,"Convert To Range completed for Query Table")},i:function(){var n=this.a.d().a();Diag.a.a(41461402,0,50,"Convert To Range initiated for Normal Table");var t=this,i=function(){return new _Ewa.Lo(t.e)},r=this;this.g(193,function(t,i){return _Ewa.dW.e(n,r.f(),t,i,null,null)},i);Diag.a.a(41461403,0,50,"Convert To Range completed for Normal Table")},g:function(n,t,i){var u=this,r=function(t){return new _Ewa.I(n,0,t,0,i)};return _Ewa.S.a(this.a.h(),t,r,null)}};_Ewa.Qn.a=function(n,t){this.h=Function.createDelegate(this,this.moveNext);this.a=n;this.i=t;this.c=t;this.e=this.l;this.moveNext()};_Ewa.Qn.a.prototype={c:null,i:null,a:null,f:null,g:0,d:null,e:null,b:0,l:function(){return(Diag.a.a(41714579,0,50,"ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is {0} milliseconds",this.a.b.b()),this.c&&!_Ewa.T.a(this.c))?(this.a.c=this.c.Result,this.a.c)?(this.f=_Ewa.h.b(3,2,0,648,0,-66108047,"ConvertToRange"),this.d=_Ewa.L.a(this.a.a).d(this.f).G(),this.d.b.b>3||(this.b=2,this.d.a(this.h)),this.m):(this.a.i(),this.k):this.j},j:function(){this.a.b.a();Diag.a.a(41714581,0,50,"ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is {0} milliseconds",this.a.b.b());this.b=3},k:function(){return this.j},m:function(){return this.g=this.d.c(),Diag.a.a(41714580,0,50,"ConvertToRangeManager.ShowDialog: Time taken for User Input is {0} milliseconds",this.a.b.b()),this.g||this.a.h(),this.k},dispose:function(){},moveNext:function(){try{for(this.b=1;this.b===1;)this.e=this.e()}catch(n){this.b=3}}};_Ewa.bfj=function(n,t){_Ewa.bfj.initializeBase(this,[n,t,!0,3,n.a(573)]);this.y=!0};_Ewa.bfj.prototype={b:null,z:null,x:null,y:!1,dispose:function(){this.z=null;this.x=null;this.b=null;_Ewa.Rc.prototype.dispose.call(this)},C:function(){var n="<div id = 'ctd'class='ewa-dlg-body-sectionlabel' aria-live='polite' aria-atomic='true'>\r\n\t<span>{0}<\/span>\r\n\t<span id='tableDataRange' class='ewa-dlg-columnName'>{1}<\/span>\r\n<\/div>\r\n<div  class='ewa-dlg-body-sectionbreak'>\r\n\t<input type='checkbox' id='{2}' disabled='true' class='ewa-dlg-input' />\r\n\t<label for='{2}' class='ewa-dlg-label'>{3}<\/label>\r\n<\/div>";n=String.format(n,_Ewa.ClientStringManager.a().a(645),_Ewa.ClientStringManager.a().a(646),"hasHeaders",_Ewa.ClientStringManager.a().a(644));this.B.innerHTML=n;this.D()||(this.F(),this.U(),this.dA.setAttribute("aria-describedby","ctd"));_Ewa.Rc.prototype.C.call(this)},F:function(){this.z=_Ewa.a.a(this.B,"tableDataRange");this.x=_Ewa.a.a(this.B,"hasHeaders")},bq:function(){var n=this.A,i=_Ewa.g.a(_Ewa.b.a(n).a().a(),n),r=n.d().a().b(!1),t=this;return function(u,f){return _Ewa.i.s(n.d().a(),i,t.by(u),t.br(f),null,r)}},L:function(){var i=this.b.TableRange,n=_Ewa.g.b(i),t,r,u;if(this.x.checked){if(t=n.f(),t.W(2,n.a),r=_Ewa.b.a(this.A).bc(t),_Ewa.b.a(this.A).f().e(t)&&!_Ewa.b.a(this.A).f().v(t))return u=new _Ewa.Qp(this.A,i,this.b.HasTotalRow),!0}else n.d=n.d+1;return _Ewa.b.a(this.A).a().f(n,n,0,0,!0,"",!1,!0,!0),_Ewa.Rc.prototype.L.call(this)},bb:function(){var n=this;return function(){return new _Ewa.Lp(n.x.checked,n.b.TableRange)}},G:function(){var n=this.n(1),t;n&&(this.y?n.get_element().focus():(t=this.n(0),t.get_element().focus()))},K:function(n,t,i){var u=this.b=n.Result,f=this.x,r;(f.checked=u.HasHeaders,f.disabled=!1,this.z.innerText=u.StringTableRange,_Ewa.bfN.prototype.K.call(this,n,t,i),r=this.n(0),r)&&(r.get_element().disabled&&(r.get_element().disabled=!1),this.y=!1)}};_Ewa.yC=function(n){this.P=Function.createDelegate(this,this.S);_Ewa.yC.initializeBase(this,[n,_Ewa.ClientStringManager.a().a(642)])};_Ewa.yC.prototype={e:function(){return"CreateTableDialog"},Q:function(){return 206},O:function(){var n=this;return function(t,i){return _Ewa.dW.c(n.A.d().a(),n.b.TableRange,n.x.checked,!1,n.b.HasTotalRow,_Ewa.o.a(t,n.P),i,null,null)}},K:function(n,t,i){_Ewa.bfj.prototype.K.call(this,n,t,i)},S:function(){_Ewa.cP.a(this.A).g(1)}};_Ewa.Qo=function(n,t){this.P=-1;_Ewa.Qo.initializeBase(this,[n,_Ewa.ClientStringManager.a().a(643)]);this.P=t};_Ewa.Qo.prototype={e:function(){return"FormatAsTableDialog"},Q:function(){return 215},bb:function(){var t=this.b.TableRange,n=this;return function(){return new _Ewa.mT(t,n.x.checked,n.P,!0)}},O:function(){var t=this.b.TableRange,i=_Ewa.g.j(t),n=this;return function(t,r){return _Ewa.dW.a(n.A.d().a(),i,n.x.checked,!1,n.b.HasTotalRow,n.P,t,r,null,null)}},K:function(n,t,i){_Ewa.bfj.prototype.K.call(this,n,t,i)}};_Ewa.nC=function(n,t,i,r){this.i=Function.createDelegate(this,this.C);this.l=Function.createDelegate(this,this.D);this.m=Function.createDelegate(this,this.E);this.o=Function.createDelegate(this,this.G);this.n=Function.createDelegate(this,this.F);this.a=n;this.b=t;this.j=i;this.k=this.a.w();this.c=_Ewa.b.a(this.a).a();this.d=r;this.d.e(this.n)};_Ewa.nC.a=function(n,t){t.SheetName=n.j().a;t.NamedObjectView=n.c().b()};_Ewa.nC.prototype={a:null,d:null,k:null,h:null,c:null,f:-1,b:null,j:null,z:function(n,t){switch(t){case-544558380:return!(this.a.a(436)&&this.b&&this.c.r()&&!this.e()&&_Ewa.bS.c(this.b.a()));case 1544516694:if(!this.a.a(436)||!this.b||!this.c.r()&&!this.c.D())return!0;break;case-697806646:case 323142015:return!this.c.r();case 341449783:case 2128797448:return!(this.b&&this.b.f(this.c.c()));case-1400250766:return!this.a.a(538);case-123538519:return!(this.a.a(435)&&this.c.r()&&this.d&&this.d.a());case 756677940:return!(this.a.a(593)&&this.B());case 753331043:case 2105103744:case-585683120:return this.a.isChangeGateEnabled("OfficeVSO:3770811_DeferredGetTableStylesCall")?!(this.a.a(435)&&this.d&&this.r()):!(this.a.a(435)&&this.d&&this.d.a()&&this.r())}return!1},w:function(n,t,i){var w=$$sc.a.a(Boolean,!0),f=this.a.d().a(),r=null,e=1,c=t.a,o=this.a.d().a().b(!1),u=null,v,ri,ui,y,b,fi,ei,oi,k,p,d,g,at,nt,tt,it,l,si,vt,rt,yt,pt,li,a,s,wt,ut,et,kt,vi,dt,ot,gt,ni,st,ht,pi,ct,ii;switch(c){case-2058042992:v=_Ewa.F.b(i.CommandValueId);_Ewa.nC.a(this.a,v);ri=this;r=function(n,t){return _Ewa.dW.d(f,v,null,null,!1,!1,!1,n,t,null,null)};e=176;ui=this;u=function(){return new _Ewa.KY(v)};break;case 504133448:case-798968736:case 477776686:y=_Ewa.F.b(i.CommandValueId);_Ewa.nC.a(this.a,y);b=t.a===504133448?1:t.a===-798968736?2:3;!0&&(fi=this,r=function(n,t){return _Ewa.i.v(f,y,b,n,t,null,o)},e=177);ei=this;u=function(){return new _Ewa.KJ(y,b)};break;case 341449783:case 2128797448:var h=this.g(),lt=t.a===341449783,wi=this;r=function(n,t){return _Ewa.Qq.a(f,h,lt,n,t,null,o)};e=178;oi=this;u=function(){return new _Ewa.Lt(h,lt)};break;case-712419744:this.A();break;case 1868184698:k=new _Ewa.yC(this.a);k.C();k.w(!1);break;case 746310646:break;case 1544516694:case-544558380:p=i.MenuItemId;!this.a.a(436)||!p||!p.length||(this.f=this.x(p),d=_Ewa.b.a(this.a).a().D(),this.f!==-1?(Diag.a.a(41996800,0,50,"TableCommandHandler: The selected {0} style option {1} was toggled.",d?"PivotTable":"table",this.f),h=this.g(),g=this,r=function(n,t){return _Ewa.dW.j(f,h,g.f,_Ewa.o.a(n,g.o),t,null,o)},e=196,at=this,u=function(){return new _Ewa.Lu(h,at.f)}):Diag.a.a(41735315,0,10,"TableCommandHandler: The selected {0} style option {1} is not valid.",d?"PivotTable":"table",this.f));break;case 756677940:if(this.e()&&this.s()){Diag.a.a(594130064,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}if(nt=i.Text,tt=this.u(),tt)it=this,r=function(n,t){return _Ewa.dW.h(f,nt,tt,_Ewa.o.a(n,it.m),_Ewa.o.b(t,it.l),o,null)},e=217,l=null,this.b.a()?l=this.b.a().a:this.b.e()?l=this.b.e().a:Diag.a.a(594130063,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command"),l&&(si=this,u=function(){return new _Ewa.Lq(l,nt)});else return Diag.a.a(50679901,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),$$sc.a.a(Boolean,!1);break;case 323142015:if(this.e())break;return h=this.g(),vt=new _Ewa.Qn(this.a,h,this.b.a().a),vt.j();case-1400250766:if(this.a.a(538)){e=211;r=this.I(i,f,o);var hi=i.OriginalTableRange,ci=_Ewa.g.l(hi,this.a.f().a()),bi=this;u=function(){return new _Ewa.Lr(ci)}}break;case 1872288872:this.a.a(538)&&this.b.s();break;case-123538519:if(!this.a.a(435)||this.e())break;e=212;r=this.t(i,f,o);rt=this.q(i);this.a.isChangeGateEnabled("OfficeVSO:3961277_ReplaceTopLeftCellWithActiveCellInTable")?(yt=this,u=function(){return new _Ewa.vR(yt.g(),rt)}):(pt=_Ewa.g.a(this.b.b(this.b.a().b.e()),this.a),li=this,u=function(){return new _Ewa.vR(pt,rt)});break;case 753331043:if(!this.a.a(435))break;if(a=i.MenuItemId,!a||!a.length){Diag.a.a(42821663,0,10,"TableCommandHandler.FormatAsTable MenuItemIdKey is null");break}if(s=Number.parseInvariant(a),this.c.r()){if(Diag.a.a(51181321,0,50,"TableCommandHandler.FormatAsTable invoked on existing table with style index: {0}",s),this.a.a(462)){wt=this.c.d().a();ut=[];for(var bt=wt,ai=bt.length,ft=0;ft<ai;++ft)et=bt[ft],_Ewa.b.a(this.a).f().c(et)&&Array.add(ut,et);kt=_Ewa.g.e(ut,this.a);vi=this;r=function(n,t){return _Ewa.dW.a(f,kt,!1,!1,!1,s,n,t,null,o)};this.e()||(dt=this.b.a(),ot=this,u=function(){return new _Ewa.mT(_Ewa.g.l(ot.b.b(dt.b.e()),ot.a.f().a()),!1,s,!1)})}else if(this.a.isChangeGateEnabled("OfficeVSO:3961277_ReplaceTopLeftCellWithActiveCellInTable"))gt=this,r=function(n,t){return _Ewa.dW.a(f,gt.p(),!1,!1,!1,s,n,t,null,o)},ni=this,u=function(){return new _Ewa.mT(ni.g(),!1,s,!1)};else if(!this.e()){var ti=this.b.a(),yi=_Ewa.g.s(this.b.b(ti.b.e()),this.a.f().a()),ki=this;r=function(n,t){return _Ewa.dW.a(f,yi,!1,!1,!1,s,n,t,null,o)};st=this;u=function(){return new _Ewa.mT(_Ewa.g.l(st.b.b(ti.b.e()),st.a.f().a()),!1,s,!1)}}e=215}else Diag.a.a(51181322,0,50,"TableCommandHandler.FormatAsTable invoked on newly created table with style index: {0}",s),ht=new _Ewa.Qo(this.a,Number.parseInvariant(a)),ht.C(),ht.w(!1);break;default:return _Ewa.J.a(c)}return r&&(pi=this,ct=function(n){return new _Ewa.I(e,0,n,0,u)},this.a.a(371)&&this.j&&(c===-2058042992||c===504133448||c===-798968736||c===477776686)?(ii=this,w=this.j.a().CW(function(n){var i=n.a();i&&_Ewa.S.a(ii.a.h(),r,ct,t)})):w=_Ewa.S.a(this.a.h(),r,ct,t)),w},I:function(n,t,i){var u=n.ResizeTableRange,r=n.OriginalTableRange,f=_Ewa.g.l(u,this.a.f().a()),e=this,o=function(){e.b.i(r)},s=this,h=function(n){n.Errors&&s.b.i(r)},c=this;return function(n,r){return _Ewa.dW.i(t,f,_Ewa.o.a(n,h),_Ewa.o.b(r,o),null,i)}},q:function(n){var i=-1,t;return _Ewa.e.a(n.MenuItemId)||(t=n.MenuItemId,i=_Ewa.e.c(t,"preview",!0)?this.d.g(t):Number.parseInvariant(n.MenuItemId)),i},t:function(n,t,i){var r=this.q(n),a=n.MenuItemId,v=_Ewa.e.c(a,"preview",!0)||_Ewa.e.c(n.SourceControlId,"TableStyleIcon",!0),y=v?"Preview Gallery":"Pop-out Gallery",s,u,e,c,l,o;if(Diag.a.a(51181323,0,50,"TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from {0} with style index {1}",y,r.toString()),this.a.a(462)){s=this.c.d().a();u=[];for(var h=s,p=h.length,f=0;f<p;++f)e=h[f],_Ewa.b.a(this.a).f().c(e)&&Array.add(u,e);return c=_Ewa.g.e(u,this.a),l=this,function(n,u){return _Ewa.dW.b(t,c,r,_Ewa.o.a(n,l.i),u,null,i)}}if(this.a.isChangeGateEnabled("OfficeVSO:3961277_ReplaceTopLeftCellWithActiveCellInTable"))return o=this,function(n,u){return _Ewa.dW.b(t,o.p(),r,_Ewa.o.a(n,o.i),u,null,i)};if(this.e())return null;var w=this.b.a(),b=_Ewa.g.s(this.b.b(w.b.e()),this.a.f().a()),k=this;return function(n,u){return _Ewa.dW.b(t,b,r,_Ewa.o.a(n,k.i),u,null,i)}},v:function(n,t){var i=!1;switch(t.a){case-2058042992:case 504133448:case-798968736:case 477776686:case 341449783:case 2128797448:case-712419744:case 1868184698:case 746310646:case 1872288872:case 323142015:i=!0;break;case 1544516694:case-544558380:i=this.a.a(436);break;case-1400250766:i=this.a.a(538);break;case-123538519:case 753331043:i=this.a.a(435);break;case 756677940:i=this.a.a(593)}return i},y:function(n,t,i){var r=!1;switch(t){case"PopulateTableMoreStylesMenu":this.h=i.MenuId;this.a.isChangeGateEnabled("OfficeVSO:3770811_DeferredGetTableStylesCall")?(this.d.a()||this.d.c("formatAsTableMenu"),r=this.d.d(n,t,i)):this.d.a()&&(r=this.d.d(n,t,i))}return r},F:function(){this.H()},H:function(){_Ewa.e.c(this.h,"Format",!0)&&this.h&&this.k.w(this.h)},g:function(){var n=this.c.c();return _Ewa.g.a(n,this.a)},p:function(){var n=this.c.c();return _Ewa.g.s(n,this.a.f().a())},u:function(){var n=this.b.o();return n?_Ewa.g.a(n,this.a):null},A:function(){var u,h,f,e,i,o,c;if(this.b){var s=_Ewa.b.a(this.a),n=this.c.c(),r=this.b.b(n),t=null;if(!r||r.t)for(u=s.bf().$$ge();u.$$mn();)for(h=u.$$cu(),f=h.$$ge();f.$$mn();)e=f.$$cu(),i=e.a(),n.b>=i[0]&&n.b<=i[i.length-1]&&(o=e.m(n,!1,!1).b(!1),t=o?_Ewa.a.e(o,"af-img",!1):null);else t=s.e(_Ewa.n.a(r.a,n.b,!1)).w(56,"click").a;t&&(c=this,_Ewa.y.a().a(function(){_Ewa.a.Q(t,null)},0,_Ewa.m.cm,!0,!0))}},x:function(n){var t=Number.parseInvariant(n);return t>-1&&t<=8?t:-1},C:function(n){_Ewa.T.a(n)?Diag.a.a(42821664,0,10,"TableStyleManager.OnApplyTableStyleSuccessful - Webservice call failed with errors"):this.a.A()},G:function(n){var r,u;if(this.a.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")&&!(_Ewa.T.a(n)||this.e())||!(_Ewa.T.a(n)&&this.e())){var i=this.c.c(),t=this.a.a(462)?this.c.d().c():this.c.a(),f=this.b.a().b;this.f===2&&_Ewa.bS.b(this.b.a())&&i.d===f.d&&(r=t.I()?new _Ewa.n(t.a-1,t.b,t.d-1,t.c,!1,!0):new _Ewa.n(t.a,t.b,t.d-1,t.c,!1,!0),u=r.i(i)?i:_Ewa.n.a(r.d,i.b,!1),_Ewa.b.a(this.a).a().f(r,u,0,3,!0,"",!1,!0,!0))}},E:function(n){if(_Ewa.T.a(n)){Diag.a.a(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input");this.a.A();return}Diag.a.a(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")},D:function(){Diag.a.a(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");this.a.A()},e:function(){return!this.b.a()},s:function(){var n=this.b.e();return n?!1:(Diag.a.a(594130059,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)},r:function(){var n=this.c.r(),t=(!this.a.a(462)||this.c.d().b())&&!_Ewa.b.a(this.a).f().c(_Ewa.b.a(this.a).a().a());return n||t},B:function(){return this.c.r()||!this.s()}};_Ewa.yD=function(n){_Ewa.yD.initializeBase(this,[n])};_Ewa.yD.a=function(n){_Ewa.ba.a(86,new _Ewa.yD(n))};_Ewa.yD.prototype={dispose:function(){_Ewa.ba.prototype.dispose.call(this)},m:function(){var n=_Ewa.l.a(_Ewa.dq,this.h.b(),134,this.dD(),this.l),t=_Ewa.l.a(_Ewa.hM,this.h.b(),330,this.dD(),this.l),i,r,u;this.h.a(371)?(i=_Ewa.l.b(_Ewa.gN,this.h.b(),309,310,this.l),r=this,_Ewa.f.cw($$sc.a.WAA(n,i,t),function(){r.k([new _Ewa.nC(r.h,n.a(),i.a(),t.a())],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.h.i(),3)):(u=this,_Ewa.f.cw($$sc.a.WAA(n,t),function(){u.k([new _Ewa.nC(u.h,n.a(),null,t.a())],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.h.i(),3))}};_Ewa.Qp=function(n,t,i){this.e=Function.createDelegate(this,this.X);_Ewa.Qp.initializeBase(this,[n,null]);this.d=t;this.b=i;this.p=_Ewa.qr.b();this.j(_Ewa.ClientStringManager.a().a(884),this.e,null)};_Ewa.Qp.prototype={d:null,b:!1,X:function(n){this.i();n===1&&this.R()},R:function(){var n=this,t=function(t,i){return _Ewa.dW.c(n.a.d().a(),n.d,!0,!0,n.b,t,i,null,null)},i=new _Ewa.I(1001,0,t,0,null);this.a.h().a(i,null)}};_Ewa.Qq=function(){};_Ewa.Qq.a=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.sheetRange=t,o.headerRow=i,_Ewa.i.a(n,"ToggleTableRow",o,r,u,f,0,null)};_Ewa.dW=function(){};_Ewa.dW.d=function(n,t,i,r,u,f,e,o,s,h,c){var l=n.a(41,c);return l.autoFilterOptions=t,l.items=i,l.dateItems=r,l.showBlanks=u,l.hideBlanks=f,l.noData=e,_Ewa.i.a(n,"ApplyItemFilter",l,o,s,h,0,null)};_Ewa.dW.c=function(n,t,i,r,u,f,e,o,s){var h=n.a(41,s);return h.tableRange=t,h.hasHeaders=i,h.convertHeader=r,h.hasTotalRow=u,_Ewa.i.a(n,"CreateTable",h,f,e,o,0,null)};_Ewa.dW.i=function(n,t,i,r,u,f){var e=n.a(41,f);return e.targetRange=t,_Ewa.i.a(n,"ResizeTable",e,i,r,u,0,null)};_Ewa.dW.e=function(n,t,i,r,u,f){var e=n.a(41,f);return e.convertToRangeInput=t,_Ewa.i.a(n,"ConvertToRange",e,i,r,u,0,null)};_Ewa.dW.f=function(n,t,i,r,u,f){var e=n.a(41,f);return e.convertToRangeInput=t,_Ewa.i.a(n,"ConvertToRangeForQueryTable",e,i,r,u,0,null)};_Ewa.dW.j=function(n,t,i,r,u,f,e){var o=n.a(41,e);return o.tableRange=t,o.optionType=i,_Ewa.i.a(n,"ToggleTableStyleOption",o,r,u,f,4,null)};_Ewa.dW.g=function(n,t,i,r,u,f){var e=n.a(1,f);return e.selectedRange=t,_Ewa.i.a(n,"IsRangeQueryTable",e,i,r,u,4,null)};_Ewa.dW.b=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.tableRanges=t,o.styleIndex=i,_Ewa.i.a(n,"ApplyTableStyle",o,r,u,f,4,null)};_Ewa.dW.a=function(n,t,i,r,u,f,e,o,s,h){var c=n.a(1,h);return c.tableRanges=t,c.hasHeaders=i,c.convertHeader=r,c.hasTotalRow=u,c.styleIndex=f,_Ewa.i.a(n,"FormatAsTable",c,e,o,s,0,null)};_Ewa.dW.h=function(n,t,i,r,u,f,e){var o=n.a(41,e);return o.newName=t,o.selectedRange=i,_Ewa.i.a(n,"RenameTable",o,r,u,f,4,null)};_Ewa.bfj.registerClass("_Ewa.bfj",_Ewa.Rc);_Ewa.yC.registerClass("_Ewa.yC",_Ewa.bfj);_Ewa.Qo.registerClass("_Ewa.Qo",_Ewa.bfj);_Ewa.nC.registerClass("_Ewa.nC",null,_Ewa.jP);_Ewa.yD.registerClass("_Ewa.yD",_Ewa.ba);_Ewa.Qp.registerClass("_Ewa.Qp",_Ewa.Ef);_Ewa.qr.a="<div class='WACDialogRow' id='block1'> <label id='label2' class='WACDialogLabel' for='resizeInput' >{0}<\/label> <\/div>";Type.registerNamespace("_Ewa");_Ewa.bfk=function(){};_Ewa.bfk.a=function(){_Ewa.j.a(_Ewa.yD.a)};_Ewa.bfk.a();Type.registerNamespace("_Ewa");_Ewa.cL=function(){};_Ewa.cL.d=function(n){var t=new Sys.StringBuilder(CommonUI.b.a(_Ewa.cL.c,_Ewa.ClientStringManager.a().a(1806)));return n.CellsWithDataInWorksheet>0&&!_Ewa.e.a(n.EndOfSheet)&&t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1809),n.EndOfSheet)),t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1808),n.CellsWithDataInWorksheet.toString())),t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1810),n.TablesInWorksheet.toString())),n.PivotTablesInWorksheet>0&&t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1811),n.PivotTablesInWorksheet.toString())),t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(988),n.FormulasInWorksheet.toString())),n.DataRangesInWorksheet>0&&t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1812),n.DataRangesInWorksheet.toString())),n.ChartsInWorksheet>0&&t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1813),n.ChartsInWorksheet.toString())),n.ImagesInWorksheet>0&&t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1814),n.ImagesInWorksheet.toString())),n.ObjectsInWorksheet>0&&t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().b(536),n.ObjectsInWorksheet.toString())),n.CommentsInWorksheet>0&&t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(911),n.CommentsInWorksheet.toString())),n.NotesInWorksheet>0&&t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1817),n.NotesInWorksheet.toString())),t.append(CommonUI.b.a(_Ewa.cL.b,_Ewa.ClientStringManager.a().a(1807))),t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1815),n.SheetsInWorkbook.toString())),t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1808),n.CellsWithDataInWorkbook.toString())),t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1810),n.TablesInWorkbook.toString())),n.PivotTablesInWorkbook>0&&t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1811),n.PivotTablesInWorkbook.toString())),t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(988),n.FormulasInWorkbook.toString())),n.ChartsInWorkbook>0&&t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1813),n.ChartsInWorkbook.toString())),n.ExternalConnectionsInWorkbook>0&&t.append(CommonUI.b.a(_Ewa.cL.a,_Ewa.ClientStringManager.a().a(1816),n.ExternalConnectionsInWorkbook.toString())),t.toString()};_Ewa.bfS=function(){};_Ewa.bfS.a=function(){_Ewa.j.a(_Ewa.zc.a)};_Ewa.Rp=function(n){this.b=Function.createDelegate(this,this.d);this.c=Function.createDelegate(this,this.e);this.a=n};_Ewa.Rp.prototype={a:null,z:function(){return!1},w:function(n,t){var r=!1;switch(t.a){case 2070214365:Diag.a.a(594896395,0,50,"WorkbookStatisticsCommandHandler - Send RetrieveWorkbookStatistics call");var i=this,u=function(n,t){return _Ewa.Rr.a(i.a.d().a(),i.a.c().q().c(),_Ewa.o.a(n,i.c),_Ewa.o.b(t,i.b),null,null)},f=this;_Ewa.S.a(this.a.h(),u,function(n){return new _Ewa.I(227,0,n,16,null)},null);r=!0}return r?$$sc.a.a(Boolean,!0):_Ewa.J.a(t.a)},v:function(n,t){return t.a===2070214365},y:function(){return!1},e:function(n,t,i){var r,u;_Ewa.h.e(n.Errors)?this.d(null,t,i):(r=n.Result,Diag.a.a(594896394,0,50,"WorkbookStatisticsCommandHandler.OnRetrieveWorkbookStatisticsSuccess"),u=new _Ewa.Rq(this.a),u.d(r))},d:function(){Diag.a.a(594896393,0,50,"WorkbookStatisticsCommandHandler.OnRetrieveWorkbookStatisticsFailed")}};_Ewa.zc=function(n){_Ewa.zc.initializeBase(this,[n])};_Ewa.zc.a=function(n){_Ewa.ba.a(354,new _Ewa.zc(n))};_Ewa.zc.prototype={m:function(){this.k([new _Ewa.Rp(this.h)],null)}};_Ewa.Rq=function(n){this.b=Function.createDelegate(this,this.e);_Ewa.Rq.initializeBase(this,[n,null]);this.s=!1;Diag.a.a(51401282,0,50,"WorkbookStatisticsDialog.WorkbookStatisticsDialog")};_Ewa.Rq.prototype={e:function(){this.i()},d:function(n){Diag.a.a(51401283,0,50,"WorkbookStatisticsDialog.InitAndShow");this.p=_Ewa.cL.d(n);this.h(0);this.j(_Ewa.ClientStringManager.a().a(1805),this.b,null);Diag.a.a(51401284,0,50,"WorkbookStatisticsDialog.InitAndShow completed.")}};_Ewa.Rr=function(){};_Ewa.Rr.a=function(n,t,i,r,u,f){var e=n.a(1,f);return e.sheetName=t,_Ewa.i.a(n,"RetrieveWorkbookStatistics",e,i,r,u,0,null)};_Ewa.Rp.registerClass("_Ewa.Rp",null,_Ewa.jP);_Ewa.zc.registerClass("_Ewa.zc",_Ewa.ba);_Ewa.Rq.registerClass("_Ewa.Rq",_Ewa.Ef);_Ewa.cL.c="<div class='WACDialogSectionTitle'>{0}<\/div> <table id='WorksheetStatisticsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'>";_Ewa.cL.b="<\/table> <div class='WACDialogSectionTitle'>{0}<\/div> <table id='WorkbookStatisticsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'>";_Ewa.cL.a="<tr role='presentation'> <td> <span id='WorkbookStatisticsEntryLabel' class='WACDialogSpan'>{0}<\/span> <\/td> <td style='text-align:right'> <span id='WorkbookStatisticsEntryCount' class='WACDialogSpan'>{1}<\/span> <\/td> <\/tr>";_Ewa.bfS.a();Type.registerNamespace("_Ewa");_Ewa.UO=function(){};_Ewa.UO.a=function(){_Ewa.j.a(_Ewa.rb.a)};_Ewa.rb=function(n){_Ewa.rb.initializeBase(this);this.h=n;this.j()};_Ewa.rb.a=function(n){n.b().b(_Ewa.bbq.$$(_Ewa.gg),157,new _Ewa.rb(n))};_Ewa.rb.prototype={h:null,b:function(){this.i(this.h.b().a(_Ewa.gg,15,!1)||new _Ewa.Ah(this.h))}};_Ewa.Ah=function(n){var t,i;this.p=["CCB","NK","HUI","TM","RM","BB","FB","GHC","BE","TPP","SCP","GK","CVK","FOK","STB","CUF","SB","BM"];this.q=["HUI","VHP","VHH"];_Ewa.Ah.initializeBase(this,[document.body,n]);t=_Ewa.ClientStringManager.a().b(207);this.k=this.d.L().f(t);this.b(0);n.b().b(_Ewa.gg,15,this);i=this;_Ewa.f.c(_Ewa.l.b(Common.S,n.b(),21,137,-2),function(n){var t=n.a();t.c("App_AccessibilityLoopComplete");t.b("App_AccessibilityLoopComplete",i.m)},n.i())};_Ewa.Ah.prototype={k:null,f:0,i:function(){return this.f},b:function(n){this.f=n;switch(n){case 0:this.o(this.p);break;case 2:this.o(this.q);break;default:Diag.a.b(41980873,0,!0,"Accessibility Mode value is not in allowed values")}return n},a:function(n){this.d.r()&65536&&_Ewa.Ao.prototype.a.call(this,n)},n:function(n){if(_Ewa.e.b(this.k,this.d.L().e(n,0),!1)){var t=_Ewa.bY.b(this.d);t&&t.bt()&&(_Ewa.D.a(n,!0),t.x(!0,!1))}}};_Ewa.rb.registerClass("_Ewa.rb",_Ewa.qc.$$(_Ewa.gg));_Ewa.Ah.registerClass("_Ewa.Ah",_Ewa.Ao);_Ewa.UO.a();Type.registerNamespace("_Ewa");_Ewa.rf=function(n){_Ewa.rf.initializeBase(this);this.h=n;this.j()};_Ewa.rf.a=function(n){n.b().b(_Ewa.bbq.$$(Sys.IDisposable),39,new _Ewa.rf(n))};_Ewa.rf.prototype={h:null,b:function(){Common.a.s("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");Common.a.a.a("RefreshAccessTokenSilently")?this.i(this.k()):this.i(this.h.b().a(Sys.IDisposable,38,!1)||new _Ewa.Aq(this.h))},k:function(){var n=this.h.b().a(Sys.IDisposable,38,!1),t;return n?n:(t=new Common.App.SessionExpiration.g(Common.a.i(),Common.a.G(),new Common.App.SessionExpiration.h,null),new _Ewa.Ar(this.h,t))}};_Ewa.Aq=function(n){this.l=new _Ewa.cq(!1);_Ewa.Aq.initializeBase(this);this.k=n;this.k.b().b(_Ewa.nS,38,this)};_Ewa.Aq.prototype={k:null,g:function(n){this.l.dE("SessionExpired",n)},e:function(n){this.l.dE("TokenRefreshed",n)},h:function(n){this.l.dF("TokenRefreshed",n)},B:function(){var n=new Date(this.m),t=n.format(this.k.e().ShortTimeFormat);return String.format(_Ewa.ClientStringManager.a().c(71),t)},s:!1,i:function(){return this.s},r:!1,b:function(){return this.r},j:function(n){return this.r=n,n},d:function(){return!1},a:function(){return!1},f:function(){return!1},c:function(){return!1},dispose:function(){System.a.a(this.l);this.k=null},u:function(){this.k.k()&&this.v(!1)},t:function(){this.s=!0;this.v(!0);this.l.dC("SessionExpired",null,null)},v:function(n){var t;Diag.a.a(19981001,0,15,"EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired {0}, GotDeploymentOrTimedOutError {1}",n,this.k.y().bd());t=this.k.p().Q();n&&t&&t.g()&&t.b().MessageId===1299163859&&this.k.p().Q().d();var r=this.z(n),i=this,u=function(){var t=_Ewa.Q.a(i.k),n=t.a().a();n.NPAnu=i.k.bA(i.k.k(),!0);n.NPAnum="ntw";n.PUOAudna="cw50";t.a().d([r])};_Ewa.L.a(this.k).a(new _Ewa.cw("cw8",5,u))},z:function(n){return n?_Ewa.h.C():this.A()},A:function(){var n=_Ewa.h.b(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");return n.Description=this.B(),n}};_Ewa.Ar=function(n,t){var i,r;this.w=Function.createDelegate(this,this.G);this.x=Function.createDelegate(this,this.H);this.u=Function.createDelegate(this,this.C);this.v=Function.createDelegate(this,this.F);this.n=new _Ewa.cq(!1);this.k=n;this.s=t;this.r=n.o().b("WebServiceCall","refreshToken");Common.be.a().j(this.v);Common.be.a().i(this.u);i=this.k.c();i.g(this.x);i.bj(this.w);r=new Date;Diag.a.a(39929153,217,50,"Initializing EwaAccessTokenExpirationRefreshManager. {0}",{AccessTokenTtl:Common.a.p,NowGetTime:r.getTime(),BootTime:Common.a.I,WopiTokenExpiresAfterMinutes:Common.a.bL,WopiTokenTaskItemPriority:Common.a.bM});this.k.b().b(_Ewa.nS,38,this)};_Ewa.Ar.prototype={k:null,s:null,q:!1,p:!1,r:null,g:function(n){this.n.dE("SessionExpired",n)},e:function(n){this.n.dE("TokenRefreshed",n)},h:function(n){this.n.dF("TokenRefreshed",n)},y:!1,i:function(){return this.y},m:!1,b:function(){return this.m},j:function(n){return this.m=n,n},t:!1,a:function(){return this.t},o:!1,c:function(){return this.o},l:null,d:function(){return this.o?!1:this.k.c().k().a()?_Ewa.cJ.a<1:_Ewa.cJ.b<6},f:function(){return this.q},dispose:function(){Common.be.a().m(this.v);Common.be.a().l(this.u);var n=this.k.c();n&&(n.h(this.x),n.bn(this.w));System.a.a(this.n);this.k=null},B:function(n){if(!this.l||this.l.b||this.l.d!==n){var t=new _Ewa.As(Common.A.a().a,n);return this.l&&!this.l.c&&Diag.a.a(594596952,0,15,"TokenManager.InitContext: creating new context [{0}] although previeous one [{1}] not used successfully, isPreviousOneRefreshedSuccessfully [{2}] ",t.a,this.l.a,this.l.b),this.l=t,!0}return!1},C:function(){this.A(!1)},H:function(n,t){var i,r;t.b&&this.l&&this.l.b&&!this.l.c&&(this.l.c=!0,i={},i.Name="EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect",i.IsUserActive=this.k.c().k().a(),i.RefreshAccessTokenCorrelationID=this.l.a,r=_Ewa.F.a(i),Diag.a.a(594596951,0,50,r))},G:function(){var n,t;this.l&&this.l.b&&!this.l.c&&(n={},n.Name="EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed",n.CreatedForExpired=this.l.d,n.RefreshAccessTokenCorrelationID=this.l.a,n.OpenWorkbookErrors=_Ewa.h.a(this.k.c().s(),","),n.ExecutionContextErrors=_Ewa.h.a(_Ewa.Q.a(this.k).a().c(),","),n.accesstokenTTL=Common.a.p,t=_Ewa.F.a(n),Diag.a.a(594596950,0,15,t))},F:function(){this.p=!1;this.A(!0)},I:function(n){n&&this.m&&!this.t&&this.k.c().k().a()&&!this.o&&(this.m=!1)},A:function(n){var e,r,i;if(this.I(n),!this.q&&(!this.p||n)&&!this.m&&this.d()){this.q=!0;var u=this.l?this.l.e:null,f=this.B(n),t={};t.Name="EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh";t.newContextCreated=f;t.IsUserActive=this.k.c().k().a();t.ContainsChangesWorkbookOperations=this.k.h().g();t.isSessionExpired=n;t.stopRefreshRetriesUntilTokenExpired=this.p;t.FailedToRefreshExpiredToken=this.m;t.numOfFailuresWhileUserIsActive=_Ewa.cJ.a;t.numOfFailuresWhileUserIsInActive=_Ewa.cJ.b;t.RefreshAccessTokenCorrelationID=this.l.a;f&&u&&(t.TimeInMinFromPreviosContextCreation=Math.round(_Ewa.cb.b(_Ewa.v.a(),u)/60));e=_Ewa.F.a(t);Diag.a.a(40416199,0,50,e);this.r.d();this.t=this.k.c().k().a();r=this.s.c(!n);i=this;r.CW(function(){var t=i.s.b(r);i.r.a();t?(i.p=!1,i.E(r.a().b(),n)):i.D(r.a().a(),n);i.q=!1})}},D:function(n,t){var r,f;this.p=!0;t&&(this.m||(this.m=!0,this.y=!0),this.s.a(n)&&(this.o=!0));var u=t&&!this.d(),e=u?39982555:40380379,i=this.z(t);i.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";i.FailedToRefreshExpiredToken=this.m;i.LastErrorIsPermanent=this.o;n.e.length>0&&(r=n.a(0),i.errorName=r.Name,r.Errors.length>0&&(i.ErrorId=r.Errors[0].Id,i.ErrorDetails=r.Errors[0].Details));f=_Ewa.F.a(i);Diag.a.a(e,0,u?15:50,f);this.n.dC("TokenRefreshed",new Common.App.SessionExpiration.b(null,n),null)},z:function(n){var t={};return t.Name="",t.IsUserActive=this.k.c().k().a(),t.GotDeploymentOrTimedOutError=this.k.y().bd(),t.TimeInSecFromLastStatefulSuccessfulRequest=this.k.y().bg(),t.TimeFromLastUserActivityInMs=this.k.c().k().b(),t.calledFromSessionExpiredFlow=n,t.RefreshTokenDurationInMS=this.r.b(),t.numOfFailuresWhileUserIsActive=_Ewa.cJ.a,t.numOfFailuresWhileUserIsInActive=_Ewa.cJ.b,t.RefreshAccessTokenCorrelationID=this.l.a,t.accessTokenTTL=Common.a.p,t.ContainsChangesWorkbookOperations=this.k.h().g(),t},E:function(n,t){var e,r;this.m=!1;this.J();var u=!t&&this.k.c().k().a(),f=!this.k.k()&&this.k.c().U(),i=this.z(t);return(i.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess",i.shouldTriggerSilentReloadAfterExpiring=u,i.WopiTokenTaskItemPriority=Common.a.bM,i.isDirtyViewSession=f,e=_Ewa.F.a(i),Diag.a.a(39982556,0,15,e),this.n.dC("TokenRefreshed",new Common.App.SessionExpiration.b(n,null),null),f)?(this.k.c().k().a()&&(Diag.a.a(594596949,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),this.k.c().bb()),!0):(this.k.c().k().a()?u&&(r=_Ewa.Q.a(this.k).a().a(),r.RATAtsratr=!0,r.CWMfsc=!0,r.OWMem=this.k.k(),_Ewa.L.a(this.k).a(new _Ewa.cw("cw4",2,null))):_Ewa.i.i(this.k.d().a(),!0,!1,null,null,null,null),!0)},J:function(){isNullOrUndefined(this.k.y().f().WorkbookUri)?Diag.a.a(594596948,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null"):(this.k.y().f().WorkbookUri=Common.k.d(this.k.y().f().WorkbookUri,Common.a.u,Common.a.D,!1),this.k.y().f().WorkbookUri=Common.k.d(this.k.y().f().WorkbookUri,"access_token_ttl",Common.a.p.toString(),!1),this.k.c().Z());this.k.e().AccessToken=Common.a.D;this.k.e().AccessTokenValidTo=Common.a.p;isNullOrUndefined(this.k.e().DocumentHostInfo.QuerySignatureWithoutVersion)||(this.k.e().DocumentHostInfo.QuerySignatureWithoutVersion=Common.k.d(this.k.e().DocumentHostInfo.QuerySignatureWithoutVersion,Common.a.u,Common.a.D,!1),this.k.e().DocumentHostInfo.QuerySignatureWithoutVersion=Common.k.d(this.k.e().DocumentHostInfo.QuerySignatureWithoutVersion,"access_token_ttl",Common.a.p.toString(),!1));isNullOrUndefined(this.k.e().EmbedConfiguratorUrl)||(this.k.e().EmbedConfiguratorUrl=Common.k.d(this.k.e().EmbedConfiguratorUrl,Common.a.u,Common.a.D,!1),this.k.e().EmbedConfiguratorUrl=Common.k.d(this.k.e().EmbedConfiguratorUrl,"access_token_ttl",Common.a.p.toString(),!1));this.l.b=!0}};_Ewa.rf.registerClass("_Ewa.rf",_Ewa.qc.$$(Sys.IDisposable));_Ewa.Aq.registerClass("_Ewa.Aq",Common.App.SessionExpiration.i,_Ewa.nS,Common.hb,Sys.IDisposable);_Ewa.Ar.registerClass("_Ewa.Ar",null,_Ewa.nS,Common.hb,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.UT=function(){};_Ewa.UT.a=function(){_Ewa.j.a(_Ewa.rf.a)};_Ewa.UT.a();var WacAnimation={},WacCurveType={Instant:0,Hold:1,Linear:2,CubicBezier:3},WacCurveID={Instant:0,Hold:1,Linear:2,ShotgunToPillowLanding:3,ReverseShotgunToPillowLanding:4,ShotgunToLinear:5,EaseIn:6,EaseOut:7,EaseInOut:8,Exponential:9,ShotgunToPillowLanding_VisualRefresh:10,Cxe_ShowHintBar:11,Cxe_HideHintBar:12,Cxe_ColorWheel:13,Cxe_SpinnerDot1:14,Cxe_SpinnerDot2:15,Cxe_SpinnerDot4:16,Cxe_SpinnerDot5:17,Cxe_SpinnerDot7:18,InOutSine:19,PresenceUI_Standard:20},g_AnimationCurves=new Array(21),g_numAnimationAttributes,AnimRelativeTo,WacKeyframeType,g_AnimationContextVariables,g_WacAnimations,g_WacRadix,g_WacAnimationTelemetry,g_LastAnimationData;g_AnimationCurves[WacCurveID.Instant]=new WacCurve(WacCurveID.Instant,WacCurveType.Instant,0,0,0,0);g_AnimationCurves[WacCurveID.Hold]=new WacCurve(WacCurveID.Hold,WacCurveType.Hold,0,0,0,0);g_AnimationCurves[WacCurveID.Linear]=new WacCurve(WacCurveID.Linear,WacCurveType.Linear,0,0,0,0);g_AnimationCurves[WacCurveID.ShotgunToPillowLanding]=new WacCurve(WacCurveID.ShotgunToPillowLanding,WacCurveType.CubicBezier,0,0,0,1);g_AnimationCurves[WacCurveID.ReverseShotgunToPillowLanding]=new WacCurve(WacCurveID.ReverseShotgunToPillowLanding,WacCurveType.CubicBezier,1,0,1,1);g_AnimationCurves[WacCurveID.ShotgunToLinear]=new WacCurve(WacCurveID.ShotgunToLinear,WacCurveType.CubicBezier,0,0,.42,1);g_AnimationCurves[WacCurveID.EaseIn]=new WacCurve(WacCurveID.EaseIn,WacCurveType.CubicBezier,.83,0,1,1);g_AnimationCurves[WacCurveID.EaseOut]=new WacCurve(WacCurveID.EaseOut,WacCurveType.CubicBezier,0,0,.58,1);g_AnimationCurves[WacCurveID.EaseInOut]=new WacCurve(WacCurveID.EaseInOut,WacCurveType.CubicBezier,.42,0,.58,1);g_AnimationCurves[WacCurveID.Exponential]=new WacCurve(WacCurveID.Exponential,WacCurveType.CubicBezier,.1,.25,.75,.9);g_AnimationCurves[WacCurveID.ShotgunToPillowLanding_VisualRefresh]=new WacCurve(WacCurveID.ShotgunToPillowLanding_VisualRefresh,WacCurveType.CubicBezier,.1,.9,.2,1);g_AnimationCurves[WacCurveID.Cxe_ShowHintBar]=new WacCurve(WacCurveID.Cxe_ShowHintBar,WacCurveType.CubicBezier,.1,.9,.2,1);g_AnimationCurves[WacCurveID.Cxe_HideHintBar]=new WacCurve(WacCurveID.Cxe_HideHintBar,WacCurveType.CubicBezier,.9,.1,.2,1);g_AnimationCurves[WacCurveID.Cxe_ColorWheel]=new WacCurve(WacCurveID.Cxe_ColorWheel,WacCurveType.CubicBezier,.4,0,0,1);g_AnimationCurves[WacCurveID.Cxe_SpinnerDot1]=new WacCurve(WacCurveID.Cxe_SpinnerDot1,WacCurveType.CubicBezier,.13,.21,.1,.7);g_AnimationCurves[WacCurveID.Cxe_SpinnerDot2]=new WacCurve(WacCurveID.Cxe_SpinnerDot2,WacCurveType.CubicBezier,.02,.33,.38,.77);g_AnimationCurves[WacCurveID.Cxe_SpinnerDot4]=new WacCurve(WacCurveID.Cxe_SpinnerDot4,WacCurveType.CubicBezier,.57,.17,.95,.75);g_AnimationCurves[WacCurveID.Cxe_SpinnerDot5]=new WacCurve(WacCurveID.Cxe_SpinnerDot5,WacCurveType.CubicBezier,0,.19,.07,.72);g_AnimationCurves[WacCurveID.Cxe_SpinnerDot7]=new WacCurve(WacCurveID.Cxe_SpinnerDot7,WacCurveType.CubicBezier,0,0,.95,.37);g_AnimationCurves[WacCurveID.InOutSine]=new WacCurve(WacCurveID.InOutSine,WacCurveType.CubicBezier,.66,0,.34,1);g_AnimationCurves[WacCurveID.PresenceUI_Standard]=new WacCurve(WacCurveID.PresenceUI_Standard,WacCurveType.CubicBezier,.8,0,.2,1);WacKeyFrame.prototype={type:0,curveID:0,startTime:new WacIntWrapper(0,null),endTime:new WacIntWrapper(0,null),startValue:new WacIntWrapper(0,null),endValue:new WacIntWrapper(0,null),relativeTo:0,operationType:0};g_numAnimationAttributes=8;WacAnimation.Attribute={PositionX:1,PositionY:2,Height:3,Width:4,Opacity:5,ScrollTop:6,ScrollLeft:7,RotateZ:8};AnimRelativeTo={Initial:0,Final:1,Absolute:2};WacKeyframeType={Mult:0,Add:1};WacAnimation.ContextID={};g_AnimationContextVariables=new Array(0);WacAnimation.ContextVariableManager=WacAnimation_ContextVariableManager;WacAnimation_ContextVariableManager.prototype={};WacAnimation_ContextVariableManager.prototype.SetContextVariable=function(n,t){var i=WacAnimation.ContextID[n];g_AnimationContextVariables[i].value=t};WacAnimation.ID={BASIC_INSTANTFADE:0,BASIC_QUICKESTSHOW:1,BASIC_QUICKMOVE:2,BASIC_QUICKSIZE:3,BASIC_QUICKSHOW:4,BASIC_QUICKHIDE:5,BASIC_QUICKERMOVE:6,BASIC_QUICKERSIZE:7,BASIC_QUICKERFADE:8,BASIC_QUICKERSHOW:9,BASIC_QUICKERHIDE:10,BASIC_MOVE:11,BASIC_SIZE:12,BASIC_FADE:13,BASIC_SHOW:14,BASIC_HIDE:15,BASIC_SCROLL:16,BASIC_SLOWMOVE:17,BASIC_SLOWSIZE:18,BASIC_SLOWFADE:19,BASIC_SLOWSHOW:20,BASIC_SLOWERSCROLL:21,ONENOTEBASIC_MOVE:22,ONENOTEBASIC_SIZE:23,ONENOTEBASIC_FADE:24,ONENOTEBASIC_SHOW:25,ONENOTEBASIC_HIDE:26,SHARED_QUICKHIDE:27,TAB_MOVE:28,TAB_SLIDEINFADEINBOTTOM:29,TAB_SLIDEINBOTTOMVISUALREFRESH:30,TAB_SLIDEOUTBOTTOMVISUALREFRESH:31,SHARED_INSERTSHOW:32,BASIC_MOVEVISUALREFRESH:33,BASIC_SIZEVISUALREFRESH:34,MSOHELP_FOLLOWTHEDOTMOVE:35,DELAY_SHOW:36,DELAY_MOVE:37,WAC_RIBBONMOVE:38,WAC_RIBBONSHOW:39,WAC_RIBBONHIDE:40};g_WacAnimations=new Array(41);g_WacAnimations[WacAnimation.ID.BASIC_INSTANTFADE]=new WacAnim(WacAnimation.ID.BASIC_INSTANTFADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Instant,0,0,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKESTSHOW]=new WacAnim(WacAnimation.ID.BASIC_QUICKESTSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,50,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKMOVE]=new WacAnim(WacAnimation.ID.BASIC_QUICKMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKSIZE]=new WacAnim(WacAnimation.ID.BASIC_QUICKSIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKSHOW]=new WacAnim(WacAnimation.ID.BASIC_QUICKSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,167,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKHIDE]=new WacAnim(WacAnimation.ID.BASIC_QUICKHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKERMOVE]=new WacAnim(WacAnimation.ID.BASIC_QUICKERMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKERSIZE]=new WacAnim(WacAnimation.ID.BASIC_QUICKERSIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKERFADE]=new WacAnim(WacAnimation.ID.BASIC_QUICKERFADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKERSHOW]=new WacAnim(WacAnimation.ID.BASIC_QUICKERSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKERHIDE]=new WacAnim(WacAnimation.ID.BASIC_QUICKERHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_MOVE]=new WacAnim(WacAnimation.ID.BASIC_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SIZE]=new WacAnim(WacAnimation.ID.BASIC_SIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_FADE]=new WacAnim(WacAnimation.ID.BASIC_FADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_SHOW]=new WacAnim(WacAnimation.ID.BASIC_SHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_HIDE]=new WacAnim(WacAnimation.ID.BASIC_HIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_SCROLL]=new WacAnim(WacAnimation.ID.BASIC_SCROLL,[new WacKeyFrame(WacAnimation.Attribute.ScrollTop,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.ScrollLeft,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWMOVE]=new WacAnim(WacAnimation.ID.BASIC_SLOWMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWSIZE]=new WacAnim(WacAnimation.ID.BASIC_SLOWSIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWFADE]=new WacAnim(WacAnimation.ID.BASIC_SLOWFADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,750,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWSHOW]=new WacAnim(WacAnimation.ID.BASIC_SLOWSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,750,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWERSCROLL]=new WacAnim(WacAnimation.ID.BASIC_SLOWERSCROLL,[new WacKeyFrame(WacAnimation.Attribute.ScrollTop,WacCurveID.ShotgunToPillowLanding,0,1e3,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.ScrollLeft,WacCurveID.ShotgunToPillowLanding,0,1e3,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_MOVE]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_SIZE]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_SIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_FADE]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_FADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,367,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_SHOW]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_SHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,367,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_HIDE]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_HIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.SHARED_QUICKHIDE]=new WacAnim(WacAnimation.ID.SHARED_QUICKHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,50,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.TAB_MOVE]=new WacAnim(WacAnimation.ID.TAB_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,433,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,433,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.TAB_SLIDEINFADEINBOTTOM]=new WacAnim(WacAnimation.ID.TAB_SLIDEINFADEINBOTTOM,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,50,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,0,null,40,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.TAB_SLIDEINBOTTOMVISUALREFRESH]=new WacAnim(WacAnimation.ID.TAB_SLIDEINBOTTOMVISUALREFRESH,[new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Instant,0,0,null,32,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Instant,0,100,null,32,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,101,350,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.Instant,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.Instant,0,100,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,101,350,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Instant,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Instant,0,100,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.TAB_SLIDEOUTBOTTOMVISUALREFRESH]=new WacAnim(WacAnimation.ID.TAB_SLIDEOUTBOTTOMVISUALREFRESH,[new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,267,null,32,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,1,AnimRelativeTo.Initial,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.SHARED_INSERTSHOW]=new WacAnim(WacAnimation.ID.SHARED_INSERTSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,101,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_MOVEVISUALREFRESH]=new WacAnim(WacAnimation.ID.BASIC_MOVEVISUALREFRESH,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding_VisualRefresh,0,300,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding_VisualRefresh,0,300,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SIZEVISUALREFRESH]=new WacAnim(WacAnimation.ID.BASIC_SIZEVISUALREFRESH,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding_VisualRefresh,0,300,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding_VisualRefresh,0,300,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.MSOHELP_FOLLOWTHEDOTMOVE]=new WacAnim(WacAnimation.ID.MSOHELP_FOLLOWTHEDOTMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.EaseInOut,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.EaseInOut,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.DELAY_SHOW]=new WacAnim(WacAnimation.ID.DELAY_SHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,200,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.ShotgunToPillowLanding,201,500,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.DELAY_MOVE]=new WacAnim(WacAnimation.ID.DELAY_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.Linear,0,200,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Linear,0,200,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,201,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,201,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.WAC_RIBBONMOVE]=new WacAnim(WacAnimation.ID.WAC_RIBBONMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.WAC_RIBBONSHOW]=new WacAnim(WacAnimation.ID.WAC_RIBBONSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.WAC_RIBBONHIDE]=new WacAnim(WacAnimation.ID.WAC_RIBBONHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);var g_WacAnimationEngine=null,g_WacAnimationLogging=window.location.search.indexOf("AnimationLogging=1")!=-1,g_WacAnimationThrottleFPS=0,g_WacAnimationThrottleNumInstance=3;window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){window.setTimeout(n,16)}}();WacAnimation.State=WacAnimation_State;WacAnimation.Object=WacAnimation_Object;WacAnimationEngine.prototype={AnimationQueue:new Array(0),sharedTimer:null,sharedCancelTimer:null,resetInterval:5e3,sharedTimerRefs:0,conflictTable:new Array(0),currentAnimationIndex:-1,temporaryIDGenerator:0};WacAnimationEngine.prototype.LocalStepper=function(){g_WacAnimationEngine.StepAllAnimations()};WacAnimationEngine.prototype.LocalStopper=function(){g_WacAnimationEngine.StepAllAnimations();g_WacAnimationEngine.StopEngine()};WacAnimationEngine.prototype.StartEngine=function(){this.sharedTimer==null&&this.sharedCancelTimer==null&&this.sharedTimerRefs==0&&(this.sharedTimer=window.requestAnimationFrame(WacAnimationEngine.prototype.LocalStepper),g_WacAnimationEngine.StartCancelTimer(),this.sharedTimerRefs=0,g_WacAnimationTelemetry.Start())};WacAnimationEngine.prototype.StopEngine=function(){g_WacAnimationTelemetry.Stop();g_WacAnimationEngine.StopCancelTimer();this.sharedTimer!=null&&(this.sharedTimer=null);this.sharedTimerRefs=0;this.conflictTable=new Array(0);this.AnimationQueue=new Array(0)};WacAnimationEngine.prototype.StartAnimation=function(n){this.AnimationQueue[this.sharedTimerRefs++]=n};WacAnimationEngine.prototype.StopAnimation=function(n){for(var t=0;t<this.AnimationQueue.length;t++)this.AnimationQueue[t]==n&&(this.RemoveTemporaryIds(n),this.AnimationQueue[t]=null)};WacAnimationEngine.prototype.StepAllAnimations=function(){var i=!1,t=null,n;for(g_WacAnimationEngine.StopCancelTimer(),n=0;n<this.AnimationQueue.length;n++)this.AnimationQueue[n]!=null&&(IsNullOrUndef(t)&&(t=this.AnimationQueue[n].currentTime),this.currentAnimationIndex=n,this.AnimationQueue[n].StepAnimation(),i=!0);this.currentAnimationIndex=-1;i&&!IsNullOrUndef(t)&&g_WacAnimationTelemetry.AddPerfData(new Date-t);i?(g_WacAnimationEngine.StartCancelTimer(),window.requestAnimationFrame(WacAnimationEngine.prototype.LocalStepper)):this.StopEngine()};WacAnimationEngine.prototype.CheckForConflictingAnimations=function(n,t){var e,f,r,i;if((n.id==null||n.id=="")&&(e="tempAnimID_"+String(this.temporaryIDGenerator),this.temporaryIDGenerator++,n.id=e),f=n.id+"_"+String(t),r=this.conflictTable[f],IsNullOrUndef(r)||r==this.currentAnimationIndex||this.AnimationQueue[r]==null)this.conflictTable[f]=this.currentAnimationIndex;else if(i=this.AnimationQueue[r],i.curveID.SetAttribute(t,null),i.finishFunc!=null){var u=this.AnimationQueue[this.currentAnimationIndex],o=i.finishFunc,s=i.extraData,h=u.finishFunc,c=u.extraData;u.finishFunc=h==null?function(){o(s)}:function(){o(s);h(c)};u.extraData=null;i.finishFunc=null}};WacAnimationEngine.prototype.RemoveTemporaryIds=function(n){var t,r,i;if(IsArrayCheck(n.element))for(r=n.element.length,i=0;i<r;i++)t=n.element[i],t.id.indexOf("tempAnimID_")==0&&t.id==null;else t=n.element,t.id.indexOf("tempAnimID_")==0&&t.id==null};WacAnimationEngine.prototype.StopCancelTimer=function(){this.sharedCancelTimer!=null&&(window.clearTimeout(this.sharedCancelTimer),this.sharedCancelTimer=null)};WacAnimationEngine.prototype.StartCancelTimer=function(){this.sharedCancelTimer=window.setTimeout(WacAnimationEngine.prototype.LocalStopper,this.resetInterval)};g_WacRadix=10;WacAnimation_State.prototype={Index:0,Data:new Array(0),AnimateRight:!1};WacAnimation_State.prototype.SetAttribute=function(n,t){var r=this.GetDataIndex(n),i;r==-1?(i=this.Data.length,this.Index+=n*Math.pow(g_WacRadix,i),this.Data[i]=t):this.Data[r]=t};WacAnimation_State.prototype.GetAttribute=function(n){var t=this.GetDataIndex(n);return t==-1?null:this.Data[t]};WacAnimation_State.prototype.GetDataIndex=function(n){for(var i=0,t=this.Index,r;t!=0;){if(r=t%g_WacRadix,r==n)return i;t=Math.floor(t/g_WacRadix);i++}return-1};WacAnimation_State.prototype.SetAnimateRight=function(n){this.AnimateRight=n};WacAnimation_Object.prototype={animationID:-1,delay:0,element:null,finalState:null,finishFunc:null,extraData:null,arrAnimationUnits:null,idxAnimUnit:0,cachedContextVariables:null};WacAnimation_Object.prototype.Initialize=function(n,t,i,r,u,f){this.animationID=n;this.delay=t;this.element=i;this.finalState=r;this.finishFunc=u;this.extraData=f;this.arrAnimationUnits=new Array(0);this.idxAnimUnit=0;this.cachedContextVariables=g_AnimationContextVariables};WacAnimation_Object.prototype.GetIntWrapperValue=function(n){return n.contextId==null?n.value:this.cachedContextVariables[n.contextId].value};WacAnimation_Object.prototype.RunAnimation=function(){var t,n;if(this.animationID!=-1&&this.element!=null)for(this.GenerateAnimationUnits(),t=this.arrAnimationUnits.length,n=0;n<t;n++)this.arrAnimationUnits[n].StartAnimation()};WacAnimation_Object.prototype.AdvanceToFinalState=function(n,t){for(var r,o,u,i,f,s,h=new WacAnimation_State,c=t.keyFrames.length,e=0;e<c;e++)r=t.keyFrames[e],h.SetAttribute(r.type,this.GetFinalValue(r,n));for(o=g_numAnimationAttributes,u=IsArrayCheck(this.element)?this.element[n]:this.element,i=1;i<=o;i++)f=h.GetAttribute(i),f!=null&&(s=new WacAnimationUnit(u,0,0,null,null,this.finalState.AnimateRight),s.SetStyle(i,u,f))};WacAnimation_Object.prototype.GenerateAnimationUnits=function(){for(var n,u,i,e,t,s=g_WacAnimations[this.animationID],f=null,h=s.keyFrames.length,r=null,o=0;o<h;o++)if(n=s.keyFrames[o],u=this.FindMatchingAnimationUnit(n),u!=null)if(u.startValue.SetAttribute(n.type,this.GetIntWrapperValue(n.startValue)),u.curveID.SetAttribute(n.type,n.curveID),IsArrayCheck(this.element))for(e=this.element.length,i=0;i<e;i++)if(r=this.GetFinalValue(n,i),IsNullOrUndef(r)){u.curveID.SetAttribute(n.type,null);break}else u.targetValue[i].SetAttribute(n.type,r);else r=this.GetFinalValue(n,-1),IsNullOrUndef(r)?u.curveID.SetAttribute(n.type,null):u.targetValue.SetAttribute(n.type,r);else{if(t=new WacAnimationUnit(this.element,this.GetIntWrapperValue(n.startTime)+this.delay,this.GetIntWrapperValue(n.endTime)-this.GetIntWrapperValue(n.startTime),null,null,this.finalState.AnimateRight),t.startValue.SetAttribute(n.type,this.GetIntWrapperValue(n.startValue)),t.curveID.SetAttribute(n.type,n.curveID),IsArrayCheck(this.element))for(e=this.element.length,i=0;i<e;i++)if(t.targetValue==null&&(t.targetValue=new Array(this.element.length)),t.targetValue[i]==null&&(t.targetValue[i]=new WacAnimation_State),r=this.GetFinalValue(n,i),IsNullOrUndef(r)){t.curveID.SetAttribute(n.type,null);break}else t.targetValue[i].SetAttribute(n.type,r);else t.targetValue==null&&(t.targetValue=new WacAnimation_State),r=this.GetFinalValue(n,-1),IsNullOrUndef(r)?t.curveID.SetAttribute(n.type,null):t.targetValue.SetAttribute(n.type,r);(f==null||f.delay+f.duration<=t.delay+t.duration)&&(f=t);this.arrAnimationUnits[this.idxAnimUnit++]=t}f!=null&&(f.finishFunc=this.finishFunc,f.extraData=this.extraData)};WacAnimation_Object.prototype.FindMatchingAnimationUnit=function(n){for(var t,r=this.arrAnimationUnits.length,i=0;i<r;i++)if(t=this.arrAnimationUnits[i],t.delay==this.GetIntWrapperValue(n.startTime)+this.delay&&t.duration==this.GetIntWrapperValue(n.endTime)-this.GetIntWrapperValue(n.startTime))return t;return null};WacAnimation_Object.prototype.GetFinalValue=function(n,t){var i=null,f,u,e,r;if(!IsNullOrUndef(this.GetIntWrapperValue(n.endValue)))switch(n.relativeTo){case 0:f=IsArrayCheck(this.element)?this.element[t]:this.element;u=this.GetIntWrapperValue(n.startValue)==null?GetCurrentAttributeCssValue(f,n.type,this.finalState.AnimateRight):this.GetIntWrapperValue(n.startValue);i=n.operationType==0?this.GetIntWrapperValue(n.endValue)*u:this.GetIntWrapperValue(n.endValue)+u;break;case 1:e=IsArrayCheck(this.element)?this.finalState[t]:this.finalState;r=e.GetAttribute(n.type);IsNullOrUndef(r)||(i=n.operationType==0?this.GetIntWrapperValue(n.endValue)*r:this.GetIntWrapperValue(n.endValue)+r);break;case 2:i=this.GetIntWrapperValue(n.endValue)}return i};WacAnimationUnit.prototype={element:null,delay:0,duration:0,startValue:null,perElementStartValue:null,targetValue:null,curveID:null,finishFunc:null,extraData:null,startTime:null,fIsExecuting:!1,animateRight:!1,relativePosition:!1};WacAnimationUnit.prototype.Initialize=function(n,t,i,r,u,f){this.element=n;this.delay=t;this.duration=i;this.finishFunc=r;this.extraData=u;this.startValue=new WacAnimation_State;this.perElementStartValue=null;this.targetValue=null;this.curveID=new WacAnimation_State;this.startTime=null;this.fIsExecuting=!1;this.animateRight=f;this.relativePosition=!1};WacAnimationUnit.prototype.StartAnimation=function(){g_WacAnimationEngine==null&&(g_WacAnimationEngine=new WacAnimationEngine);g_WacAnimationEngine.sharedTimer==null&&g_WacAnimationEngine.StartEngine();this.element.style.position=="relative"&&(this.relativePosition=!0);this.startTime=new Date;this.currentTime=new Date;g_WacAnimationEngine.StartAnimation(this)};WacAnimationUnit.prototype.StopAnimation=function(){g_WacAnimationEngine.StopAnimation(this)};WacAnimationUnit.prototype.StepAnimation=function(){var r,n,h,e,t,u,f,o,s,l,i;if(this.currentTime=new Date,r=Number(this.currentTime)-Number(this.startTime),!(r<this.delay)){r-=this.delay;var c=!0,a=!this.fIsExecuting,v=g_numAnimationAttributes;for(n=1;n<=v;n++)if(h=this.curveID.GetAttribute(n),!IsNullOrUndef(h))if(e=this.PositionFunction(r,this.duration,h),IsArrayCheck(this.element))for(l=this.element.length,i=0;i<l;i++)o=this.element[i],t=this.startValue.GetAttribute(n),s=this.targetValue[i],u=s.GetAttribute(n),IsNullOrUndef(t)&&(this.perElementStartValue==null&&(this.perElementStartValue=new Array(this.element.length)),IsNullOrUndef(this.perElementStartValue[i])&&(this.perElementStartValue[i]=new WacAnimation_State),t=this.perElementStartValue[i].GetAttribute(n),IsNullOrUndef(t)&&(t=GetCurrentAttributeCssValue(o,n,this.animateRight,this.relativePosition),this.perElementStartValue[i].SetAttribute(n,t))),f=t+e*(u-t),r>=this.duration||e>1?f=u:c=!1,a&&g_WacAnimationEngine.CheckForConflictingAnimations(o,n),this.SetStyle(n,o,f);else o=this.element,t=this.startValue.GetAttribute(n),s=this.targetValue,u=s.GetAttribute(n),IsNullOrUndef(t)&&(t=GetCurrentAttributeCssValue(this.element,n,this.animateRight,this.relativePosition),this.startValue.SetAttribute(n,t)),f=t+e*(u-t),r>=this.duration||e>1?f=u:c=!1,a&&g_WacAnimationEngine.CheckForConflictingAnimations(this.element,n),this.SetStyle(n,this.element,f);this.fIsExecuting=!0;c&&(this.StopAnimation(),this.finishFunc!=null&&(g_WacAnimationTelemetry.LogData("calling fnishfunc"),this.finishFunc(this.extraData)))}};WacAnimationUnit.prototype.PositionFunction=function(n,t,i){var r=0,u=g_AnimationCurves[i];switch(u.type){case 0:r=1;break;case 1:r=n<t?0:1;break;case 2:r=n/t;break;case 3:r=CalculateBezier(u.x1,u.y1,u.x2,u.y2,n/t)}return r};WacAnimationUnit.prototype.SetStyle=function(n,t,i){g_WacAnimationTelemetry.elementIds[t.id]=!0;switch(n){case 1:this.StyleLeftSetter(t,i);break;case 2:this.StyleTopSetter(t,i);break;case 3:this.StyleHeightSetter(t,i);break;case 4:this.StyleWidthSetter(t,i);break;case 5:this.StyleOpacitySetter(t,i);break;case 6:this.StyleScrollTopSetter(t,i);break;case 7:this.StyleScrollLeftSetter(t,i);break;case 8:this.StyleRotateZSetter(t,i)}};WacAnimationUnit.prototype.StyleLeftSetter=function(n,t){this.animateRight?this.relativePosition?n.style.marginRight=String(t)+"px":n.style.right=String(t)+"px":this.relativePosition?n.style.marginLeft=String(t)+"px":n.style.left=String(t)+"px";g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", "+(this.animateRight?"right":"left")+": "+String(t)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleTopSetter=function(n,t){this.relativePosition?n.style.marginTop=String(t)+"px":n.style.top=String(t)+"px";g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", top: "+String(n.style.top)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleHeightSetter=function(n,t){n.style.height=String(t)+"px";g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", height: "+String(n.style.height)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleWidthSetter=function(n,t){n.style.width=String(t)+"px";g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", width: "+String(n.style.width)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleOpacitySetter=function(n,t){SetCssOpacity(n,t);g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", opacity: "+String(t)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleScrollTopSetter=function(n,t){n.scrollTop=t;g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", scrollTop: "+t+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleScrollLeftSetter=function(n,t){n.scrollLeft=t;g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", scrollLeft: "+t+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleRotateZSetter=function(n,t){SetCssRotation(n,t);g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", rotateZ: "+t+", timestamp: "+String(Number(new Date)))};WacAnimationTelemetry.prototype={perfData:null,logData:null,animationStatsLength:5,animationStats:null,animationStatsIndex:0,perfDataIndex:0,logDataIndex:0,animationIndex:0,startTime:null,duration:null,numUnits:0,elementIds:null,avgSessionFps:-1,countSessionFps:0,minSessionFps:-1,maxSessionFps:-1};WacAnimationTelemetry.prototype.Start=function(){this.startTime=new Date;this.perfDataIndex=0;this.logDataIndex=0;this.elementIds={}};WacAnimationTelemetry.prototype.Stop=function(){this.duration=Number(new Date)-Number(this.startTime);this.numUnits=g_WacAnimationEngine.sharedTimerRefs;this.CalculateAndShowStatistics();this.perfDataIndex=0;this.logDataIndex=0};WacAnimationTelemetry.prototype.AddPerfData=function(n){this.perfData[this.perfDataIndex++]=n};WacAnimationTelemetry.prototype.LogData=function(n){this.logData[this.logDataIndex++]=n};WacAnimationTelemetry.prototype.CalculateStatistics=function(){var i=0,h=Number.MAX_VALUE,c=Number.MIN_VALUE,f=0,r=0,l="",a="",y=new Date,v="",o=this.duration,p,n,u,e,w,s,t;if(IsNullOrUndef(o)&&(o=Number(y)-Number(this.startTime)),g_WacAnimationLogging&&this.logDataIndex>0)for(p=this.logDataIndex,n=0;n<p;n++)n!=0&&(l+="<br/>"),l+=this.logData[n];if(this.perfDataIndex>0){for(u=this.perfDataIndex,n=0;n<u;n++)this.perfData[n]<h&&(h=this.perfData[n]),this.perfData[n]>c&&(c=this.perfData[n]),f+=this.perfData[n],n!=0&&(a+=", "),a+=this.perfData[n];for(u>1&&(f/=u-1),f=Math.round(f*100)/100,n=0;n<u;n++)e=this.perfData[n]-f,e=e*e,r+=e;u>1&&(r/=u-1);r=Math.sqrt(r);r=Math.round(r*100)/100;i=this.perfDataIndex/o*1e3;i=Math.round(i)}for(w in this.elementIds)v+=w,v+=",";return(this.minSessionFps==-1||i<this.minSessionFps)&&(this.minSessionFps=i),(this.maxSessionFps==-1||i>this.maxSessionFps)&&(this.maxSessionFps=i),this.countSessionFps==0?(this.countSessionFps++,this.avgSessionFps=i):(s=this.avgSessionFps*this.countSessionFps,s=s+i,this.countSessionFps++,this.avgSessionFps=s/this.countSessionFps),t=new Array(12),t[0]=o,t[1]=i,t[2]=h,t[3]=c,t[4]=f,t[5]=r,t[6]=a,t[7]=l,t[8]=this.numUnits,t[9]=Number(this.startTime),t[10]=Number(y),t[11]=v,t};WacAnimationTelemetry.prototype.CalculateAndShowStatistics=function(){var n=this.CalculateStatistics();g_LastAnimationData=n;this.StoreAnimationStats(n)};WacAnimationTelemetry.prototype.StoreAnimationStats=function(n){this.animationStats[this.animationStatsIndex]=n;this.animationStatsIndex++;this.animationStatsIndex=this.animationStatsIndex%this.animationStatsLength};WacAnimationTelemetry.prototype.GetRecentAnimationStats=function(){for(var n,r=[],t=0,i=g_WacAnimationTelemetry.animationStatsIndex;i<g_WacAnimationTelemetry.animationStatsLength;i++)g_WacAnimationTelemetry.animationStats[i]!=null&&(r[t]=g_WacAnimationTelemetry.animationStats[i],t++);for(n=0;n<g_WacAnimationTelemetry.animationStatsIndex;n++)g_WacAnimationTelemetry.animationStats[n]!=null&&(r[t]=g_WacAnimationTelemetry.animationStats[n],t++);return r};WacAnimationTelemetry.prototype.GetAnimationSqmStats=function(){var n=[];return n[0]=g_WacAnimationTelemetry.avgSessionFps<0?0:g_WacAnimationTelemetry.avgSessionFps,n[1]=g_WacAnimationTelemetry.minSessionFps<0?0:g_WacAnimationTelemetry.minSessionFps,n[2]=g_WacAnimationTelemetry.maxSessionFps<0?0:g_WacAnimationTelemetry.maxSessionFps,n};g_WacAnimationTelemetry=new WacAnimationTelemetry;g_LastAnimationData=null;WacAnimation.Telemetry=g_WacAnimationTelemetry;Type.registerNamespace("_Ewa");_Ewa.Vi=function(){};_Ewa.Vi.a=function(){_Ewa.bm.a().b(_Ewa.kp,141,new _Ewa.AY)};_Ewa.AY=function(){_Ewa.AY.initializeBase(this)};_Ewa.AY.prototype={dispose:function(){Common.y.g()&&Common.y.f()},a:function(n,t,i,r,u){!t||!t.length||Common.y.b(n.a,t);Common.y.a(n,r,u);!i||!i.length||Common.y.o(n.a,i)}};_Ewa.AY.registerClass("_Ewa.AY",_Ewa.kp,Sys.IDisposable);_Ewa.Vi.a();Type.registerNamespace("_Ewa");_Ewa.Ls=function(n,t){this.sourceRange=n;this.destinationRange=t};_Ewa.Ls.prototype={sourceRange:null,destinationRange:null};_Ewa.Ow=function(n){this.e=[3];_Ewa.Ow.initializeBase(this,[!1]);this.a=n};_Ewa.Ow.prototype={a:null,c:function(){var n=this.a.c().b().a(_Ewa.fm,281,!1);return n||Diag.a.a(40428307,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes)."),n},l:function(n){this.dE("mrek",n)},f:function(n,t,i){for(var f,u=this.a.G(),e=u.length,r=0;r<e;++r)f=u[r],Common.f.a().a("msospPointerMove",f.j(),n);Common.f.a().a("msospPointerUp",document.documentElement,t);this.a.l().n(!0);i&&Common.f.a().a("msospPointerLeave",this.a.A(),t)},g:function(n,t,i){for(var f,u=this.a.G(),e=u.length,r=0;r<e;++r)f=u[r],Common.f.a().b("msospPointerMove",f.j(),n);Common.f.a().b("msospPointerUp",document.documentElement,t);this.a.l().n(!1);i&&Common.f.a().b("msospPointerLeave",this.a.A(),t)},m:function(n,t){for(var u,r=this.a.G(),f=r.length,i=0;i<f;++i)u=r[i],Common.l.a().a("touchmove",u.j(),n);Common.l.a().a("touchend",document.documentElement,t)},n:function(n,t){for(var u,r=this.a.G(),f=r.length,i=0;i<f;++i)u=r[i],Common.l.a().b("touchmove",u.j(),n);Common.l.a().b("touchend",document.documentElement,t)},h:function(n,t,i,r){var u=document.createElement("div"),o;u.className=t;for(var e=i,s=e.length,f=0;f<s;++f)o=e[f],Sys.UI.DomElement.addCssClass(u,o);return n.appendChild(u),Common.f.a().a("msospPointerDown",u,r),u},i:function(n){var i=n.c.parentNode,t;return i?(t=parseInt(i.getAttribute("IndexInMarqueeCollection")),isNaN(t))?(Diag.a.b(38887579,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.a.k().e(3,1,t):(Diag.a.b(38887578,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null)},b:function(n,t,i){for(var f,e=i&&!!this.c()&&this.c().c(n),u=t,o=u.length,r=0;r<o;++r)f=u[r],_Ewa.a.b(f,e,!0)},d:function(){return this.a.Z()?_Ewa.dL.a(this.a.c()):this.a.g()},k:function(){var n=this.d();n&&this.c()?this.c().b(n):(Diag.a.a(38926108,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.a.k().a(this.e),this.a.k().b(null,this.e,!0))},j:function(n,t){this.dC("mrek",new _Ewa.OC(n,t),null)}};_Ewa.Ox=function(n,t,i,r){_Ewa.Ox.initializeBase(this,[n,t,i,r])};_Ewa.Ox.prototype={p:function(){return 19},g:function(){return this.a.a().d().c()},j:function(){return!(this.a.B()||this.a.H()||this.a.m())&&_Ewa.bei.prototype.j.call(this)}};_Ewa.Oy=function(n,t,i,r,u,f){var o;this.w=Function.createDelegate(this,this.C);_Ewa.Oy.initializeBase(this,[n,t,i,u]);this.p=_Ewa.b.a(this.b);this.i=r;this.j=this.b.b().a(_Ewa.fm,281,!1);Diag.a.b(38621457,0,!!this.j,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");for(var s=this.e,h=s.length,e=0;e<h;++e)o=s[e],Common.f.a().a("msospPointerEnter",o,this.i.i),Common.f.a().a("msospPointerLeave",o,this.i.j);this.s(f)};_Ewa.Oy.prototype={h:null,f:null,p:null,j:null,i:null,s:function(n){this.k.b(n,this.e,!0);this.i.n()},P:function(n){Diag.a.a(39695183,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.p.bF(!0);this.f.k(!1);this.l(4);this.i.l(n.c);this.f.a().E();this.f.w(this.w);this.R(this.m,this.n);this.t=this.c.k()?1:this.c.n()?2:0},Q:function(){var n=this.x();return this.l(-1),this.o(this.m,this.n,!0),n},N:function(){this.p.bF(!1);this.i.m(this.e[0]);this.f.a().o();this.f.B(this.w);this.k.k()},C:function(){this.u(!0)},u:function(n){Diag.a.a(39916748,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");n&&this.o(this.m,this.n,!0)},O:function(n){return(this.f=this.k.d(),this.h=this.k.i(n),!this.f||!this.h||!this.h.b)?(Diag.a.b(38926109,0,!!this.f,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),Diag.a.b(38926110,0,!!this.h,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),Diag.a.b(38926111,0,!!this.h.b,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null):this.h.b},x:function(){return this.h?this.j.a(this.f,this.h,this.a):(Diag.a.b(38621460,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)},T:function(){return this.x()},B:function(){return!0}};_Ewa.gQ=function(n,t,i,r,u){this.x=Function.createDelegate(this,this.be);this.w=Function.createDelegate(this,this.bd);this.D=Function.createDelegate(this,this.bg);this.C=Function.createDelegate(this,this.bf);this.E=Function.createDelegate(this,this.bh);this.F=Function.createDelegate(this,this.bi);_Ewa.gQ.initializeBase(this,[n,t,i,u]);this.G=r;this.h=null;this.i={};this.p=!1;this.d.s(this.F);this.d.k(this.E);this.d.B(this.C);this.d.g(this.D)};_Ewa.gQ.prototype={i:null,j:null,G:null,h:null,f:!1,p:!1,dispose:function(){if(this.d&&(this.d.t(this.F),this.d.l(this.E),this.d.G(this.C),this.d.h(this.D)),this.i)for(var n=1;n<=4;n++)_Ewa.a.g(this.i[n.toString()]);this.j=null;this.i=null;_Ewa.bee.prototype.dispose.call(this)},P:function(n){this.p=!0;this.h=this.bb(this.G.b(this.c.e()));var t=_Ewa.b.a(this.b);this.h&&!this.h.g(this.c)?(this.f=this.h.b===this.c.b&&this.h.c===this.c.c,this.j=this.f?[11]:[12],this.l(5),this.R(this.w,this.x),this.W(n.get_clientPoint(),n.c,this.f?11:12,!0)):(this.h=null,this.R(this.m,this.n),this.t=this.c.k()?1:this.c.n()?2:0,this.W(n.get_clientPoint(),n.c,6,!1));this.H()},Q:function(){if(this.p=!1,this.g().a(_Ewa.gQ.a),!this.b.Y([this.a],1))return this.o(this.m,this.n,!0),this.l(-1),!0;if(this.d.a().g(this.a)||this.U(this.a)||this.U(this.c))this.l(-1);else{this.V();this.d.y(this.c.f());var n=this.d.n(),t=this.d.a();this.b.C(-694765314,2,0,{DragDropSourceRange:n,DragDropDestinationRange:t})}return this.h||this.o(this.m,this.n,!0),!0},N:function(){for(var t,n=1;n<=4;n++)t=this.i[n.toString()],t&&t.parentNode.removeChild(t),this.i[n.toString()]=null;this.j=null;this.p=!1},be:function(n){var t,i;return n=_Ewa.x.a(this.b).a(n),this.v()===4?this.Z(n):(this.p=!1,this.g().a(this.j),!this.b.Y([this.a],1)||this.bk()||this.bc()||(this.d.y(this.c.f()),this.bj(),this.f?this.a.a>this.c.a&&(t=this.a.l(),this.a.a=this.a.a-t,this.a.d=this.a.d-t):this.a.b>this.c.b&&(i=this.a.o(),this.a.b=this.a.b-i,this.a.c=this.a.c-i),this.V())),this.o(this.w,this.x,!0),this.h=null,this.l(-1),!0},bd:function(n){var c=n.get_clientPoint(),t,i,u,o,f,s;if(n=_Ewa.x.a(this.b).a(n),t=this.d.m(c,n.c,4,!1,!0,!0),t){if(this.h.i(t.e())){var r=_Ewa.b.a(this.b),e=r.z(t,1,!1),v=r.n(this.M),l=_Ewa.bH.b(v.h().c(),this.dA.parentNode,c,r.d()),h=!1,a=2;if(this.f&&l.b-e.a.b>e.d()/2?(h=!0,a=1):!this.f&&l.a-e.a.a>e.c()/2&&(h=!0),h){i=r.u("DragSelectionClickBehavior.OnPointerMoveRearrange",r.M(),a,!0);try{i.b(t,!0);i.$$mn();t=i.$$cu().b()}finally{i&&i.dispose()}}if(this.a=this.ba(t),this.d.y(this.a),this.g().b(this.a,this.j,!0),this.g().c(this.j,null,null),this.g().a(_Ewa.gQ.a),this.v()!==5){for(u=1;u<=4;u++)o=this.i[u.toString()],o.parentNode.removeChild(o),this.g().e(this.f?11:12,u,0).a.appendChild(o);this.l(5)}}else if(this.a=this.Y(t),this.g().b(this.a,_Ewa.gQ.a,!0),this.g().c(_Ewa.gQ.a,null,null),this.g().a(this.j),this.v()!==4){for(f=1;f<=4;f++)s=this.i[f.toString()],s.parentNode.removeChild(s),this.g().e(6,f,0).a.appendChild(s);this.l(4)}this.H()}return!0},O:function(){return this.d.a()},V:function(){return this.d.f(this.a,this.a.e(),0,0,!0,"",!1,!0,!0),!0},T:function(){return this.g().b(this.a,_Ewa.gQ.a,!0),this.g().c(_Ewa.gQ.a,null,null),this.H(),!0},bh:function(){Sys.UI.DomElement.removeCssClass(this.dA,"selecting")},bi:function(){Sys.UI.DomElement.addCssClass(this.dA,"selecting")},bg:function(){if(this.b.k()){var n=this.bl();this.S(n)}},bf:function(){this.p&&this.v()>=4&&(this.h?(this.g().a(this.j),this.o(this.w,this.x,!0)):(this.g().a(_Ewa.gQ.a),this.o(this.m,this.n,!0)))},u:function(){Diag.a.a(38926112,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")},B:function(){return!1},bl:function(){var t,r;if(this.b.a(462)&&!_Ewa.b.a(this.b).a().d().b())return!1;t=_Ewa.b.a(this.b).C(this.d.a());for(var i=t,u=i.length,n=0;n<u;++n)if(r=i[n],_Ewa.co.isInstanceOfType(r))return!1;return!0},bb:function(n){if(n&&n.i(this.c)&&!n.g(this.c)){if(n.q&&this.c.d===this.c.a&&this.c.a===n.a)return this.c=new _Ewa.n(this.c.a,this.c.b,n.d,this.c.c,!1,!1),this.d.f(this.c,this.c.e(),0,0,!0,"",!1,!0,!0),n;if(this.f=n.b===this.c.b&&n.c===this.c.c,n.a===this.c.a&&n.d===this.c.d||this.f)return n}return null},ba:function(n){var t=n.f();return this.f?t.b=Math.max(n.b-this.y,1):t.a=Math.max(n.a-this.z,1),t.c=t.b+this.c.o()-1,t.d=t.a+this.c.l()-1,this.X(t)},bc:function(){var n=this.a.e().h(this.c);return n?n:this.f?this.a.a===this.c.d+1:this.a.b===this.c.c+1},bk:function(){if(this.f&&this.a.b!==this.h.b||!this.f&&this.a.a!==this.h.a){var n=_Ewa.h.b(1,1,0,789,0,2065438552,"RearrangeInvalidDest");return _Ewa.L.a(this.b).c([n]),!0}return!1},bj:function(){var n={};this.f?(n.FirstRow=this.a.a-1,n.FirstColumn=0,n.DeltaColumn=0,n.DeltaRow=this.a.d-this.a.a+1):(n.FirstRow=0,n.FirstColumn=this.a.b-1,n.DeltaColumn=this.a.c-this.a.b+1,n.DeltaRow=0);n.LastRow=1048575;n.LastColumn=16383;n.SheetName=this.b.f().a()?this.b.f().a().a:this.b.m().b(this.b.m().a().a).e;var t=_Ewa.g.a(this.c,this.b),i=this,r=function(r,u){return _Ewa.OJ.a(i.b.d().a(),t,n,r,u,null,null)},f=this,u=function(){return new _Ewa.Ls(t,n)};this.b.h().a(new _Ewa.be(514,0,r,0,u),null)},U:function(n){for(var r,u,i=_Ewa.b.a(this.b).C(n),t=0,f=i.length;t<f;++t)if(r=i[t],_Ewa.co.isInstanceOfType(r))return u=_Ewa.h.b(1,0,0,785,0,2105176604,"InsDelCellsPivotTable"),_Ewa.L.a(this.b).c([u]),!0;return!1},W:function(n,t,i,r){for(var o,s,e=_Ewa.a.i(t),u=t===this.e[0]||t===this.e[1],h=u?e.width:e.height,c=(u?-25:-50)+"px",l=u?t===this.e[0]?"top":"bottom":t===this.e[3]||r?"right":"left",a=(u?r?0:n.x-e.x:n.y-e.y)*100/h,f=1;f<=4;f++)o=document.createElement("div"),o.className="ewr-selection-dragtooltip",this.i[f.toString()]=o,this.g().e(i,f,0).a.appendChild(o),s=this.i[f.toString()],s.style[l]=c,s.style[u?"left":"top"]=a+"%"},H:function(){for(var t=this.a.toString(),n=1;n<=4;n++)this.i[n.toString()].innerText=t}};_Ewa.bee=function(n,t,i,r){var e,o;this.J=Function.createDelegate(this,this.bq);this.I=Function.createDelegate(this,this.bn);this.n=Function.createDelegate(this,this.bp);this.m=Function.createDelegate(this,this.bo);_Ewa.bee.initializeBase(this,[n]);this.e=[];this.b=t;this.d=_Ewa.b.a(this.b).a();this.M=i;this.k=r;for(var f=["ewr-selection-draghandle-top","ewr-selection-draghandle-bottom","ewr-selection-draghandle-left","ewr-selection-draghandle-right"],s=f.length,u=0;u<s;++u)e=f[u],o=this.k.h(n,e,["ewr-selection-draghandle"],this.I),Array.add(this.e,o);this.b.E(this.J);this.S(this.b.k())};_Ewa.bee.prototype={A:!1,L:null,K:null,q:0,b:null,d:null,k:null,t:0,M:0,y:0,z:0,r:null,e:null,c:null,a:null,g:function(){return _Ewa.b.a(this.b).k()},v:function(){return this.d.q()},l:function(n){return this.d.o(n),n},dispose:function(){var n=this;Array.forEach(this.e,function(t){Common.f.a().b("msospPointerDown",t,n.I)});Array.clear(this.e);this.a=null;this.c=null;this.r=null;Diag.a.a(50671828,0,50,"DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = {0}, EwaControl is null : {1}",this.q,!this.b);this.b&&(this.b.G(this.J),this.q===1&&(Diag.a.a(50671829,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.o(this.K,this.L,!1)));_Ewa.gK.prototype.dispose.call(this)},bp:function(n){return n=_Ewa.x.a(this.b).a(n),this.Z(n)},Z:function(){if(this.v()!==4)return!1;var n=this.Q();return n||this.u(!1),_Ewa.bQ.b(this.b,!1),n},bn:function(n){var i,t;if(n=_Ewa.x.a(this.b).a(n),n.b===2&&!n.f&&!this.A){if(i=this.O(n),!i)return Diag.a.b(38926113,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.a=i.f();this.c=this.a.f();this.r=this.a;t=this.bm(n);t&&(this.l(4),this.z=t.a-this.c.a,this.y=t.b-this.c.b,_Ewa.b.a(this.b).r().b("move"),this.P(n),this.A=!0,_Ewa.bQ.b(this.b,!0))}return!1},bo:function(n){var t,i;return(n=_Ewa.x.a(this.b).a(n),t=this.d.m(n.get_clientPoint(),n.c,4,!1,!0,!0),t&&(this.a=this.Y(t),i=this.T(),!i))?(Diag.a.b(38926114,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.u(!0),!1):!0},R:function(n,t){Diag.a.b(50671830,0,!this.q,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.q+=1;this.K=n;this.L=t;this.k.f(n,t,this.B())},Y:function(n){if(!n||!this.a)return Diag.a.b(38926115,0,!!n,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),Diag.a.b(38926144,0,!!this.a,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;var t=this.a.f();return this.t!==1&&(t.b=Math.max(n.b-this.y,1),t.c=t.b+this.c.o()-1),this.t!==2&&(t.a=Math.max(n.a-this.z,1),t.d=t.a+this.c.l()-1),this.X(t)},o:function(n,t,i){Diag.a.b(50671831,0,this.q===1,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");this.q-=1;_Ewa.b.a(this.b).r().b("default");this.k.g(n,t,this.B());i&&this.N();this.t=0;this.A=!1},X:function(n){var r=_Ewa.b.a(this.b),t=n,u,f,i;if(r.i().l()){if(u=r.e(n.e()),!u){f=this.r.a!==n.a?1:2;i=r.u("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",r.M(),f,!0);try{i.c(this.r.a<n.a||this.r.b<n.b);i.b(n.e(),!0);t=i.$$cu().b()}finally{i&&i.dispose()}}t.c=t.b+n.o()-1;t.d=t.a+n.l()-1}return this.r=t,t},S:function(n){var t=this;Array.forEach(this.e,function(t){_Ewa.a.b(t,n,!0)})},bq:function(n,t){t.b||this.S(this.b.k())},bm:function(n){var t=n.c,i=n.get_clientPoint();return!t||!i?(Diag.a.b(38926145,0,!!t,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),Diag.a.b(38926146,0,!!i,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null):(i.y+=t===this.e[0]?2:t===this.e[1]?-2:0,i.x+=t===this.e[2]?2:t===this.e[3]?-2:0,this.d.m(i,t,4,!1,!0,!0))}};_Ewa.Oz=function(n,t){this.g=Function.createDelegate(this,this.o);this.h=Function.createDelegate(this,this.p);this.i=Function.createDelegate(this,this.j);this.e=Function.createDelegate(this,this.m);this.f=Function.createDelegate(this,this.n);this.c=Function.createDelegate(this,this.k);this.d=Function.createDelegate(this,this.l);_Ewa.Oz.initializeBase(this,[n]);this.a=t;var i=document.createElement("div");i.className="ewr-selection-fillhandle";this.b=i;this.j(null,null);n.appendChild(i);Common.f.a().a("msospPointerDown",this.b,this.d);Common.i.a().a("dblclick",this.b,this.c);this.a.a().s(this.f);this.a.a().k(this.e);this.a.c().E(this.i);this.a.c().p().bM(this.h);this.a.c().p().bL(this.g)};_Ewa.Oz.prototype={a:null,b:null,dispose:function(){Common.f.a().b("msospPointerDown",this.b,this.d);Common.i.a().b("dblclick",this.b,this.c);this.a.c()&&(this.a.a().t(this.f),this.a.a().l(this.e),this.a.c().G(this.i),this.a.c().p().bQ(this.h),this.a.c().p().bP(this.g));_Ewa.gK.prototype.dispose.call(this)},m:function(){Sys.UI.DomElement.removeCssClass(this.dA,"selecting")},n:function(){Sys.UI.DomElement.addCssClass(this.dA,"selecting")},l:function(n){return n.b!==2||n.f||(this.a.a().o(3),this.a.a().y(this.a.a().a())),!1},k:function(){return this.a.c().C(1983983164,2,0,null),!0},j:function(){_Ewa.a.b(this.b,this.a.c().k(),!0)},p:function(){_Ewa.a.b(this.b,!1,!0)},o:function(){_Ewa.a.b(this.b,!0,!0)}};_Ewa.nn=function(n,t){this.b=Function.createDelegate(this,this.c);_Ewa.nn.initializeBase(this,[n,null]);this.a=t;Common.i.a().a("click",n,this.b)};_Ewa.nn.prototype={a:null,c:function(n){var v=n.a,i=this.a.bR(n.get_clientPoint()),r,e,u,l,t,f;if(!i||(r=i.b,e=r.i(i.a),!e))return!1;var w=n.d,h=r.f().j(),y=_Ewa.k.G(_Ewa.k.n(r.d(),h,this.a.c().isChangeGateEnabled("OfficeVSO:4071894_IeAndEdgeMisplacedEditorInRtlEnabled")),i.a),o=0,c=this.a.e(e.a(!1));for(u=0,l=_Ewa.nn.a.length;u<l;++u)if((t=_Ewa.nn.a[u],t!==128&&t!==64||!this.a.c().k())&&(f=c.w(t,"click"),f&&f.a.style.display!=="none")){var s=f.a,a=_Ewa.k.n(s,h,this.a.c().isChangeGateEnabled("OfficeVSO:4071894_IeAndEdgeMisplacedEditorInRtlEnabled")),p=new Sys.UI.Bounds(a.x,a.y,s.offsetWidth,s.offsetHeight);if(Common.g.c(p,y)){o=t;break}}return o?(c.U(o,v),!0):!1}};_Ewa.OB=function(n){this.e=Function.createDelegate(this,this.r);this.k=Function.createDelegate(this,this.s);this.j=Function.createDelegate(this,this.q);this.i=Function.createDelegate(this,this.p);this.b=n;this.c=0;this.d=!1;this.f=!1;this.a=Number.NaN;this.b.a().s(this.k);this.b.a().k(this.e);this.b.a().B(this.e)};_Ewa.OB.prototype={b:null,c:0,d:!1,f:!1,a:0,o:function(){this.b.a().t(this.k);this.b.a().l(this.e);this.b.a().G(this.e)},n:function(){this.c=0;this.d=!1;this.a=Number.NaN},p:function(n){var t=n.c;return this.g(t,1),!0},q:function(n){var t=n.c;return this.g(t,-1),!0},l:function(n){this.d=!0;this.g(n,1)},m:function(n){this.d=!1;this.g(n,-1)},g:function(n,t){if(!n){Diag.a.b(39175838,0,!!n,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.");return}if(!n.parentNode){Diag.a.b(39175839,0,!!n.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");return}if(this.f){isNaN(this.a)||(this.h(this.a,!1),this.a=Number.NaN);return}var r=n.parentNode,i=parseInt(r.getAttribute("IndexInMarqueeCollection"));if(isNaN(i)){Diag.a.b(39175840,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");return}if(!isNaN(this.a)&&i!==this.a){if(this.d)return;this.h(this.a,!1)}(isNaN(this.a)||i!==this.a)&&(this.a=i,this.c=0);!this.c&&t>0&&this.h(i,!0);this.c=Math.max(this.c+t,0);!this.c&&t<0&&(this.h(i,!1),this.a=Number.NaN)},h:function(n,t){for(var f,u,i,r=1;r<=4;r++)for(f=this.b.k().e(3,r,n),u=f.a,_Ewa.a.f(u,"ewr-marquee-thick",t),i=u.firstChild;i;i=i.nextSibling)_Ewa.e.c(i.className,"resizemarqueehandle",!0)&&_Ewa.a.f(i,"ewr-resizemarqueehandle-thick",t)},r:function(){this.f=!1},s:function(){this.f=!0}};_Ewa.OC=function(n,t){_Ewa.OC.initializeBase(this);this.b=n;this.a=t};_Ewa.OC.prototype={b:!1,a:0};_Ewa.OD=function(n,t){this.d=Function.createDelegate(this,this.i);this.e=Function.createDelegate(this,this.j);this.f=Function.createDelegate(this,this.k);this.h=Function.createDelegate(this,this.m);this.g=Function.createDelegate(this,this.l);_Ewa.OD.initializeBase(this,[n,null]);this.a=$$as(_Ewa.me,t.h);this.b=document.createElement("div");this.b.id=String.format("{0}-{1}",n.id,"HighlightContainer");this.b.className="CatchUpDotOuterDiv";this.c=document.createElement("div");this.c.id=String.format("{0}-{1}",n.id,"HighlightDot");this.c.className="CatchUpActivityHighlightDot";this.b.appendChild(this.c);n.appendChild(this.b);Diag.a.a(51172355,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");Common.f.a().a("msospPointerEnter",this.b,this.g);Common.f.a().a("msospPointerLeave",this.b,this.h);Common.f.a().a("msospPointerDown",this.b,this.f);Common.J.a().a("click",this.b,this.e);Common.J.a().a("dblclick",this.b,this.d)};_Ewa.OD.prototype={c:null,b:null,a:null,dispose:function(){Common.f.a().b("msospPointerEnter",this.b,this.g);Common.f.a().b("msospPointerLeave",this.b,this.h);Common.f.a().b("msospPointerDown",this.b,this.f);Common.J.a().b("click",this.b,this.e);Common.J.a().b("dblclick",this.b,this.d);_Ewa.a.g(this.c);this.c=null;_Ewa.a.g(this.b);this.b=null;this.a=null;_Ewa.gK.prototype.dispose.call(this)},s:function(n){this.a=$$as(_Ewa.me,n.h)},l:function(){return this.a?(this.a.o(this.c,!1),this.a.m(this.c,!1),this.a.a.a===3)?!0:(this.a.n(!0),!0):(Diag.a.b(42795993,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1)},m:function(){return this.a?(this.a.s(!1),this.a.j(this.c,!1),this.a.a.a===3)?!0:(this.a.n(!1),!0):!1},k:function(n){return this.a?n.b===2&&!n.f?!0:!1:!1},j:function(){return this.a?(this.a.j(this.c,!0),this.a.o(this.c,!0),this.a.m(this.c,!0),this.a.g(!0),!0):!1},i:function(n){return n.a?(n.a.stopPropagation(),!0):(Diag.a.a(42795994,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill."),!0)}};_Ewa.OE=function(n,t,i,r){_Ewa.OE.initializeBase(this,[n,t,i,r])};_Ewa.OE.prototype={p:function(){return 16},g:function(){return this.a.a().v().a(!1)},j:function(){return(this.a.B()||this.a.H())&&_Ewa.bei.prototype.j.call(this)}};_Ewa.OF=function(n,t){_Ewa.OF.initializeBase(this,[n,null]);var i=document.createElement("div"),r=document.createElement("div");i.className=t?"ewr_selection_rearrangeleft":"ewr_selection_rearrangetop";r.className=t?"ewr_selection_rearrangeright":"ewr_selection_rearrangebottom";n.appendChild(i);n.appendChild(r)};_Ewa.beg=function(n,t,i,r,u){var h,c,o;this.j=Function.createDelegate(this,this.N);this.i=Function.createDelegate(this,this.M);this.u=Function.createDelegate(this,this.K);this.v=Function.createDelegate(this,this.L);_Ewa.beg.initializeBase(this,[n,null]);this.n=t;this.g=t.c();this.b=[];this.m=this.n.a();this.k=i;this.a=r;this.f=u;this.p=this.g.b().a(_Ewa.fm,281,!1);Diag.a.b(39856331,0,!!this.p,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");for(var s=this.B(),a=s.length,f=0;f<a;++f)h=s[f],c=this.a.h(n,h,this.w(),this.v),Array.add(this.b,c);for(var l=this.b,v=l.length,e=0;e<v;++e)o=l[e],Common.f.a().a("msospPointerEnter",o,this.k.i),Common.f.a().a("msospPointerLeave",o,this.k.j);this.s(u)};_Ewa.beg.prototype={h:null,e:null,g:null,m:null,c:0,k:null,d:null,l:null,t:!1,n:null,p:null,a:null,f:null,b:null,dispose:function(){var n=this;Array.forEach(this.b,function(t){Common.f.a().b("msospPointerDown",t,n.v)});Array.clear(this.b);_Ewa.gK.prototype.dispose.call(this)},s:function(n){this.f=n;this.x(n);this.a.b(n,this.b,this.r());this.k.n()},L:function(n){var t,i;if(n=_Ewa.x.a(this.g).a(n),this.C(n)&&!this.t){if(this.z(),this.e=this.a.d(),this.h=this.a.i(n),!this.e||!this.h||!this.h.b)return Diag.a.b(39856332,0,!!this.e,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),Diag.a.b(39856333,0,!!this.h,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),Diag.a.b(39856334,0,!!this.h.b,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;if(this.l=this.h.b.f(),this.d=this.l.f(),this.c=this.y(n),this.c===4)return Diag.a.b(39856335,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;if(t=this.G(n,!0),!t)return Diag.a.b(39856336,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(i=this.F(t),!i)return Diag.a.b(39856337,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.n.bF(!0);this.e.k(!1);this.k.l(n.c);this.a.j(!0,this.f.f);this.e.a().E();this.e.w(this.u);this.A();this.t=!0;_Ewa.bQ.b(this.g,!0)}return!0},M:function(n){var i,t,r;return(n=_Ewa.x.a(this.g).a(n),i=this.G(n,!1),!i)?!0:(t=this.F(i),!t)?(Diag.a.b(39856338,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.q(!0),!1):this.l.g(t)?!0:(this.l=t,r=this.O(),r||(Diag.a.b(39856339,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.q(!0)),r)},N:function(n){var t,i;return n=_Ewa.x.a(this.g).a(n),t=this.I(),Diag.a.b(39856340,0,t,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed"),Common.c.n()&&(this.m.M(!0),i=this,window.setTimeout(function(){i.m.M(!1)},100)),this.q(!t),t},G:function(n,t){var r=n.c,i=n.get_clientPoint(),u;return!r||!i?(Diag.a.b(39856341,0,!!r,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),Diag.a.b(39856342,0,!!i,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null):(t&&(i=this.H(i)),u=this.m.m(i,r,0,!0,!1,!0),u||(i=this.H(i),u=this.m.m(i,r,0,!0,!1,!0)),u)},H:function(n){return n.y+=!this.c||this.c===1?2:-2,n.x+=!this.c||this.c===2?2:-2,n},F:function(n){if(!n||!this.d)return Diag.a.b(39856343,0,!!n,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),Diag.a.b(39856344,0,!!this.d,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(this.c){if(this.c===1)return new _Ewa.n(n.a,this.d.b,this.d.d,n.c,!0,!1);if(this.c===2)return new _Ewa.n(this.d.a,n.b,n.d,this.d.c,!0,!1);if(this.c===3)return new _Ewa.n(this.d.a,this.d.b,n.d,n.c,!0,!1)}else return new _Ewa.n(n.a,n.b,this.d.d,this.d.c,!0,!1);return Diag.a.b(39856345,0,!1,"ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: {0}",_Ewa.beg.a.toString(this.c)),null},I:function(){return this.p.a(this.e,this.h,this.l)},O:function(){return this.I()},K:function(){this.q(!0)},q:function(n){n&&Diag.a.a(39916749,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.k.m(this.b[0]);this.a.j(!1,this.f.f);this.e.a().o();this.e.B(this.u);this.D();this.n.bF(!1);this.t=!1;_Ewa.bQ.b(this.g,!1);this.a.k()}};_Ewa.beg.a=function(){};_Ewa.beg.a.prototype={topLeft:0,topRight:1,bottomLeft:2,bottomRight:3,error:4};_Ewa.beg.a.registerEnum("_Ewa.beg.a",!1);_Ewa.OG=function(n,t,i,r,u){_Ewa.OG.initializeBase(this,[n,t,i,r,u])};_Ewa.OG.prototype={B:function(){return["ewr-selection-resizemarqueehandle-topleft","ewr-selection-resizemarqueehandle-topright","ewr-selection-resizemarqueehandle-bottomleft","ewr-selection-resizemarqueehandle-bottomright"]},w:function(){return["ewr-selection-resizemarqueehandle"]},y:function(n){var t=n.c;return t===this.b[0]?0:t===this.b[1]?1:t===this.b[2]?2:t===this.b[3]?3:(Diag.a.b(39383828,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle."),4)},A:function(){this.a.f(this.i,this.j,!0)},D:function(){this.a.g(this.i,this.j,!0)},C:function(n){return _Ewa.E.b(n.b)===2&&!n.f},r:function(){return!0},z:function(){Diag.a.a(39695184,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")},x:function(n){for(var r,i=this.b,u=i.length,t=0;t<u;++t)r=i[t],r.style.backgroundColor=n.a.style.borderColor}};_Ewa.OH=function(n,t,i,r,u){this.J=Function.createDelegate(this,this.Q);this.E=Function.createDelegate(this,this.P);_Ewa.OH.initializeBase(this,[n,t,i,r,u]);_Ewa.E.g(this.E);this.o=_Ewa.E.a===3;this.a.l(this.J)};_Ewa.OH.prototype={o:!1,dispose:function(){_Ewa.E.h(this.E);_Ewa.beg.prototype.dispose.call(this)},B:function(){return["ewr-grippie-marquee-topleft","ewr-grippie-marquee-bottomright"]},w:function(){return["ewr-grippie","ewr-grippie-circle-container","ewr-grippie-circle"]},y:function(n){var t=n.c;return t===this.b[0]?0:t===this.b[1]?3:(Diag.a.b(39383829,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle."),4)},A:function(){Common.c.g()?this.a.f(this.i,this.j,!1):this.a.m(this.i,this.j)},D:function(){Common.c.g()?this.a.g(this.i,this.j,!1):this.a.n(this.i,this.j)},C:function(n){return _Ewa.E.b(n.b)===3},r:function(){return _Ewa.E.a===3},z:function(){Diag.a.a(39695185,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")},x:function(){},P:function(){var n=_Ewa.E.a===3;this.o&&!n?this.a.b(this.f,this.b,!1):!this.o&&n&&this.a.b(this.f,this.b,!0);this.o=n},Q:function(n,t){t.a===this.f.f&&this.a.b(this.f,this.b,!t.b&&this.r())}};_Ewa.qb=function(n){_Ewa.qb.initializeBase(this,[n,null]);var t=document.createElement("div");t.className="ewr-selection-inner-border";n.appendChild(t)};_Ewa.kc=function(n){_Ewa.kc.initializeBase(this,[n,null]);_Ewa.kc.a(n,"ewr-selection-ants-top ewr-ants");_Ewa.kc.a(n,"ewr-selection-ants-right ewr-ants");_Ewa.kc.a(n,"ewr-selection-ants-bottom ewr-ants");_Ewa.kc.a(n,"ewr-selection-ants-left ewr-ants");_Ewa.kc.a(n,"ewr-selection-ants-hc")};_Ewa.kc.a=function(n,t){var i=document.createElement("div");i.className=t;n.appendChild(i)};_Ewa.OK=function(n,t){this.d=Function.createDelegate(this,this.g);_Ewa.OK.initializeBase(this,[!1]);this.f=n;this.a=_Ewa.b.a(n);this.e=t;this.b=new _Ewa.OB(this.a);this.c=new _Ewa.Ow(this.a);this.a.k()&&(this.a.k().l(this.d),this.a.k().f(!1,!0));n.b().b(Sys.IDisposable,64,this)};_Ewa.OK.prototype={a:null,e:null,f:null,b:null,c:null,dispose:function(){this.a.k().p(this.d);this.b&&(this.b.o(),this.b=null);_Ewa.Ya.prototype.dispose.call(this)},g:function(n,t){var e=t.a,f=this.a,i=t.d,r=i.a,u=i.e;Common.c.c()&&Array.add(u,new _Ewa.nn(r,f));switch(e){case 24:Array.add(i.e,new _Ewa.OD(r,i));break;case 0:Array.add(i.e,new _Ewa.Oz(r,f));Common.c.d()||Array.add(u,new _Ewa.gQ(r,this.a.c(),i.d,this.e,this.c));Array.add(u,new _Ewa.OM(i,r,f,i.d));break;case 3:Array.add(u,new _Ewa.qb(r));Common.c.d()||(Array.add(u,new _Ewa.Oy(r,this.a.c(),i.d,this.b,this.c,i)),Array.add(u,new _Ewa.OG(r,this.a,this.b,this.c,i)),Array.add(u,new _Ewa.OH(r,this.a,this.b,this.c,i)));break;case 4:case 5:Array.add(u,new _Ewa.kc(r));break;case 30:Array.add(u,new _Ewa.OL(r));break;case 16:Array.add(u,new _Ewa.kd(r));Array.add(u,new _Ewa.OE(i,r,f,i.d));break;case 11:case 12:Array.add(u,new _Ewa.OF(r,e===11));break;case 17:Array.add(u,new _Ewa.qb(r));break;case 19:Array.add(u,new _Ewa.qb(r));Array.add(u,new _Ewa.Ox(i,r,f,i.d))}i.j=!0}};_Ewa.OL=function(n){_Ewa.OL.initializeBase(this,[n,null]);appChrome.renderSpinner(n)};_Ewa.kd=function(n){_Ewa.kd.initializeBase(this,[n,null]);_Ewa.kd.a(n,"ewr-selection-rangepicker-ants-top ewr-ants");_Ewa.kd.a(n,"ewr-selection-rangepicker-ants-right ewr-ants");_Ewa.kd.a(n,"ewr-selection-rangepicker-ants-bottom ewr-ants");_Ewa.kd.a(n,"ewr-selection-rangepicker-ants-left ewr-ants");_Ewa.kd.a(n,"ewr-selection-rangepicker-ants-hc")};_Ewa.kd.a=function(n,t){var i=document.createElement("div");i.className=t;n.appendChild(i)};_Ewa.OM=function(n,t,i,r){_Ewa.OM.initializeBase(this,[n,t,i,r])};_Ewa.OM.prototype={p:function(){return 0},g:function(){return this.a.a().a()},j:function(){return!(this.a.B()||this.a.H()||this.a.m())&&_Ewa.bei.prototype.j.call(this)}};_Ewa.bei=function(n,t,i,r){var u,e,f,s,c;this.J=Function.createDelegate(this,this.bi);this.E=Function.createDelegate(this,this.bd);this.B=Function.createDelegate(this,this.Y);this.A=Function.createDelegate(this,this.X);this.H=Function.createDelegate(this,this.bg);this.F=Function.createDelegate(this,this.be);this.n=Function.createDelegate(this,this.bk);this.y=Function.createDelegate(this,this.V);this.G=Function.createDelegate(this,this.bf);this.x=Function.createDelegate(this,this.P);this.K=Function.createDelegate(this,this.bj);this.C=Function.createDelegate(this,this.Z);this.D=Function.createDelegate(this,this.ba);this.z=Function.createDelegate(this,this.W);this.m=Function.createDelegate(this,this.bc);this.l=Function.createDelegate(this,this.bb);this.I=Function.createDelegate(this,this.bh);_Ewa.bei.initializeBase(this,[t,null]);u=i.c();this.a=i;this.d=i.a();this.q=n;this.M=t;this.v=r;e=this.dA.currentStyle;f="#000000";e&&(f=e.borderTopColor);this.c=new _Ewa.xF(this.L(),f,u);this.b=new _Ewa.xF(this.L(),f,u);this.r=u.c().b()&&u.l().NovMode===1;this.c.j(this.I);this.c.i(this.l);this.c.k(this.m);this.b.j(this.z);this.b.i(this.l);this.b.k(this.m);for(var h=this.a.G(),l=h.length,o=0;o<l;++o)s=h[o],Common.l.a().a("touchstart",s.j(),this.D),Common.l.a().a("touchend",s.j(),this.C);i.h().d(this.K);i.g().c(this.x);i.k().g(this.G);i.bL(this.y);u.R(this.n);i.t(this.n);this.d.k(this.F);this.d.s(this.H);i.K(this.A);this.d.z(this.B);_Ewa.E.g(this.E);u.a(828)&&(c=this,_Ewa.f.cw(_Ewa.l.b(_Ewa.hI,u.b(),376,377,-2),function(n){n.a().a(c.J)},u.i(),3))};_Ewa.bei.prototype={q:null,M:null,c:null,b:null,d:null,k:!1,o:!1,u:!1,r:!1,i:null,v:0,t:!1,f:!1,a:null,dispose:function(){var t,i;System.a.b([this.c,this.b]);this.c.n(this.I);this.c.m(this.l);this.c.o(this.m);this.b.n(this.z);this.b.m(this.l);this.b.o(this.m);for(var r=this.a.G(),u=r.length,n=0;n<u;++n)t=r[n],Common.l.a().b("touchstart",t.j(),this.D),Common.l.a().b("touchend",t.j(),this.C);this.a.h().b(this.K);this.a.g().d(this.x);this.a.k().h(this.G);this.a.bP(this.y);this.a.c().S(this.n);this.a.y(this.n);this.d.l(this.F);this.d.t(this.H);this.a.L(this.A);this.d.x(this.B);_Ewa.E.h(this.E);this.a.c().a(828)&&(this.f&&Diag.a.a(591959439,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode"),i=this.a.c().b().a(_Ewa.hI,376,!1),i&&i.c(this.J));_Ewa.gK.prototype.dispose.call(this)},j:function(){if(!this.q.b||!this.q.b.g(this.g()))return!1;if(this.a.c().isChangeGateEnabled("OfficeVSO:3603754_FixRangePickerGrippiesRowCol")){var n=!this.a.E().a();if(this.a.m()&&n&&(this.g().k()||this.g().n()))return!1}else if(this.a.m()&&(this.g().k()||this.g().n()))return!1;return _Ewa.E.a===3},e:function(){this.k&&(this.c.set_visible(!1),this.b.set_visible(!1),this.k=!1,this.a.c().a(828)&&this.w())},h:function(){var c,l,o;if(this.j()){this.bm();var s=_Ewa.a.i(this.i),t=_Ewa.a.i(this.M),n=new Sys.UI.Bounds(t.x-s.x,t.y-s.y,t.width,t.height),i=this.g(),a=i.e(),v=i.p(),h=i.k()||i.n(),r,f,u,e;i.n()?(c=this.R(),r=n.x-18,f=c,u=n.x+t.width,e=c):i.k()?(l=this.Q(),r=l,f=n.y-18,u=l,e=n.y+t.height):(f=n.y,e=n.y+t.height,this.a.d()?(r=n.x+t.width,u=n.x):(r=n.x,u=n.x+t.width));o=h?0:9;this.c.cy().left=r-o+"px";this.c.cy().top=f-o+"px";this.b.cy().left=u-o+"px";this.b.cy().top=e-o+"px";this.c.set_visible(this.N(f,r,a,h,s));this.b.set_visible(this.N(e,u,v,h,s));this.k=!0}},N:function(n,t,i,r,u){var f=3,e=_Ewa.a.i(this.a.n(this.v).j()),o=new Sys.UI.Bounds(e.x-u.x-f,e.y-u.y-f,e.width+2*f,e.height+2*f);return(this.a.i().c(i)===this.v||r)&&Common.g.c(o,new Sys.UI.Point(t,n))},bm:function(){if(!!(this.r^this.o)){this.i=null;var n=this.L();this.c.r(n);this.b.r(n)}},R:function(){return(this.a.h().a().d()+this.a.i().a.b-9)/2},Q:function(){return(this.a.h().a().c()+this.a.i().a.a-9)/2},bj:function(){this.k&&this.t?this.h():this.e()},Z:function(n){return n.b===3&&(this.t=!0,this.h()),!1},ba:function(n){if(n.b===3){if(!n.c||this.S(n))return!1;this.t=!1;this.e()}return!1},S:function(n){return _Ewa.a.K(n.c,"ewa-scrollbars")&&(this.T(n)||this.U(n))},U:function(n){var t,i,r;return this.a.d()?t=n.get_clientPoint().x:(i=_Ewa.a.i(n.c),r=i.x+i.width-_Ewa.Z.a(),t=n.get_clientPoint().x-r),t>0&&t<=_Ewa.Z.a()},T:function(n){var t=_Ewa.a.i(n.c),r=t.y+t.height-_Ewa.Z.a(),i=n.get_clientPoint().y-r;return i>0&&i<=_Ewa.Z.a()},be:function(){this.f&&this.w();this.h();this.u=!1},bg:function(){this.e();this.u=!0},bf:function(n,t){t.a===this.p()&&(t.c?this.u||this.h():this.e())},bh:function(){this.O(this.c.cl(),!1)},W:function(){this.O(this.b.cl(),!0)},bb:function(n,t){this.d.F(t)},O:function(n,t){this.f&&Diag.a.a(591959438,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.d.V(n,t,this.f);this.e()},bc:function(n,t){_Ewa.s.j(this.a.c())&&this.d.F(_Ewa.kE.b(t))},bd:function(){_Ewa.E.a===3?this.h():this.e();this.a.c().a(828)&&this.f&&_Ewa.E.a===1&&this.w()},bi:function(){this.bl()},bl:function(){this.f||(Diag.a.a(591959437,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.f=!0,this.c.p(),this.b.p(),this.a.a().y(this.a.a().a()),this.h())},w:function(){this.f&&(Diag.a.a(591959436,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.f=!1,this.c.q(),this.b.q())},L:function(){if(!this.i){if(this.o=!1,this.r){var n=this.a.c().b().a(_Ewa.gM,22,!1);if(n)return this.o=!0,this.i=n.c()}this.i=this.a.A()}return this.i},P:function(){this.e()},X:function(){this.d.b().a()&&this.e()},V:function(){this.e()},Y:function(n,t){this.a.c().a(828)&&this.w();t.b===3?this.h():this.e()},bk:function(){this.k&&(this.e(),this.h())}};_Ewa.xF=function(n,t,i){this.g=Function.createDelegate(this,this.s);this.e=Function.createDelegate(this,this.u);this.f=Function.createDelegate(this,this.v);this.h=Function.createDelegate(this,this.t);_Ewa.xF.initializeBase(this,[document.createElement("div"),null]);this.a=i;Sys.UI.DomElement.addCssClass(this.cl(),"ewr-grippie");Sys.UI.DomElement.addCssClass(this.cl(),"ewr-grippie-circle-container");n.appendChild(this.cl());_Ewa.a.b(this.cl(),!1,!0);this.b=document.createElement("div");Sys.UI.DomElement.addCssClass(this.b,"ewr-grippie-circle");this.b.style.borderColor=t;this.cl().appendChild(this.b);Common.f.a().a("msospPointerDown",this.cl(),this.h);Common.f.a().a("msospPointerUp",this.cl(),this.f);Common.l.a().a("touchend",this.cl(),this.f);Common.f.a().a("msospPointerMove",this.cl(),this.e);Common.l.a().a("touchmove",this.cl(),this.e);Common.i.a().a("click",this.cl(),this.g)};_Ewa.xF.prototype={b:null,d:null,c:!1,a:null,j:function(n){this.cv("GrDrag",n)},n:function(n){this.cx("GrDrag",n)},i:function(n){this.cv("GrContxt",n)},m:function(n){this.cx("GrContxt",n)},k:function(n){this.cv("GrPointerUp",n)},o:function(n){this.cx("GrPointerUp",n)},dispose:function(){Common.j.e(this.cl());_Ewa.VA.prototype.dispose.call(this)},r:function(n){this.cl().parentNode.removeChild(this.cl());n.appendChild(this.cl())},p:function(){Sys.UI.DomElement.removeCssClass(this.cl(),"ewr-grippie-circle-container");Sys.UI.DomElement.removeCssClass(this.b,"ewr-grippie-circle");Sys.UI.DomElement.addCssClass(this.b,"ewr-grippie-square")},q:function(){Sys.UI.DomElement.removeCssClass(this.b,"ewr-grippie-square");Sys.UI.DomElement.addCssClass(this.b,"ewr-grippie-circle");Sys.UI.DomElement.addCssClass(this.cl(),"ewr-grippie-circle-container")},t:function(n){if(this.a.isChangeGateEnabled("OfficeVSO:4181203_FloatieMenuIncorrectPlaceInZoom")&&(n=_Ewa.x.a(this.a)?_Ewa.x.a(this.a).a(n):n),this.c=!1,_Ewa.E.b(n.b)===3){var t=n.a.rawEvent,i=t.srcElement||t.target;_Ewa.a.h(this.cl(),i)&&_Ewa.a.h(t.currentTarget,i)&&(this.c=!0,this.d=n.get_clientPoint())}return!1},v:function(n){return this.a.isChangeGateEnabled("OfficeVSO:4181203_FloatieMenuIncorrectPlaceInZoom")&&(n=_Ewa.x.a(this.a)?_Ewa.x.a(this.a).a(n):n),this.cn("GrPointerUp",n),this.c=!1,!1},u:function(n){return this.a.isChangeGateEnabled("OfficeVSO:4181203_FloatieMenuIncorrectPlaceInZoom")&&(n=_Ewa.x.a(this.a)?_Ewa.x.a(this.a).a(n):n),n.b===3&&this.c&&this.l(n.get_clientPoint())&&(this.cn("GrDrag",null),this.c=!1),!1},s:function(n){return this.a.isChangeGateEnabled("OfficeVSO:4181203_FloatieMenuIncorrectPlaceInZoom")&&(n=_Ewa.x.a(this.a)?_Ewa.x.a(this.a).a(n):n),_Ewa.s.j(this.a)||n.b!==3||this.l(n.get_clientPoint())||this.cn("GrContxt",new Common.bj(n.a,this.cl(),n.get_clientPoint(),3)),!0},l:function(n){return!!this.d&&(Math.abs(n.x-this.d.x)>3||Math.abs(n.y-this.d.y)>3)}};_Ewa.OA=function(n){_Ewa.OA.initializeBase(this,[!1]);n.b().b(_Ewa.hI,376,this)};_Ewa.OA.prototype={a:function(n){this.dE("TAF",n)},c:function(n){this.dF("TAF",n)},b:function(){this.dC("TAF",null,null)}};_Ewa.xD=function(n){_Ewa.xD.initializeBase(this);this.h=n;this.j()};_Ewa.xD.a=function(n){n.a(828)&&n.b().b(_Ewa.bbq.$$(_Ewa.hI),377,new _Ewa.xD(n))};_Ewa.xD.prototype={h:null,b:function(){this.i(this.h.b().a(_Ewa.hI,376,!1)||new _Ewa.OA(this.h))}};_Ewa.OJ=function(){};_Ewa.OJ.a=function(n,t,i,r,u,f,e){var o=n.a(41,e);return o.sourceRange=t,o.destinationRange=i,_Ewa.i.a(n,"RearrangeRowColumn",o,r,u,f,0,null)};_Ewa.xE=function(n){_Ewa.xE.initializeBase(this);this.h=n;this.j()};_Ewa.xE.a=function(n){n.b().b(_Ewa.bbq.$$(Sys.IDisposable),149,new _Ewa.xE(n))};_Ewa.xE.prototype={h:null,b:function(){var n=this;_Ewa.f.cw(_Ewa.l.a(_Ewa.dq,this.h.b(),134,this.dD(),this.l),function(t){n.i(n.h.b().a(Sys.IDisposable,64,!1)||new _Ewa.OK(n.h,t.a()))},this.dD(),3)}};_Ewa.Ls.registerClass("_Ewa.Ls");_Ewa.Ow.registerClass("_Ewa.Ow",_Ewa.cq);_Ewa.bei.registerClass("_Ewa.bei",_Ewa.Zx);_Ewa.Ox.registerClass("_Ewa.Ox",_Ewa.bei);_Ewa.qb.registerClass("_Ewa.qb",_Ewa.Zx);_Ewa.bee.registerClass("_Ewa.bee",_Ewa.qb);_Ewa.Oy.registerClass("_Ewa.Oy",_Ewa.bee);_Ewa.gQ.registerClass("_Ewa.gQ",_Ewa.bee);_Ewa.Oz.registerClass("_Ewa.Oz",_Ewa.qb);_Ewa.nn.registerClass("_Ewa.nn",_Ewa.Zx);_Ewa.OB.registerClass("_Ewa.OB");_Ewa.OC.registerClass("_Ewa.OC",Sys.EventArgs);_Ewa.OD.registerClass("_Ewa.OD",_Ewa.Zx);_Ewa.OE.registerClass("_Ewa.OE",_Ewa.bei);_Ewa.OF.registerClass("_Ewa.OF",_Ewa.Zx);_Ewa.beg.registerClass("_Ewa.beg",_Ewa.Zx);_Ewa.OG.registerClass("_Ewa.OG",_Ewa.beg);_Ewa.OH.registerClass("_Ewa.OH",_Ewa.beg);_Ewa.kc.registerClass("_Ewa.kc",_Ewa.Zx);_Ewa.OK.registerClass("_Ewa.OK",_Ewa.Ya);_Ewa.OL.registerClass("_Ewa.OL",_Ewa.Zx);_Ewa.kd.registerClass("_Ewa.kd",_Ewa.Zx);_Ewa.OM.registerClass("_Ewa.OM",_Ewa.bei);_Ewa.xF.registerClass("_Ewa.xF",_Ewa.VA);_Ewa.OA.registerClass("_Ewa.OA",_Ewa.cq,_Ewa.hI,Sys.IDisposable);_Ewa.xD.registerClass("_Ewa.xD",_Ewa.qc.$$(_Ewa.hI));_Ewa.xE.registerClass("_Ewa.xE",_Ewa.qc.$$(Sys.IDisposable));_Ewa.gQ.a=[6];_Ewa.nn.a=[1,2,32,256,128,64];Type.registerNamespace("_Ewa");_Ewa.beh=function(){};_Ewa.beh.a=function(){_Ewa.j.a(_Ewa.xE.a);_Ewa.j.a(_Ewa.xD.a)};_Ewa.beh.a();