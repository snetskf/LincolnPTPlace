var excelOnlineCalc=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return c})),r.d(t,"f",(function(){return s}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function a(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function u(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}c((n=n.apply(e,t||[])).next())}))}function c(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}function s(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,a++)n[a]=i[o];return n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9);t.utils=n;var a=r(10);t.ULS=a.ULS,t.TraceLevel=a.TraceLevel,t.LogCategory=a.LogCategory,t.NulLogger=a.NulLogger,t.ConsoleLogger=a.ConsoleLogger;var i=r(11);t.browserSupport=i;var o=r(12);t.perfWatch=o;var u=r(13);t.initEwaUtils=u.initEwaUtils,t.ewaUtils=u.ewaUtils;var c=r(14);t.initStopwatchFactory=c.initStopwatchFactory;var s=r(15);t.getNewGuid=s.getNewGuid;var l=r(16);t.TextAreaVirtualKeyboardPolicy=l.TextAreaVirtualKeyboardPolicy,t.TextAreaInputMode=l.TextAreaInputMode},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.mathpack=n;var a=r(20);t.dtr=a,r(4)._start()},function(e,t,r){"use strict";r.r(t);var n=r(0);function a(e){return o(e)&&"WorkerError"===e.name&&"object"==typeof e.info}var i=function(e){function t(t,r){var n=this.constructor,a=e.call(this,t)||this;a.info=r,a.name="WorkerError";var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}return Object(n.c)(t,e),t.isWorkerError=a,t}(Error);function o(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function u(e){return o(e)?e:new Error("(non-Error object) "+e)}var c={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function s(e){return{name:e.name,message:e.message,stack:e.stack,info:a(e)?(t=e.info,Object(n.a)(Object(n.a)({},t),{error:t.error?s(t.error):void 0})):void 0};var t}function l(e){return o(e)?{isError:!0,value:s(e)}:{isError:!1,value:e}}function f(e){var t;if("WorkerError"===e.name)t=new i(e.message,function(e){return Object(n.a)(Object(n.a)({},e),{error:e.error?f(e.error):void 0})}(e.info));else{var r=c[e.name];r?t=new r(e.message):(t=new Error(e.message)).name=e.name}return null!=e.stack&&(t.stack=e.stack),t}function d(e){return e.isError?f(e.value):e.value}function h(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}function p(e,t,r){if(e>1<<30)return r;var n=setTimeout(t,Math.max(0,e));return{resolve:function(e){clearTimeout(n),r.resolve(e)},reject:function(e){clearTimeout(n),r.reject(e)}}}function v(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function m(e,t){var r=v(),n=function(t,r){var n;return null!=(n=t[r])?n:t[r]=e(r)};return t?(t.forEach((function(e){return n(r,e)})),r):new Proxy(r,{get:n})}function g(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}var C;function S(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}function E(e){if(C)throw new TypeError("setConfig has already been called");C=e}function y(){var e=null!=C?C:{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?Object(n.f)(e.importScriptUrls):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName}}function O(e,t){var r,n=null!=(r=t.stack)?r:t.message;console.warn(e+": "+n),a(t)&&console.warn("WorkerError info:",t.info)}function A(e){if(g()){var t={kind:1,error:l(e)};self.postMessage(t)}else O("defaultOnWorkerError",e)}function k(e){var t,r;try{(null!=(r=null===(t=C)||void 0===t?void 0:t.onWorkerError)?r:A)(e)}catch(t){O("dispatchWorkerError",u(t)),O("dispatchWorkerError (original)",e)}}function R(e){if(g()){var t={kind:2,stats:e};self.postMessage(t)}}function b(e){var t,r;try{(null!=(r=null===(t=C)||void 0===t?void 0:t.onCreateWorker)?r:R)(e)}catch(e){O("dispatchCreateWorker",u(e))}}var I=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return I.transfer.apply(I,Object(n.f)([e,void 0],t))};I.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var T=-1,N=function(){function e(e,t){var r,n,a=this;this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=v();var i=function(){var e,t;return null===(t=(e=a).onClose)||void 0===t?void 0:t.call(e)},o=((r={})[0]=this.onInvoke.bind(this),r[1]=this.onResult.bind(this),r[2]=function(e){var t,r,n=e.funcNames;null===(r=(t=a).onImports)||void 0===r||r.call(t,m(a.createPostProxy.bind(a),n),m(a.createCallProxy.bind(a),n))},r[3]=i,r),u=((n={})[0]=this.onSendInvokeFailed.bind(this),n[1]=this.onSendResultFailed.bind(this),n[2]=i,n[3]=i,n);this.port.onmessage=function(e){var t=e.data;return o[t.kind](t)},this.port.onmessageerror=function(e){var t=e.data;return u[t.kind](t)}}return e.prototype.setExports=function(e){this.exports=e;var t={kind:2,funcNames:"function"==typeof Proxy?void 0:function(e){for(var t=v();null!=e;){for(var r=0,n=Object.getOwnPropertyNames(e);r<n.length;r++){var a=n[r];try{"function"==typeof e[a]&&(t[a]=!0)}catch(e){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)}(e)};this.port.postMessage(t)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;for(var e in this.port.postMessage({kind:3}),this.port.close(),this.unresolvedCalls){var t=this.unresolvedCalls[e],r=t.reject,n=t.funcName,a={cause:"Connection",idInfo:this.idInfo,funcName:n};r(new i("Importing Endpoint closed while waiting for "+n+" result",a))}}},e.prototype.onInvoke=function(e){var t=this,r=e.callId,n=e.funcName,a=e.args,o=Promise.resolve().then((function(){var e=t.exports[n];if(e)return e.apply(t.exports,a);var o=r>=0?"call":"post",u={cause:"Connection",idInfo:t.idInfo,callId:r,funcName:n};throw new i("Exporting Endpoint received a "+o+" to unknown function "+n,u)}));r>=0?o.then((function(e){return t.sendResult(r,n,!0,e)}),(function(e){return t.sendResult(r,n,!1,e)})):o.catch((function(e){return t.sendResult(r,n,!1,e)}))},e.prototype.sendResult=function(e,t,r,n){var a={kind:1,callId:e,funcName:t,isFulfilled:r,resultValue:l(n)};try{this.port.postMessage(a,void 0)}catch(e){this.onSendResultFailed(a,u(e))}},e.prototype.onSendResultFailed=function(e,t){var r=e.callId,n=e.funcName,a=e.resultValue,o=t?"Exporting Endpoint failed to send "+n+" result":"Importing Endpoint failed to deserialize "+n+" result",u={cause:"MessageError",idInfo:this.idInfo,error:t,callId:r,funcName:n},c=new i(o,u);a.isError?k(c):this.sendResult(r,n,!1,c)},e.prototype.takeCallbacks=function(e){var t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t},e.prototype.setCallTimeout=function(e,t,r,n){var a=this;if(r>1<<30)return n;return p(r,(function(){var n=a.takeCallbacks(e);if(n){var o={cause:"Timeout",idInfo:a.idInfo,timeout:r,callId:e,funcName:t};n.reject(new i("Importing Endpoint's call to "+t+" timed out",o))}}),n)},e.prototype.sendCall=function(e,t,r,a){var o=this;return new Promise((function(c,s){var l=T+=1,f={kind:0,callId:l,funcName:e,args:t};o.unresolvedCalls[l]=Object(n.a)(Object(n.a)({},o.setCallTimeout(l,e,r,{resolve:c,reject:s})),{funcName:e});try{o.port.postMessage(f,a)}catch(t){var d=o.takeCallbacks(l);if(d){var h=u(t),p={cause:"MessageError",idInfo:o.idInfo,error:h,callId:l,funcName:e};d.reject(new i("Importing Endpoint failed to send call to "+e,p))}}}))},e.prototype.sendPost=function(e,t,r){var n={kind:0,callId:-1,funcName:e,args:t};try{this.port.postMessage(n,r)}catch(t){var a=u(t),o={cause:"MessageError",idInfo:this.idInfo,error:a,callId:-1,funcName:e};throw new i("Importing Endpoint failed to post to "+e,o)}},e.prototype.onSendInvokeFailed=function(e){var t,r,n=e.callId,a=e.funcName,o=n>=0?"call":"post",u={cause:"MessageError",idInfo:this.idInfo,callId:n,funcName:a},c=new i("Exporting Endpoint failed to deserialize "+o+" to "+a,u);(null!=(r=null===(t=n>=0?this.takeCallbacks(n):void 0)||void 0===t?void 0:t.reject)?r:k)(c)},e.prototype.onResult=function(e){var t=e.callId,r=e.funcName,n=e.isFulfilled,a=e.resultValue;if(t>=0){var o=this.takeCallbacks(t);if(o)(n?o.resolve:o.reject)(d(a))}else if(!n){var u=a.isError?f(a.value):void 0,c={cause:"UnhandledError",idInfo:this.idInfo,error:u,callId:t,funcName:r};k(new i("Exporting Endpoint's "+r+" implementation threw or rejected",c))}},e.prototype.createPostProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.f)([void 0],e))};return r.transfer=function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];t.isClosed||t.sendPost(e,n,r)},r},e.prototype.createCallProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.f)([void 0],e))};return r.transfer=function(n){for(var a,o,u,c,s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];if(t.isClosed){var f={cause:"Connection",idInfo:t.idInfo,funcName:e};return Promise.reject(new i(t.idInfo.side+" Endpoint's call."+e+" called after close",f))}var d=null!=(c=null!=(a=r.timeout)?a:null===(u=(o=t).getCallTimeout)||void 0===u?void 0:u.call(o))?c:1/0;return t.sendCall(e,s,d,n)},r.timeout=void 0,r},e}();var F,_=function(){function e(e,t,r){this.callTimeout=1/0,this._idInfo=e,this._state=t,this.createMode=r;var n=function(t){return function(){var r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new i(e.side+" Endpoint's "+t+" referenced before the "+r+" Endpoint started",n)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}return e._create=function(t,r,n){var a,o,u,c=r.port,s=r.options,l=r.createMode,f={type:"Endpoint",side:t,id:null===(a=s)||void 0===a?void 0:a.id};try{o=new N(f,c),u=new e(f,o,l)}catch(e){return Promise.reject(e)}return new Promise((function(e,r){var a;o.getCallTimeout=function(){return u.callTimeout},o.onImports=function(e,t){Object.defineProperties(u,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),d.resolve()},o.onClose=function(){return u.close("Force")};var c,l=function(e){var t,r,n,a;return null!=(a=null!=(r=null===(t=e)||void 0===t?void 0:t.createTimeout)?r:null===(n=C)||void 0===n?void 0:n.createTimeout)?a:3e5}(s),d=p(l,(function(){var e=new i(t+" Endpoint timed out waiting for the "+("Outside"===t?"inside":"outside")+" to start",{cause:"Timeout",idInfo:f,timeout:l});d.reject(e)}),{resolve:e,reject:r});u._closedDuringCreate=function(){d.resolve()};try{c=n(u)}catch(e){return d.reject(e)}null===(a=u._state)||void 0===a||a.setExports(c)})).then((function(){return u._closedDuringCreate=void 0,u}),(function(e){return u._closedDuringCreate=void 0,u.close(),Promise.reject(e)}))},e.prototype.hasBeenClosed=function(){return void 0===this._state},e.prototype.close=function(e){var t,r;if(this._state){if(this._closedDuringCreate){if("Force"!==e){var n={cause:"Connection",idInfo:this._idInfo};throw new i(this._idInfo.side+" Endpoint's close called during creation",n)}this._closedDuringCreate()}var a=this._state;this._state=void 0;try{a.close(),null===(t=this._onClose)||void 0===t||t.call(this),null===(r=this.onClose)||void 0===r||r.call(this)}catch(e){n={cause:"Connection",idInfo:this._idInfo,error:u(e)};k(new i(this._idInfo.side+" Endpoint's close threw an error",n))}}},e.createOutside=function(t,r){return void 0===r&&(r=function(){}),e._create("Outside",t,r)},e.createInside=function(t,r){return e._create("Inside",t,r).then((function(){}))},e}(),M=function(){!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){r.r(t);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function i(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,a++)n[a]=i[o];return n}function o(e){return u(e)&&"WorkerError"===e.name&&"object"==typeof e.info}!function(e){function t(t,r){var n=this.constructor,a=e.call(this,t)||this;a.info=r,a.name="WorkerError";var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}(function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(t,e),t.isWorkerError=o}(Error);function u(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError;function c(e){return{name:e.name,message:e.message,stack:e.stack,info:o(e)?(t=e.info,a(a({},t),{error:t.error?c(t.error):void 0})):void 0};var t}function s(e){throw new ReferenceError(e+" is not defined")}function l(e,t,r){void 0===r&&(r=s);try{for(var n=t.split("."),a=0,i=n;a<i.length;a++){e=e[i[a]]}return null!=e?e:r(t)}catch(e){return r(t)}}var f=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return f.transfer.apply(f,i([e,void 0],t))};f.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var d="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function h(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:d()))}self.onmessage=function(e){var t,r=e.data,n=r.config,a=r.port,s=r.options,f=r.script,p=r.args;function v(){var e;if(t)return t;if(void 0===n.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return importScripts(n.typedWorkersUrl),(t=l(self,null!=(e=n.typedWorkersName)?e:"typedWorkers")).setConfig(n),t}self.onmessage=null,self.__typed_workers_thread=!0;var m={status:"Pending",start:d()};function g(e,t){var r,n={kind:0,error:e?void 0:(r=function(e){return u(e)?e:new Error("(non-Error object) "+e)}(t),u(r)?{isError:!0,value:c(r)}:{isError:!1,value:r}),stopwatch:m};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw h(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!=(r=h(e,"Success"))?r:t}),r)}catch(e){r(e)}})(m,(function(){var e,t,r;return importScripts.apply(void 0,i(null!=(r=null!=(t=null===(e=s)||void 0===e?void 0:e.importScriptUrls)?t:n.importScriptUrls)?r:[],void 0!==f.scriptUrl?[f.scriptUrl]:[])),l(self,f.insideInitName).apply(void 0,i([{config:n,importTypedWorkers:v,connection:{port:a,options:s,createMode:"Thread"}}],p))})).then((function(){return g(!0)}),(function(e){return g(!1,e)}))}catch(e){g(!1,e)}}}])},w=-1;function L(){return void 0===F&&(F="("+M.toString()+")();"),F}var D=function(){function e(e){var t,r;try{var n;t=function(e){var t="def"in e?e:I(e),r=t.def,n=t.args,a=t.transferables;if("function"!=typeof r)return[r,n,a,void 0];var i="__generatedInsideInit"+(w+=1);return[{scriptUrl:void 0,insideInitName:i},n,a,"var "+i+" = "+r.toString()+";"]}(e),this.script=t[0],this.args=t[1],this.transferables=t[2];var a=void 0===(n=t[3])?[L()]:[n,"\n\n",L()];this.blobUrl=URL.createObjectURL(new Blob(a,{type:"application/javascript"})),this.worker=new Worker(this.blobUrl)}catch(e){throw null===(r=this.worker)||void 0===r||r.terminate(),this.revokeBlobUrl(),e}}return e.prototype.revokeBlobUrl=function(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(e,t){var r=this,u=e.port,c=e.options,s={type:"Thread",side:"Outside",id:c.id},l=this.worker;return h(new Promise((function(e,f){r.createCallbacks={resolve:e,reject:f};var h={config:y(),port:u,options:c,script:r.script,args:r.args};l.postMessage(h,Object(n.f)([u],r.transferables)),l.onerror=function(e){e.preventDefault();var t=function(e,t,r){if(o(r.error)){if(a(r.error))return r.error;var n={cause:"UnhandledError",idInfo:e,error:r.error};return new i(t+" received an unhandled error",n)}if(null==r.message)return new i(t+" received a non-error (worker script fetch probably failed)",{cause:"UnhandledError",idInfo:e});var u={cause:"UnhandledError",idInfo:e},c=r.message+" at "+r.filename+":"+r.lineno+":"+r.colno;return new i(t+" received an unhandled error: "+c,u)}(s,"worker.onerror",e);r.createCallbacks?r.createCallbacks.reject(t):k(t)},l.onmessage=function(e){var n,a,i=e.data;switch(i.kind){case 0:return t.insideInit=i.stopwatch,void 0===i.error?null===(n=r.createCallbacks)||void 0===n?void 0:n.resolve():null===(a=r.createCallbacks)||void 0===a?void 0:a.reject(d(i.error));case 1:return k(d(i.error));case 2:return b(i.stats)}}})),(function(){r.createCallbacks=void 0}))},e.prototype.terminate=function(){var e;if(this.worker){var t=this.worker;this.worker=void 0,null===(e=this.createCallbacks)||void 0===e||e.resolve(),t.terminate(),this.revokeBlobUrl()}},e}(),U="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function x(){return{status:"Pending",start:U()}}function P(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:U()))}function G(e,t){function r(t){throw P(e,a(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!=(r=P(e,"Success"))?r:t}),r)}catch(e){r(e)}}function V(e){return Math.round(1e3*e)/1e3}function W(e,t,r){return e<t?t:e>r?r:e}function B(e,t,r){var n,a,i,o,u,c,s=W(null!=(a=null===(n=e)||void 0===n?void 0:n.start)?a:1/0,t,r),l=W(null!=(o=null===(i=e)||void 0===i?void 0:i.end)?o:1/0,t,r);return{status:(c=null===(u=e)||void 0===u?void 0:u.status,null!=c?c:"Pending"),start:V(s-t),end:V(l-t),duration:V(l-s)}}var j=function(){return r(3)};function H(e,t,r,n,a){var i,o=new MessageChannel,u=o.port1,c=o.port2;return Promise.all([n({port:u,options:e,createMode:t}),G(r.createOutside=x(),(function(){return _.createOutside({port:c,options:e,createMode:t},(function(e){return a(i=e)}))}))]).then((function(){return i}),(function(e){return i?i.close("Force"):c.close(),Promise.reject(e)}))}function K(e,t,r,a){return H(e,"Local",t,(function(e){return function(e,t,r){var a="def"in r?r:I(r),o=a.def,u=a.args;if("function"!=typeof o){var c={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new i("Loading an InsideScript to create a local worker is unimplemented",c))}return Promise.resolve().then((function(){return G(t.insideInit=x(),(function(){return o.apply(void 0,Object(n.f)([{config:y(),importTypedWorkers:j,connection:e}],u))}))}))}(e,t,r)}),a)}function q(e,t,r,n){var a;t.createThread=x();try{a=new D(r)}catch(e){return P(t.createThread,"Error"),Promise.reject(e)}return P(t.createThread,"Success"),H(e,"Thread",t,(function(e){return a.createInside(e,t)}),n).then((function(e){return e.hasBeenClosed()?a.terminate():e._onClose=a.terminate.bind(a),e}),(function(e){return a.terminate(),Promise.reject(e)}))}function J(e,t,r){void 0===r&&(r=function(){});var n=function(e){var t,r,n,a,i=null!=(a=null!=(r=null===(t=e)||void 0===t?void 0:t.createMode)?r:null===(n=C)||void 0===n?void 0:n.createMode)?a:"Thread";return"ThreadOrLocal"===i?S()?"Thread":"Local":i}(e),a="local"in t?"Local"===n?t.local:t.thread:t,i="Local"===n?K:q,o={id:e.id,createMode:n,createWorker:x()};return h(G(o.createWorker,(function(){return i(function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls}}(e),o,a,r)})),(function(){var e=function(e){var t=e.id,r=e.createMode,n=e.createWorker,a=e.insideInit,i=e.createOutside,o=e.createThread,u=n.status,c=n.start,s=n.end;if("Pending"!==u&&void 0!==s)return{id:t,createMode:r,createWorker:{status:u,absStart:c,duration:V(s-c)},createThread:"Thread"===r?B(o,c,s):void 0,createOutside:B(i,c,s),insideInit:B(a,c,s)}}(o);e&&b(e)}))}r.d(t,"WorkerError",(function(){return i})),r.d(t,"isThreadingSupported",(function(){return S})),r.d(t,"setConfig",(function(){return E})),r.d(t,"paramInsideDef",(function(){return I})),r.d(t,"Endpoint",(function(){return _})),r.d(t,"createWorker",(function(){return J}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__growWasmMemory=t.stackRestore=t.stackAlloc=t.stackSave=t.setThrew=t.__errno_location=t._start=t.Mathpack_Pack=t.Mathpack_FormatGeneral=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Acos=t.Mathpack_Asin=t.Mathpack_Tan=t.Mathpack_Cos=t.Mathpack_Sin=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_Exp=t.Mathpack_Sqrt=t.Mathpack_ViewRound=t.Mathpack_Equal=t.Mathpack_GetExp32=t.Mathpack_Compare=t.Mathpack_RoundDown=t.Mathpack_RoundUp=t.Mathpack_Round=t.Mathpack_SFix=t.Mathpack_LFix=t.Mathpack_Fix=t.Mathpack_SFloat=t.Mathpack_Float=t.Mathpack_Neg=t.Mathpack_Abs=t.Mathpack_Floor=t.Mathpack_Ceil=t.Mathpack_Trunc=t.Mathpack_TakeMathError=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Power=t.Mathpack_Add=t.Mathpack_Sub=t.Mathpack_Mul=t.Mathpack_Div=t.Mathpack_Pi=t.Mathpack_One=t.Mathpack_Zero=t.Dtr_ToNum=t.Dtr_FracSec=t.Dtr_Wdy=t.Dtr_Sec=t.Dtr_Min=t.Dtr_Hour=t.Dtr_DOM=t.Dtr_Mon=t.Dtr_Yr=t.Dtr_FromNum=t.Dtr_DaysPerMonth=t.Base_StrBufSize=t.Base_StrBuf=t.memory=void 0;var n=r(17),a=r(18),i=r(19),o=new ArrayBuffer(8),u=new Int32Array(o),c=(new Float32Array(o),new Float64Array(o));function s(e){return u[e]}function l(e,t){u[e]=t}function f(){return c[0]}function d(e){c[0]=e}var h,p=new ArrayBuffer(65536),v=(h=new Uint8Array(p),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)h[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)h[e+n]=r[n]});v(1024,"+AgAAAEAAAACAAAAAwAAAAAAAAAE"),v(1056,"yAgAANAIAADYCAAA4AgAAB8dHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8dHx4fHh8fHh8eHw=="),v(1152,"kAgAAKgIAACgCAAAsAg="),v(1175,"oAQ="),v(1191,"yAc="),v(1207,"+go="),v(1222,"QJwO"),v(1238,"UMMR"),v(1254,"JPQU"),v(1269,"gJaYGA=="),v(1285,"ILy+Gw=="),v(1301,"KGvuHg=="),v(1317,"+QKVIg=="),v(1332,"QLdDuiU="),v(1348,"EKXU6Cg="),v(1364,"KueEkSw="),v(1379,"gPQg5rUv"),v(1395,"oDGpX+My"),v(1411,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//wAAAAAYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),v(2214,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQQEAAAQBA=="),v(2401,"Sg==");var m=function(e,t,r){var n=new e.Int8Array(r),a=new e.Int16Array(r),i=new e.Int32Array(r),o=new e.Uint8Array(r),u=new e.Uint16Array(r),c=new e.Uint32Array(r),h=(new e.Float32Array(r),new e.Float64Array(r)),p=e.Math.imul,v=(e.Math.fround,e.Math.abs),m=(e.Math.clz32,e.Math.min),g=(e.Math.max,e.Math.floor),C=e.Math.ceil,S=e.Math.sqrt,E=t.abort,y=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),O=t.Base_LocaleGetOrdinal,A=t.Base_LocaleDecimalSeparator,k=t.Math_log10,R=t.Math_log,b=(S=t.Math_sqrt,t.Math_sin),I=t.Math_cos,T=t.Math_tan,N=t.Math_atan,F=t.Math_exp,_=t.proc_exit,M=18784;function w(){}function L(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=o[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=o[0|t],r=r+-1|0;);}function D(e,t){var r,c,l=0,f=0,p=0,v=0;if(f=2368,M=r=M-48|0,i[r+40>>2]=0,a[r+30>>1]=0,a[r+32>>1]=0,h[296]=e,c=G(e),h[296]=c,le(c,r+40|0,r),u[r+42>>1]){l=(0|(l=re(t)<<16))<0?100:l>>16,d(+t),p=0|s(1),s(0),(v=-65536&p)&&(2146435072!=(2146435072&p)?l=(0|v)<1?0-l|0:l:i[594]=1);e:{if(!((0|(l=a[r+40>>1]+l|0))>=a[r+42>>1])){if((0|l)<1){f=2200;break e}(255&l)>>>0>=o[r+30|0]||(n[r+30|0]=l)}se(2300,2368,r)}e=h[f>>3]}return M=r+48|0,e}function U(e,t){var r,n=0,a=0,o=0;if(h[296]=e,d(+e),a=0|s(1),s(0),o=a,a=0,(n=-65536&o)&&(2146435072!=(2146435072&o)?a=(0|n)<1:(i[594]=1,a=0)),i[593]=2147483647&o,J(h[274]),n=-65536&(o=i[593]))if(2146435072!=(2146435072&o)){if(!((0|n)<1))return V(8),0}else i[594]=1;r=Q(h[274],e),h[296]=Q(h[272],r),X(r),ie();e:{t:{if((n=i[593])>>>0>=65536){if(2146435072!=(2146435072&n))break t;i[594]=1}if(t){if(i[592]=0,i[593]=0,!a)break e;return t=i[541],i[592]=i[540],i[593]=t,h[296]}if(n=i[547],i[592]=i[546],i[593]=n,t=n,1^a|n>>>0<65536)break e;return i[593]=-2147483648^t,h[296]}he(e),oe(),t&&(h[296]=Q(h[273],h[296]))}return h[296]}function x(e,t,r){var n,o=0,c=0,s=0,l=0,f=0;if(M=n=M-16|0,r&&(s=r>>31,s^=s+r))for(r=(0|r)>0?1152:1648;(o=15&s)&&(c=a[(o=(o<<4)+r|0)+8>>1],f=P(h[e>>3],h[o>>3],n),t=t+c|0,a[n+14>>1]<=0?(o=u[n+6>>1],c=u[n+8>>1]):(c=i[n+4>>2],o=u[n+6>>1]<<1,a[n+6>>1]=o,l=i[n+8>>2],i[n+12>>2]=i[n+12>>2]<<1|l>>>31,c=l<<1|c>>>31,i[n+8>>2]=c,t=t+-1|0),(65535&o|1&c|0!=(0|f))>>>0<32769||(c=(o=i[n+8>>2])+1|0,i[n+8>>2]=c,c>>>0>=o>>>0||(c=(o=i[n+12>>2])+1|0,i[n+12>>2]=c,c>>>0>=o>>>0||(i[n+12>>2]=-2147483648,t=t+1|0))),o=i[n+12>>2],i[e>>2]=i[n+8>>2],i[e+4>>2]=o),r=r+240|0,s>>=4;);return M=n+16|0,t}function P(e,t,r){var n,i,o,u=0,c=0,l=0,f=0,h=0,v=0,m=0,g=0,C=0,S=0,E=0,y=0;return d(+t),f=0|s(1),h=65535&(c=0|s(0)),d(+e),S=0|s(1),u=0|s(0),l=S,i=p(g=65535&u,h),a[r>>1]=i,o=((65535&(E=p(C=u>>>16,h)))+(i>>>16)|0)+(65535&(m=p(c>>>=16,g)))|0,a[r+2>>1]=o,E=(((v=((65535&(u=p(n=65535&l,h)))+(E>>>16)|0)+(m>>>16)|0)+(65535&(m=p(c,C)))|0)+(65535&(y=p(S=65535&f,g)))|0)+(o>>>16)|0,a[r+4>>1]=E,m=(((((((65535&(v=p(f>>>=16,g)))+(u>>>16)|0)+(65535&(l=p(u=l>>>16,h)))|0)+(m>>>16)|0)+(y>>>16)|0)+(65535&(h=p(S,C)))|0)+(65535&(g=p(c,n)))|0)+(E>>>16)|0,a[r+6>>1]=m,C=((((((y=(l>>>16)+(v>>>16)|0)+(65535&(l=p(f,C)))|0)+(h>>>16)|0)+(g>>>16)|0)+(65535&(v=p(u,c)))|0)+(65535&(c=p(S,n)))|0)+(m>>>16)|0,a[r+8>>1]=C,v=((c=(((65535&(h=p(f,n)))+(l>>>16)|0)+(v>>>16)|0)+(c>>>16)|0)+(65535&(l=p(u,S)))|0)+(C>>>16)|0,a[r+10>>1]=v,u=(((65535&(f=p(u,f)))+(h>>>16)|0)+(l>>>16)|0)+(v>>>16)|0,a[r+12>>1]=u,a[r+14>>1]=(u>>>16)+(f>>>16),65535&(i|o|E)}function G(e){var t,r,n=0,a=0,o=0,u=0,l=0,f=0;return M=t=M-16|0,h[t+8>>3]=e,d(+e),n=0|s(1),a=0|s(0),r=n,(n&=2146435072)&&(i[t+8>>2]=a<<11,i[t+12>>2]=r<<11|a>>>21|-2147483648,u=(n=p(a=(n>>>20)-1022|0,39457)>>17)+-14|0,o=x(t+8|0,a,14-n|0),a=i[t+8>>2],(0|o)>=(0|(c[t+12>>2]<(a>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(o=x(t+8|0,o,1),a=i[t+8>>2],u=n+-15|0),n=u,u=(u=a)+(a=-2147483648>>>(31&o))|0,i[t+8>>2]=u,u>>>0>=a>>>0||(f=(l=i[t+12>>2])+1|0,i[t+12>>2]=f,f>>>0>=l>>>0||(i[t+12>>2]=-2147483648,o=o+1|0)),i[t+8>>2]=u&0-(a<<1),o=x(t+8|0,o,n),3071&(n=i[t+8>>2])?(a=n+1024|0,i[t+8>>2]=a,n>>>0<4294966272||(u=(n=i[t+12>>2])+1|0,i[t+12>>2]=u,o=(u>>>0<n>>>0)+o|0)):a=n,(0|o)<=-1023?(i[t+8>>2]=0,i[t+12>>2]=0):(0|(n=1071644672+(o<<20)|0))<=-1||(o=i[t+12>>2],i[t+8>>2]=o<<21|a>>>11,i[t+12>>2]=o>>>11&1048575|n|-2147483648&r),e=h[t+8>>3]),M=t+16|0,e}function V(e){var t;return t=i[594],i[594]=e,t}function W(){var e,t,r;return e=i[592],t=i[593],K(1048576),K(2146435072),a[1187]<0?(i[592]=e,i[593]=t,-2147483648):(r=te(),i[592]=e,i[593]=t,-2147483648^r)}function B(e){var t,r=0,n=0,a=0,i=0;if(d(+e),r=0|s(1),t=0|s(0),i=r,a=0,!((r=2047&(n=r>>>20))>>>0<1023||(a=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return l(0,n&t),l(1,0|i),+f();i&=n,l(0,0),l(1,0|i),a=+f()}return a}function j(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return i[592]=0,i[593]=-2147483648,n=x(2368,1,e),r=i[592],e=i[593],3071&r&&(t=i[593],(e=i[592]+1024|0)>>>0<1024&&(t=t+1|0),i[592]=e,i[593]=t,r=e,e=t),i[592]=e<<21|r>>>11,void(i[593]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(i[594]=1),i[592]=0,i[593]=0}function H(){var e=0,t=0,r=0;e:{if(r=i[592],t=-65536&(e=i[593])){if(2146435072==(2146435072&e))return i[594]=1,void ue();if((0|t)<1)break e}return void ue()}ue(),(0|r)==i[592]&&i[593]==(0|e)||J(1)}function K(e){h[296]=q(h[296],e)}function q(e,t){var r;return d(+(e+=t)),r=0|s(1),s(0),2146435072==(2146435072&r)&&(i[594]=1,e=h[275]),e}function J(e){h[296]=Q(h[296],e)}function Q(e,t){var r;return d(+(e-=t)),r=0|s(1),s(0),2146435072==(2146435072&r)&&(i[594]=1,e=h[275]),e}function X(e){h[296]=Y(h[296],e)}function Y(e,t){var r,n=0,a=0,o=0;return d(+e*t),n=0|s(1),r=0|s(0),0|2146435072!=(0|(a=2146435072&n))?(o=(a=!(a|o))?i[550]:r,n=a?i[551]:n,l(0,0|o),l(1,0|n),+f()):(i[594]=1,n=i[551],l(0,i[550]),l(1,0|n),+f())}function z(e,t){var r=0,n=0,a=0,o=0;if(d(+t),r=0|s(1),s(0),2146435072&r){if(n=1,d(+e/t),r=0|s(1),a=0|s(0),!(!0&2146435072==(0|(o=2146435072&r))))return a=(n=!(0|o))?i[550]:a,r=n?i[551]:r,l(0,0|a),l(1,0|r),+f()}else n=4;return i[594]=n,r=i[551],l(0,i[550]),l(1,0|r),+f()}function Z(e){h[296]=e>>>0}function $(e){h[296]=0|e}function ee(){var e,t;e=+R(+h[296]),h[296]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[594]=8)}function te(){return re(h[296])}function re(e){var t,r=0,n=0,a=0,i=0;return d(+e),i=1106247680==(0|(a=2146435072&(r=0|s(1))))&i>>>0<0|a>>>0<1106247680,t=r&=2147483647,l(0,0|(n=0|s(0))),l(1,0|r),(e=+f())<0x10000000000000000&e>=0?(a=v(e)>=1?e>0?~~m(g(e/4294967296),4294967295)>>>0:~~C((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(a=0,r=0),n=i?r:n,!(r=i?a:t)&n>>>0<4294967295|r>>>0<0?n:-1}function ne(){return ae(h[296])}function ae(e){var t=0,r=0;return d(+e),t=0|s(1),s(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=v(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function ie(){var e,t;e=+S(+h[296]),h[296]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[594]=8)}function oe(){var e,t;e=+N(+h[296]),h[296]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[594]=8)}function ue(){h[296]=B(h[296])}function ce(){var e,t;e=+F(+h[296]),h[296]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[594]=1)}function se(e,t,r){return function(e,t,r){var n=0,c=0,l=0,f=0;if(n=o[r+30|0]){for(c=r;f=10*f+ +(0|ve[i[i[e>>2]+4>>2]](e,u[c>>1])),c=c+2|0,l=(0|n)>1,n=n+-1|0,l;);if(d(+f),n=0|s(1),e=0|s(0),i[t>>2]=e<<11,i[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=x(t,(n>>>20&2047)-1022|0,((32767&u[r+32>>1])-o[r+30|0]|0)-16384|0),3071&(c=i[t>>2])?(e=c+1024|0,i[t>>2]=e,c>>>0<4294966272||(l=(c=i[t+4>>2])+1|0,i[t+4>>2]=l,n=(l>>>0<c>>>0)+n|0)):e=c,!((0|n)<=-1022))return(0|(c=1071644672+(n<<20)|0))<0?1:(n=i[t+4>>2],i[t>>2]=n<<21|e>>>11,i[t+4>>2]=-2147483648&a[r+32>>1]|c|n>>>11&1048575,0)}return i[t>>2]=0,i[t+4>>2]=0,0}(e,t,r)}function le(e,t,r){!function(e,t,r){var o,c,l=0,f=0,v=0,m=0,g=0,C=0,S=0,E=0,y=0;if(g=15,M=o=M-16|0,h[o+8>>3]=e,c=t,d(+e),f=0|s(1),v=0|s(0),m=f,C=f,f&=2146435072){if(f=p(l=(f>>>20)-1022|0,39457)>>17,a[r+32>>1]=f+16385|m>>>16&32768,i[o+8>>2]=v<<11,i[o+12>>2]=C<<11|v>>>21|-2147483648,(0|(l=x(o+8|0,l,-1^f)))>=1)for(v=r+32|0;m=u[v>>1],a[v>>1]=m+1&32767|32768&m,(0|(l=x(o+8|0,l,-1)))>0;);for(l?(f=(v=i[o+12>>2])>>>(m=0-l|0),i[o+12>>2]=f,l=v<<l+32|i[o+8>>2]>>>m,i[o+8>>2]=l):(l=i[o+8>>2],f=i[o+12>>2]),l=(m=f>>>0<(l>>>0<2576980377?429496730:429496729)>>>0?922:9223)+l|0,i[o+8>>2]=l,l>>>0<m>>>0&&(f=f+1|0,i[o+12>>2]=f),S=l>>>16,C=u[o+14>>1],E=r+32|0,v=r,y=1;;){for(m=g;g=(g=p(C,10))+((C=p(S,10)+(p(65535&l,10)>>>16)>>>16)+p(65535&f,10)>>>16)>>>16|48,a[v>>1]=g,C=(f=C+p(f,10)|0)>>>16,S=(l=p(l,10))>>>16,!(1&(-1^y|48!=(0|g)));)g=u[E>>1],a[E>>1]=g+-1&32767|32768&g;if(v=v+2|0,y=0,g=m+-1|0,!((0|m)>1))break}i[o+12>>2]=f,i[o+8>>2]=l,l=(m=v-r|0)>>1;e:{if((0|m)<=29){if((0|f)<=-1){a[v>>1]=57,f=l+1|0;break e}a[v>>1]=48}for(;;){if(f=l,(0|l)<1)break e;if(l=f+-1|0,48!=u[(v=v+-2|0)>>1])break}}n[r+30|0]=f,a[t+2>>1]=f,t=(32767&u[r+32>>1])-16384|0}else n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;a[c>>1]=t,M=o+16|0}(e,t,r)}function fe(e){return Q(h[296],e)}function de(e){return z(h[296],e)}function he(e){h[296]=z(e,h[296])}function pe(e,t){h[296]=z(e,t)}var ve=[null,function(e,t){return 0,0!=(0|y(0|(t|=0)))|0},function(e,t){return 0,0|O(0|(t|=0))},function(e){return 0,0|A()},function(e,t){return 0,(t|=0)+-48|0},w];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 2304},Base_StrBufSize:function(){return 22},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return o[1072+(((p(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n){return e=+e,t|=0,r|=0,n|=0,a[1174]=0,t=function(e,t,r,n){var c=0,v=0,m=0,g=0,C=0,S=0,E=0,y=0,O=0;e:if(!u[1174]){if(h[296]=e,d(+e),c=0|s(1),m=0|s(0),S=c,O=-65536&c)if(2146435072!=(2146435072&c)){if(!((0|O)>=1))return-2147467259}else i[594]=1;C=i[570],E=i[571],g=-1;t:{if(!((0|c)<(0|(v=E))||(g=1,(0|c)>(0|v)))){if((0|C)==(0|(v=m)))break t;g=v>>>0<C>>>0?-1:1}if(v=-2147467259,1==(0|((S&E)>-1?g:0-g|0)))break e}t:{if(C=i[572],v=i[573],E=v,g=-1,!((0|c)<(0|v)||(g=1,(0|c)>(0|E)))){if((0|m)==(0|C))break t;g=m>>>0<C>>>0?-1:1}if(C=g,-1==(0|((v&S)>-1?C:0-C|0)))return-2147467259}t:{r:{if(!(n|!O))if(2146435072!=(2146435072&c)){if((0|O)<1)break r}else i[594]=1;K(h[i[1056+(t<<2)>>2]>>3]),y=h[296];break t}H(),J(e),S=i[593],m=S,l(0,0|(c=i[592])),l(1,0|m),y=+f(),i[550]==(0|c)&&i[551]==(0|m)||(v=i[593])>>>0<65536||(i[593]=-2147483648^v,d(+(y=h[296])),m=0|s(1),c=0|s(0)),S=m,C=m,m=i[1056+(t<<2)>>2],E=i[m+4>>2],v=i[m>>2],g=-1;r:{if(!((0|C)<(0|(m=E))||(g=1,(0|C)>(0|m)))){if((0|c)==(0|v)){h[296]=e;break r}g=c>>>0<v>>>0?-1:1}if(C=g,h[296]=e,-1==(0|((S&E)>-1?C:0-C|0)))break t}J(h[274])}if(a[1183]=t,c=ne(),v=-2147467259,!V(0)){if(r){if((0|c)>2957003)break e;c=c+1462|0}else if(c+4346018>>>0>7304483)break e;if(a[1181]=1+((c+6|0)%7|0),!n|c)if(c){if((0|c)<=-1?(m=-4-((r=(-1^c)/1461|0)<<2)|0,v=1461+(p(r,1461)+c|0)|0):(m=(r=(c+-1|0)/1461|0)<<2,v=p(r,-1461)+c|0),!(n&&(0|m)<=199))if((0|(v=(((0|(r=m+-101|0))/100|0)-((0|r)/400|0)|0)+v|0))>=1462){c=3&(r=m+1900|0);t:if(n){if(c|(0|m)<200)break t;c=!((r>>>0)%100)&0!=((r>>>0)%400|0)}else c||(c=!((0|r)%100)&0!=((0|r)%400|0));m=m+4|0,v=(12==(0|p(c,12))?-1460:-1461)+v|0}else(0|v)>0||(m=m+-4|0,v=v+1461|0);c=3&(r=m+1900|0);t:if(n){if(c|(0|m)<200)break t;c=!((r>>>0)%100)&0!=((r>>>0)%400|0)}else c||(c=!((0|r)%100)&0!=((0|r)%400|0));for(S=p(c,12),c=S;n=c,c=c+1|0,(0|(v=(r=v)-o[n+1072|0]|0))>0;);n=((v=n)-((0|S)<(0|(n=n+-11|0))?S:n)>>>0)/12|0,a[1174]=1900+(n+m|0),a[1175]=(p(n,-12)+c|0)-S}else i[587]=788331,r=30;else i[587]=67436;if(i[588]=r,h[296]=y,ue(),(r=i[593])>>>0>=65536&&(i[593]=-2147483648^r),K(y),X(h[279]),e=h[296],r=te(),a[1178]=r,Z(r<<16>>16),(r=i[593])>>>0>=65536&&(i[593]=-2147483648^r),K(e),X(h[280]),e=h[296],r=te(),a[1179]=r,Z(r<<16>>16),(r=i[593])>>>0>=65536&&(i[593]=-2147483648^r),K(e),X(h[280]),!t)return t=te(),a[1182]=0,a[1180]=t,0;e=h[296],r=te(),a[1180]=r,Z(r<<16>>16),(r=i[593])>>>0>=65536&&(i[593]=-2147483648^r),K(e),X(h[i[1152+(t<<2)>>2]>>3]),h[296]=G(h[296]),a[1182]=te(),v=0}}return v}(e,t,0!=(0|r),0!=(0|n)),i[594]=0,0|t},Dtr_Yr:function(){return a[1174]},Dtr_Mon:function(){return a[1175]},Dtr_DOM:function(){return i[588]},Dtr_Hour:function(){return a[1178]},Dtr_Min:function(){return a[1179]},Dtr_Sec:function(){return a[1180]},Dtr_Wdy:function(){return a[1181]},Dtr_FracSec:function(){return a[1182]},Dtr_ToNum:function(e,t,r,n,c,s,l,f,d,v){return e|=0,t|=0,r|=0,n|=0,c|=0,s|=0,l|=0,f|=0,d|=0,v|=0,a[1182]=l,a[1180]=s,a[1179]=c,a[1178]=n,i[588]=r,a[1175]=t,a[1174]=e,a[1183]=f,i[592]=0,i[593]=0,a[1181]=0,function(e,t){var r,n=0;M=r=M-16|0;e:{t:{r:{if((u[1175]+-32767&65535)>>>0>1){if(a[1183]>=1?($(a[1182]),n=de(h[i[1152+(a[1183]<<2)>>2]>>3]),$(a[1180]),K(n)):$(a[1180]),n=de(h[280]),$(a[1179]),K(n),n=de(h[280]),$(a[1178]),K(n),n=de(h[279]),!((0|function(e,t,r){var n,c=0,s=0,l=0,f=0,d=0,h=0,v=0,m=0;s=i[588],d=-2146827284;c=(0|(l=a[1175]))>=1?(l+-1|0)/12|0:(0|l)/-12^-1;if(!((0|(n=c+u[1174]<<16>>16))>9999|((t?1900:-9999)+(e?4:0)|0)>(0|n)||((l=l+p(c,-12)<<16>>16)+-1&65535)>>>0>11|(!s|1900==(0|n)&2==(0|l)&29==(0|s)?!t:0))){if(v=(0|(f=(c=(0|(h=n+1e4|0))/4|0)<<2))%100|0,m=(0|f)%400|0,s=p(c,1461)+s|0,c=((s+((0|(c=f+-1|0))/-100|0)|0)+((0|c)/400|0)|0)-1|0,f=(p(h-f|0,12)+l|0)-1|0)for(f=f+(s=m?v?0:12:0)|0;c=o[s+1072|0]+c|0,(0|f)!=(0|(s=s+1|0)););n:if(t||e){if(e=c+-4346385|0,!((0|n)>1900|(0|l)>=3))break n;e=c+-4346384|0}else e=c+-4346384|0;e>>>0>2958465||(i[r>>2]=e,d=0)}return d}(e,t,r+12|0))<0)){if(t=i[r+12>>2],!e)break r;if($(t+-1462|0),!((0|t)<1462)){if(e=i[593],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){i[594]=1;break t}if((0|t)>=1)break t}}i[592]=0,i[593]=0}i[592]=0,i[593]=0,V(8);break e}Z(t)}K(n)}M=r+16|0}(0!=(0|d),0!=(0|v)),+h[296]},Mathpack_Zero:function(){return+h[275]},Mathpack_One:function(){return+h[274]},Mathpack_Pi:function(){return+h[270]},Mathpack_Div:function(e,t){return+z(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+Y(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+Q(e=+e,t=+t)},Mathpack_Add:function(e,t){return+q(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,o=0,c=0;h[296]=t,d(+t),r=0|s(1),s(0),o=r,i[593]=2147483647&r,t=h[296];e:{if(d(+fe(h[271])),r=0|s(1),n=0|s(0),65535==(0|r)&n>>>0<=4294967295|r>>>0<65535)h[296]=e,ie();else if(ue(),d(+fe(t)),r=0|s(1),n=0|s(0),65535==(0|r)&n>>>0>4294967295|r>>>0>65535||-1==(0|(r=te()))){if(h[296]=e,d(+e),n=0|s(1),s(0),(0|(n=(r=n)>>>16<<16))>=1)ee(),X(t),ce();else if(!((0|n)>-1)){if(pe(h[274],t),c=G(h[296]),h[296]=c,ue(),d(+fe(c)),65535==(0|(n=0|s(1)))&s(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=ne()))|!(1&n))break e;h[296]=e,i[593]=2147483647&r,ee(),X(t),ce(),(r=i[593])>>>0<65536||(i[593]=-2147483648^r)}}else h[296]=e,function(e){var t,r=0;if(!((t=a[1187])|e))return void(i[594]=4&i[594]?4:64);if(!((0|t)<1)&&10==(0|te())){if(r=h[296],ue(),J(r),!u[1187])return void j(e);h[296]=r}r=1;for(;1&e&&(r=Y(h[296],r)),e>>>=1;)X(h[296]);h[296]=r}(r);if(o>>>16<<16>>16<=-1){if(1&(o=i[594]))return i[592]=0,i[593]=0,i[594]=-2&o,h[296];he(h[274])}return h[296]}return i[594]=8,h[296]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return d(+(e=+e)),t=0|s(1),s(0),(r=-65536&t)?2146435072==(2146435072&t)?(i[594]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,a,i,o=0,u=0,c=0;d(+(e=+e)),o=0|s(1),r=0|s(0),n=o,i=o,d(+t),a=0|s(1),o=0|s(0),c=-1;e:{if(!((0|n)<(0|(u=a))||(c=1,(0|i)>(0|u)))){if(u=0,(0|o)==(0|r))break e;c=r>>>0<o>>>0?-1:1}o=c,u=(a&n)>-1?o:0-o|0}return 0|u},Mathpack_TakeMathError:function(){var e;return e=i[594],i[594]=0,0|e},Mathpack_Trunc:function(e){return+B(e=+e)},Mathpack_Ceil:function(e){return e=+e,h[296]=e,function(){var e=0,t=0,r=0;e:{if(r=i[592],e=i[593],t=-65536&e){if(2146435072==(2146435072&e))return i[594]=1,void ue();if((0|t)>0)break e}return void ue()}ue(),(0|r)==i[592]&&i[593]==(0|e)||K(1)}(),+h[296]},Mathpack_Floor:function(e){return e=+e,h[296]=e,H(),+h[296]},Mathpack_Abs:function(e){var t=0;return d(+(e=+e)),t=0|s(1),t&=2147483647,l(0,0|(0|s(0))),l(1,0|t),+f()},Mathpack_Neg:function(e){var t,r,n,a;return d(+(e=+e)),n=-2147483648^(t=0|s(1)),l(0,0|(r=0|s(0))),l(1,0|n),a=+f(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?a:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|re(e=+e)},Mathpack_LFix:function(e){return 0|ae(e=+e)},Mathpack_SFix:function(e){return e=+e,h[296]=e,0|W()},Mathpack_Round:function(e,t){return+function(e,t){var r,o=0,c=0,l=0,f=0;M=r=M+-64|0,i[r+56>>2]=0,a[r+46>>1]=0,a[r+48>>1]=0,h[296]=e,d(+e),o=0|s(1),s(0);e:if(c=-65536&o)if(2146435072!=(2146435072&o)){(0|c)>0||(f=32768,o>>>0<65536||(i[593]=-2147483648^o,e=h[296])),le(e,r+56|0,r+16|0),u[r+58>>1]||(a[r+56>>1]=1),h[296]=t,o=(0|(o=W()))<0?100:o;t:{if(c=i[593],l=-65536&c)if(2146435072!=(2146435072&c)){if(!((0|l)>0)){if((o=i[593])>>>0>=65536&&(i[593]=-2147483648^o),(0|(o=W()))<=-1)break t;o=0-o|0}}else i[594]=1;c=a[r+56>>1],l=o+c|0,o=a[r+58>>1],(0|l)<(0|o)&&(i[r+12>>2]=o,i[r+8>>2]=c,function(e,t,r,n){var o=0,c=0,s=0;r:{n:{a:{i:{if(!n){if(u[e>>1]<=52)break i;break n}if(!((0|n)<1)&&(0|n)<15)break a}return i[t>>2]=1,void(i[r>>2]=0)}if(u[(n<<1)+e>>1]<=52)break r;for(;;){if(s=u[(c=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[c>>1]=s,58!=(65535&s))break r;if(!(n=o))break}}return a[e>>1]=49,i[t>>2]=i[t>>2]+1,void(i[r>>2]=1)}for(;t=n,(0|n)>=2&&48==u[((n=t+-1|0)<<1)+e>>1];);i[r>>2]=t}(r+16|0,r+8|0,r+12|0,l),o=i[r+12>>2],a[r+58>>1]=o,c=i[r+8>>2],a[r+56>>1]=c),n[r+46|0]=o,a[r+48>>1]=c+16384&32767|f,se(2300,2368,r+16|0),e=h[296];break e}e=h[275]}else i[594]=1;return M=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,u=0;d(+e),r=0|s(1),s(0);(n=-65536&r)&&(2146435072!=(2146435072&r)?u=(0|n)<1?-1:1:i[594]=1);if(a=D(e,t),h[296]=e,h[296]=G(e),J(a),(r=i[593])>>>0>=65536){if(2146435072==(2146435072&r))return i[594]=1,a;if(r=(0|(r=re(t)<<16))<0?309:r>>16,d(+t),n=0|s(1),s(0),(o=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|o)<1?0-r|0:r:i[594]=1),(0|r)<=-309)return V(8),0;j(0-r|0),(0|u)>-1||(r=i[593])>>>0<65536||(i[593]=-2147483648^r),K(a),a=h[296]}return a}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return d(+(e=D(e=+e,t=+t))),r=0|s(1),s(0),2146435072==(2146435072&r)&&(i[594]=1,e=-1),+e},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,a=0,o=0,u=0,c=0;M=r=M-16|0,h[r+8>>3]=e,h[r>>3]=t,d(+e),n=0|s(1),a=0|s(0),o=n,d(+t),n=0|s(1),u=0|s(0),c=n;e:{if((0|a)!=(0|u)||(0|o)!=(0|n)){if((c+2097152&2146435072)-(2146435072&o)>>>0<=5242879&&(e=G(e),h[r+8>>3]=e,d(+e),n=0|s(1),s(0),o=n,e=G(t),h[r>>3]=e,d(+e),n=0|s(1),s(0),c=n),n=1,o=i[(u=(a=(c&o)>-1)?r+8|0:r)+4>>2],c=i[(a=a?r:r+8|0)+4>>2],(0|o)>(0|c))break e;if((0|o)<(0|c)){n=-1;break e}if(u=i[u>>2],a=i[a>>2],u>>>0>a>>>0)break e;if(n=-1,u>>>0<a>>>0)break e}n=0}return M=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return d(+(e=+e)),t=0|s(1),s(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,a=0;return d(+(e=+e)),a=0|s(1),r=0|s(0),d(+t),n=0|s(1),0|(a=(0|r)==(0|s(0))?(0|a)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return d(+(e=+e)),t=0|s(1),s(0),2146435072==(2146435072&t)?(i[594]=1,-1):+G(e)},Mathpack_Sqrt:function(e){return e=+e,h[296]=e,ie(),+h[296]},Mathpack_Exp:function(e){return e=+e,h[296]=e,ce(),+h[296]},Mathpack_Ln:function(e){return e=+e,h[296]=e,ee(),+h[296]},Mathpack_Log:function(e){return e=+e,h[296]=e,function(){var e,t;e=+k(+h[296]),h[296]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[594]=8)}(),+h[296]},Mathpack_Sin:function(e){return e=+e,h[296]=e,function(){var e=0,t=0;d(+(t=h[296])),e=0|s(1),s(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+b(+t),h[296]=t,d(+t),e=0|s(1),s(0),2146435072!=(2146435072&e))||(i[594]=8)}(),+h[296]},Mathpack_Cos:function(e){return e=+e,h[296]=e,function(){var e=0,t=0;d(+(t=h[296])),e=0|s(1),s(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+I(+t),h[296]=t,d(+t),e=0|s(1),s(0),2146435072!=(2146435072&e))||(i[594]=8)}(),+h[296]},Mathpack_Tan:function(e){return e=+e,h[296]=e,function(){var e=0,t=0,r=0;r=8,d(+(t=h[296])),e=0|s(1),s(0);1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+T(+t),h[296]=t,r=4,d(+t),e=0|s(1),s(0),2146435072!=(2146435072&e))||(i[594]=r)}(),+h[296]},Mathpack_Asin:function(e){return+U(e=+e,0)},Mathpack_Acos:function(e){return+U(e=+e,1)},Mathpack_Atan:function(e){return e=+e,h[296]=e,oe(),+h[296]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,u=0,c=0;h[296]=e;e:{if(d(+e),r=0|s(1),s(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;i[594]=1}h[296]=t;t:{if(d(+t),r=0|s(1),s(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;i[594]=1}return V(4),0}return $((0|n)<1?-1:1),X(h[270]),h[296]=z(h[296],h[272]),h[296]}e:if((0|r)<=-1){d(+t),r=0|s(1),s(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else i[594]=1;a=h[270];break e}d(+(a=h[270])),r=0|s(1),n=0|s(0),o=-2147483648^r,l(0,0|n),l(1,0|o),u=+f(),c=a,a=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?u:c}else a=h[275];return pe(t,e),oe(),K(a),h[296]}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,o,c=0,l=0;return d(+(e=+e)),r=0|s(1),o=0|s(0),2146435072==(2146435072&r)?(i[594]=1,-1):(h[296]=e,c=2304,(n=-65536&(l=r))&&(2146435072!=(2146435072&l)?(c=2304,(0|n)>0||(l>>>0>=65536&&(i[593]=-2147483648^l),c=2304,!o&-2147483648==(0|r)||(a[1152]=45,c=2306))):(i[594]=1,c=2304)),l=c,t=(0|t)<21?t:21,t=function(e,t,r,n){var o;M=o=M-16|0,e=0|ve[i[i[e>>2]+8>>2]](e),i[o+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;a[t>>1]=0}else le(h[296],o+8|0,t),t=function(e,t,r,n,o,c){var s,l,f,d=0,h=0,v=0,m=0,g=0;M=l=M-16|0,s=(t<<1)+e|0,f=l+12|0;t:{r:{n:{a:if(!(v=(0|r)<5&(h=o?n:1)+3>>>0<8)){i:if(!((0|h)>(0|r))){if((0|(n=r+h|0))>=3){if((0|r)<5|(0|h)>-4)break a;if((n+-2|0)<(0|o))break i;break a}if((0|r)<5)break a}if(m=1,n=1,(0|r)<7)break n;n=r-(h+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,h))&&(n=r-((0|h)<(0|r)?(0|h)<1?2-h|0:1:0)|0)}n:{if((0|n)<(0|o)){d=1,o=0;a:if(!((0|t)<1)){i:{o:{if(!n){if(u[e>>1]>52)break o;break a}if((0|n)<1|(0|n)>=(0|t))break a;if(u[(n<<1)+e>>1]<=52)break i;for(;;){if(g=u[(d=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[d>>1]=g,58!=(65535&g))break i;if(n=o,!o)break}}a[e>>1]=49,o=1,d=h+1|0;break a}for(;(0|(o=n))>=2&&48==u[((n=o+-1|0)<<1)+e>>1];);d=h}if((-1^v)&(0|d)>(0|r)|m)break n;break r}if(d=h,!m)break r}if(i[f>>2]=32768,r=e+2|0,(0|o)<2||(n=r+(o<<1)|0)>>>0>=s>>>0?n=r:(o=o+-1|0,i[f>>2]=32768|o,e=e+4|0,(t<<1)-4>>1>>>0<o>>>0&&(_(1),E()),L(e,r,o<<1),a[r>>1]=c),n>>>0<s>>>0&&(a[n>>1]=69,n=n+2|0),n>>>0>=s>>>0?o=n:(o=n+2|0,(0|d)<=0?(a[n>>1]=45,d=1-d|0):(a[n>>1]=43,d=d+-1|0)),(0|d)<100|o>>>0>=s>>>0||(e=(d>>>0)/100|0,a[o>>1]=e+48,d=d-p(e,100)|0,o=o+2|0),o>>>0<s>>>0&&(a[o>>1]=48+((0|d)/10|0),o=o+2|0),o>>>0>=s>>>0)break t;a[o>>1]=48+((0|d)%10|0),o=o+2|0;break t}if((0|o)<0|(0|o)>(0|d))if(r=o-d|0,i[f>>2]=r,(0|d)>=1){if(!((r=(n=((v=(r=(h=(0|d)>(0|t)?t:d)<<1)+e|0)+(o<<1)|0)-r|0)+-2|0)>>>0<e>>>0|n>>>0>=s>>>0))for(;a[n>>1]=u[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=v>>>0;);(0|d)<(0|t)&&(a[v>>1]=c),o=v+(((0|(e=s-v>>1))>(0|(t=o-h|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(d<<1)|0)+(o<<1)|0)|0)>>>0>=s>>>0||(o=((o<<1)+e|0)-2|0)>>>0<e>>>0))for(;a[n>>1]=u[o>>1],n=n+-2|0,(o=o+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(a[e>>1]=48,e=e+2|0),e>>>0<s>>>0&&(a[e>>1]=c,e=e+2|0),n=s-e>>1,d&&(t=(0|n)<(0|(t=0-d|0))?n:t))for(o=0;a[(o<<1)+e>>1]=48,(0|t)!=(0|(o=o+1|0)););o=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|d)>(0|t)?t:d)-o|0)for(t=(o<<1)+e|0,o=0;a[t+(o<<1)>>1]=48,(0|r)!=(0|(o=o+1|0)););o=(n<<1)+e|0}}return M=l+16|0,o}(t,r,n,a[o+8>>1],a[o+10>>1],e);return M=o+16|0,t}(i[256],l,2348-l>>1,(0|t)>0?t:0),i[592]=0,i[593]=0,t-2304>>1)},Mathpack_Pack:function(e,t,r){var o;return e|=0,t|=0,r|=0,M=o=M-48|0,n[o+39|0]=0,L(o+8|0,2304,(r=(0|r)<15?r:15)<<1),a[o+40>>1]=t+16384&32767|!e<<15,n[o+38|0]=r,i[o>>2]=0,i[o+4>>2]=0,se(i[256],o,o+8|0)&&(i[594]=1),M=o+48|0,+h[o>>3]},_start:w,__errno_location:function(){return 2392},setThrew:function(e,t){e|=0,t|=0,i[596]||(i[597]=t,i[596]=e)},stackSave:function(){return 0|M},stackAlloc:function(e){return M=e=M-(e|=0)&-16,0|e},stackRestore:function(e){M=e|=0},__growWasmMemory:function(e){return 0,0|E()}}}({Math:n.Math,Int8Array:Int8Array,Uint8Array:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:a.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:a.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:a.Base_LocaleDecimalSeparator,Math_log10:a.Math_log10,Math_log:a.Math_log,Math_sqrt:a.Math_sqrt,Math_sin:a.Math_sin,Math_cos:a.Math_cos,Math_tan:a.Math_tan,Math_atan:a.Math_atan,Math_exp:a.Math_exp,proc_exit:i.proc_exit},p),g=m.memory;t.memory=g;var C=m.Base_StrBuf;t.Base_StrBuf=C;var S=m.Base_StrBufSize;t.Base_StrBufSize=S;var E=m.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=E;var y=m.Dtr_FromNum;t.Dtr_FromNum=y;var O=m.Dtr_Yr;t.Dtr_Yr=O;var A=m.Dtr_Mon;t.Dtr_Mon=A;var k=m.Dtr_DOM;t.Dtr_DOM=k;var R=m.Dtr_Hour;t.Dtr_Hour=R;var b=m.Dtr_Min;t.Dtr_Min=b;var I=m.Dtr_Sec;t.Dtr_Sec=I;var T=m.Dtr_Wdy;t.Dtr_Wdy=T;var N=m.Dtr_FracSec;t.Dtr_FracSec=N;var F=m.Dtr_ToNum;t.Dtr_ToNum=F;var _=m.Mathpack_Zero;t.Mathpack_Zero=_;var M=m.Mathpack_One;t.Mathpack_One=M;var w=m.Mathpack_Pi;t.Mathpack_Pi=w;var L=m.Mathpack_Div;t.Mathpack_Div=L;var D=m.Mathpack_Mul;t.Mathpack_Mul=D;var U=m.Mathpack_Sub;t.Mathpack_Sub=U;var x=m.Mathpack_Add;t.Mathpack_Add=x;var P=m.Mathpack_Power;t.Mathpack_Power=P;var G=m.Mathpack_Cond;t.Mathpack_Cond=G;var V=m.Mathpack_Cond2;t.Mathpack_Cond2=V;var W=m.Mathpack_TakeMathError;t.Mathpack_TakeMathError=W;var B=m.Mathpack_Trunc;t.Mathpack_Trunc=B;var j=m.Mathpack_Ceil;t.Mathpack_Ceil=j;var H=m.Mathpack_Floor;t.Mathpack_Floor=H;var K=m.Mathpack_Abs;t.Mathpack_Abs=K;var q=m.Mathpack_Neg;t.Mathpack_Neg=q;var J=m.Mathpack_Float;t.Mathpack_Float=J;var Q=m.Mathpack_SFloat;t.Mathpack_SFloat=Q;var X=m.Mathpack_Fix;t.Mathpack_Fix=X;var Y=m.Mathpack_LFix;t.Mathpack_LFix=Y;var z=m.Mathpack_SFix;t.Mathpack_SFix=z;var Z=m.Mathpack_Round;t.Mathpack_Round=Z;var $=m.Mathpack_RoundUp;t.Mathpack_RoundUp=$;var ee=m.Mathpack_RoundDown;t.Mathpack_RoundDown=ee;var te=m.Mathpack_Compare;t.Mathpack_Compare=te;var re=m.Mathpack_GetExp32;t.Mathpack_GetExp32=re;var ne=m.Mathpack_Equal;t.Mathpack_Equal=ne;var ae=m.Mathpack_ViewRound;t.Mathpack_ViewRound=ae;var ie=m.Mathpack_Sqrt;t.Mathpack_Sqrt=ie;var oe=m.Mathpack_Exp;t.Mathpack_Exp=oe;var ue=m.Mathpack_Ln;t.Mathpack_Ln=ue;var ce=m.Mathpack_Log;t.Mathpack_Log=ce;var se=m.Mathpack_Sin;t.Mathpack_Sin=se;var le=m.Mathpack_Cos;t.Mathpack_Cos=le;var fe=m.Mathpack_Tan;t.Mathpack_Tan=fe;var de=m.Mathpack_Asin;t.Mathpack_Asin=de;var he=m.Mathpack_Acos;t.Mathpack_Acos=he;var pe=m.Mathpack_Atan;t.Mathpack_Atan=pe;var ve=m.Mathpack_Atan2;t.Mathpack_Atan2=ve;var me=m.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=me;var ge=m.Mathpack_Pack;t.Mathpack_Pack=ge;var Ce=m._start;t._start=Ce;var Se=m.__errno_location;t.__errno_location=Se;var Ee=m.setThrew;t.setThrew=Ee;var ye=m.stackSave;t.stackSave=ye;var Oe=m.stackAlloc;t.stackAlloc=Oe;var Ae=m.stackRestore;t.stackRestore=Ae;var ke=m.__growWasmMemory;t.__growWasmMemory=ke},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});var a,i=r(4),o=r(6);function u(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(a=t.MathErrorNum||(t.MathErrorNum={}));var c=((n={})[a.Over]=u(a.Over),n[a.Under]=u(a.Under),n[a.DivBy0]=u(a.DivBy0),n[a.Trans]=u(a.Trans),n);function s(e){var t;return null!=(t=c[e])?t:u(e)}function l(e){return function(t){var r=e(t),n=i.Mathpack_TakeMathError();return n===a.None?r:s(n)}}function f(e){return function(t,r){var n=e(t,r),o=i.Mathpack_TakeMathError();return o===a.None?n:s(o)}}t.mathError=s,t.zero=i.Mathpack_Zero,t.one=i.Mathpack_One,t.pi=i.Mathpack_Pi,t.exp32=i.Mathpack_GetExp32,t.equal=function(e,t){return 0!==i.Mathpack_Equal(e,t)},t.trunc=i.Mathpack_Trunc,t.ceil=l(i.Mathpack_Ceil),t.floor=l(i.Mathpack_Floor),t.abs=i.Mathpack_Abs,t.neg=i.Mathpack_Neg,t.float=function(e){return e<0?i.Mathpack_SFloat(e):i.Mathpack_Float(e)},t.fix=function(e){return i.Mathpack_Fix(e)>>>0},t.lfix=i.Mathpack_LFix,t.sfix=l(i.Mathpack_SFix),t.round=f(i.Mathpack_Round),t.roundUp=f(i.Mathpack_RoundUp),t.roundDown=f(i.Mathpack_RoundDown),t.compare=i.Mathpack_Compare,t.div=f(i.Mathpack_Div),t.mul=f(i.Mathpack_Mul),t.sub=f(i.Mathpack_Sub),t.add=f(i.Mathpack_Add),t.power=f(i.Mathpack_Power),t.cond=function(e){var t=i.Mathpack_Cond(e),r=i.Mathpack_TakeMathError();return r===a.None?t:s(r)},t.cond2=i.Mathpack_Cond2,t.viewRound=l(i.Mathpack_ViewRound),t.sqrt=l(i.Mathpack_Sqrt),t.exp=l(i.Mathpack_Exp),t.ln=l(i.Mathpack_Ln),t.log=l(i.Mathpack_Log),t.sin=l(i.Mathpack_Sin),t.cos=l(i.Mathpack_Cos),t.tan=l(i.Mathpack_Tan),t.asin=l(i.Mathpack_Asin),t.acos=l(i.Mathpack_Acos),t.atan=l(i.Mathpack_Atan),t.atan2=f(i.Mathpack_Atan2),t.formatGeneral=function(e,t,r){try{o.setLocale(e);var n=i.Mathpack_FormatGeneral(t,r);return n<0?s(i.Mathpack_TakeMathError()):o.pxcharToStr(i.Base_StrBuf(),n)}finally{o.setLocale(void 0)}},t.pack=function(e,t,r,n){try{o.setLocale(e);var u=o.fastMin(n.length,i.Base_StrBufSize());o.strToPxchar(i.Base_StrBuf(),n.substring(0,u));var c=i.Mathpack_Pack(!!t,r,u),l=i.Mathpack_TakeMathError();return l!==a.None?s(l):isNaN(c)?s(a.Over):c}finally{o.setLocale(void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),a=void 0;t.setLocale=function(e){a=e};t.Base_LocaleIsNumeral=function(e){return a.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return a.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){var e=a.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.pxcharToStr=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a="",i=0;i<t;i+=1)a+=String.fromCharCode(r[e+(i<<1)>>1]);return a},t.strToPxchar=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a=0;a<t.length;a+=1)r[e+(a<<1)>>1]=t.charCodeAt(a)}},function(e,t,r){r(8),e.exports=r(21)},function(e,t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,n=void 0,a=void 0,i=function(e,t){d[r]=e,d[r+1]=t,2===(r+=2)&&(a?a(h):C())},o="undefined"!=typeof window?window:void 0,u=o||{},c=u.MutationObserver||u.WebKitMutationObserver,s="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var e=setTimeout;return function(){return e(h,1)}}var d=new Array(1e3);function h(){for(var e=0;e<r;e+=2)(0,d[e])(d[e+1]),d[e]=void 0,d[e+1]=void 0;r=0}var p,v,m,g,C=void 0;function S(e,t){var r=this,n=new this.constructor(O);void 0===n[y]&&M(n);var a=r._state;if(a){var o=arguments[a-1];i((function(){return F(a,n,o,r._result)}))}else T(r,n,e,t);return n}function E(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(O);return k(t,e),t}s?C=function(){return process.nextTick(h)}:c?(v=0,m=new c(h),g=document.createTextNode(""),m.observe(g,{characterData:!0}),C=function(){g.data=v=++v%2}):l?((p=new MessageChannel).port1.onmessage=h,C=function(){return p.port2.postMessage(0)}):C=void 0===o?function(){try{var e=Function("return this")().require("vertx");return void 0!==(n=e.runOnLoop||e.runOnContext)?function(){n(h)}:f()}catch(e){return f()}}():f();var y=Math.random().toString(36).substring(2);function O(){}function A(t,r,n){r.constructor===t.constructor&&n===S&&r.constructor.resolve===E?function(e,t){1===t._state?b(e,t._result):2===t._state?I(e,t._result):T(t,void 0,(function(t){return k(e,t)}),(function(t){return I(e,t)}))}(t,r):void 0===n?b(t,r):e(n)?function(e,t,r){i((function(e){var n=!1,a=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?k(e,r):b(e,r))}),(function(t){n||(n=!0,I(e,t))}),e._label);!n&&a&&(n=!0,I(e,a))}),e)}(t,r,n):b(t,r)}function k(e,t){if(e===t)I(e,new TypeError("You cannot resolve a promise with itself"));else if(a=typeof(n=t),null===n||"object"!==a&&"function"!==a)b(e,t);else{var r=void 0;try{r=t.then}catch(t){return void I(e,t)}A(e,t,r)}var n,a}function R(e){e._onerror&&e._onerror(e._result),N(e)}function b(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&i(N,e))}function I(e,t){void 0===e._state&&(e._state=2,e._result=t,i(R,e))}function T(e,t,r,n){var a=e._subscribers,o=a.length;e._onerror=null,a[o]=t,a[o+1]=r,a[o+2]=n,0===o&&e._state&&i(N,e)}function N(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,a=void 0,i=e._result,o=0;o<t.length;o+=3)n=t[o],a=t[o+r],n?F(r,n,a,i):a(i);e._subscribers.length=0}}function F(t,r,n,a){var i=e(n),o=void 0,u=void 0,c=!0;if(i){try{o=n(a)}catch(e){c=!1,u=e}if(r===o)return void I(r,new TypeError("A promises callback cannot return that same promise."))}else o=a;void 0!==r._state||(i&&c?k(r,o):!1===c?I(r,u):1===t?b(r,o):2===t&&I(r,o))}var _=0;function M(e){e[y]=_++,e._state=void 0,e._result=void 0,e._subscribers=[]}var w=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(O),this.promise[y]||M(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?b(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&b(this.promise,this._result))):I(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===E){var a=void 0,i=void 0,o=!1;try{a=e.then}catch(e){o=!0,i=e}if(a===S&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof a)this._remaining--,this._result[t]=e;else if(r===L){var u=new r(O);o?I(u,i):A(u,e,a),this._willSettleAt(u,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?I(n,r):this._result[t]=r),0===this._remaining&&b(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;T(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},e}(),L=function(){function t(e){this[y]=_++,this._result=this._state=void 0,this._subscribers=[],O!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){k(e,t)}),(function(t){I(e,t)}))}catch(t){I(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return L.prototype.then=S,L.all=function(e){return new w(this,e).promise},L.race=function(e){var r=this;return t(e)?new r((function(t,n){for(var a=e.length,i=0;i<a;i++)r.resolve(e[i]).then(t,n)})):new r((function(e,t){return t(new TypeError("You must pass an array to race."))}))},L.resolve=E,L.reject=function(e){var t=new this(O);return I(t,e),t},L._setScheduler=function(e){a=e},L._setAsap=function(e){i=e},L._asap=i,L.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=L},L.Promise=L,L.polyfill(),L},e.exports=n()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var a=Object.getPrototypeOf(t);a&&"object"==typeof a&&Object.keys(a).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i={};return Object.keys(n).forEach((function(t){i[t]=e(n[t],r+1)})),i}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},a=1;a<=t;a+=1)n(a);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var a=e[n];r=r.catch((function(){return t(a)}))},a=1;a<e.length;a+=1)n(a);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").body.innerHTML:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,a=0;a<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(a)),a!==n-1);a+=2)r=4294967295&((r<<5)+r^e.charCodeAt(a+1));var i=t+35685*r+(23896*r<<16)&4294967295;return i<0&&(i+=4294967296),i},t.getCharIndexInTextFromPoint=function(e,t){var r=-1,n=null;if(void 0!==document.caretPositionFromPoint)null!==(a=document.caretPositionFromPoint(e,t))&&(r=a.offset,n=null!=a.offsetNode&&null!=a.offsetNode.parentElement&&"SPAN"===a.offsetNode.parentElement.nodeName?a.offsetNode.parentElement:a.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(a=document.caretRangeFromPoint(e,t))&&(r=a.startOffset,n=null!=a.startContainer&&null!=a.startContainer.parentElement&&"SPAN"===a.startContainer.parentElement.nodeName?a.startContainer.parentElement:a.startContainer)}else try{var a;n=document.elementFromPoint(e,t),(a=document.body.createTextRange()).moveToPoint(e,t);var i=document.body.createTextRange();i.moveToElementText(n),i.setEndPoint("EndToStart",a),r=i.text.length}catch(e){return r}for(;null!=n;)null!=(n=n.previousSibling)&&null!=n.textContent&&(r+=n.textContent.length);return r},t.getBoundingRectForText=function(e,t,r){function n(e,t,r){if(!e||!e.textContent)return t;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var a=e.childNodes,i=0;i<a.length&&t>=0;i+=1)t=n(a[i],t,r);return t}var a=document.createRange();return n(e,t,(function(e,t){return a.setStart(e,t)})),n(e,r,(function(e,t){return a.setEnd(e,t)})),a.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,a){return t.traceTag(e,r,n,a)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,a){return t.debugTraceTag(e,r,n,a)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,a){return t.assertTag(e,r,n,a)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,a){return t.shipAssertTag(e,r,n,a)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var a=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();t.NulLogger=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function a(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){var t=n(),r=e,i=t,o={},u=function(e,t,n){return function(e,t,r,n,i,o){a(e,"end",r);var u={sessionName:t,result:n?"success":"failure",message:o,marks:e},c=JSON.stringify(u);i(c)}(o,r,i,e,t,n)};return o.start=0,{mark:function(e){return function(e){return a(o,e,i)}(e)},end:function(e){return u(!0,e)},success:function(e,t){return u(!0,e,t)},failure:function(e,t){return u(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return n},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var a=n(),i=r;return{reset:function(e){null!=e&&(i=e),a=n()},stop:function(r){var o=n()-a,u=JSON.stringify({Target:i,Duration:o.toFixed(t),StopInfo:r});e(u)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r=window.crypto||window.msCrypto;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var n=!1,a=window.performance;try{a&&a.now&&a.now()!==1/0&&(n=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var i=0;i<e.length;i+=1){try{if(n){t.perfNow=!0;var o=Math.floor(100*a.now())%10;(o<0||o>9)&&(o=0);for(var u=0;u<o;u+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[i]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const n=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992
/*!== 0*/&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),t.Math_atan=t.Math_tan=t.Math_cos=t.Math_sin=t.Math_exp=t.Math_log=t.Math_log10=t.Math_sqrt=void 0;var n=r(6);const a=Math.sqrt;t.Math_sqrt=a;const i=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=i;const o=Math.log;t.Math_log=o;const u=Math.exp;t.Math_exp=u;const c=Math.sin;t.Math_sin=c;const s=Math.cos;t.Math_cos=s;const l=Math.tan;t.Math_tan=l;const f=Math.atan;t.Math_atan=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),a=r(5);function i(e,t,r,n,a,i,o,u){return{yr:e,mon:t,dom:r,hour:n,min:a,sec:i,wdy:o,fracSec:u}}t.daysPerMonth=function(e,t,r){return n.Dtr_DaysPerMonth(e,t,r?1:0)},function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(t.Rounding||(t.Rounding={})),t.dtr=i,t.fromNum=function(e,t,r,a){var o=t;return 0===n.Dtr_FromNum(e,o,r?1:0,a?1:0)&&i(n.Dtr_Yr(),n.Dtr_Mon(),n.Dtr_DOM(),n.Dtr_Hour(),n.Dtr_Min(),n.Dtr_Sec(),n.Dtr_Wdy(),n.Dtr_FracSec())},t.toNum=function(e,t,r,i){var o=t,u=n.Dtr_ToNum(e.yr,e.mon,e.dom,e.hour,e.min,e.sec,e.fracSec,o,r?1:0,i?1:0),c=n.Mathpack_TakeMathError();return c===a.MathErrorNum.None?u:a.mathError(c)}},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"createParseGlobals",(function(){return Ui})),r.d(n,"ReasonKind",(function(){return Pi})),r.d(n,"parseLocals",(function(){return xi})),r.d(n,"formatLocalsGrid",(function(){return Gi})),r.d(n,"formatLocalsName",(function(){return Vi})),r.d(n,"notImplemented",(function(){return Di})),r.d(n,"notFormulaString",(function(){return Wi})),r.d(n,"createParser",(function(){return Fs})),r.d(n,"parseResultHelper",(function(){return Vs}));var a={};r.r(a),r.d(a,"SyntaxError",(function(){return Ps})),r.d(a,"TypeError",(function(){return Gs}));var i={};r.r(i),r.d(i,"MachineCallKind",(function(){return sf})),r.d(i,"machineCall",(function(){return hf})),r.d(i,"isMachineCall",(function(){return pf})),r.d(i,"ArrayMachine",(function(){return vf})),r.d(i,"TransitionKind",(function(){return Xl})),r.d(i,"nextTransition",(function(){return af})),r.d(i,"callMachineTransition",(function(){return of})),r.d(i,"nextOnSuccessReceiver",(function(){return cf})),r.d(i,"MachineCycle",(function(){return lf})),r.d(i,"MachineRuntime",(function(){return ff})),r.d(i,"AllMachine",(function(){return df}));var o={};r.r(o),r.d(o,"analyzeLocalsGrid",(function(){return zs})),r.d(o,"analyzeLocalsName",(function(){return Zs})),r.d(o,"analyzeFormatLocals",(function(){return $s})),r.d(o,"diagnostics",(function(){return a})),r.d(o,"summarizeFormulaDiagnostics",(function(){return Xs})),r.d(o,"createAnalyzeGlobals",(function(){return Ys})),r.d(o,"createAnalyzer",(function(){return Ih}));var u={};r.r(u),r.d(u,"fastMathpack",(function(){return sa})),r.d(u,"createCompiler",(function(){return hp})),r.d(u,"createEvaluator",(function(){return Hv})),r.d(u,"createFormulaInspector",(function(){return tm})),r.d(u,"ReasonKind",(function(){return Dl})),r.d(u,"interval",(function(){return Wl})),r.d(u,"CellKind",(function(){return Pl})),r.d(u,"Interrupt",(function(){return Gl})),r.d(u,"notImplemented",(function(){return wl})),r.d(u,"finalValue",(function(){return jl})),r.d(u,"pendingValue",(function(){return Hl})),r.d(u,"cellFormula",(function(){return Kl})),r.d(u,"userDefinedFunc",(function(){return Jl})),r.d(u,"unavailable",(function(){return Ll})),r.d(u,"stopped",(function(){return ql})),r.d(u,"nameCycle",(function(){return zl})),r.d(u,"cellCycle",(function(){return Zl})),r.d(u,"paused",(function(){return tf})),r.d(u,"previousFailure",(function(){return $l})),r.d(u,"evalGlobals",(function(){return Ql})),r.d(u,"evalLocals",(function(){return Yl})),r.d(u,"compileLocals",(function(){return xl})),r.d(u,"getEvalFailureReason",(function(){return rf})),r.d(u,"illFormedFormula",(function(){return Bl})),r.d(u,"createCompileGlobals",(function(){return Ul})),r.d(u,"limitExceeded",(function(){return ef})),r.d(u,"LimitKind",(function(){return Vl})),r.d(u,"extractResultValue",(function(){return Ff})),r.d(u,"evalToCellValue",(function(){return _f})),r.d(u,"getBasicFirstOrderFunc",(function(){return ty})),r.d(u,"extension",(function(){return ZE}));var c={};r.r(c),r.d(c,"WorkerKind",(function(){return EO})),r.d(c,"ErrorKind",(function(){return yO})),r.d(c,"isWorkerSupported",(function(){return nA})),r.d(c,"createWorker",(function(){return iA})),r.d(c,"tryCreateWorker",(function(){return oA})),r.d(c,"dedicatedWorkerInsideInit",(function(){return cA})),r.d(c,"runSmokeTest",(function(){return gA})),r.d(c,"cancelSmokeTest",(function(){return vA})),r.d(c,"smokeTestInsideInit",(function(){return dA})),r.d(c,"smokeTestInsideDef",(function(){return CA}));var s={};r.r(s),r.d(s,"getBasicFirstOrderFunc",(function(){return ty}));var l={};r.r(l),r.d(l,"recalcMapper",(function(){return ky})),r.d(l,"mapperContext",(function(){return Ry})),r.d(l,"formulaCacheGlobals",(function(){return wy})),r.d(l,"formulaCache",(function(){return Ly})),r.d(l,"createFormatInfo",(function(){return My})),r.d(l,"worksheetFunctionName",(function(){return xy})),r.d(l,"errorTypeName",(function(){return Py})),r.d(l,"localeData",(function(){return Gy})),r.d(l,"numberFormat",(function(){return Vy})),r.d(l,"sheetName",(function(){return Wy})),r.d(l,"blankValue",(function(){return By})),r.d(l,"errorValue",(function(){return jy})),r.d(l,"richValue",(function(){return Hy})),r.d(l,"getCellValueKind",(function(){return Ky})),r.d(l,"cellLocation",(function(){return qy})),r.d(l,"rangeLocation",(function(){return Jy})),r.d(l,"sheetRangeLocation",(function(){return Qy})),r.d(l,"cellData",(function(){return Xy})),r.d(l,"cellFormulaCellData",(function(){return Yy})),r.d(l,"arrayFormulaCellData",(function(){return zy})),r.d(l,"valueCellData",(function(){return Zy})),r.d(l,"rangeUpdate",(function(){return $y})),r.d(l,"rangeWrite",(function(){return eO})),r.d(l,"rangePromote",(function(){return tO})),r.d(l,"arrayData",(function(){return rO})),r.d(l,"arrayUpdate",(function(){return nO})),r.d(l,"arrayWrite",(function(){return aO})),r.d(l,"arrayPromote",(function(){return iO})),r.d(l,"unusedCellsUpdate",(function(){return oO})),r.d(l,"namedValueData",(function(){return uO})),r.d(l,"namedFormulaData",(function(){return cO})),r.d(l,"namedRangeData",(function(){return sO})),r.d(l,"namedFailureData",(function(){return lO})),r.d(l,"namedObject",(function(){return fO})),r.d(l,"namedObjectsUpdate",(function(){return dO})),r.d(l,"namedObjectsWrite",(function(){return hO})),r.d(l,"undefinedNamesWrite",(function(){return pO})),r.d(l,"namedObjectsPromote",(function(){return vO})),r.d(l,"rangeFormulaEdit",(function(){return mO})),r.d(l,"cellFormulaRangeFormulaEdit",(function(){return gO})),r.d(l,"valueRangeFormulaEdit",(function(){return CO})),r.d(l,"inferredRangeFormulaEdit",(function(){return SO})),r.d(l,"arrayFormulaEdit",(function(){return kO})),r.d(l,"inferredFormat",(function(){return RO})),r.d(l,"cellDataDelta",(function(){return bO})),r.d(l,"rangeDelta",(function(){return IO})),r.d(l,"arrayDelta",(function(){return TO})),r.d(l,"rangeFailure",(function(){return NO})),r.d(l,"recalcResults",(function(){return FO})),r.d(l,"updateRequest",(function(){return _O})),r.d(l,"recalcServiceConfig",(function(){return MO})),r.d(l,"createRecalcService",(function(){return kI})),r.d(l,"RecalcServiceCreateMode",(function(){return EI})),r.d(l,"recalcServiceInsideDef",(function(){return AI}));var f=r(1);function d(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function h(e,t,r){return void 0===r&&(r=0),r+t.length<=e.length&&e.substring(r,r+t.length)===t}function p(e){var t=[];return Object.keys(e).map(Number).forEach((function(r){return t[r]=e[r]})),t}function v(e){if(null==e||"object"!=typeof e)return"<not object>";var t=e,r=String(t.message);if(null!=t.stack){var n=String(t.stack);return n.indexOf(r)>=0?n:"Error: "+r+"\n"+n}return r}function m(e){return e}function g(e,t){if("string"==typeof t&&null!=S[t])return e;var r=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),n=void 0!==r?y[r]:void 0;return void 0===n&&(n=E[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(e instanceof Array)return"Array"}return t}(e)]),void 0!==n?n(e,t):"<unexpected>"}function C(e){try{return JSON.stringify(g(e,void 0))}catch(e){return e instanceof Error?"<error "+e.name+": "+JSON.stringify(e.message)+">":"<error: "+JSON.stringify(e)+">"}}var S={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},E={boolean:m,symbol:m,undefined:m,null:m,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function "+t+">":"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=g(e[r],r));return t},Array:function(e){return"object"==typeof e&&e instanceof Array?e.map(g):"<unexpected>"}},y=Object.create(null),O={ULS:new(function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){if(!r)throw new Error("shipAssertTag "+e+" "+t+" "+n)},e.prototype.assertTag=function(e,t,r,n){if(!r)throw new Error("assertTag "+e+" "+t+" "+n)},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}())};function A(e){O.ULS=e}function k(e,t){var r=e+": code should be unreachable because a value has type 'never'; given "+C(t);return O.ULS.assertTag(595980872,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}function R(e){return O.ULS.assertTag(595980873,f.LogCategory.msoulscat_ES_EWAJS,!1,e)}function b(e,t){t||R(e+": expected condition to be true")}function I(e,t){(!d(t)||t<0)&&R(e+": expected natural number; given "+C(t))}function T(e,t){(!d(t)||t<=0)&&R(e+": expected positive integer; given "+C(t))}function N(e,t,r){(!d(t)||t<0||t>=r)&&R(e+": expected natural number less than "+C(r)+"; given "+C(t))}function F(e,t,r){(!d(t)||t<=0||t>r)&&R(e+": expected positive integer at most "+C(r)+"; given "+C(t))}var _,M,w,L,D,U,x,P=r(0);function G(e){return void 0===e&&(e=0),{kind:M.Error,isQuoted:!1,label:e}}function V(e){return void 0===e&&(e=0),{kind:M.Relative,isQuoted:!1,label:e}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(_||(_={})),function(e){e.Error="QualError",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(M||(M={})),function(e){e.Error="RefError",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(w||(w={})),function(e){e.Abs="Abs",e.Rel="Rel"}(L||(L={})),function(e){e.WorksheetFuncName="WorksheetFuncName",e.LocalName="LocalName"}(D||(D={})),function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.Bad="Bad",e.Operator="Operator"}(U||(U={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Sequence="Sequence"}(x||(x={}));var W=G(),B=V();function j(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:M.Document,isQuoted:r,label:n,document:e,path:t}}function H(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:M.Sheet,isQuoted:r,label:n,sheet:e,document:t}}function K(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:M.Ident,isQuoted:t,label:r,name:e}}function q(e,t,r,n,a){return void 0===n&&(n=!1),void 0===a&&(a=0),{kind:M.SheetRange,isQuoted:n,label:a,sheet1:e,sheet2:t,document:r}}function J(e,t){return{kind:e,index:t}}function Q(e){return void 0===e&&(e=0),{kind:w.Error,label:e}}var X,Y,z,Z,$,ee,te=Q();function re(e,t,r){return void 0===r&&(r=0),{kind:w.Single,label:r,row:e,col:t}}function ne(e,t,r){return void 0===r&&(r=0),{kind:w.Range,label:r,ref1:e,ref2:t}}function ae(e,t,r){return void 0===r&&(r=0),{kind:w.Row,label:r,row1:e,row2:t}}function ie(e,t,r){return void 0===r&&(r=0),{kind:w.Col,label:r,col1:e,col2:t}}function oe(e,t,r){return{node:e,spans:t,annotations:r}}function ue(e,t,r,n){var a,i;return I("calc.lang.formulaSpan",e),a="calc.lang.formulaSpan",d(i=t)||R(a+": expected integer; given "+C(i)),t<e&&R("calc.lang.formulaSpan: expected end >= "+e+"; given "+t),{start:e,end:t,pre:r,post:n}}function ce(e){return{kind:D.WorksheetFuncName,id:e}}function se(e){return{kind:D.LocalName,name:e}}function le(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:U.Literal,label:r,oper:e,isClosed:t}}function fe(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:U.Array,label:r,nodes:e,isClosed:t}}function de(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:U.App,label:n,head:e,args:t,isClosed:r}}function he(e,t){return void 0===t&&(t=0),{kind:U.Operator,label:t,id:e}}function pe(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:U.Paren,label:r,node:e,isClosed:t}}function ve(e,t,r){return void 0===r&&(r=0),{kind:U.Name,label:r,whole:e,qualifier:t}}function me(e,t,r){return void 0===r&&(r=0),{kind:U.CellRef,label:r,ref:e,qualifier:t}}function ge(e,t,r){return void 0===r&&(r=0),{kind:U.Bad,label:r,type:e,contents:t}}function Ce(e,t,r,n,a,i,o){(I("calc.lang.functionType",e),0===r.length?0!==n.length:n.length>=r.length)&&R("calc.lang.functionType: expected tailTypes.length < restTypes.length; given "+JSON.stringify(n));0===r.length&&t.length+n.length<e&&R("calc.lang.functionType: expected headTypes.length + tailTypes.length >= "+e+"; given "+JSON.stringify(t));return{minArgs:e,headTypes:t,restTypes:r,tailTypes:n,returnType:a,staticPrecs:i,flags:o}}!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(X||(X={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(Y||(Y={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(z||(z={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",e[e.Internal=8]="Internal",e[e.Allow3dRef=16]="Allow3dRef"}(Z||(Z={})),function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(ee||(ee={}));var Se,Ee;function ye(e,t,r,n){return{cells:e,names:t,special:r,bound:n}}function Oe(e){var t=we[e];return void 0!==t?t:Me(e)}!function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=13]="FIELD"}(Se||(Se={})),function(e){e[e.First=1]="First",e[e.Last=13]="Last"}(Ee||(Ee={}));var Ae=Me(Se.NULL),ke=Me(Se.DIV0),Re=Me(Se.VALUE),be=Me(Se.REF),Ie=Me(Se.NAME),Te=Me(Se.NUM),Ne=Me(Se.NA),Fe=Me(Se.GETTING_DATA),_e=Me(Se.FIELD);function Me(e){return{kind:X.Error,type:e}}var we=p((($={})[Se.NULL]=Ae,$[Se.DIV0]=ke,$[Se.VALUE]=Re,$[Se.REF]=be,$[Se.NAME]=Ie,$[Se.NUM]=Te,$[Se.NA]=Ne,$[Se.GETTING_DATA]=Fe,$[Se.FIELD]=_e,$));function Le(e,t,r){return I("calc.lang.arrayOper",e),I("calc.lang.arrayOper",t),r.length!==e?R("calc.lang.arrayOper: Inconsistent row number"):{kind:X.Array,rows:e,cols:t,opers:r}}function De(e,t){return T("calc.lang.rangeSeqOper",t.length),{kind:X.Range,sheets:e,ranges:t}}function Ue(e,t){return{kind:X.Range,sheets:e,ranges:[t]}}var xe,Pe={kind:X.Missing},Ge={kind:X.Blank};!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.SUBARRAY=634]="SUBARRAY",e[e.APPENDROWS=635]="APPENDROWS",e[e.APPENDCOLUMNS=636]="APPENDCOLUMNS",e[e.SELECTROW=637]="SELECTROW",e[e.SELECTCOLUMN=638]="SELECTCOLUMN",e[e.LET=639]="LET",e[e.FUN=640]="FUN",e[e.ARRAYMAKE=641]="ARRAYMAKE",e[e.APPLY=642]="APPLY",e[e.ISFUN=643]="ISFUN",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.RECORD=646]="RECORD",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.TESTFUNCTIONBEGIN=649]="TESTFUNCTIONBEGIN",e[e.IMAGE=650]="IMAGE",e[e.GRF=651]="GRF",e[e.UNIT=652]="UNIT",e[e.RICHERROR=653]="RICHERROR",e[e.COUNTER=654]="COUNTER",e[e.BROKENRECORD=655]="BROKENRECORD",e[e.FORMULABYTES=656]="FORMULABYTES",e[e.FORMULACODE=657]="FORMULACODE",e[e.FORMULAHTML=658]="FORMULAHTML",e[e.STREAM=659]="STREAM",e[e.FORMATTEDNUMBER=660]="FORMATTEDNUMBER",e[e.LETREC=680]="LETREC"}(xe||(xe={}));var Ve,We=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[637,"SelectRow"],[638,"SelectColumn"],[641,"ARRAY.MAKE"]].reduce((function(e,t){return e[t[0]]=t[1],e}),[]),Be=[],je=[[1,Be,[57],Be,1,0,16],[1,[36,831,831],Be,Be,823,0,0],[1,[15],Be,Be,4,0,0],[1,[15],Be,Be,4,0,0],[1,Be,[305],Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[0,[16],Be,Be,33,0,0],[0,[16],Be,Be,33,0,0],[0,Be,Be,Be,3,0,16],[2,[1],[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,[1,1],Be,Be,2,0,0],[1,[1,65,4],Be,Be,2,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[0,Be,Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[263,48,48],Be,Be,263,0,0],[2,[48,1,1,1],Be,Be,311,0,0],[2,[2,1],Be,Be,2,0,0],[3,[2,1,1],Be,Be,2,0,0],[1,[2],Be,Be,1,0,0],[1,[7],Be,Be,1,0,0],[0,Be,Be,Be,4,0,16],[0,Be,Be,Be,4,0,16],[1,Be,[52],Be,4,0,16],[1,Be,[52],Be,4,0,16],[1,[4],Be,Be,4,0,16],[2,[1,1],Be,Be,1,0,0],[3,[16,83,18],Be,Be,1,0,0],[3,[16,19,18],Be,Be,1,0,0],[3,[16,19,18],Be,Be,1,0,0],[3,[16,19,18],Be,Be,1,0,0],[3,[16,19,18],Be,Be,1,0,0],[3,[16,19,18],Be,Be,1,0,0],[1,Be,[49],Be,1,0,16],[3,[16,19,18],Be,Be,1,0,0],[2,[7,2],Be,Be,2,0,0],[1,[48,112,84,84],Be,Be,32,0,0],[1,[48,112,112,84],Be,Be,32,0,0],[1,[48,112,84,84],Be,Be,32,0,0],[1,[48,112,112,84],Be,Be,32,0,0],[1,[16],Be,Be,512,0,2],[0,[4],Be,Be,512,0,2],[0,[575],Be,Be,512,0,2],[3,[1,1,1,1,1],Be,Be,1,0,0],[3,[1,1,1,1,1],Be,Be,1,0,0],[3,[1,1,1,1,1],Be,Be,1,0,0],[3,[1,1,1,1,1],Be,Be,1,0,0],[3,[1,1,1,1,1,1],Be,Be,1,0,0],[3,[48,1,1],Be,Be,1,0,16],[1,[48,1],Be,Be,1,0,0],[0,Be,Be,Be,1,16383,0],[2,[263,305,17],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1,1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[0,Be,Be,Be,1,16383,0],[1,[16],Be,Be,1,0,0],[1,[48],Be,Be,1,0,0],[1,[48],Be,Be,1,0,0],[3,[16,65,65,65,65],Be,Be,16,16383,0],[2,[2,16],Be,Be,16,0,2],[2,[16,16],Be,Be,2,0,2],[0,[66,81,16],Be,Be,4,0,2],[2,[2,2,1],Be,Be,1,0,0],[1,[39],Be,Be,32,0,0],[0,[1,24],Be,Be,4,0,2],[0,Be,Be,Be,4,0,2],[1,[303],Be,Be,1,0,0],[0,[4],Be,Be,4,0,2],[1,[2,63],Be,Be,4,0,2],[0,Be,Be,Be,50,0,2],[1,[16],Be,Be,47,0,2],[0,[65,66],Be,Be,32,0,2],[4,[87,117,117,1,117],Be,Be,4,0,0],[0,[1,66],Be,Be,32,0,2],[0,Be,Be,Be,16,0,2],[0,Be,Be,Be,16,0,2],[0,[1],Be,Be,4,0,2],[2,[1,1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[2,[33],[831],Be,823,0,0],[3,[263,49,49,4],Be,Be,295,0,0],[3,[263,49,49,4],Be,Be,295,0,0],[0,[66,65],Be,Be,32,0,2],[1,[2,65,66,67,65,65,2],Be,Be,575,0,2],[1,[63],Be,Be,4,0,0],[1,[18],Be,Be,2,0,2],[1,[2,4],Be,Be,6,0,2],[2,[16,47],Be,Be,4,0,2],[1,[1,1],Be,Be,1,0,0],[1,[2,1,4,4],Be,Be,7,0,2],[1,[1],Be,Be,2,0,0],[1,[2],Be,Be,2,0,0],[1,[2],Be,Be,2,0,0],[1,[2],Be,Be,2,0,0],[1,[2,9],Be,Be,2,0,0],[1,[2,9],Be,Be,2,0,0],[2,[2,2],Be,Be,4,0,0],[1,[2],Be,Be,2,0,0],[4,[2,1,1,2],Be,Be,2,0,0],[3,[2,2,2,2],Be,Be,2,0,0],[1,[2],Be,Be,1,0,0],[0,[66,65,66],Be,Be,32,0,2],[0,[2],Be,Be,2,0,2],[2,[2,2,1],Be,Be,1,0,0],[1,[2,16],Be,Be,303,16383,0],[1,[15],Be,Be,4,0,0],[1,[143],Be,Be,4,0,0],[1,[143],Be,Be,4,0,0],[1,[143],Be,Be,4,0,0],[1,[23],Be,Be,2,0,0],[1,[23],Be,Be,1,0,0],[1,[2,1],Be,Be,1,0,2],[1,[1],Be,Be,1,0,2],[1,[1],Be,Be,1,0,2],[1,[1],Be,Be,2,0,2],[2,[1,1],Be,Be,2,0,2],[2,[1,2],Be,Be,1,0,2],[2,[1,2],Be,Be,1,0,2],[1,[1,1],Be,Be,1,0,2],[1,[3],Be,Be,1,0,0],[1,[3],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[4,[1,1,1,1],Be,Be,1,0,0],[4,[1,1,1,1,1],Be,Be,1,0,0],[1,[2,66,65],Be,Be,2,0,2],[1,[16,4],Be,Be,2,0,2],[1,[2,4],Be,Be,16,0,2],[1,[2,4],Be,Be,16,16383,0],[1,[2,3,66,66,66,65,67,66,67],[66],Be,3,0,2],[1,[3],[127],Be,575,0,2],[0,[3],Be,Be,1,0,2],[2,[3,115,83,3],Be,Be,1,0,2],[3,[3,83,115,83,3],Be,Be,1,0,2],[4,[3,3,3,4,3],Be,Be,4,0,2],[4,[3,3,3,4,3],Be,Be,4,0,2],[4,[3,3,3,3,3],Be,Be,4,0,2],[0,[3],Be,Be,4,0,2],[2,[3,3,3],Be,Be,4,0,2],[3,[3,3,3,3],Be,Be,4,0,2],[1,[1,67,66],Be,Be,1,0,2],[1,[52],Be,Be,36,0,2],[1,[2],Be,Be,2,0,0],[1,[32],Be,Be,1,0,0],[1,[32],Be,Be,32,0,0],[2,[32,32],Be,Be,32,0,0],[0,[2,2],Be,Be,32,0,2],[4,[1,1,1,1,1,1],Be,Be,1,0,0],[4,[1,1,1,1,1,1],Be,Be,1,0,0],[1,Be,[121],Be,1,0,16],[0,[1,16],Be,Be,4,0,2],[3,[2,1,1,1],Be,Be,512,0,2],[1,[4],Be,Be,512,0,2],[0,Be,Be,Be,512,0,2],[0,Be,Be,Be,512,0,2],[2,[2,2],Be,Be,1,0,2],[2,[1,2],Be,Be,32,0,2],[3,[1,18,18],Be,Be,4,0,2],[2,[1,2],Be,Be,4,0,2],[1,[1],Be,Be,4,0,2],[0,[1],Be,Be,512,0,2],[0,[2],Be,Be,4,0,2],[0,[3,3,3,3],Be,Be,3,0,2],[1,Be,[113],Be,1,0,16],[1,[1],Be,Be,1,0,0],[1,[1,16],Be,Be,47,0,2],[1,[1],Be,Be,47,0,2],[1,[1,2],Be,Be,47,0,2],[1,[1,2],Be,Be,63,0,2],[3,[16,19,18],Be,Be,1,0,0],[1,[143],Be,Be,4,0,0],[0,[82,65,65],Be,Be,2,0,2],[0,[66,82,17,17],Be,Be,1,0,2],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[3,[16,19,18],Be,Be,1,0,0],[3,[16,19,18],Be,Be,1,0,0],[1,[1,1],Be,Be,1,0,0],[1,[143],Be,Be,4,0,0],[3,[16,83,18],Be,Be,1,0,0],[1,[3],Be,Be,4,0,2],[1,[3],Be,Be,4,0,2],void 0,void 0,[1,[1,1],Be,Be,2,0,0],[2,[2,2,1],Be,Be,1,0,0],[2,[2,2,1],Be,Be,1,0,0],[4,[2,1,1,2],Be,Be,2,0,0],[1,[2,9],Be,Be,2,0,0],[1,[2,9],Be,Be,2,0,0],[3,[2,1,1],Be,Be,2,0,0],[1,[2],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[1,[2],Be,Be,2,0,0],[1,[2],Be,Be,2,0,0],[2,[1,16,4],Be,Be,1,0,16],void 0,void 0,[2,[1,65,65,68,66],Be,Be,2,0,0],[2,[1,1,4],Be,Be,1,0,0],[0,Be,Be,Be,1,16383,0],[5,[1,1,1,1,1,1,4],Be,Be,1,0,0],[0,Be,Be,Be,512,0,2],[1,[12],Be,Be,512,0,2],[0,Be,Be,Be,512,0,2],[1,[2,82,84],Be,Be,512,0,2],[1,Be,[49],Be,1,0,16],[1,Be,[32],Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[3,[16,19,18],Be,Be,263,0,0],[2,[1,18,17,17,18,17,17,115,84,21,17],Be,Be,2,0,2],[0,[4],Be,Be,4,0,2],[0,Be,Be,Be,16,0,2],[0,[2,2],Be,Be,4,0,2],[0,[2,2,2],Be,Be,4,0,2],[2,[2,23,23,23,23],Be,Be,2,0,2],[2,[2,1,1,2],Be,Be,1,0,2],[1,[2,66,65,65],Be,Be,1,0,2],[1,[2],Be,Be,3,16383,0],[0,Be,Be,Be,2,0,2],[1,[1,2,1,1,1],Be,Be,47,0,2],[4,[1,1,1,1,1],Be,Be,1,0,0],[0,[4],Be,Be,512,0,2],void 0,void 0,[0,[1],Be,Be,512,0,2],[2,[48,48],Be,Be,32,0,16],[0,[66,96],Be,Be,2,0,2],[1,[2],Be,Be,4,0,2],[1,[17],[127],Be,575,0,0],[1,[3],Be,Be,4,0,2],[1,[2],Be,Be,63,0,2],[1,[1,3],Be,Be,47,0,2],[1,[1,3,1],Be,Be,47,0,2],[1,[2,66,4],Be,Be,4,0,2],[1,[15],Be,Be,1,0,0],[0,[2],Be,Be,4,0,2],[0,[2],Be,Be,4,0,2],[0,[99,66],Be,Be,4,0,2],[3,[3,1,4],Be,Be,4,0,2],[3,[3,1,4],Be,Be,4,0,2],[2,[2,3,66],Be,Be,1,0,2],[1,[1,2],Be,Be,35,0,2],[1,Be,[49],Be,1,0,16],[3,[1,1,1,65,65],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[3,[1,1,1,65,65],Be,Be,1,0,0],[4,[1,1,1,4],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[3,[1,1,4],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[4,[1,1,1,4],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[4,[1,1,1,1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[4,[1,1,1,4],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[3,[1,1,4],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[4,[1,1,1,4],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[3,[1,32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[4,[32,32,1,1],Be,Be,1,0,0],[3,[32,32,1,65],Be,Be,1,0,0],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[2,[49,1,1],Be,Be,1,0,16],[2,[49,1],Be,Be,1,0,16],[2,[49,1],Be,Be,1,0,16],[2,[49,1],Be,Be,1,0,16],[2,[49,1],Be,Be,1,0,16],[2,[49,1,65],Be,Be,1,0,16],[1,Be,[32],Be,1,0,16],[2,[49,1],Be,Be,1,0,16],[2,[1,1],Be,Be,1,0,0],void 0,[3,[2,1,1,1],Be,Be,1,0,2],[2,[2,1,1],Be,Be,1,0,2],[1,Be,[2],Be,2,0,0],[2,[1,1],Be,Be,1,0,0],[2,[66,2,66,65,65,65,66,66,66],Be,Be,2,0,2],[1,[1,2],Be,Be,35,0,2],[1,[1,66,2],Be,Be,35,0,2],[1,[1,66,66,2],Be,Be,7,0,2],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[2,[1],[16],Be,1,0,0],[2,[16,15,16],Be,Be,1,0,0],[2,[16,15],Be,Be,1,0,0],[1,[16],Be,Be,1,0,0],[1,[1,2],Be,Be,19,0,2],[1,[33],Be,Be,33,0,2],[4,[1,1,1,1],Be,Be,1,0,0],[3,[1,1,2],Be,Be,1,0,0],[1,[1],Be,Be,2,0,0],[2,[1,1],Be,Be,2,0,0],[1,[1,5],Be,Be,2,0,0],[0,[66,66,66,65],Be,Be,6,0,2],[0,[66,66,66,66,65],Be,Be,6,0,2],[1,[1,2],Be,Be,19,0,2],[2,[18,18],[2,79],Be,15,0,0],[1,[2,39],Be,Be,39,0,0],[1,[16],Be,Be,2,0,0],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,[1],Be,Be,2,0,0],[1,[1],Be,Be,2,0,0],[1,[3],Be,Be,2,0,0],[1,[1],Be,Be,2,0,0],[1,[1],Be,Be,2,0,0],[1,[1],Be,Be,2,0,0],[1,[2],Be,Be,1,0,0],[1,[2],Be,Be,4,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[3,Be,[2],Be,2,0,0],[1,[2],[50],Be,15,0,0],[2,[2,50,2],Be,Be,10,0,0],[3,[2,2,2],Be,Be,15,0,0],[3,[2,2,1,2],Be,Be,10,0,0],[1,[95,95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95,95],Be,Be,9,0,0],[1,[95,95],Be,Be,9,0,0],[1,[95,95],Be,Be,9,0,0],[1,[95,95],Be,Be,9,0,0],[1,[95,95],Be,Be,9,0,0],[1,[95,95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95,95],Be,Be,9,0,0],[1,[95,95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[2,[95,95,95],Be,Be,9,0,0],[1,Be,[127],Be,9,0,0],[1,Be,[127],Be,9,0,0],[4,[95,95,95,127],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[1,[95,95],Be,Be,9,0,0],[1,[95,95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[1,[95,95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[2,[127,127,95],Be,Be,9,0,0],[3,[95,127,127],Be,Be,9,0,0],[5,[95,95,95,95,95,95],Be,Be,9,0,0],[5,[95,95,95,95,95,95],Be,Be,9,0,0],[4,[95,95,95,95,95],Be,Be,9,0,0],[4,[95,95,95,95,95],Be,Be,9,0,0],[4,[95,95,95,95,95],Be,Be,9,0,0],[4,[95,95,95,95,95],Be,Be,9,0,0],[4,[95,95,95,95,95],Be,Be,9,0,0],[3,[95,95,95],Be,Be,9,0,0],[3,[95,95,95],Be,Be,9,0,0],[3,[95,95,95],Be,Be,9,0,0],[6,[95,95,95,95,95,95,95],Be,Be,9,0,0],[6,[95,95,95,95,95,95,95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[6,[95,95,95,95,95,95],Be,Be,9,0,0],[6,[95,95,95,95,95,95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,0,0],[2,[95,95,95],Be,Be,9,0,0],[3,[95,95,95,95],Be,Be,9,0,0],[3,[95,95,95,95],Be,Be,9,0,0],[3,[95,95,95,95],Be,Be,9,0,0],[3,[95,95,95,95],Be,Be,9,0,0],[3,[95,95,95,95],Be,Be,9,0,0],[3,[95,95,95,95],Be,Be,9,0,0],[5,[95,95,95,95,95,95],Be,Be,9,0,0],[5,[95,95,95,95,95,95],Be,Be,9,0,0],[7,[95,95,95,95,95,95,95,95],Be,Be,9,0,0],[7,[95,95,95,95,95,95,95,95],Be,Be,9,0,0],[8,[95,95,95,95,95,95,95,95,95],Be,Be,9,0,0],[8,[95,95,95,95,95,95,95,95,95],Be,Be,9,0,0],[2,[95,95],Be,Be,9,16383,0],[1,[95,95],Be,Be,9,0,0],[6,[95,95,95,95,95,95,95],Be,Be,9,0,0],[6,[95,95,95,95,95,95,95],Be,Be,9,0,0],[3,[95,95,95],Be,Be,9,0,0],[6,[95,95,95,95,95,95,95,95],Be,Be,9,0,0],[4,[95,95,95,95,95],Be,Be,9,0,0],[2,[95,95,127],Be,Be,9,0,0],[2,[95,95,127],Be,Be,9,0,0],[1,Be,[127],Be,9,0,0],[1,Be,[127],Be,9,0,0],[1,Be,[127],Be,9,0,0],[2,[95,127],Be,Be,9,0,0],[3,[2,2,1,2],Be,Be,10,0,0],[2,[2,50,2,1,2],Be,Be,10,0,0],[1,[2],Be,Be,9,0,0],[2,[47,575],Be,Be,303,0,0],[2,Be,[16,15],Be,1,0,0],[3,[16],[16,15],Be,1,0,0],[2,[16,15,16],Be,Be,1,0,0],[3,[16],[16,15],Be,1,0,0],[3,[1,1,48,17],[16],Be,1,0,0],[4,[1,1,1,4],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[2,[32,32],Be,Be,1,0,0],[3,[1,1,4],Be,Be,1,0,0],[4,[1,1,1,4],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[1,Be,[32],Be,32,0,16],[1,Be,[32],Be,1,0,16],[4,[1,1,1,4],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[2,[49,1],Be,Be,1,0,16],[2,[49,1],Be,Be,1,0,16],[2,[49,1,65],Be,Be,1,0,16],[2,[49,1,65],Be,Be,1,0,16],[3,[1,1,4],Be,Be,1,0,0],[2,[49,1],Be,Be,1,0,16],[2,[49,1],Be,Be,1,0,16],[2,[1,16,4],Be,Be,1,0,16],[2,[1,16,4],Be,Be,1,0,16],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[3,[1,1,4],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[1,Be,[49],Be,1,0,16],[1,Be,[49],Be,1,0,16],[4,[1,1,1,4],Be,Be,1,0,0],[2,[95,95,75,127],Be,Be,9,0,0],[2,[95,95,75,127],Be,Be,9,0,0],[2,[1,1],Be,Be,1,0,0],[1,[1,65],Be,Be,1,0,0],void 0,[4,[1,1,1,4,65,65],Be,Be,1,0,0],[3,[1,1,1,65,65],Be,Be,1,0,0],[3,[1,1,4],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[4,[1,1,1,4],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[5,[1,1,1,1,4],Be,Be,1,0,0],[4,[1,1,1,4],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[4,[1,1,1,4],Be,Be,1,0,0],[2,[1,4],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[4,[32,32,1,1],Be,Be,1,0,0],[2,[49,1,1],Be,Be,1,0,16],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[1],Be,Be,1,0,0],[1,[1,65],Be,Be,1,0,0],[1,[1,65],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[2,[1,1],Be,Be,1,0,0],[1,Be,[52],Be,4,0,16],[3,[1,1,1],Be,Be,1,0,0],[2,[1,1,65],Be,Be,2,0,0],[2,[2,1],Be,Be,1,0,0],[2,[3,3],Be,Be,1,0,0],[3,[1,1,1,65],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,Be,[49],Be,1,0,16],[1,[1],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[3,[1,1,1],Be,Be,1,0,0],[1,[1],Be,Be,2,0,0],[1,[2],Be,Be,1,0,0],[1,[1],Be,Be,32,0,0],[1,[2],Be,Be,1,0,0],[1,[1],Be,Be,1,0,0],[1,[2,66,66],Be,Be,1,0,0],[0,[50],Be,Be,1,16383,16],[0,[48],Be,Be,1,16383,16],[1,[16],Be,Be,2,16383,0],[1,[16],Be,Be,4,0,0],[2,[47,575],Be,Be,303,0,0],[1,[1,65,65],Be,Be,1,0,0],[1,[1,65,65],Be,Be,1,0,0],[1,[95],Be,Be,9,0,0],[1,[95],Be,Be,9,0,0],[2,[2,2],Be,Be,47,0,0],[1,[2],Be,Be,10,0,0],[1,[2],Be,Be,10,0,0],[3,[1,48,48,65,65,65],Be,Be,1,0,0],[3,[1,48,48,65,65,65,65],Be,Be,1,0,0],[2,[48,48,65,65],Be,Be,1,0,0],[3,[1,32,32],Be,Be,1,0,0],[3,[48,48,1,65,65,65],Be,Be,1,0,0],[3,[16],[16,15],Be,1,0,0],[3,[16],[16,15],Be,1,0,0],[3,[114,68],[114],Be,2,0,16],[1,Be,[114],Be,2,0,16],[2,Be,[44,575],Be,831,0,0],[3,[47],[575,575],[575],831,0,0],[1,[1399],Be,Be,1375,0,17],[2,Be,[113,113],Be,1,0,17],[1,[16],Be,Be,48,0,21],[2,[271,2,4],Be,Be,303,0,21],[2,[271,2],Be,Be,303,0,17],[2,[48,48,111],Be,Be,303,0,1],[1,[160,96,96,4],Be,Be,32,0,1],[1,[160,4,4],Be,Be,32,0,1],[2,[2,256],Be,Be,1,0,8],[3,[2,49,1],Be,Be,1,0,25],[3,[2,49,1],Be,Be,1,0,25],[2,[2],[49],Be,1,0,25],[2,[2,2,65,68,68],Be,Be,1,0,1],[1,[2,65,65],Be,Be,2,0,1],[2,[2,2,65,68],Be,Be,2,0,1],[2,[2,2,65,68],Be,Be,2,0,1],[2,[2,98,98,68],Be,Be,32,0,1],[1,[32,96,96,4],Be,Be,32,0,9],[2,[4,16],Be,Be,32,0,25],[2,[391,48,65,65],Be,Be,1,0,1],[3,[391,48,48,511,65,65],Be,Be,319,0,1],[2,[160],[160,65],Be,32,0,1],[0,[65,65,65,65,68],Be,Be,32,16383,1],[1,[65,65,65,65],Be,Be,32,0,1],[2,[258,1,65,65,68],[65],Be,32,0,17],[1,[48,65,65,65,65],Be,Be,48,0,1],[1,[48],[48],Be,32,0,1],[1,[48],[48],Be,32,0,1],[1,[48,33],[33],Be,32,0,1],[1,[48,33],[33],Be,32,0,1],[3,Be,[319,319],[319],319,0,1],[1,Be,[319],Be,319,0,1],[3,[1,1,319],Be,Be,32,0,1],[1,Be,[319],Be,319,0,1],[1,[319],Be,Be,4,0,1],[1,[319],Be,Be,9,0,1],[0,Be,Be,Be,319,0,1],[3,[15],[2,47],Be,303,0,17],[1,[399,1],Be,Be,2,0,1],[1,[32,1],Be,Be,2,0,1],[0,Be,Be,Be,1,0,1],[1,[2],Be,Be,258,0,1],[1,[287,2],Be,Be,288,0,17],[2,[15,2],Be,Be,271,0,17],[1,[1],Be,Be,10,0,17],[0,Be,Be,Be,1,0,1],[3,[47],[2,47],Be,47,0,17],[1,[16],Be,Be,2,16383,1],[1,[16],Be,Be,2,16383,1],[1,[16],Be,Be,2,16383,1],[0,[1],Be,Be,1,0,1],[2,[1,1],Be,Be,265,0,17],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,Be,[319,319],[319],319,0,1]].map((function(e){return void 0===e?void 0:Ce.apply(void 0,e)})),He=Ce(0,[],[Y.All],[],Y.All,z.All,Z.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.Dot=24]="Dot",e[e.At=25]="At",e[e.Pound=26]="Pound"}(Ve||(Ve={}));var Ke,qe,Je=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,".","@","#"],Qe=X.Number|X.String|X.Boolean|X.Blank,Xe=X.Number|X.String|X.Boolean|X.Blank,Ye=Ce(2,[X.Number,X.Number],[],[],X.Number,z.None,Z.None),ze=Ce(1,[X.Number],[],[],X.Number,z.None,Z.None),Ze=Ce(1,[Qe],[],[],Qe,z.None,Z.None),$e=Ce(2,[X.String,X.String],[],[],X.String,z.None,Z.None),et=Ce(2,[Xe,Xe],[],[],X.Boolean,z.None,Z.None),tt=Ce(2,[X.Range,X.Range],[],[],X.Range,z.AllCells,Z.None),rt=Ce(2,[X.Range,X.Range],[],[],X.Range,z.None,Z.None),nt=Ce(2,[X.Boolean,X.Boolean],[],[],X.Boolean,z.None,Z.None),at=[];function it(e){var t=at[e];return null!=t?t:He}function ot(e){var t=je[e];return null!=t?t:He}function ut(e,t){var r=je[e];null!=r&&(r.staticPrecs=t)}function ct(e){return{kind:Ke.Success,value:e}}function st(e){return{kind:Ke.Failure,reason:e}}function lt(e){return null!=e&&e.kind===Ke.Success}function ft(e){return{kind:qe.JavaScriptError,error:e}}function dt(e){return e.index===e.index2}function ht(e){return e.isWellFormed}function pt(e){return 1===e.rows&&1===e.cols}function vt(e){return dt(e.sheet)}function mt(e){return pt(e.range)}function gt(e,t){if(pt(e))return t(e,0,0);for(var r=e.row,n=e.rows,a=e.col,i=e.cols,o=0;o<n;o+=1)for(var u=0;u<i;u+=1)if(!t(tr(r+o,a+u),o,u))return!1;return!0}function Ct(e,t){return e===t||e.name===t.name&&e.path===t.path}function St(e,t){return Ct(e.document,t.document)&&e.index===t.index}function Et(e,t){return e.row===t.row&&e.col===t.col}function yt(e,t){return St(e.sheet,t.sheet)&&Et(e.range,t.range)}function Ot(e){return pt(e)?e:$t(e.row,e.col,1,1)}function At(e){return mt(e)?e:ir(e.sheet,Ot(e.range))}function kt(e,t){var r=e.row,n=e.col,a=t.row,i=t.col;return $t(Math.min(r,a),Math.min(n,i),Math.abs(a-r)+1,Math.abs(i-n)+1)}function Rt(e,t){function r(r){var n=e.spans[r.label];return void 0!==n&&n.start<=t&&t<n.end}for(var n=e.node,a=!0;a;)switch(a=!1,n.kind){case U.Array:for(var i=n.nodes,o=i.length-1;!a&&o>=0;o-=1)for(var u=i[o],c=u.length-1;!a&&c>=0;c-=1){r(l=u[c])&&(n=l,a=!0)}break;case U.App:var s=n.args;for(c=s.length-1;!a&&c>=0;c-=1){r(l=s[c])&&(n=l,a=!0)}break;case U.Paren:var l;r(l=n.node)&&(n=l,a=!0);break;case U.Bad:case U.Name:case U.CellRef:case U.Literal:break;default:k("getSubExpressionFromPosition",n)}return n}function bt(e,t){var r=-1,n=document.elementFromPoint(e,t);if(void 0!==document.caretPositionFromPoint)null!==(a=document.caretPositionFromPoint(e,t))&&(r=a.offset);else if(void 0!==document.caretRangeFromPoint){null!==(a=document.caretRangeFromPoint(e,t))&&(r=a.startOffset)}else try{var a;(a=document.body.createTextRange()).moveToPoint(e,t);var i=document.body.createTextRange();i.moveToElementText(n),i.setEndPoint("EndToStart",a),r=i.text.length}catch(e){return r}for(;null!=n&&"SPAN"===n.nodeName;)null!=(n=n.previousSibling)&&null!=n.textContent&&(r+=n.textContent.length);return r}at[Ve.Add]=Ye,at[Ve.Sub]=Ye,at[Ve.Mul]=Ye,at[Ve.Div]=Ye,at[Ve.Pow]=Ye,at[Ve.Percent]=ze,at[Ve.Neg]=ze,at[Ve.At]=je[xe.SINGLE],at[Ve.Pound]=je[xe.ANCHORARRAY],at[Ve.Pos]=Ze,at[Ve.Concat]=$e,at[Ve.Eq]=et,at[Ve.Ne]=et,at[Ve.Lt]=et,at[Ve.Le]=et,at[Ve.Gt]=et,at[Ve.Ge]=et,at[Ve.Range]=tt,at[Ve.Isect]=rt,at[Ve.Union]=rt,at[Ve.And]=nt,at[Ve.Or]=nt,at[Ve.Xor]=nt,at[Ve.Min]=Ye,at[Ve.Max]=Ye,at[Ve.Dot]=je[xe._FV],ut(xe.ROW,z.OwnRow),ut(xe.COLUMN,z.OwnCol),ut(xe.SHEET,z.OwnDocSheets),ut(xe.SHEETS,z.OwnDocSheets),ut(xe.OFFSET,z.AllCells),ut(xe.INDIRECT,z.AllCells),ut(xe.SUMIF,z.AllCells),ut(xe.AVERAGEIF,z.AllCells),ut(xe.LOOKUP,z.AllCells),ut(xe.ADDRESS,z.RefStyle),ut(xe.FORMULATEXT,z.RefStyle),ut(xe.NOW,z.Time),ut(xe.TODAY,z.Time),ut(xe.RAND,z.Calc),ut(xe.RANDBETWEEN,z.Calc),ut(xe.RANDARRAY,z.Calc),ut(xe.SUBTOTAL,z.CellProps),ut(xe.CELL,z.CellProps|z.AllCells),ut(xe.INFO,z.None),function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(Ke||(Ke={})),function(e){e.JavaScriptError="JavaScriptError"}(qe||(qe={}));var It,Tt=[];function Nt(e){return 0===function(e){if(1===e.args.length){var t=e.args[0];if(t.kind===U.Literal&&Lt(t.oper)===X.Missing)return 0}return e.args.length}(e)?Tt:e.args}function Ft(e){return e.kind===U.Operator}function _t(e){return e.kind===U.Name&&void 0===e.qualifier}function Mt(e,t,r){var n=e.headTypes,a=e.restTypes,i=e.tailTypes;if(T("calc.runtime.getArgType: n",r),N("calc.runtime.getArgType: i",t,r),t<n.length)return n[t];if(0===a.length)return Y.None;var o=(r-n.length)%a.length;return o>i.length?Y.None:t>=r-o?i[t-(r-o)]:a[(t-n.length)%a.length]}function wt(e,t){var r=e.minArgs,n=e.headTypes,a=e.restTypes,i=e.tailTypes;return!(t<r)&&(t<=n.length||0!==a.length&&(t-n.length)%a.length<=i.length)}function Lt(e){switch(typeof e){case"number":return X.Number;case"string":return X.String;case"boolean":return X.Boolean;default:return e.kind}}function Dt(e){return"number"==typeof e&&isFinite(e)}function Ut(e,t,r){if(typeof t!=typeof e)return!1;if("object"!=typeof t||"object"!=typeof e)return t===e;if(t.kind!==e.kind)return!1;switch(t.kind){case X.Error:return t.type===e.type;case X.Rich:return r;case X.Array:var n=e;if(t.cols!==n.cols||t.rows!==n.rows)return!1;for(var a=0;a<t.rows;a+=1)for(var i=t.opers[a],o=n.opers[a],u=0;u<t.cols;u+=1)if(!Ut(o[u],i[u],r))return!1;return!0;case X.Blank:return!0;default:return k("calc.lang.readOperEq",t)}}!function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable"}(It||(It={}));var xt=Object(P.a)(Object(P.a)({},qe),It);function Pt(e){return{kind:xt.NotImplemented,features:e}}function Gt(e){return 0===e.length&&R("calc.lang.unavailable: expected nonempty array"),{kind:xt.Unavailable,objects:e}}var Vt,Wt=function(e){this.reason=e,this.name="EvaluationError",this.stack="EvaluationError",this.message=e.kind};function Bt(e){if(null!=e){var t=e.path,r=e.name;return null!=t&&"string"!=typeof t?(O.ULS.traceTag(595969803,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"Illegal document path: type is "+typeof t),Xt):"string"!=typeof r?(O.ULS.traceTag(595969804,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"Illegal document name: type is "+typeof r),Xt):e}}function jt(e,t){var r=0===e.stringCompareCI(t.substr(0,6),"_xlfn.")?t.slice(6):t;return r=0===e.stringCompareCI(r.substr(0,6),"_xlws.")?r.slice(6):r,e.getWorksheetFuncId(r)}function Ht(e,t){var r=t.whole;return 0===e.stringCompareCI(r.substr(0,6),"_xludf.")?r.slice(6):r}function Kt(e){return{kind:Vt.Cell,range:e}}function qt(e){return{kind:Vt.Range,range:e}}function Jt(e,t){switch(e){case Vt.Cell:return mt(t)?Kt(t):R("calc.lang.lexicalSourceGrid: expected cell");case Vt.Range:return qt(t)}}function Qt(e){return{kind:Vt.NameManager,name:e}}(Wt.prototype=Object.create(Error.prototype)).constructor=Wt,function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.Other=7]="Other"}(Vt||(Vt={}));var Xt=Yt(void 0,"");function Yt(e,t){return{path:e,name:t}}function zt(e,t,r){return{document:e,index:t,index2:r,length:1}}function Zt(e,t){return zt(e,t,t)}function $t(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function er(e,t,r,n){return N("calc.lang.gridRange",e,1<<20),N("calc.lang.gridRange",t,16384),F("calc.lang.gridRange",r,(1<<20)-e),F("calc.lang.gridRange",n,16384-t),$t(e,t,r,n)}function tr(e,t){return N("calc.lang.gridCell",e,1<<20),N("calc.lang.gridCell",t,16384),$t(e,t,1,1)}function rr(e,t){return{sheet:e,range:t}}var nr=rr,ar=rr,ir=rr,or=rr;function ur(e){return{document:e,index:void 0}}function cr(e,t){return void 0===t?ur(e):Zt(e,t)}function sr(e,t){return{scope:e,name:t}}function lr(e,t){return{document:e,path:t}}function fr(e,t){return{wrap:e,unwrap:t}}function dr(e){return e}function hr(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function pr(e){return null!=e}function vr(e){return null==e}function mr(e,t){return pr(e)?e:t}function gr(e,t){return[e,t]}function Cr(e,t){return e<t?e:t}function Sr(e,t){return e<t?t:e}function Er(e){return e<0?-e:e}function yr(e){try{var t=new Intl.Collator(function(e){var t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}}var Or="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};function Ar(e){return 32===e||10===e}function kr(e,t,r,n){N("calc.parse.parseUint",t,16);for(var a=0,i=n,o=r.length;i<o;i+=1){var u=r.charCodeAt(i);if(!e.isNumeral(u))break;var c=e.getOrdinal(u);0===a&&0!==c&&(o=Cr(o,i+t)),a=10*a+c}return i===o&&i<r.length&&e.isNumeral(r.charCodeAt(i))?[0,n]:[a,i]}var Rr=43,br=45;function Ir(e,t,r,n){var a=n,i=0,o="";if(h(r,e.decimalSeparator,n)||r.length>n&&e.isNumeral(r.charCodeAt(n))){for(;a<r.length;a+=1){var u=r.charCodeAt(a);if(!e.isNumeral(u))break;if(0!==e.getOrdinal(u))break}for(var c=a;a<r.length;a+=1){u=r.charCodeAt(a);if(!e.isNumeral(u))break;i+=1}o+=r.substring(c,a);var s=!1;if(h(r,e.decimalSeparator,a)&&(s=a===n,a+=e.decimalSeparator.length),0===i)for(;a<r.length;a+=1){u=r.charCodeAt(a);if(!e.isNumeral(u))break;if(0!==e.getOrdinal(u))break;i-=1}for(c=a;a<r.length;a+=1){u=r.charCodeAt(a);if(!e.isNumeral(u))break}if(o+=r.substring(c,a),!(s&&a<=n+e.decimalSeparator.length)){var l=function(e,t,r){var n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!(n+1<t.length&&"**"===t.substring(n,n+2)))return[0,r];n+=2}var a=!1;if(n<t.length){var i=t.charCodeAt(n);((a=i===br)||i===Rr)&&(n+=1)}if(n>=t.length||!e.isNumeral(t.charCodeAt(n)))return!1;var o=kr(e,10,t,n),u=o[0],c=o[1];return c!==n&&(!(u>2147483647)&&[a?-u:u,c])}(e,r,a);if(!1!==l)i+=l[0],a=l[1];return!1===l||Er(i)>=309?{value:void 0,i:a}:{value:t.parse(e,!0,i,o),i:a}}}}var Tr=1<<20,Nr=Tr.toString(10).length,Fr=16384,_r=Fr.toString(26).length,Mr=Fr.toString(10).length;function wr(e){return e>=97&&e<=122||e>=65&&e<=90}function Lr(e){return 1+(e>=97?e-97:e-65)}function Dr(e,t,r){return function(n,a,i,o){var u=function(e,t){return"$"===e[t]?[L.Abs,t+1]:[L.Rel,t]}(i,o),c=u[0],s=u[1],l=e(n,r,i,s),f=l[0],d=l[1];if(d>s){if(f<1||f>t)return;return[J(c,(c===L.Rel?f-a:f)-1),!1,d]}return[void 0,!1,o]}}function Ur(e,t,r){return zr(e,t,r)-e}function xr(e,t,r,n){return function(a,i,o,u){var c=t?e?"R":a.rowLetter:e?"C":a.columnLetter;if(u>=o.length||0!==a.stringCompareCI(c,o[u]))return[void 0,!1,u];var s=u+1,l=kr(a,n,o,s),f=l[0],d=l[1];if(d>s){if(f<1||f>r)return;return[J(L.Abs,f-1),!1,d]}if(o[s]===a.leftBracket){if(o[s+=1]===a.rightBracket)return[J(L.Rel,Ur(i,0,r)),!0,s+1];var h=1;"+"===o[s]?s+=1:"-"===o[s]&&(h=-1,s+=1);var p=kr(a,n,o,s),v=p[0],m=p[1];if(m>s&&v<r&&o[m]===a.rightBracket)return[J(L.Rel,Ur(i,v*h,r)),!0,m+1]}return[!1,!1,d]}}function Pr(e,t,r,n,a,i,o){var u=n(e,t,i,o);if(null==u)return[void 0,void 0,o];var c=u[0],s=u[1],l=u[2];if(l>o){var f=a(e,r,i,l);if(null==f)return s?[c,void 0,l]:[void 0,void 0,o];var d=f[0],h=f[2];return h>l?[c,d,h]:[c,void 0,l]}var p=a(e,r,i,o);if(null==p)return[void 0,void 0,o];var v=p[0],m=p[2];return m>o?[void 0,v,m]:[void 0,void 0,o]}var Gr=Dr(kr,Tr,Nr),Vr=Dr((function(e,t,r,n){return function(e,t,r){for(var n=0,a=r,i=Math.min(t.length,r+e);a<i;a+=1){var o=t.charCodeAt(a);if(!wr(o))break;n=26*n+Lr(o)}return a===i&&wr(t.charCodeAt(a))?[0,r]:[n,a]}(t,r,n)}),Fr,_r),Wr=xr(!1,!0,Tr,Nr),Br=xr(!1,!1,Fr,Mr),jr=xr(!0,!0,Tr,Nr),Hr=xr(!0,!1,Fr,Mr);function Kr(e,t,r,n,a){var i,o=r.col,u=r.row;if(t===_.A1){var c=Pr(e,o,u,Vr,Gr,n,a),s=c[0],l=c[1],f=c[2];if(null!=l&&null!=s||null!=l&&l.kind===L.Abs||null!=s&&s.kind===L.Abs||(null!=l||null!=s)&&(":"===n[a-1]||":"===n[f])){if(f>=n.length||!e.isIdentContinue(n.charCodeAt(f)))return{refStyle:_.A1,row:l,col:s,i:f};if("."===n[f])return}}var d=!1,h=Pr(e,u,o,Wr,Br,n,a),p=h[0],v=h[1],m=h[2];if(null!=p||null!=v||"R"===e.rowLetter&&"C"===e.columnLetter||(d=!0,p=(i=Pr(e,u,o,jr,Hr,n,a))[0],v=i[1],m=i[2]),null!=p||null!=v){var g=null!=p&&!1!==p||null!=v&&!1!==v;if(m>=n.length||g||!e.isIdentContinue(n.charCodeAt(m)))return{refStyle:_.R1C1,row:p,col:v,i:m,enLocale:d}}}function qr(e,t){var r=Pr(e,0,0,Vr,Gr,t,0),n=r[0],a=r[1],i=r[2];return void 0!==n&&void 0!==a&&i===t.length?tr(a.index,n.index):void 0}function Jr(e,t){var r=Pr(e,0,0,Vr,Gr,t,0),n=r[0],a=r[1],i=r[2];if(void 0!==n&&void 0!==a){if(i===t.length)return tr(a.index,n.index);if(":"===t[i]){var o=Pr(e,0,0,Vr,Gr,t,i+1),u=o[0],c=o[1],s=o[2];if(void 0!==u&&void 0!==c&&s===t.length){var l=Cr(a.index,c.index),f=Cr(n.index,u.index);return er(l,f,Sr(a.index,c.index)+1-l,Sr(n.index,u.index)+1-f)}}}}var Qr=J(L.Abs,0),Xr=J(L.Abs,1048575);function Yr(e){for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(65+n)+r,t=Math.floor((t-n)/26)}return r}function zr(e,t,r){return e+t&r-1}function Zr(e,t,r,n){if(t.kind===L.Abs)return t.index;if(n)return zr(e,t.index,r);var a=e+t.index;return 0<=a&&a<r?a:void 0}function $r(e,t,r,n,a,i){var o=Zr(r,n,a,i);if(void 0!==o){if(n.kind===L.Abs)return t+(o+1).toFixed();var u=o-r;return 0===u?t:t+e.leftBracket+u.toFixed()+e.rightBracket}}function en(e,t,r,n,a){return t===_.A1?function(e,t,r){var n=Zr(e,t,1<<20,r);if(void 0!==n){var a=(n+1).toFixed();return t.kind===L.Abs?"$"+a:a}}(r,n,a):$r(e,e.rowLetter,r,n,1<<20,a)}function tn(e,t,r,n,a){return t===_.A1?function(e,t,r){var n=Zr(e,t,16384,r);if(void 0!==n){var a=Yr(n);return t.kind===L.Abs?"$"+a:a}}(r,n,a):$r(e,e.columnLetter,r,n,16384,a)}function rn(e,t,r,n){if(r.kind===L.Abs)return r;var a=Zr(t,r,e,n);if(void 0!==a){var i=a-t;return i===r.index?r:J(L.Rel,i)}}rn.bind(void 0,1<<20),rn.bind(void 0,16384);function nn(e,t,r,n,a){var i=Zr(e,t,n,a),o=Zr(e,r,n,a);if(void 0!==i&&void 0!==o)return i<=o?[t,r,i,o]:[r,t,o,i]}function an(e,t,r,n,a,i,o,u,c){var s=nn(i,o,u,r,c);if(void 0!==s){var l=s[0],f=s[1],d=s[2],h=s[3];if(void 0!==t&&0===d&&h===r-1&&o.kind===u.kind)return t(n,a,c);var p=e(n,a,i,l,c);if(void 0!==p){if(a===_.R1C1&&l.kind===f.kind&&l.index===f.index)return p;var v=e(n,a,i,f,c);if(void 0!==v)return p+":"+v}}}var on=an.bind(void 0,en,void 0,1<<20),un=an.bind(void 0,tn,(function(e,t,r){return on(e,t,0,Qr,Xr,r)}),16384);function cn(e,t,r,n,a,i){var o=nn(r,n,a,t,i);if(void 0!==o){var u=o[0],c=o[1],s=o[2],l=o[3];if(void 0!==e&&0===s&&l===t-1&&n.kind===a.kind)return e;var f=rn(t,r,u,i),d=rn(t,r,c,i);if(void 0!==f&&void 0!==d)return[!1,f,d]}}cn.bind(void 0,void 0,1<<20),cn.bind(void 0,[!0,Qr,Xr],16384);function sn(e,t,r,n,a,i){var o=en(e,t,r.row,n,i),u=tn(e,t,r.col,a,i);if(void 0!==o&&void 0!==u)return t===_.A1?u+o:o+u}function ln(e,t,r,n,a,i,o,u){var c=nn(r.row,n,i,1<<20,u),s=nn(r.col,a,o,16384,u);if(void 0!==c&&void 0!==s){var l=c[0],f=c[1],d=c[2],h=c[3],p=s[0],v=s[1],m=s[2],g=s[3];if(0===m&&16383===g&&a.kind===o.kind)return on(e,t,r.row,l,f,u);if(0===d&&1048575===h&&n.kind===i.kind)return un(e,t,r.col,p,v,u);var C=sn(e,t,r,l,p,u),S=sn(e,t,r,f,v,u);if(void 0!==C&&void 0!==S)return C+":"+S}}var fn=/'/g;function dn(e,t){if(0===t.length)return!1;if(!e.isIdentStart(t.charCodeAt(0)))return!1;for(var r=1;r<t.length;r+=1)if(!e.isIdentContinue(t.charCodeAt(r)))return!1;return!0}var hn=tr(0,0);function pn(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;var n=Kr(e,t,hn,r,0);if(void 0!==n){var a=n.refStyle,i=n.i;if(a!==_.A1)return!0;if(void 0===e.getWorksheetFuncId(r.substring(0,i)))return!0}return!dn(e,r)&&(!function(e,t){var r=0;if(t.substring(r,r+e.leftBracket.length)!==e.leftBracket)return!1;if((r+=e.leftBracket.length)===t.length||!e.isIdentContinue(t.charCodeAt(r)))return!1;for(r+=1;;){if(t.substring(r,r+e.rightBracket.length)===e.rightBracket){r+=e.rightBracket.length;break}if(r===t.length||!e.isIdentContinue(t.charCodeAt(r)))return!1;r+=1}var n=t.indexOf(":",r);return n<0?dn(e,t.substring(r)):dn(e,t.substring(r,n))&&dn(e,t.substring(n+1))}(e,r)&&!function(e,t){var r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&(t.substring(0,r)===e.leftBracket&&(t.substring(t.length-n)===e.rightBracket&&dn(e,t.substring(r,t.length-n))))}(e,r))}function vn(e,t,r){return pn(e,t,r)?"'"+r.replace(fn,"''")+"'":r}function mn(e,t,r){var n=1===t.cols&&1===t.rows?sn(e,_.A1,tr(0,0),J(L.Rel,t.row),J(L.Rel,t.col),!1):ln(e,_.A1,tr(0,0),J(L.Rel,t.row),J(L.Rel,t.col),J(L.Rel,t.row+t.rows-1),J(L.Rel,t.col+t.cols-1),!1);return b("calc.lang.formatGridRangeA1",void 0!==n),void 0===r?n:vn(e,_.A1,r)+"!"+n}var gn,Cn=r(3),Sn={ULS:new f.NulLogger},En=Object(f.initStopwatchFactory)((function(e){return Sn.ULS.traceTag(595948114,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,e)}));function yn(e,t){return Object(P.b)(this,void 0,void 0,(function(){var r;return Object(P.d)(this,(function(n){switch(n.label){case 0:r=En(e),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,t()];case 2:return[2,n.sent()];case 3:return r.stop(),[7];case 4:return[2]}}))}))}!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcNewFunctions="CalcNewFunctions",e.CalcContractChecks="CalcContractChecks",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcFormatCalculations="CalcFormatCalculations",e.CalcFormulaCacheAPIChanges="CalcFormulaCacheAPIChanges",e.CalcStrictFormulaChecking="CalcStrictFormulaChecking",e.CalcSupportRowReference="CalcSupportRowReference",e.CalcFieldValueFunction="CalcFieldValueFunction",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcLetFunction="CalcLetFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcFunFunctions="CalcFunFunctions",e.CalcWebWorker="CalcWebWorker",e.CalcWebWorkerTest="CalcWebWorkerTest",e.CalcWorksheetFunctions="CalcWorksheetFunctions",e.CalcLogStopWatch="CalcLogStopWatch",e.CalcDynamicArrayOperators="CalcDynamicArrayOperators",e.CalcExcelMath="CalcExcelMath",e["OfficeVSO:3832565_CalcCGRowColRefs"]="OfficeVSO:3832565_CalcCGRowColRefs",e["OfficeVSO:3832568_CalcCGGetUsedRange"]="OfficeVSO:3832568_CalcCGGetUsedRange",e["OfficeVSO:3852168_CalcCGIFS"]="OfficeVSO:3852168_CalcCGIFS",e["OfficeVSO:3852168_CalcCGSWITCH"]="OfficeVSO:3852168_CalcCGSWITCH",e["OfficeVSO:3852168_CalcCGAVERAGEIF"]="OfficeVSO:3852168_CalcCGAVERAGEIF",e["OfficeVSO:3852168_CalcCGAVERAGEIFS"]="OfficeVSO:3852168_CalcCGAVERAGEIFS",e["OfficeVSO:3852168_CalcCGCOUNT"]="OfficeVSO:3852168_CalcCGCOUNT",e["OfficeVSO:3852168_CalcCGCOUNTIF"]="OfficeVSO:3852168_CalcCGCOUNTIF",e["OfficeVSO:3852168_CalcCGCOUNTIFS"]="OfficeVSO:3852168_CalcCGCOUNTIFS",e["OfficeVSO:3852168_CalcCGMEDIAN"]="OfficeVSO:3852168_CalcCGMEDIAN",e["OfficeVSO:3852168_CalcCGSUMSQ"]="OfficeVSO:3852168_CalcCGSUMSQ",e["OfficeVSO:3852168_CalcCGSUMIF"]="OfficeVSO:3852168_CalcCGSUMIF",e["OfficeVSO:3852168_CalcCGSUMIFS"]="OfficeVSO:3852168_CalcCGSUMIFS",e["OfficeVSO:3852168_CalcCGROWS"]="OfficeVSO:3852168_CalcCGROWS",e["OfficeVSO:3852168_CalcCGCOLUMNS"]="OfficeVSO:3852168_CalcCGCOLUMNS",e["OfficeVSO:3852168_CalcCGINDEX"]="OfficeVSO:3852168_CalcCGINDEX",e["OfficeVSO:3852168_CalcCGMATCH"]="OfficeVSO:3852168_CalcCGMATCH",e["OfficeVSO:3852168_CalcCGLOOKUP"]="OfficeVSO:3852168_CalcCGLOOKUP",e["OfficeVSO:3852168_CalcCGHLOOKUP"]="OfficeVSO:3852168_CalcCGHLOOKUP",e["OfficeVSO:3852168_CalcCGVLOOKUP"]="OfficeVSO:3852168_CalcCGVLOOKUP",e["OfficeVSO:3852168_CalcCGLARGE"]="OfficeVSO:3852168_CalcCGLARGE",e["OfficeVSO:3852168_CalcCGSMALL"]="OfficeVSO:3852168_CalcCGSMALL",e["OfficeVSO:3852168_CalcCGPERCENTILE"]="OfficeVSO:3852168_CalcCGPERCENTILE",e["OfficeVSO:3852168_CalcCGPERCENTILE_EXC"]="OfficeVSO:3852168_CalcCGPERCENTILE_EXC",e["OfficeVSO:3852168_CalcCGQUARTILE"]="OfficeVSO:3852168_CalcCGQUARTILE",e["OfficeVSO:3852168_CalcCGQUARTILE_EXC"]="OfficeVSO:3852168_CalcCGQUARTILE_EXC",e["OfficeVSO:3852168_CalcCGRANK"]="OfficeVSO:3852168_CalcCGRANK",e["OfficeVSO:3852168_CalcCGRANK_AVG"]="OfficeVSO:3852168_CalcCGRANK_AVG",e["OfficeVSO:3852168_CalcCGTRIMMEAN"]="OfficeVSO:3852168_CalcCGTRIMMEAN",e["OfficeVSO:3852168_CalcCGTRUE"]="OfficeVSO:3852168_CalcCGTRUE",e["OfficeVSO:3852168_CalcCGFALSE"]="OfficeVSO:3852168_CalcCGFALSE",e["OfficeVSO:3852168_CalcCGNOT"]="OfficeVSO:3852168_CalcCGNOT",e["OfficeVSO:3852168_CalcCGNA"]="OfficeVSO:3852168_CalcCGNA",e["OfficeVSO:3852168_CalcCGAVERAGEA"]="OfficeVSO:3852168_CalcCGAVERAGEA",e["OfficeVSO:3852168_CalcCGMAXA"]="OfficeVSO:3852168_CalcCGMAXA",e["OfficeVSO:3852168_CalcCGMINA"]="OfficeVSO:3852168_CalcCGMINA",e["OfficeVSO:3852168_CalcCGMAXIFS"]="OfficeVSO:3852168_CalcCGMAXIFS",e["OfficeVSO:3852168_CalcCGMINIFS"]="OfficeVSO:3852168_CalcCGMINIFS",e["OfficeVSO:3852168_CalcCGXOR"]="OfficeVSO:3852168_CalcCGXOR",e["OfficeVSO:3852168_CalcCGT"]="OfficeVSO:3852168_CalcCGT",e["OfficeVSO:3852168_CalcCGN"]="OfficeVSO:3852168_CalcCGN",e["OfficeVSO:3852168_CalcCGHYPERLINK"]="OfficeVSO:3852168_CalcCGHYPERLINK",e["OfficeVSO:3852168_CalcCGAGGREGATE"]="OfficeVSO:3852168_CalcCGAGGREGATE",e["OfficeVSO:3852168_CalcCGSUBTOTAL"]="OfficeVSO:3852168_CalcCGSUBTOTAL",e["OfficeVSO:3852168_CalcCGVAR"]="OfficeVSO:3852168_CalcCGSVAR",e["OfficeVSO:3852168_CalcCGVARP"]="OfficeVSO:3852168_CalcCGVARP",e["OfficeVSO:3852168_CalcCGSTDEV"]="OfficeVSO:3852168_CalcCGSTDEV",e["OfficeVSO:3852168_CalcCGSTDEVP"]="OfficeVSO:3852168_CalcCGSTDEVP",e["OfficeVSO:3852168_CalcCGVARA"]="OfficeVSO:3852168_CalcCGSVARA",e["OfficeVSO:3852168_CalcCGVARPA"]="OfficeVSO:3852168_CalcCGVARPA",e["OfficeVSO:3852168_CalcCGSTDEVA"]="OfficeVSO:3852168_CalcCGSTDEVA",e["OfficeVSO:3852168_CalcCGSTDEVPA"]="OfficeVSO:3852168_CalcCGSTDEVPA",e["OfficeVSO:3852168_CalcCGAVEDEV"]="OfficeVSO:3852168_CalcCGAVEDEV",e["OfficeVSO:3852168_CalcCGDEVSQ"]="OfficeVSO:3852168_CalcCGDEVSQ",e["OfficeVSO:3852168_CalcCGMODE"]="OfficeVSO:3852168_CalcCGMODE",e["OfficeVSO:3852168_CalcCGMODE_MULT"]="OfficeVSO:3852168_CalcCGMODE_MULT",e["OfficeVSO:3852168_CalcCGTYPE"]="OfficeVSO:3852168_CalcCGTYPE",e["OfficeVSO:3852168_CalcCGERROR_TYPE"]="OfficeVSO:3852168_CalcCGERROR_TYPE",e["OfficeVSO:3852168_CalcCGAREAS"]="OfficeVSO:3852168_CalcCGAREAS",e["OfficeVSO:3852168_CalcCGSHEETS"]="OfficeVSO:3852168_CalcCGSHEETS",e["OfficeVSO:3852168_CalcCGROW"]="OfficeVSO:3852168_CalcCGROW",e["OfficeVSO:3852168_CalcCGCOLUMN"]="OfficeVSO:3852168_CalcCGCOLUMN",e["OfficeVSO:3852168_CalcCGSHEET"]="OfficeVSO:3852168_CalcCGSHEET",e["OfficeVSO:3852168_CalcCGOFFSET"]="OfficeVSO:3852168_CalcCGOFFSET",e["OfficeVSO:3852168_CalcCGEXACT"]="OfficeVSO:3852168_CalcCGEXACT",e["OfficeVSO:3852168_CalcCGREPT"]="OfficeVSO:3852168_CalcCGREPT",e["OfficeVSO:3852168_CalcCGTRIM"]="OfficeVSO:3852168_CalcCGTRIM",e["OfficeVSO:3852168_CalcCGCLEAN"]="OfficeVSO:3852168_CalcCGCLEAN",e["OfficeVSO:3852168_CalcCGCHAR"]="OfficeVSO:3852168_CalcCGCHAR",e["OfficeVSO:3852168_CalcCGUNICHAR"]="OfficeVSO:3852168_CalcCGUNICHAR",e["OfficeVSO:3852168_CalcCGCODE"]="OfficeVSO:3852168_CalcCGCODE",e["OfficeVSO:3852168_CalcCGUNICODE"]="OfficeVSO:3852168_CalcCGUNICODE",e["OfficeVSO:3852168_CalcCGLOWER"]="OfficeVSO:3852168_CalcCGLOWER",e["OfficeVSO:3852168_CalcCGUPPER"]="OfficeVSO:3852168_CalcCGUPPER",e["OfficeVSO:3852168_CalcCGPROPER"]="OfficeVSO:3852168_CalcCGPROPER",e["OfficeVSO:3852168_CalcCGFIND"]="OfficeVSO:3852168_CalcCGFIND",e["OfficeVSO:3852168_CalcCGSEARCH"]="OfficeVSO:3852168_CalcCGSEARCH",e["OfficeVSO:3852168_CalcCGREPLACE"]="OfficeVSO:3852168_CalcCGREPLACE",e["OfficeVSO:3852168_CalcCGSUBSTITUTE"]="OfficeVSO:3852168_CalcCGSUBSTITUTE",e["OfficeVSO:3852168_CalcCGISFORMULA"]="OfficeVSO:3852168_CalcCGISFORMULA",e["OfficeVSO:3852168_CalcCGFORMULATEXT"]="OfficeVSO:3852168_CalcCGFORMULATEXT",e["OfficeVSO:3852168_CalcCGINFO"]="OfficeVSO:3852168_CalcCGINFO",e["OfficeVSO:3852168_CalcCGDELTA"]="OfficeVSO:3852168_CalcCGDELTA",e["OfficeVSO:3852168_CalcCGGESTEP"]="OfficeVSO:3852168_CalcCGGESTEP",e["OfficeVSO:3852168_CalcCGTRANSPOSE"]="OfficeVSO:3852168_CalcCGTRANSPOSE",e["OfficeVSO:3852168_CalcCGADDRESS"]="OfficeVSO:3852168_CalcCGADDRESS",e["OfficeVSO:3852168_CalcCGINDIRECT"]="OfficeVSO:3852168_CalcCGINDIRECT",e["OfficeVSO:3852168_CalcCGTEXTJOIN"]="OfficeVSO:3852168_CalcCGTEXTJOIN",e["OfficeVSO:3852168_CalcCGCHOOSE"]="OfficeVSO:3852168_CalcCGCHOOSE",e["OfficeVSO:3852168_CalcCGSQRTPI"]="OfficeVSO:3852168_CalcCGSQRTPI",e["OfficeVSO:3852168_CalcCGFACTDOUBLE"]="OfficeVSO:3852168_CalcCGFACTDOUBLE",e["OfficeVSO:3852168_CalcCGINT"]="OfficeVSO:3852168_CalcCGINT",e["OfficeVSO:3852168_CalcCGTRUNC"]="OfficeVSO:3852168_CalcCGTRUNC",e["OfficeVSO:3852168_CalcCGODD"]="OfficeVSO:3852168_CalcCGODD",e["OfficeVSO:3852168_CalcCGMROUND"]="OfficeVSO:3852168_CalcCGMROUND",e["OfficeVSO:3852168_CalcCGQUOTIENT"]="OfficeVSO:3852168_CalcCGQUOTIENT",e["OfficeVSO:3852168_CalcCGFLOOR.MATH"]="OfficeVSO:3852168_CalcCGFLOOR.MATH",e["OfficeVSO:3852168_CalcCGFLOOR.PRECISE"]="OfficeVSO:3852168_CalcCGFLOOR.PRECISE",e["OfficeVSO:3852168_CalcCGCEILING.MATH"]="OfficeVSO:3852168_CalcCGCEILING.MATH",e["OfficeVSO:3852168_CalcCGCEILING.PRECISE"]="OfficeVSO:3852168_CalcCGCEILING.PRECISE"}(gn||(gn={}));var On,An=function(e){return!1},kn={};function Rn(e){return void 0===kn[e]&&(kn[e]=An(e)),kn[e]}function bn(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var r=0;r<e.length;r+=2)for(var n=e[r],a=e[r+1],i=n;i<a;i+=1)t(i,n,a)}!function(e){e[e.Ordinal=15]="Ordinal",e[e.DigitClass=16]="DigitClass",e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"}(On||(On={}));var In=function(e,t,r){var n;function a(e){n[e]|=On.IdentStartClass}function i(e){n[e]|=On.IdentContinueClass}function o(e,t){n[e]|=On.DigitClass,n[e]|=e-t}return function(u){if(void 0===n){var c=Sr(e[e.length-1],Sr(t[t.length-1],r[r.length-1]));n=new Uint8Array(c),bn(e,a),bn(t,i),bn(r,o);for(var s=4969;s<4978;s+=1)o(s,4968)}var l=n[u];return void 0!==l?l:0}}([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2238,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3333,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12731,12784,12800,13312,19894,19968,40944,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42951,42999,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43880,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[46,47,48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2238,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2902,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3332,3333,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3458,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6847,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11160,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12731,12736,12772,12784,12831,12832,19894,19904,40944,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42951,42999,43052,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43880,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534],[48,58,1632,1642,1776,1786,1984,1994,2406,2416,2534,2544,2662,2672,2790,2800,2918,2928,3046,3056,3174,3184,3302,3312,3430,3440,3558,3568,3664,3674,3792,3802,3872,3882,4160,4170,4240,4250,6112,6122,6160,6170,6470,6480,6608,6618,6784,6794,6800,6810,6992,7002,7088,7098,7232,7242,7248,7258,42528,42538,43216,43226,43264,43274,43472,43482,43504,43514,43600,43610,44016,44026,65296,65306]);function Tn(e,t){return{key:e,value:t}}var Nn=function(){function e(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([e,t])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var r=this.getKeyIndex(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,this.values[r]]},e.prototype.filter=function(e){for(var t=[],r=0;r<this.keys.length;r+=1){var n=this.keys[r],a=this.values[r];e(n,a)&&t.push([n,a])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return Tn(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0},e.prototype.setValues=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this.keys.map((function(t,r){return[t,e.values[r],r]})),a=n.length;t.forEach((function(e,t){var r=e[0],i=e[1];return n.push([r,i,t+a])})),n.sort((function(t,r){var n=t[0],a=t[2],i=r[0],o=r[2],u=e.keyCompare(n,i);return 0!==u?u:a-o}));for(var i=[],o=void 0,u=0;u<n.length;u+=1){var c=n[u],s=c[0],l=c[1];void 0===o||0!==this.keyCompare(s,o)?(i.push([s,l]),o=s):i[i.length-1]=[s,l]}return this.ofSequence(i)},e.prototype.getKeyIndex=function(e){for(var t=Fn;t>=0&&t<this.keys.length;){var r=this.keyCompare(e,this.keys[t]);if(0===r)return t;r<0?t=_n(t):r>0&&(t=Mn(t))}},e.prototype.ofSequence=function(t){var r=this,n=t.slice();n.sort((function(e,t){var n=e[0],a=t[0];return r.keyCompare(n,a)}));for(var a=new Array(n.length),i=new Array(n.length),o=function(e){var t=new Array(e);return function e(t,r,n,a){if(t>=r.length)return;var i=function(e){var t=function(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}(e);if(t/2-1<=e-t)return t-1;return e-t/2}(a);r[t]=n+i,e(_n(t),r,n,i),e(Mn(t),r,n+i+1,a-i-1)}(Fn,t,0,e),t}(n.length),u=0;u<n.length;u+=1){var c=n[o[u]],s=c[0],l=c[1];a[u]=s,i[u]=l}return new e(this.keyCompare,a,i)},e}(),Fn=0;function _n(e){return 2*e+1}function Mn(e){return 2*e+2}function wn(e){return isFinite(e)?e:Te}function Ln(e,t){return e<t?-1:e>t?1:0}var Dn=["0","1","2","3","4","5","6","7","8","9"];var Un={zero:0,one:1,pi:Math.PI,add:function(e,t){return wn(e+t)},sub:function(e,t){return wn(e-t)},mul:function(e,t){return wn(e*t)},div:function(e,t){return 0===t?ke:wn(e/t)},power:function(e,t){var r=Math.pow(e,t);return isFinite(r)?r:isNaN(r)?ke:Te},percent:function(e){return e/100},neg:function(e){return-e},compare:Ln,formatGeneral:function(e,t,r){var n=e.decimalSeparator,a=String(t).replace("e","E");return"."!==n&&(a=a.replace(".",n)),a},parse:function(e,t,r,n){return Number((t?"":"-")+"0."+function(e,t){for(var r=e.getOrdinal,n="",a=0;a<t.length;a+=1)n+=Dn[r(t.charCodeAt(a))];return n}(e,n)+"E"+r)},trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)},ceil:Math.ceil.bind(Math),floor:Math.floor.bind(Math),abs:Math.abs.bind(Math),cond:function(e){return Ln(e,0)},cond2:Ln,fromNumber:dr,toNumber:dr,sqrt:function(e){return wn(Math.sqrt(e))},exp:function(e){return wn(Math.exp(e))},ln:function(e){return wn(Math.log(e))},log:function(e){return wn(Math.log(e)/Math.LN10)},sin:Math.sin.bind(Math),cos:Math.cos.bind(Math),tan:Math.tan.bind(Math),asin:function(e){return wn(Math.asin(e))},acos:function(e){return wn(Math.acos(e))},atan:function(e){return wn(Math.atan(e))},atan2:function(e,t){return Math.atan2(t,e)},round:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.substring(r.indexOf("e")+1),a=parseInt(n,10),i=Un.trunc(t)+a+1;if(0===i){var o=parseFloat("5e"+n);if(Math.abs(e)>=o)return wn((e<0?-1:1)*parseFloat("10e"+n))}return i<1?0:i>21?e:wn(parseFloat(e.toExponential(i-1)))},roundUp:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.indexOf("e"),a="-"===r.substring(0,1)?"-":"",i=r.substring(a.length,n),o=r.substring(n+1),u=parseInt(o,10),c=Un.trunc(t)+u+1;return c<1?wn(parseFloat(a+"10e"+(u-c))):c>21?e:wn(parseFloat(a+function(e,t){var r=e.replace(".","");if(r.length<=t)return e;for(var n=r.substring(0,t),a=0,i=n.length-1;i>=0&&n.charCodeAt(i)-48==9;i-=1)a+=1;if(a===n.length)return"10";var o=n.substring(0,n.length-a-1)+String.fromCharCode(n.charCodeAt(n.length-a-1)+1);return o.substring(0,1)+"."+o.substring(1)}(i,c)+"e"+o))},roundDown:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.indexOf("e"),a="-"===r.substring(0,1)?"-":"",i=r.substring(a.length,n),o=r.substring(n+1),u=parseInt(o,10),c=Un.trunc(t)+u+1;if(c<1)return 0;if(c>21)return e;var s=i.substring(0,c+1);return wn(parseFloat(a+s+"e"+o))},checkAlmostCancellation:function(e,t){return t},fix:function(e){var t=Math.abs(e);return t>=4294967296?4294967295:Math.floor(t)},lfix:function(e){var t=Un.trunc(e);return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){var t=Un.floor(e);return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:dr},xn=r(2),Pn=xn.mathpack.zero(),Gn=xn.mathpack.one(),Vn=xn.mathpack.pi();function Wn(e){return 0!=(e.num&xn.mathpack.MathErrorNum.DivBy0)?ke:Te}function Bn(e){return function(t){return R("calc.runtime."+e+": error "+JSON.stringify(t))}}function jn(e,t){return function(r){var n=e(r);return"number"==typeof n?n:t(n)}}function Hn(e,t){return function(r,n){var a=e(r,n);return"number"==typeof a?a:t(a)}}var Kn=Hn((function(e,t){return xn.mathpack.equal(t,2)?xn.mathpack.mul(e,e):xn.mathpack.power(e,t)}),Wn),qn=jn((function(e){return xn.mathpack.div(e,100)}),Bn("xlPercent"));var Jn=jn(xn.mathpack.ceil,Bn("xlCeil")),Qn=jn(xn.mathpack.floor,Bn("xlFloor")),Xn=jn(xn.mathpack.cond,Bn("xlCond")),Yn=Hn(xn.mathpack.cond2,Bn("xlCond2"));var zn=jn(xn.mathpack.sfix,Bn("xlSfix")),Zn=jn(xn.mathpack.viewRound,Bn("xlViewRound"));var $n={zero:Pn,one:Gn,pi:Vn,add:Hn(xn.mathpack.add,Wn),sub:Hn(xn.mathpack.sub,Wn),mul:Hn(xn.mathpack.mul,Wn),div:Hn(xn.mathpack.div,Wn),power:Kn,percent:qn,neg:function(e){return 0!==Xn(e)?xn.mathpack.neg(e):e},compare:xn.mathpack.compare,formatGeneral:function(e,t,r){var n=xn.mathpack.formatGeneral(e,t,r);return"string"!=typeof n?R("calc.runtime.xlFormatGeneral: error "+JSON.stringify(n)):n},parse:function(e,t,r,n){var a=xn.mathpack.pack(e,t,r,n);return"number"!=typeof a?R("calc.runtime.xlParse: error "+JSON.stringify(a)):a},trunc:xn.mathpack.trunc,ceil:Jn,floor:Qn,abs:xn.mathpack.abs,cond:Xn,cond2:Yn,fromNumber:function(e){return b("calc.runtime.xlFromNumber",isFinite(e)),e},toNumber:function(e){return b("calc.runtime.xlToNumber",isFinite(e)),e},sqrt:jn(xn.mathpack.sqrt,Wn),exp:jn(xn.mathpack.exp,Wn),ln:jn(xn.mathpack.ln,Wn),log:jn(xn.mathpack.log,Wn),sin:jn(xn.mathpack.sin,Wn),cos:jn(xn.mathpack.cos,Wn),tan:jn(xn.mathpack.tan,Wn),asin:jn(xn.mathpack.asin,Wn),acos:jn(xn.mathpack.acos,Wn),atan:jn(xn.mathpack.atan,Wn),atan2:Hn(xn.mathpack.atan2,Wn),round:Hn(xn.mathpack.round,Wn),roundUp:Hn(xn.mathpack.roundUp,Wn),roundDown:Hn(xn.mathpack.roundDown,Wn),checkAlmostCancellation:function(e,t){return xn.mathpack.exp32(e)-xn.mathpack.exp32(t)>=52428800?Pn:t},fix:xn.mathpack.fix,lfix:xn.mathpack.lfix,sfix:zn,viewRound:Zn},ea=Math.pow(2,-52),ta=Math.pow(2,-1022);function ra(e){return Math.abs(e)<ta?0:e}function na(e){return isFinite(e)?ra(e):Te}var aa=Math.pow(2,32)-2;function ia(e,t){var r=Math.pow(e,t);return isFinite(r)?ra(r):t<0?ke:Te}var oa=Un.fix,ua=Un.lfix;var ca,sa={zero:0,one:1,pi:Math.PI,add:function(e,t){var r=e+t;return isFinite(r)?ra(r):Te},sub:function(e,t){var r=e-t;return isFinite(r)?ra(r):Te},mul:function(e,t){return na(e*t)},div:function(e,t){return 0===ra(t)?ke:na(e/t)},power:function(e,t){return 0===t?0===e?Te:1:0===e?t<0?ke:0:e>0?ia(e,t):function(e){if(e<-aa||e>aa)return!1;if(e===Math.floor(e))return!0;var t=Math.abs(e);return 1+-22.5*ea<=t&&t<=1+2*ea}(t)?ia(e,Math.round(t)):Te},percent:function(e){return ra(e/100)},neg:Un.neg,compare:Un.compare,formatGeneral:Un.formatGeneral,parse:Un.parse,trunc:Un.trunc,ceil:Un.ceil,floor:Un.floor,abs:Un.abs,cond:Un.cond,cond2:Un.cond2,fromNumber:dr,toNumber:dr,sqrt:function(e){return na(Math.sqrt(e))},exp:function(e){return na(Math.exp(e))},ln:function(e){return na(Math.log(e))},log:function(e){return na(Math.log(e)/Math.LN10)},sin:function(e){return Math.abs(e)<Math.pow(2,27)?na(Math.sin(e)):Te},cos:function(e){return Math.abs(e)<Math.pow(2,27)?na(Math.cos(e)):Te},tan:function(e){return Math.abs(e)<Math.pow(2,27)?na(Math.tan(e)):Te},asin:function(e){return na(Math.asin(e))},acos:function(e){return na(Math.acos(e))},atan:function(e){return na(Math.atan(e))},atan2:function(e,t){return 0===e&&0===t?ke:ra(Math.atan2(t,e))},round:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.indexOf("e"),a="-"===r.substring(0,1)?"-":"",i=r.substring(a.length,n),o=r.substring(n+1),u=parseInt(o,10),c=Un.trunc(t)+u+1;return 0===c&&i.charCodeAt(0)-48>=5?na(parseFloat(a+"10e"+o)):c<1?0:c>21?e:na(parseFloat(a+function(e,t){var r=e.replace(".","");if(r.length<=t)return e;if(r.charCodeAt(t)-48>=5){for(var n=r.substring(0,t),a=0,i=n.length-1;i>=0&&n.charCodeAt(i)-48==9;i-=1)a+=1;if(a===n.length)return"10";var o=n.substring(0,n.length-a-1)+String.fromCharCode(n.charCodeAt(n.length-a-1)+1);return o.substring(0,1)+"."+o.substring(1)}return e.substring(0,t+1)}(i,c)+"e"+o))},roundUp:Un.roundUp,roundDown:Un.roundDown,checkAlmostCancellation:function(e,t){return t},fix:oa,lfix:ua,sfix:function(e){var t=e+1048576+2146435072;return t<0?-2147483648:oa(t)-2147483648},viewRound:dr};function la(){return Rn(gn.CalcExcelMath)?$n:sa}function fa(e,t,r){return void 0===t&&(t=_.A1),void 0===r&&(r=la()),{localeInfo:e,refStyle:t,mathpack:r}}var da=!1,ha=void 0,pa=/^(https)|(http)|(file):\/\//;function va(e,t,r){if(da){O.ULS.traceTag(595910878,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized")}else{var n;if(A(e),function(e){Sn.ULS=e}(e),"function"==typeof(n=t)&&(An=n),null!=r){if(!pa.test(r)){var a="calc.config.initCalc: calcAbsUrl is not absolute: "+r;O.ULS.traceTag(595910879,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a)}Cn.setConfig({onWorkerError:function(e){var t,r=Object(P.a)(Object(P.a)({},e.info),{error:void 0}),n={error:e.message,info:r,innerError:null===(t=e.info.error)||void 0===t?void 0:t.message},a="calc.onWorkerError: "+JSON.stringify(n);O.ULS.traceTag(593335298,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a)},onCreateWorker:function(e){var t="calc.onCreateWorker: "+JSON.stringify(e);O.ULS.traceTag(593335299,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,t)}})}ha=r,da=!0;O.ULS.traceTag(594642132,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.config.initCalc: Calc version 11.13.0 (production) initialized")}}function ma(){return da}function ga(){return ha}function Ca(e,t,r,n,a,i,o,u,c,s,l,f,d,h,p,v,m,g,C,S,E,y){function O(e){return 92===e||95===e||u(String.fromCharCode(e))}return Sa(e,r,n,(function(e){return a(String.fromCharCode(e))}),(function(e){return i(String.fromCharCode(e))}),O,(function(e){return O(e)||46===e||63===e||a(String.fromCharCode(e))}),c,s,l,f,d,h,p,v,m,g,C,S,E,y)}function Sa(e,t,r,n,a,i,o,u,c,s,l,f,d,h,p,v,m,g,C,S,E){return{parseNumber:e,getWorksheetFuncId:function(e){return t(e.toLocaleUpperCase())},getWorksheetFuncName:r,isNumeral:n,getOrdinal:a,isIdentStart:i,isIdentContinue:o,stringCompareCI:u,errorNames:c,trueName:s,falseName:l,rowLetter:f,columnLetter:d,leftBrace:h,rightBrace:p,leftBracket:v,rightBracket:m,decimalSeparator:g,listSeparator:C,columnSeparator:S,rowSeparator:E}}function Ea(e){return function(t){for(var r=0;r<t.length&&Ar(t.charCodeAt(r));)r+=1;var n=!1;if(r<t.length){var a=t.charCodeAt(r);if(43===a||45===a)for(n=45===a,r+=1;r<t.length&&Ar(t.charCodeAt(r));)r+=1}var i=Ir(this,e,t,r);if(void 0!==i&&void 0!==i.value){for(r=i.i;r<t.length&&Ar(t.charCodeAt(r));)r+=1;if(r===t.length)return n?e.neg(i.value):i.value}}}function ya(e){return 0!=(In(e)&On.DigitClass)}function Oa(e){var t=In(e);return 0==(t&On.DigitClass)?R("calc.config.getOrdinal: expected numeral; given "+C(e)):t&On.Ordinal}function Aa(e){return 0!=(In(e)&On.IdentStartClass)}function ka(e){return 0!=(In(e)&On.IdentContinueClass)}var Ra=p(((ca={})[Se.NULL]="#NULL!",ca[Se.DIV0]="#DIV/0!",ca[Se.VALUE]="#VALUE!",ca[Se.REF]="#REF!",ca[Se.NAME]="#NAME?",ca[Se.NUM]="#NUM!",ca[Se.NA]="#N/A",ca[Se.GETTING_DATA]="#GETTING_DATA",ca[Se.FIELD]="#FIELD",ca)),ba=void 0;function Ia(e){var t=Na()[e];return void 0===t?"wsf:"+e:t}var Ta=/_/g;function Na(){if(null==ba)for(var e in ba=[],xe){var t=Number(e);if(!isNaN(t)){var r=We[t],n=null!=r?r:xe[e].replace(Ta,".");ba[t]=n}}return ba}function Fa(e,t){var r=function(e,t){var r,n=[];return t.forEach((function(e,t){null!=e&&n.push([e,t])})),(r=Nn.create(e)).setValues.apply(r,n)}(e,t);return{getWorksheetFuncId:function(e){return r.getValue(e)},getWorksheetFuncName:function(e){var r=t[e];return null==r?R("calc.config.getWorksheetFuncName: unknown function ID "+e):r}}}var _a=void 0;function Ma(){var e,t,r,n,a;return null==_a&&(e=Na(),t=yr("en-US"),r=Fa(t,e),n=r.getWorksheetFuncId,a=r.getWorksheetFuncName,_a=Sa(Ea(la()),n,a,ya,Oa,Aa,ka,t,Ra,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";")),_a}var wa,La=w,Da=M,Ua=j,xa=tr,Pa=Zt,Ga=zt,Va=nr,Wa=ur,Ba=sr,ja=kt,Ha=lt,Ka=xt,qa=Pt;function Ja(e){return{kind:wa.NoOriginSheet,origin:e}}function Qa(e){if(void 0===e)return!0;if(null===e||"object"!=typeof e)return!1;switch(e.kind){case Ka.NotImplemented:case Ka.Unavailable:case wa.NoOriginSheet:return!0}return!1}function Xa(e,t,r){return function(n,a){return void 0===a?t(n):Qa(a)?r(a,n):e(a)}}function Ya(e){return function(t){if(Qa(t))return t;if(!Array.isArray(t)){var r=e(t);return void 0===r?void 0:[t,r]}for(var n=0;n<t.length;n+=1){var a=t[n],i=e(a);if(void 0!==i)return[a,i]}}}function za(e,t,r){var n=Zr(e.row,t.row,1<<20,r),a=Zr(e.col,t.col,16384,r);return void 0!==n&&void 0!==a?xa(n,a):void 0}function Za(e,t){var r=e.originGridCell;if(!Ha(r))return r.reason;var n=r.value,a=e.wrapCellReferences;switch(t.kind){case La.Error:return;case La.Single:return za(n,t,a);case La.Range:var i=za(n,t.ref1,a),o=za(n,t.ref2,a);return void 0!==i&&void 0!==o?ja(i,o):void 0;case La.Row:if(Rn(gn["OfficeVSO:3832565_CalcCGRowColRefs"])){var u=Zr(n.row,t.row1,1<<20,a),c=Zr(n.row,t.row2,1<<20,a);return void 0!==u&&void 0!==c?ja(xa(u,0),xa(c,16383)):void 0}return qa(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]);case La.Col:if(Rn(gn["OfficeVSO:3832565_CalcCGRowColRefs"])){var s=Zr(n.col,t.col1,16384,a),l=Zr(n.col,t.col2,16384,a);return void 0!==s&&void 0!==l?ja(xa(0,s),xa(1048575,l)):void 0}return qa(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]);default:return k("calc.runtime.resolverService.resolveGridRef",t)}}function $a(e){function t(t,r){if(!pr(r)){var n=t.originSheet;return Ha(n)?n.value.document:n.reason}var a=e.getDocumentLoc(r.path,r.document);return pr(a)?a:void 0}function r(r,n){var a=t(r,n.document);if(!Qa(a)){var i=e.getSheetIndex(a,n.sheet);return Ha(i)?pr(i.value)?Pa(a,i.value):void 0:i.reason}}return{resolveName:function(n,a,i){var o;if(vr(a)||a.kind===Da.Relative){var u=n.originSheet;if(!Ha(u))return u.reason;var c=u.value;if(void 0===c.index)return Ja(c);if(void 0===e.getNameLoc){var s=i.toLocaleUpperCase();return[Ba(c,s),Ba(Wa(c.document),s)]}var l=e.getNameLoc(c,i);if(l.kind===Ke.Failure)return l.reason;if(!vr(l.value))return l.value;o=Wa(c.document)}else{var f=function(n,a){switch(a.kind){case Da.Document:var i=t(n,a);return Qa(i)?i:Wa(i);case Da.Sheet:return r(n,a);case Da.Ident:var o=t(n,void 0);if(Qa(o))return o;var u=e.getSheetIndex(o,a.name);if(!Ha(u))return u.reason;if(pr(u.value))return Pa(o,u.value);var c=t(n,Ua(a.name));return Qa(c)?c:Wa(c);default:return k("calc.runtime.resolverService.resolveNameQualifier",a)}}(n,a);if(Qa(f))return f;o=f}if(void 0===e.getNameLoc){s=i.toLocaleUpperCase();return Ba(o,s)}var d=e.getNameLoc(o,i);return d.kind===Ke.Failure?d.reason:vr(d.value)?void 0:d.value},resolveGridRef:Za,resolveCellRef:function(n,a,i){var o,u=Za(n,i);if(Qa(u))return u;if(vr(a)||a.kind===Da.Relative){var c=n.originSheet;if(!Ha(c))return c.reason;var s=c.value;if(void 0===s.index)return Ja(s);o=s}else{var l=function(n,a){switch(a.kind){case Da.Error:return;case Da.Sheet:return r(n,a);case Da.SheetRange:var i=t(n,a.document);if(Qa(i))return;var o=e.getSheetIndex(i,a.sheet1);if(!Ha(o))return o.reason;var u=e.getSheetIndex(i,a.sheet2);if(!Ha(u))return u.reason;var c=o.value,s=u.value;if(vr(c)||vr(s))return;return Ga(i,c,s);default:return k("calc.runtime.resolverService.resolveCellRefQualifier",a)}}(n,a);if(Qa(l))return l;o=l}return Va(o,u)},resolveUserDefinedFunc:function(r,n,a){var i;if(vr(n)){var o=r.originSheet;if(!Ha(o))return o.reason;i=o.value.document}else{var u=function(e,r){switch(r.kind){case Da.Document:return t(e,r);case Da.Ident:return t(e,Ua(r.name));default:return k("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",r)}}(r,n);if(Qa(u))return u;i=u}if(void 0===e.getUserDefinedFuncLoc)return qa(["getUserDefinedFuncLoc"]);var c=e.getUserDefinedFuncLoc(i,a);return c.kind===Ke.Failure?c.reason:0!==c.value.length?c.value:void 0}}}!function(e){e.NoOriginSheet="NoOriginSheet"}(wa||(wa={}));function ei(e,t,r){return void 0===r&&(r=100),t.maxDepth=r,t.level=0,ti(e,t)}function ti(e,t){if(t.level===t.maxDepth)throw"AST is too deep to continue the visit. Currently as level "+t.level;var r;switch(t.level+=1,e.kind){case U.Literal:r=function(e,t){if("boolean"==typeof e)return t.visitBoolean(e);if("number"==typeof e)return t.visitNumber(e);if("string"==typeof e)return t.visitString(e);if(e.kind===X.Missing)return t.visitMissing(e);if(e.kind===X.Error)return t.visitError(e);throw"Tried to visit unrecognized AST node: "+e.kind+"."}(e.oper,t.operVisitor);break;case U.Array:r=t.visitArray(e);break;case U.App:r=t.visitApp(e);break;case U.Paren:r=t.visitParen(e);break;case U.Name:r=t.visitName(e);break;case U.CellRef:r=t.visitCellRef(e);break;case U.Bad:r=t.visitBad(e);break;case U.Operator:r=t.visitOperator(e);break;case w.Error:r=t.visitRefError(e);break;case w.Single:r=t.visitSingle(e);break;case w.Range:r=t.visitRange(e);break;case w.Row:r=t.visitRow(e);break;case w.Col:r=t.visitCol(e);break;case M.Error:r=t.visitNameError(e);break;case M.Relative:r=t.visitRelative(e);break;case M.Document:r=t.visitDocument(e);break;case M.Sheet:r=t.visitSheet(e);break;case M.Ident:r=t.visitIdent(e);break;case M.SheetRange:r=t.visitSheetRange(e);break;default:throw"Tried to visit unrecognized AST node: "+e.kind+"."}return t.level-=1,r}function ri(e){return{visitString:e,visitBoolean:e,visitNumber:e,visitMissing:e,visitError:e}}function ni(e,t,r){return{level:0,operVisitor:e,visitArray:mr(r.vArray,t),visitApp:mr(r.vApp,t),visitParen:mr(r.vParen,t),visitName:mr(r.vName,t),visitCellRef:mr(r.vCellRef,t),visitBad:mr(r.vBad,t),visitOperator:mr(r.vOperator,t),visitRefError:mr(r.vRefError,t),visitSingle:mr(r.vSingle,t),visitRange:mr(r.vRange,t),visitRow:mr(r.vRow,t),visitCol:mr(r.vCol,t),visitNameError:mr(r.vNameError,t),visitRelative:mr(r.vRelative,t),visitDocument:mr(r.vDocument,t),visitSheet:mr(r.vSheet,t),visitIdent:mr(r.vIdent,t),visitSheetRange:mr(r.vSheetRange,t)}}var ai,ii,oi=/"/g,ui=/'/g,ci=ir(Zt(Yt(void 0,"Book1"),0),tr(0,0)),si=function(){function e(e,t,r,n,a){var i,o,u,c,s,l;this.spans=r,this.annotations=n,this.anonymize=a,this.level=0,this.operVisitor=this,this.locals=t,this.localeInfo=null!=(u=null===(o=null===(i=t)||void 0===i?void 0:i.config)||void 0===o?void 0:o.localeInfo)?u:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!=(l=null===(s=null===(c=t)||void 0===c?void 0:c.config)||void 0===s?void 0:s.refStyle)?l:e.config.refStyle}return e.prototype.anon=function(e){return this.anonymize?Mi(e):e},e.prototype.pre=function(e,t){var r,n;return this.anonymize?t:null!=(n=null===(r=this.spans[e.label])||void 0===r?void 0:r.pre)?n:t},e.prototype.post=function(e,t){var r,n;return this.anonymize?t:null!=(n=null===(r=this.spans[e.label])||void 0===r?void 0:r.post)?n:t},e.prototype.visitString=function(e){return'"'+this.anon(e).replace(oi,'""')+'"'},e.prototype.visitBoolean=function(e){return e?this.localeInfo.trueName:this.localeInfo.falseName},e.prototype.visitNumber=function(e){return this.anon(this.mathpack.formatGeneral(this.localeInfo,e,21))},e.prototype.visitMissing=function(e){return""},e.prototype.visitError=function(e){var t=this.localeInfo.errorNames[e.type];if(void 0===t)throw"No locale data for error oper";return t},e.prototype.visitArray=function(e){var t=this,r=[];return e.nodes.forEach((function(e){var n=[];e.forEach((function(e){n.push(ti(e,t))})),r.push(n.join(t.localeInfo.columnSeparator))})),this.localeInfo.leftBrace+r.join(this.localeInfo.rowSeparator)+(e.isClosed?this.localeInfo.rightBrace:"")},e.prototype.visitApp=function(e){var t=this;if(Ft(e.head)){var r=ti(e.head,this);if(1===e.args.length){var n=ti(e.args[0],this);switch(e.head.id){case Ve.Percent:return n+this.pre(e.head,"")+r;case Ve.Pound:return n+r;default:return r+this.post(e.head,"")+n}}if(2===e.args.length){var a=ti(e.args[0],this),i=ti(e.args[1],this);return a+this.pre(e.head," ")+r+this.post(e.head,e.head.id===Ve.Isect?"":" ")+i}throw"Tried to pretty print operator with 0 or more than 2 operators"}var o=e.args.map((function(e,r){return t.pre(e,0===r||function(e){return e.kind===U.Literal&&"object"==typeof e.oper&&e.oper.kind===X.Missing}(e)?"":" ")+ti(e,t)}));return this.visitAppFormulaHead(e.head)+"("+o.join(this.localeInfo.listSeparator)+(0===e.args.length?"":this.post(e.args[e.args.length-1],""))+(e.isClosed?")":"")},e.prototype.visitParen=function(e){return"("+this.pre(e.node,"")+ti(e.node,this)+this.post(e.node,"")+(e.isClosed?")":"")},e.prototype.visitName=function(e){var t="";return void 0!==e.qualifier&&(t=ti(e.qualifier,this)+"!"),t+this.anon(Ht(this.localeInfo,e))},e.prototype.visitCellRef=function(e){var t="";return void 0!==e.qualifier&&(t=ti(e.qualifier,this)+"!"),t+ti(e.ref,this)},e.prototype.visitBad=function(e){var t=this;if(e.type===x.Sequence){var r=[];return e.contents.forEach((function(e){r.push(t.pre(e,"")+ti(e,t)+t.post(e,""))})),r.join("")}return this.pre(e,"")+this.anon(e.contents)+this.post(e,"")},e.prototype.visitOperator=function(e){switch(e.id){case Ve.Isect:return"";case Ve.Union:return this.localeInfo.listSeparator;default:var t=Je[e.id];if(void 0===t)throw"Invalid operator";return t}},e.prototype.visitRefError=function(){var e=this.localeInfo.errorNames[Se.REF];if(void 0===e)throw"No locale data for #REF";return e},e.prototype.visitSingle=function(e){var t=sn(this.localeInfo,this.refStyle,this.locals.origin.range,e.row,e.col,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitRange=function(e){var t=ln(this.localeInfo,this.refStyle,this.locals.origin.range,e.ref1.row,e.ref1.col,e.ref2.row,e.ref2.col,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitRow=function(e){var t=on(this.localeInfo,this.refStyle,this.locals.origin.range.row,e.row1,e.row2,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitCol=function(e){var t=un(this.localeInfo,this.refStyle,this.locals.origin.range.col,e.col1,e.col2,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitNameError=function(e){var t=this.localeInfo.errorNames[Se.REF];if(void 0===t)throw"No locale data for #REF";return t.replace("!","")},e.prototype.visitRelative=function(e){return""},e.prototype.visitDocument=function(e){return vn(this.localeInfo,this.refStyle,this.anon(void 0!==e.path?e.path+"/"+e.document:e.document))},e.prototype.visitSheet=function(e){return vn(this.localeInfo,this.refStyle,this.anon((void 0!==e.document?this.visitSheetDocument(e.document):"")+e.sheet))},e.prototype.visitIdent=function(e){return vn(this.localeInfo,this.refStyle,this.anon(e.name))},e.prototype.visitSheetRange=function(e){var t=this.anon((void 0!==e.document?this.visitSheetDocument(e.document):"")+e.sheet1),r=this.anon(e.sheet2),n=t+":"+r;return pn(this.localeInfo,this.refStyle,t)||pn(this.localeInfo,this.refStyle,r)?"'"+n.replace(ui,"''")+"'":n},e.prototype.visitAppFormulaHead=function(e){var t,r,n=null===(t=this.annotations)||void 0===t?void 0:t[e.label];return(null===(r=n)||void 0===r?void 0:r.kind)===D.WorksheetFuncName?this.localeInfo.getWorksheetFuncName(n.id):ti(e,this)},e.prototype.visitSheetDocument=function(e){return(void 0!==e.path?e.path:"")+this.localeInfo.leftBracket+e.document+this.localeInfo.rightBracket},e}();function li(e){return{kind:ai.VisitorFailure,message:e}}function fi(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,origin:t,wrapCellReferences:!1}}function di(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,origin:t,wrapCellReferences:!0}}function hi(e,t,r,n){void 0===n&&(n=!1);try{var a=new si(e,t,r.spans,r.annotations,n);return ct("="+a.pre(r.node,"")+ei(r.node,a))}catch(e){if(O.ULS.traceTag(595964180,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.lang.printFormula: Format failed: "+("string"==typeof e?e:v(e))),"string"==typeof e)return st(li(e));throw e}}function pi(e,t){try{var r=t.kind===Vt.Cell||t.kind===Vt.Range?fi(t,t.range):t.kind===Vt.NameManager?di(t,ci):k("calc.lang.anonymizeFormula",t),n=hi((void 0===ii&&(ii={config:fa(Ma(),_.A1)}),ii),r,e,!0);if(n.kind===Ke.Success)return n.value}catch(e){}return C(e)}!function(e){e.VisitorFailure="VisitorFailure"}(ai||(ai={}));var vi,mi,gi,Ci,Si,Ei,yi,Oi,Ai,ki,Ri,bi,Ii,Ti,Ni=new RegExp("[^=\\[\\]\\.\\\\\\/%#\\-\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$\\sd]","g"),Fi=/[0-9]/g,_i=/d/g;function Mi(e){return e.toLowerCase().replace(_i,"w").replace(Fi,"d").replace(Ni,"w")}(mi=vi||(vi={})).LexicalKind=Vt,mi.sheetRows=1<<20,mi.sheetCols=16384,mi.lexicalSourceCell=Kt,mi.lexicalSourceRange=qt,mi.lexicalSourceName=Qt,mi.documentLoc=Yt,mi.sheetIndex=Zt,mi.sheetRange=zt,mi.gridCell=tr,mi.gridRange=er,mi.sheetGridCell=ir,mi.sheetGridRange=ar,mi.sheetGridCube=nr,mi.originCell=or,mi.documentScope=ur,mi.nameLoc=sr,mi.nameScope=cr,mi.userDefinedFuncLoc=lr,(Ci=gi||(gi={})).SpecialPrecs=z,Ci.PrecsBound=ee,Ci.OperKind=X,Ci.ErrorType=Se,Ci.ErrorTypeBounds=Ee,Ci.precedents=ye,Ci.errorOper=Oe,Ci.nullErrorOper=Ae,Ci.div0ErrorOper=ke,Ci.valueErrorOper=Re,Ci.refErrorOper=be,Ci.nameErrorOper=Ie,Ci.numErrorOper=Te,Ci.naErrorOper=Ne,Ci.gettingDataErrorOper=Fe,Ci.fieldErrorOper=_e,Ci.arrayOper=Le,Ci.rangeSeqOper=De,Ci.range3DOper=Ue,Ci.missingOper=Pe,Ci.blankOper=Ge,(Ei=Si||(Si={})).RefStyle=_,Ei.QualifierKind=M,Ei.CellRefKind=w,Ei.PosKind=L,Ei.NodeKind=U,Ei.BadType=x,Ei.errorQualifierLabeled=G,Ei.relativeQualifierLabeled=V,Ei.errorQualifier=W,Ei.relativeQualifier=B,Ei.documentQualifier=j,Ei.sheetQualifier=H,Ei.identQualifier=K,Ei.sheetRangeQualifier=q,Ei.pos=J,Ei.cellRefErrorLabeled=Q,Ei.cellRefError=te,Ei.cellRefSingle=re,Ei.cellRefRange=ne,Ei.cellRefRow=ae,Ei.cellRefCol=ie,Ei.formula=oe,Ei.formulaSpan=ue,Ei.literalNode=le,Ei.arrayNode=fe,Ei.appNode=de,Ei.operatorNode=he,Ei.parenNode=pe,Ei.nameNode=ve,Ei.cellRefNode=me,Ei.badNode=ge,Ei.AnnotationKind=D,Ei.worksheetFuncNameAnnotation=ce,Ei.localNameAnnotation=se,(Oi=yi||(yi={})).SignatureType=Y,Oi.FunctionFlags=Z,Oi.OperatorId=Ve,Oi.WorksheetFuncId=xe,Oi.SpecialPrecs=z,Oi.functionType=Ce,Oi.unknownFunctionType=He,Oi.getOperatorType=it,Oi.getWorksheetFuncType=ot,(ki=Ai||(Ai={})).isSheetIndex=dt,ki.isSheetGridRange=vt,ki.isGridCell=pt,ki.isSheetGridCell=mt,ki.isDocumentLocEqual=Ct,ki.isSheetIndexEqual=St,ki.isGridCellEqual=Et,ki.isSheetGridCellEqual=yt,ki.isWellFormed=ht,ki.isUnqualifiedNameNode=_t,ki.isOperatorNode=Ft,ki.gridRangeAnchor=Ot,ki.sheetGridRangeAnchor=At,ki.gridCellRange=kt,ki.getArguments=Nt,ki.getArgType=Mt,ki.isValidArgsLength=wt,ki.operKind=Lt,ki.ResultKind=Ke,ki.success=ct,ki.failure=st,ki.FailureError=Wt,ki.isSuccess=lt,ki.ReasonKind=xt,ki.notImplemented=Pt,ki.unavailable=Gt,ki.javaScriptError=ft,ki.columnName=Yr,ki.formatRow=en,ki.formatCol=tn,ki.formatRowRange=on,ki.formatColRange=un,ki.formatCellPos=sn,ki.formatGridRangeA1=mn,ki.parseGridCellA1=qr,ki.parseGridRangeA1=Jr,ki.getSubExpressionFromPosition=Rt,ki.getFormulaCharIndexFromPoint=bt,ki.ResolveReasonKind=wa,ki.noOriginSheet=Ja,ki.createResolver=$a,ki.createResolutionHandler=Xa,ki.createNameFinder=Ya,ki.defaultLiteralVisitor=ri,ki.defaultFormulaVisitor=ni,ki.dispatch=ti,ki.startVisit=ei,ki.printFormula=hi,ki.visitorFailure=li,ki.printLocalsGrid=fi,ki.printLocalsName=di,(bi=Ri||(Ri={})).LogCategory=f.LogCategory,bi.TraceLevel=f.TraceLevel,bi.localeInfo=Ca,bi.localeInfo2=Sa,bi.calcConfig=fa,bi.initCalc=va,bi.createSimpleLocaleInfo=Ma,bi.getEnglishLocaleInfo=Ma,bi.createWorksheetFuncNameCallbacks=Fa,bi.isCalcInit=ma,bi.getCalcAbsUrl=ga,(Ti=Ii||(Ii={})).ieeeMathpack=Un,Ti.xlMathpack=$n;var wi,Li=Ai.ReasonKind,Di=Ai.notImplemented;function Ui(e){return{config:e}}function xi(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,origin:t}}!function(e){e.BadFormulaString="BadFormulaString"}(wi||(wi={}));var Pi=Object(P.a)(Object(P.a)({},Li),wi),Gi=fi,Vi=di;function Wi(e){return{kind:Pi.BadFormulaString,message:e}}function Bi(e,t){var r=t-1;return function(t){if(t<=r){var n=e+": internal error: no progress made at index "+t;return O.ULS.assertTag(595980821,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}r=t}}function ji(e,t,r){for(var n=t;n<e.length&&r(e[n]);n+=1);return[e.substring(t,n),n]}function Hi(e,t,r,n,a){var i=e[t];return r(i)?1:i===n&&t+1<e.length&&a(e[t+1])?2:0}function Ki(e,t,r,n,a){for(var i=[],o=t,u=t;u<e.length;){var c=Hi(e,u,r,n,a);if(0===c)break;2===c&&(o!==u&&i.push(e.substring(o,u)),o=u+1),u+=c}return o!==u&&i.push(e.substring(o,u)),[i.join(""),u]}var qi,Ji,Qi,Xi,Yi=yi.OperatorId;function zi(e,t,r){return{kind:e,start:t,chars:r}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected"}(qi||(qi={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(Ji||(Ji={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual"}(Qi||(Qi={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(Xi||(Xi={}));var Zi=function(e){return zi(qi.End,e,"")},$i=function(e,t){return zi(qi.Spaces,e,t)};function eo(e,t,r){return void 0===r&&(r=!1),{kind:qi.Unexpected,start:e,chars:t,isQualPart:r}}var to=function(e,t){return zi(qi.Ident,e,t)};function ro(e,t,r,n){return{kind:e,start:t,chars:r,value:n}}var no=function(e,t){return ro(qi.Left,e,t,Ji.Bracket)},ao=function(e,t){return ro(qi.Left,e,t,Ji.Brace)},io=function(e){return ro(qi.Right,e,")",Ji.Paren)},oo=function(e,t){return ro(qi.Right,e,t,Ji.Bracket)},uo=function(e,t){return ro(qi.Right,e,t,Ji.Brace)},co=function(e){return ro(qi.Right,e,"'",Ji.SQuote)},so=function(e,t){return ro(qi.Sep,e,t,Qi.List)},lo=function(e,t){return ro(qi.Sep,e,t,Qi.Col)},fo=function(e,t){return ro(qi.Sep,e,t,Qi.Row)},ho=function(e){return ro(qi.Sep,e,"!",Qi.Qual)},po={"#ALL":function(e,t){return ro(qi.SpecialRef,e,t,Xi.All)},"#DATA":function(e,t){return ro(qi.SpecialRef,e,t,Xi.Data)},"#HEADERS":function(e,t){return ro(qi.SpecialRef,e,t,Xi.Headers)},"#TOTALS":function(e,t){return ro(qi.SpecialRef,e,t,Xi.Totals)},"#THIS ROW":function(e,t){return ro(qi.SpecialRef,e,t,Xi.ThisRow)}};function vo(e,t,r,n,a,i,o,u,c){return{kind:qi.CellRef,start:e,chars:t,row:r,col:n,refStyle:a,isName:i,isNumber:o,isQualPart:u,isBadLocale:c}}function mo(e){for(var t=0;t<e.length;t+=1)if("+"===e[t]||"-"===e[t]||"*"===e[t]||" "===e[t]||"/"===e[t])return!1;return!0}function go(e,t,r,n){void 0===n&&(n=!0);var a="number"==typeof r&&mo(t);return{kind:qi.Literal,start:e,chars:t,oper:r,hasRight:n,isQualPart:a}}function Co(e,t,r){return 0===e.stringCompareCI(e.falseName,r)?go(t,r,!1):0===e.stringCompareCI(e.trueName,r)?go(t,r,!0):to(t,r)}function So(e){var t=Je[e];if(null==t)throw new Error("operatorTokenMaker: invalid operator "+e);return function(r){return{kind:qi.Operator,start:r,chars:t,value:e}}}var Eo=So(Yi.Add),yo=So(Yi.Sub),Oo=So(Yi.Mul),Ao=So(Yi.Div),ko=So(Yi.Pow),Ro=So(Yi.Percent),bo=So(Yi.Concat),Io=So(Yi.Eq),To=So(Yi.Lt),No=So(Yi.Gt),Fo=So(Yi.Ne),_o=So(Yi.Le),Mo=So(Yi.Ge),wo=So(Yi.Range),Lo=(So(Yi.And),So(Yi.Or),So(Yi.Xor),So(Yi.Dot),So(Yi.At)),Do=So(Yi.Pound);function Uo(e,t,r){return r.push(t),t.start+e}var xo=Si.RefStyle,Po="+-*/^%&=<>:",Go=!1;function Vo(e){return!Go&&Rn(gn.CalcDynamicArrayOperators)&&(Po+="@#",Go=!0),Po.indexOf(e)>=0}var Wo={"+":Eo,"-":yo,"*":Oo,"/":Ao,"^":ko,"%":Ro,"&":bo,"=":Io,"<":To,">":No,":":wo,"@":Lo,"#":Do},Bo={"<>":Fo,"<=":_o,">=":Mo};function jo(e,t,r){if(t<e.length-1){var n=Bo[e.substr(t,2)];if(null!=n)return Uo(2,n(t),r)}var a=Wo[e[t]];if(null!=a)return Uo(1,a(t),r);return O.ULS.assertTag(595980822,f.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function Ho(e,t,r,n,a){var i=Ir(e,t,r,n);if(void 0!==i){var o=i.value,u=i.i;if(void 0!==o)return Uo(u-n,go(n,r.substring(n,u),o,!0),a),u;if(e.isNumeral(r.charCodeAt(n))){var c=r.substring(n,u);return Uo(u-n,eo(n,c,mo(c)),a),u}}}function Ko(e,t,r){var n=Ki(e,t+1,(function(e){return'"'!==e}),'"',(function(e){return'"'===e})),a=n[0],i=n[1],o=e.substring(t,i+1);return i<e.length?Uo(i+1-t,go(t,o,a,!0),r):Uo(i-t,go(t,o,a,!1),r)}function qo(e,t,r,n){for(var a=1;a<e.errorNames.length;a+=1){var i=e.errorNames[a];if(void 0!==i){var o=t.substr(r,i.length);if(0===e.stringCompareCI(i,o))return Uo(i.length,go(r,o,Oe(a)),n)}}}var Jo=Object.getOwnPropertyNames(po);function Qo(e,t,r,n){for(var a=0;a<Jo.length;a+=1){var i=Jo[a],o=t.substr(r,i.length);if(0===e.stringCompareCI(i,o))return Uo(i.length,po[i](r,o),n)}}function Xo(e,t){return"'"!==t&&"#"!==t&&t!==e.leftBracket&&t!==e.rightBracket}function Yo(e,t,r,n){var a=Uo(1,no(r,t[r]),n);"#"===t[a]&&(null!=(s=Qo(e,t,a,n))&&(a=s));for(var i=function(t){return Xo(e,t)},o=function(t){return!Xo(e,t)},u=Bi("calc.parse.tokenizeBracketedColRef",a);a<t.length;){u(a);var c=t[a];if(c===e.rightBracket)return Uo(1,oo(a,c),n);if(Hi(t,a,i,"'",o)>0){var s,l=Ki(t,a,i,"'",o),f=l[0];a=Uo((s=l[1])-a,to(a,f),n)}else a=Uo(1,eo(a,c),n)}return a}function zo(e,t){return!Ar(t.charCodeAt(0))&&"'"!==t&&"#"!==t&&":"!==t&&t!==e.listSeparator&&t!==e.leftBracket&&t!==e.rightBracket}function Zo(e,t,r,n){var a=Uo(1,no(r,t[r]),n);"#"===t[a]&&(null!=(f=Qo(e,t,a,n))&&(a=f));for(var i=function(t){return zo(e,t)},o=function(t){return!zo(e,t)},u=Bi("calc.parse.tokenizeBracketedRef",a);a<t.length;){u(a);var c=t[a];if(c===e.rightBracket)return Uo(1,oo(a,c),n);if(Hi(t,a,i,"'",o)>0){var s=Ki(t,a,i,"'",o),l=s[0];a=Uo((f=s[1])-a,to(a,l),n)}else if(Ar(c.charCodeAt(0))){var f,d=ji(t,a,(function(e){return Ar(e.charCodeAt(0))}));l=d[0];a=Uo((f=d[1])-a,$i(a,l),n)}else a=":"!==c?c!==e.listSeparator?c!==e.leftBracket?Uo(1,eo(a,c),n):Yo(e,t,a,n):Uo(1,so(a,c),n):Uo(1,wo(a),n)}return a}var $o;function eu(e,t,r,n){for(var a,i=Uo(1,(a=r,ro(qi.Left,a,"'",Ji.SQuote)),n),o=function(t){return function(e,t){return"':*?".indexOf(t)<0&&t!==e.leftBracket&&t!==e.rightBracket}(e,t)},u=function(e){return"'"===e},c=Bi("calc.parse.tokenizeQuotedQualifier",i);i<t.length;){c(i);var s=t[i];if("'"===s&&"'"!==t[i+1])return Uo(1,co(i),n);if(":"!==s)if(s!==e.leftBracket)if(Hi(t,i,o,"'",u)>0){var l=Ki(t,i,o,"'",u),f=l[0];i=Uo(l[1]-i,to(i,f),n)}else i=Uo(1,eo(i,s),n);else i=Zo(e,t,i,n);else i=Uo(1,wo(i),n)}return i}function tu(e,t,r,n,a,i){var o,u,c,s,l,f,d,h=Kr(e,t,r,n,a);if(null!=h){var p=h.i,v=n.substring(p,a);return Uo(p-a,h.refStyle===xo.A1?(o=a,u=v,c=h.row,s=h.col,l=null==c&&null!=s&&s.kind===Si.PosKind.Rel,f=null==s&&null!=c&&c.kind===Si.PosKind.Rel,d=!(null!=c&&c.kind!==Si.PosKind.Rel||null!=s&&s.kind!==Si.PosKind.Rel),vo(o,u,c,s,Si.RefStyle.A1,l,f,d,!1)):function(e,t,r,n,a){void 0===a&&(a=!1);var i=!(!1!==r&&null!=r&&r.kind!==Si.PosKind.Abs||!1!==n&&null!=n&&n.kind!==Si.PosKind.Abs);return vo(e,t,!1===r?Si.pos(Si.PosKind.Rel,0):r,!1===n?Si.pos(Si.PosKind.Rel,0):n,Si.RefStyle.R1C1,!1,!1,i,a)}(a,v,h.row,h.col,h.enLocale),i)}}function ru(e,t,r,n){for(var a=e[t],i=t+1;i<e.length;i+=1){var o=e[i];if(o.kind!==r)break;a=n(a,o)}return[a,i]}function nu(e,t,r,n,a,i){for(var o=function(e,t,r,n,a,i){for(var o,u=[],c=[],s=$o.Decimal,l=i,d=Bi("calc.parse.tokenize",l);l<a.length;){d(l);var h=tu(e,r,n,a,l,u);if(null==h){var p=a[l];if(s===$o.Decimal&&p===e.decimalSeparator||e.isNumeral(p.charCodeAt(0))){var v=Ho(e,t,a,l,u);if(null!=v){l=v,s=$o.FieldAccess;continue}if(p!==e.decimalSeparator){var m="calc.parse.tokenize: failed to tokenize numeral at "+l;return O.ULS.assertTag(595980823,f.LogCategory.msoulscat_ES_EWAJS,!1,m)}}if('"'!==p)if(e.isIdentStart(p.charCodeAt(0))){var g=ji(a,l,(function(t){return e.isIdentContinue(t.charCodeAt(0))})),C=g[0];l=Uo(g[1]-l,Co(e,l,C),u),s=$o.FieldAccess}else if("#"!==p)if(Vo(p))l=jo(a,l,u),s=$o.Decimal;else if(Ar(p.charCodeAt(0))){var S=ji(a,l,(function(e){return Ar(e.charCodeAt(0))}));C=S[0];l=Uo(S[1]-l,$i(l,C),u),s=$o.Decimal}else if("("!==p)if(")"!==p)if(p!==e.leftBrace)if(p!==e.rightBrace)if(p!==e.leftBracket)if(p!==e.rightBracket){if(c.length>0&&c[c.length-1]===Ji.Brace){if(p===e.columnSeparator){l=Uo(1,lo(l,p),u),s=$o.Decimal;continue}if(p===e.rowSeparator){l=Uo(1,fo(l,p),u),s=$o.Decimal;continue}}p!==e.listSeparator?"!"!==p?"'"!==p?(l=Uo(1,eo(l,p),u),s=$o.Decimal):(l=eu(e,a,l,u),s=$o.Decimal):(l=Uo(1,ho(l),u),s=$o.Decimal):(l=Uo(1,so(l,p),u),s=$o.Decimal)}else l=Uo(1,oo(l,p),u),s=$o.FieldAccess;else l=Zo(e,a,l,u),s=$o.FieldAccess;else c.length>0&&c[c.length-1]===Ji.Brace&&c.pop(),l=Uo(1,uo(l,p),u),s=$o.FieldAccess;else c.push(Ji.Brace),l=Uo(1,ao(l,p),u),s=$o.Decimal;else c.length>0&&c[c.length-1]===Ji.Paren&&c.pop(),l=Uo(1,io(l),u),s=$o.FieldAccess;else c.push(Ji.Paren),l=Uo(1,(o=l,ro(qi.Left,o,"(",Ji.Paren)),u),s=$o.Decimal;else{var E=qo(e,a,l,u);if(null!=E){l=E,s=$o.FieldAccess;continue}Rn(gn.CalcDynamicArrayOperators)?(l=jo(a,l,u),s=$o.Decimal):(l=Uo(1,eo(l,p),u),s=$o.Decimal)}else l=Ko(a,l,u),s=$o.FieldAccess}else l=h,s=$o.FieldAccess}return u}(e,t,r,n,a,i),u=[],c=0;c<o.length;){var s=o[c];if(s.kind!==qi.Unexpected)u.push(s),c+=1;else{var l=ru(o,c,qi.Unexpected,(function(e,t){var r=e,n=t;return eo(r.start,r.chars+n.chars,r.isQualPart&&n.isQualPart)})),d=l[0],h=l[1];u.push(d),c=h}}return u.push(Zi(a.length)),u}function au(e,t,r,n){var a=void 0;if(function(e){for(var t=e;null!=t;)t=t()}(e(t,r,n,(function(e,t){a=[e,t]}),(function(){a=!1}))),null==a){var i="calc.parse.runParser: internal error: parser did not call resolve or reject on "+C(t);return O.ULS.assertTag(595980827,f.LogCategory.msoulscat_ES_EWAJS,!1,i)}return a}function iu(){var e={impl:function(e,t,r,n,a){return O.ULS.assertTag(595980828,f.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.delayed: internal error: unassigned DelayedParser")},parser:function(t,r,n,a,i){return function(){return e.impl(t,r,n,a,i)}}};return e}function ou(e){return function(t,r,n,a,i){return a(e,r)}}!function(e){e[e.Decimal=1]="Decimal",e[e.FieldAccess=2]="FieldAccess"}($o||($o={}));var uu,cu=function(e,t,r,n,a){return a};function su(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,n){return t(a,e)(r,n,a,i,o)}),o)}}function lu(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return t(r,n,a,i,o)}))}}function fu(e){return 0===e.length?cu:e.reduce(lu)}function du(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return i(t,n)}))}}function hu(e,t){return function(r,n,a,i,o){var u=r[n];if(null==u)return o;var c=e(a,u);return null==c?o:i(c,n+t)}}function pu(e){return hu(e,1)}function vu(e){return hu(e,0)}function mu(e){return function(t,r,n,a,i){var o=t[r],u=t[r+1];if(null==o||null==u)return i;var c=e(n,o,u);return null==c?i:a(c,r+1)}}function gu(e,t,r){return function(n,a,i,o,u){var c=r,s=a;function l(){return e(n,s,i,d,h)}function d(e,r){if(r<=s){var a=C(n),o="calc.parse.reduce: internal error: no progress made at index "+s+" on "+a;return O.ULS.assertTag(595980829,f.LogCategory.msoulscat_ES_EWAJS,!1,o)}return c=t(i,e,c),s=r,l}function h(){return o(c,s)}return l}}function Cu(e,t){return gu(e,(function(e,t,r){return r.push(t),r}),t)}function Su(e){return function(t,r,n,a,i){return Cu(e,[])(t,r,n,a,i)}}function Eu(e,t){return su(e,(function(e,r){return Cu(t,[r])}))}function yu(e){var t=e.length;return function(r,n,a,i,o){var u=n,c=[];function s(){return e[c.length](r,u,a,l,o)}function l(e,r){return u=r,c.push(e),c.length<t?s:i(c,u)}return s}}function Ou(e,t){return yu([e,t])}function Au(e,t,r,n,a){return yu([e,t,r,n,a])}function ku(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,r){return i(t(a,e),r)}),o)}}function Ru(e,t,r){return ku(yu([e,t]),(function(e,t){return r(e,t[0],t[1])}))}function bu(e,t,r,n){return ku(yu([e,t,r]),(function(e,t){return n(e,t[0],t[1],t[2])}))}function Iu(e,t,r,n,a){return ku(yu([e,t,r,n]),(function(e,t){return a(e,t[0],t[1],t[2],t[3])}))}function Tu(e,t,r,n,a,i){return ku(yu([e,t,r,n,a]),(function(e,t){return i(e,t[0],t[1],t[2],t[3],t[4])}))}function Nu(e,t){return Ru(e,t,(function(e,t,r){return t}))}function Fu(e,t){return Ru(e,t,(function(e,t,r){return r}))}function _u(e,t){var r=e.spans[t.label];if(null==r){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+C(t);return O.ULS.assertTag(595980824,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}return r}function Mu(e,t,r,n,a){var i=e.label;return e.label+=1,e.spans[i]=Si.formulaSpan(t,r,n,a),i}function wu(e,t,r,n){var a=_u(e,r);return a.pre=t,a.post=n,r}function Lu(e,t,r){return function(n,a,i,o,u){var c=i.leftDelim,s=i.listSep;return i.leftDelim=e,i.listSep=t,r(n,a,i,(function(e,t){return i.leftDelim=c,i.listSep=s,o(e,t)}),(function(){return i.leftDelim=c,i.listSep=s,u}))}}function Du(e,t){return t.kind===qi.Spaces||t.kind===qi.End?t.start:_u(e,t).start}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(uu||(uu={}));var Uu=du(pu((function(e,t){return t.kind===qi.Spaces?t.chars:void 0})),""),xu=function(e,t,r,n,a){var i=e[t];if(null==i){var o="calc.parse.pStart: internal error: expected term at "+t+" in "+C(e);return O.ULS.assertTag(595980864,f.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(Du(r,i),t)};function Pu(e){return bu(Uu,pu(e),Uu,wu)}function Gu(e){return Ru(Uu,pu(e),(function(e,t,r){return wu(e,t,r,"")}))}function Vu(e){return Ru(pu(e),Uu,(function(e,t,r){return wu(e,"",t,r)}))}var Wu=Pu((function(e,t){return t.kind!==Si.NodeKind.Operator||t.id!==yi.OperatorId.Add&&t.id!==yi.OperatorId.Sub?void 0:t})),Bu=Vu((function(e,t){if(t.kind===Si.NodeKind.Operator){if(t.id===yi.OperatorId.Add)return Si.operatorNode(yi.OperatorId.Pos,t.label);if(t.id===yi.OperatorId.Sub)return Si.operatorNode(yi.OperatorId.Neg,t.label)}}));function ju(e,t){if(t.kind===Si.NodeKind.Operator&&t.id===yi.OperatorId.At)return Si.operatorNode(yi.OperatorId.At,t.label)}var Hu=Vu(ju),Ku=Gu((function(e,t){return t.kind===Si.NodeKind.Operator&&t.id===yi.OperatorId.Pound?t:void 0})),qu=Pu((function(e,t){return t.kind!==Si.NodeKind.Operator||t.id!==yi.OperatorId.Mul&&t.id!==yi.OperatorId.Div?void 0:t})),Ju=Pu((function(e,t){return t.kind===Si.NodeKind.Operator&&t.id===yi.OperatorId.Pow?t:void 0})),Qu=Gu((function(e,t){return t.kind===Si.NodeKind.Operator&&t.id===yi.OperatorId.Percent?t:void 0})),Xu=Pu((function(e,t){return t.kind===Si.NodeKind.Operator&&t.id===yi.OperatorId.Concat?t:void 0})),Yu=Pu((function(e,t){return t.kind===Si.NodeKind.Operator&&t.id>=yi.OperatorId.Eq&&t.id<=yi.OperatorId.Ge?t:void 0})),zu=Pu((function(e,t){return t.kind===Si.NodeKind.Operator&&t.id===yi.OperatorId.Range?t:void 0})),Zu=Pu((function(e,t){return t.kind===Si.NodeKind.Operator&&t.id===yi.OperatorId.Union?t:void 0})),$u=mu((function(e,t,r){if(t.kind===qi.Spaces&&r.kind!==qi.End&&(r.kind!==Si.NodeKind.Operator||r.id===yi.OperatorId.At)){var n=Mu(e,t.start,Du(e,r),t.chars,"");return Si.operatorNode(yi.OperatorId.Isect,n)}}));function ec(e,t,r,n){return void 0===n&&(n=e),Ru(n,Su(Ou(t,e)),(function(e,t,n){return 0===n.length?t:n.reduce(r(e),t)}))}function tc(e,t,r){return Ru(Su(t),e,(function(e,t,n){return 0===t.length?n:t.reduceRight(r(e),n)}))}function rc(e,t,r){return Ru(e,Su(t),(function(e,t,n){return 0===n.length?t:n.reduce(r(e),t)}))}function nc(e){return function(t,r){var n=r[0],a=r[1],i=_u(e,t).start,o=_u(e,a).end,u=Mu(e,i,o,"","");return Si.appNode(n,[t,a],!0,u)}}function ac(e){return function(t,r){var n=_u(e,t).start,a=_u(e,r).end,i=Mu(e,n,a,"","");return Si.appNode(r,[t],!0,i)}}function ic(e){var t=!0;return function(r,n){var a=_u(e,n).start,i=_u(e,r).end,o=Mu(e,a,i,"","");if(t&&(t=!1,r.kind===Si.NodeKind.Literal&&"number"==typeof r.oper&&""===_u(e,n).post)){var u=n.id===yi.OperatorId.Pos?r.oper:e.mathpack.neg(r.oper);return Si.literalNode(u,!0,o)}return Si.appNode(n,[r],!0,o)}}function oc(e){return function(t,r){var n=_u(e,r).start,a=_u(e,t).end,i=Mu(e,n,a,"","");return Si.appNode(r,[t],!0,i)}}var uc,cc,sc,lc,fc,dc,hc,pc,vc,mc,gc,Cc,Sc,Ec,yc=pu((function(e,t){return t.kind!==Si.NodeKind.Operator&&t.kind!==qi.Spaces&&t.kind!==qi.End?t:void 0}));function Oc(e,t){var r=Mu(e,_u(e,t[0]).start,_u(e,t[t.length-1]).end,"","");return Si.badNode(Si.BadType.Sequence,t,r)}var Ac=!1;function kc(e,t){!function(){if(!Ac){if(Rn(gn.CalcDynamicArrayOperators)){uc=Ru(xu,Su(yc),(function(e,t,r){return 0===r.length?Si.literalNode(gi.missingOper,!0,Mu(e,t,t,"","")):1===r.length?r[0]:Oc(e,r)})),cc=rc(uc,Ku,ac);var e=iu(),t=Fu(vu(ju),e.parser);sc=ec(lu(t,cc),zu,nc,cc),lc=ec(lu(t,sc),$u,nc,sc),fc=tc(lc,Hu,oc),e.impl=fc,dc=ec(fc,Zu,nc),hc=tc(dc,Bu,ic),pc=rc(hc,Qu,ac),vc=ec(pc,Ju,nc),mc=ec(vc,qu,nc),gc=ec(mc,Wu,nc),Cc=ec(gc,Xu,nc),Sc=ec(Cc,Yu,nc)}else sc=Ru(xu,Su(yc),(function(e,t,r){return 0===r.length?Si.literalNode(gi.missingOper,!0,Mu(e,t,t,"","")):1===r.length?r[0]:Oc(e,r)})),lc=ec(sc,zu,nc),fc=ec(lc,$u,nc),dc=ec(fc,Zu,nc),hc=tc(dc,Bu,ic),pc=rc(hc,Qu,ac),vc=ec(pc,Ju,nc),mc=ec(vc,qu,nc),gc=ec(mc,Wu,nc),Cc=ec(gc,Xu,nc),Sc=ec(Cc,Yu,nc);Ec=Ru(Sc,Su(Fu(vu((function(e,t){return t.kind===qi.End?void 0:t})),Sc)),(function(e,t,r){return 0===r.length?t:Oc(e,[t].concat(r))})),Ac=!0}}();var r=e.length-1;if(r<0){var n="calc.parse.parseTerms: internal error: expected at least 1 term";return O.ULS.assertTag(595980865,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[0].kind===qi.Spaces){n="calc.parse.parseTerms: internal error: array[0].kind === Spaces in "+C(e);return O.ULS.assertTag(595980866,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(r-1>=0&&e[r-1].kind===qi.Spaces){n="calc.parse.parseTerms: internal error: array[n-1].kind === Spaces in "+C(e);return O.ULS.assertTag(595980867,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[r].kind!==qi.End){n="calc.parse.parseTerms: internal error: array[n].kind !== End in "+C(e);return O.ULS.assertTag(595980868,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=au(Ec,e,0,t);if(!1===a){n="calc.parse.parseTerms: internal error: failed to parse "+C(e);return O.ULS.assertTag(595980869,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}var i=a[0],o=a[1];if(o<r){n="calc.parse.parseTerms: internal error: consumed "+o+" out of "+r+" in "+C(e);return O.ULS.assertTag(595980870,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}return i}var Rc=du(pu((function(e,t){return t.kind===qi.Spaces?t.chars:void 0})),""),bc=function(e,t,r,n,a){var i=e[t];if(null==i){var o="calc.parse.pStart: internal error: expected token at "+t+" in "+C(e);return O.ULS.assertTag(595980830,f.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(i.start,t)};function Ic(e){return pu((function(t,r){return r.kind===qi.Sep&&r.value===e||void 0}))}function Tc(e){return pu((function(t,r){return r.kind===qi.Left&&r.value===e?r.start:void 0}))}function Nc(e){return pu((function(t,r){return r.kind===qi.Right&&r.value===e||void 0}))}var Fc=Ic(Qi.List),_c=Ic(Qi.Row),Mc=Ic(Qi.Col),wc=Ic(Qi.Qual),Lc=Tc(Ji.Paren),Dc=Nc(Ji.Paren),Uc=Tc(Ji.Brace),xc=Nc(Ji.Brace),Pc=Tc(Ji.SQuote),Gc=Nc(Ji.SQuote),Vc=pu((function(e,t){return t.kind===qi.Operator&&t.value===yi.OperatorId.Range||void 0})),Wc=iu(),Bc=bu(Rc,Wc.parser,Rc,wu),jc=Iu(Lc,Lu(Ji.Paren,uu.Union,Bc),du(Dc,!1),bc,(function(e,t,r,n,a){var i=Mu(e,t,a,"","");return Si.parenNode(r,n,i)})),Hc=Eu(Bc,Fu(Mc,Bc)),Kc=Eu(Hc,Fu(_c,Hc)),qc=Iu(Uc,Lu(Ji.Brace,uu.Union,Kc),du(xc,!1),bc,(function(e,t,r,n,a){var i=Mu(e,t,a,"","");return Si.arrayNode(r,n,i)})),Jc=function(e){return e.kind===qi.Ident||e.kind===qi.CellRef&&e.isQualPart||e.kind===qi.Literal&&e.isQualPart||e.kind===qi.Unexpected&&e.isQualPart||e.kind===qi.Operator&&e.value===yi.OperatorId.Dot},Qc=Eu(pu((function(e,t){return Jc(t)&&t.chars.length>0&&46!==t.chars.charCodeAt(0)?t.chars:void 0})),pu((function(e,t){return Jc(t)?t.chars:void 0}))),Xc=pu((function(e,t){return t.kind===qi.Ident?t.chars:void 0}));function Yc(e){return e.kind===qi.Literal&&"object"==typeof e.oper&&e.oper.kind===gi.OperKind.Error&&e.oper.type===gi.ErrorType.REF}function zc(e,t,r,n){return null==t?[Si.identQualifier(e,r,n),r?"'"+e.replace(/'/g,"")+"'":e]:[Si.sheetRangeQualifier(e,t,void 0,r,n),r?"'"+e.replace(/'/g,"")+":"+t.replace(/'/g,"")+"'":e+":"+t]}var Zc=Iu(bc,Qc,du(Fu(Vc,Qc),void 0),bc,(function(e,t,r,n,a){var i=Mu(e,t,a,"","");return zc(r.join(""),null!=n?n.join(""):void 0,!1,i)})),$c=Tu(Pc,Xc,du(Fu(Vc,Xc),void 0),Gc,bc,(function(e,t,r,n,a,i){return zc(r,n,!0,Mu(e,t,i,"",""))})),es=Iu(Pc,Su(pu((function(e,t){return t.kind===qi.End||t.kind===qi.Right&&t.value===Ji.SQuote?void 0:t.chars}))),du(Ou(Gc,du(Nu(wc,Rc),!1)),[!1,!1]),bc,(function(e,t,r,n,a){var i=n[0],o=n[1],u="'"+r.join("")+(i?"'":"")+(o?"!":""),c=Mu(e,t,a,"","");return[Si.badNode(Si.BadType.Qualifier,u,c),u]})),ts=mu((function(e,t,r){if(Yc(t)){var n=Mu(e,t.start,r.start,"","");return[Si.errorQualifierLabeled(n),t.chars]}})),rs=Ru(fu([Zc,$c,vu((function(e,t){var r=Mu(e,t.start,t.start,"","");return[Si.relativeQualifierLabeled(r),""]}))]),Nu(wc,Rc),(function(e,t,r){return[t[0],t[1]+"!"]})),ns=fu([ts,rs,es]);function as(e,t){return t.kind===qi.CellRef&&e.refStyle===t.refStyle&&!t.isBadLocale}var is=mu((function(e,t,r){return as(e,t)?[t,r.start]:void 0}));function os(e,t){if(null!=e.row&&null!=e.col)return Si.cellRefSingle(e.row,e.col,t);if(null!=e.row)return Si.cellRefRow(e.row,e.row,t);if(null!=e.col)return Si.cellRefCol(e.col,e.col,t);var r="calc.parse.cellRefToken2cellRef: bad token "+C(e);return O.ULS.assertTag(595980831,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}var us=mu((function(e,t,r){if(as(e,t)&&(t.refStyle!==Si.RefStyle.A1||null!=t.row&&null!=t.col))return os(t,n=Mu(e,t.start,r.start,"",""));if(Yc(t)){var n=Mu(e,t.start,r.start,"","");return Si.cellRefErrorLabeled(n)}})),cs=lu(su(Au(is,Rc,Vc,Rc,is),(function(e,t){var r=t[0],n=r[0],a=r[1],i=t[1],o=(t[2],t[3]),u=t[4],c=u[0],s=u[1],l=Mu(e,n.start,a,"",i),f=Mu(e,c.start,s,o,""),d=os(n,l),h=os(c,f),p=void 0;if(d.kind===Si.CellRefKind.Single&&h.kind===Si.CellRefKind.Single){var v=Mu(e,n.start,s,"","");p=Si.cellRefRange(d,h,v)}else if(0===i.length&&0===o.length)if(d.kind===Si.CellRefKind.Row&&h.kind===Si.CellRefKind.Row){v=Mu(e,n.start,s,"","");p=Si.cellRefRow(d.row1,h.row1,v)}else if(d.kind===Si.CellRefKind.Col&&h.kind===Si.CellRefKind.Col){v=Mu(e,n.start,s,"","");p=Si.cellRefCol(d.col1,h.col1,v)}return null==p?cu:n.isQualPart&&c.isQualPart?vu((function(e,t){return t.kind===qi.Sep&&t.value===Qi.Qual?void 0:p})):ou(p)})),us),ss=pu((function(e,t){return t.kind===qi.Ident||t.kind===qi.CellRef&&t.isName?t.chars:void 0})),ls=su(Au(bc,ns,bc,du(lu(cs,ss),void 0),bc),(function(e,t){var r=t[0],n=t[1],a=n[0],i=n[1],o=t[2],u=t[3],c=t[4];if(null==u)return a.kind!==Si.QualifierKind.SheetRange||a.isQuoted?a.kind===Si.QualifierKind.Error?ou(Si.literalNode(gi.refErrorOper,!0,a.label)):ou(a.kind===Si.NodeKind.Bad?a:Si.badNode(Si.BadType.Qualifier,i,a.label)):cu;if("string"==typeof u){if(a.kind===Si.QualifierKind.SheetRange&&!a.isQuoted)return cu;var s=Mu(e,r,c,"","");if(a.kind===Si.NodeKind.Bad||a.kind===Si.QualifierKind.Error||a.kind===Si.QualifierKind.SheetRange){var l=a.kind===Si.NodeKind.Bad?a:Si.badNode(Si.BadType.Qualifier,i,a.label),f=Si.nameNode(u,void 0,Mu(e,o,c,"",""));return ou(Si.badNode(Si.BadType.Sequence,[l,f],s))}return ou(Si.nameNode(u,a,s))}var d=Mu(e,r,c,"","");if(a.kind===Si.NodeKind.Bad||a.kind===Si.QualifierKind.Document){var h=a.kind===Si.NodeKind.Bad?a:Si.badNode(Si.BadType.Qualifier,i,a.label);f=Si.cellRefNode(u,void 0,Mu(e,o,c,"",""));return ou(Si.badNode(Si.BadType.Sequence,[h,f],d))}var p=a.kind===Si.QualifierKind.Ident?Si.sheetQualifier(a.name,void 0,a.isQuoted,a.label):a;return ou(Si.cellRefNode(u,p,d))})),fs=bu(bc,lu(cs,ss),bc,(function(e,t,r,n){var a=Mu(e,t,n,"","");return"string"==typeof r?Si.nameNode(r,void 0,a):r.kind===Si.CellRefKind.Error?Si.literalNode(gi.refErrorOper,!0,a):Si.cellRefNode(r,void 0,a)})),ds=mu((function(e,t,r){if(t.kind===qi.Literal)return Si.literalNode(t.oper,t.hasRight,Mu(e,t.start,r.start,"",""));if(t.kind===qi.CellRef&&t.isNumber&&"object"==typeof t.row){var n=t.row.index+e.origin.row+1;return Si.literalNode(e.mathpack.fromNumber(n),!0,Mu(e,t.start,r.start,"",""))}}));function hs(e){return mu((function(t,r,n){if(e(r)){var a=Mu(t,r.start,n.start,"","");return Si.badNode(Si.BadType.Unexpected,r.chars,a)}}))}var ps=hs((function(e){return e.kind===qi.Left&&e.value===Ji.Bracket})),vs=hs((function(e){return e.kind===qi.Right&&e.value===Ji.Bracket})),ms=Tu(bc,ps,Lu(Ji.Bracket,uu.Union,Bc),du(vs,void 0),bc,(function(e,t,r,n,a,i){var o=[r,n];null!=a&&o.push(a);var u=Mu(e,t,i,"","");return Si.badNode(Si.BadType.Sequence,o,u)})),gs=mu((function(e,t,r){switch(t.kind){case qi.End:case qi.Operator:case qi.Spaces:return;case qi.Sep:if(t.value!==Qi.Qual&&(e.leftDelim===Ji.Brace||t.value!==Qi.Col&&t.value!==Qi.Row))return;break;case qi.Right:if(t.value===e.leftDelim)return}var n=t.kind===qi.CellRef?Si.BadType.CellRef:Si.BadType.Unexpected,a=Mu(e,t.start,r.start,"","");return Si.badNode(n,t.chars,a)})),Cs=mu((function(e,t,r){if((t.kind===qi.Ident||t.kind===qi.CellRef||t.kind===qi.Literal&&"boolean"==typeof t.oper)&&r.kind===qi.Left&&r.value===Ji.Paren&&null!=jt(e.localeInfo,t.chars)){var n=Mu(e,t.start,r.start,"","");return Si.nameNode(t.chars,void 0,n)}})),Ss=Iu(Lc,Lu(Ji.Paren,uu.Arg,Eu(Bc,Fu(Fc,Bc))),du(Dc,!1),bc,(function(e,t,r,n,a){return[r,n,a]})),Es=Ru(Cs,Ss,(function(e,t,r){var n=r[0],a=r[1],i=r[2],o=Mu(e,_u(e,t).start,i,"","");return Si.appNode(t,n,a,o)})),ys=Ru(fu([Es,ls,fs,ds,jc,qc,ms,gs]),Su(Ss),(function(e,t,r){var n=_u(e,t).start;return r.reduce((function(t,r){var a=r[0],i=r[1],o=r[2],u=Mu(e,n,o,"","");return Si.appNode(t,a,i,u)}),t)})),Os=mu((function(e,t,r){var n=void 0;if(t.kind===qi.Operator&&(n=t.value),t.kind===qi.Sep&&t.value===Qi.List&&e.listSep===uu.Union&&(n=yi.OperatorId.Union),null!=n){var a=Mu(e,t.start,r.start,"","");return Si.operatorNode(n,a)}})),As=pu((function(e,t){return t.kind===qi.Spaces?t:void 0})),ks=lu(ys,Os),Rs=su(ks,(function(e,t){return gu(Ou(du(As,void 0),ks),(function(e,t,r){var n=t[0],a=t[1];return null!=n&&r.push(n),r.push(a),r}),[t])})),bs=Ru(du(Rs,void 0),bc,(function(e,t,r){if(null==t){var n=Mu(e,r,r,"","");return Si.literalNode(gi.missingOper,!0,n)}if(1===t.length){var a=t[0];if(a.kind!==Si.NodeKind.Operator&&a.kind!==qi.Spaces)return a}return t.push(Zi(r)),kc(t,e)}));function Is(e,t,r,n,a,i){var o=i.length-1;if(o<0){var u="calc.parse.parseTokens: internal error: expected at least 1 token";return O.ULS.assertTag(595980832,f.LogCategory.msoulscat_ES_EWAJS,!1,u)}if(i[o].kind!==qi.End){u="calc.parse.parseTokens: internal error: array[n] !== End in "+C(i);return O.ULS.assertTag(595980833,f.LogCategory.msoulscat_ES_EWAJS,!1,u)}var c=function(e,t,r,n,a){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:n,origin:a,leftDelim:void 0,listSep:uu.Union,label:1,spans:[]}}(e,t,r,n,a),s=au(Bc,i,0,c);if(!1===s){u="calc.parse.parseTokens: internal error: failed to parse "+C(i);return O.ULS.assertTag(595980834,f.LogCategory.msoulscat_ES_EWAJS,!1,u)}var l=s[0],d=s[1];if(d<o){u="calc.parse.parseTokens: internal error: consumed "+d+" out of "+o+" in "+C(i);return O.ULS.assertTag(595980835,f.LogCategory.msoulscat_ES_EWAJS,!1,u)}return Si.formula(l,c.spans)}Wc.impl=bs;var Ts={"=":1,"+":0,"-":0,"@":-1};function Ns(e,t,r){var n,a,i,o,u=r[0],c=null!=u?Ts[u]:void 0;if(null==c)return Ai.failure(Wi("first character is not '=', '+', '-' or '@'"));if(c<0)return Ai.failure(Di(["Lotus 1-2-3 syntax"]));var s=null!=(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?a:e.config.localeInfo,l=null!=(o=null===(i=t.config)||void 0===i?void 0:i.refStyle)?o:e.config.refStyle,f=e.config.mathpack,d=nu(s,f,l,t.origin,r,c),h=Is(s,f,l,t.lexicalKind,t.origin,d);return Ai.success(h)}function Fs(e){return{parseFormula:function(t,r,n,a){if("number"==typeof t){if(null==r){return O.ULS.assertTag(595980825,f.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: expected range to be defined")}var i=t,o=r;return Ns(e,xi(n,Ai.gridRangeAnchor(function(e){return void 0===e.range}(o)?o:o.range),{refStyle:i}),a)}return Ns(e,t,r)},formatFormula:function(t,r){return Ai.printFormula(e,t,r)}}}var _s=Si.QualifierKind,Ms=Si.CellRefKind,ws=Si.NodeKind,Ls=Ai.ResultKind;function Ds(e){return e.kind===Ls.Success}function Us(e,t){var r=e[t];return null==r?R("ParseResultHelper.getFormulaSpan: expected span for label "+t+" to be defined"):r}function xs(e,t,r){return!!Ds(e)&&(function(e,t,r){if(null==e||null==r)return;var n={};null!=t?t.forEach((function(e){n[e]=!0})):n["*"]=!0;var a=[];a.push(e.node);for(;a.length>0;){var i=a.pop();if(null!=i)switch(i.kind){case ws.Literal:c("literal")&&r("literal",{label:i.label,value:i});break;case ws.Array:i.nodes.map((function(e){return e.map((function(e){a.push(e)}))}));break;case ws.App:if("object"!=typeof i.head)c("literal")&&r("literal",{label:i.label,value:i.head});else{var o=i.head;switch(o.kind){case ws.Operator:c("operator")&&r("operator",{label:i.label,value:o.id});break;case ws.Name:c("function")&&r("function",{label:i.label,name:o.whole,isClosed:i.isClosed,args:i.args});break;default:a.push(o)}}i.args.map((function(e){a.push(e)}));break;case ws.Paren:a.push(i.node);break;case ws.Name:if(c("namedRange")){var u=i.whole.split(".");r("namedRange",{label:i.label,name:u[0],names:u.slice(1),qualifier:s(i)})}break;case ws.CellRef:c("range")&&l(i);break;case ws.Bad:break;default:return k("calc.parse.traverseFormula",i)}}function c(e){return n[e]||n["*"]}function s(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case _s.Sheet:var r=e.qualifier;t.type=_s.Sheet,t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case _s.SheetRange:var n=e.qualifier;t.type=_s.SheetRange,t.sheet1=n.sheet1,t.sheet2=n.sheet2;break;case _s.Ident:var a=e.qualifier;t.type=_s.Ident,t.name=a.name;break;case _s.Document:var i=e.qualifier;t.document=i.document,null!=i.path&&(t.documentPath=i.path)}return t}}function l(t){if(null!=e&&null!=r)switch(t.ref.kind){case Ms.Error:break;case Ms.Col:var n=t.ref;r("range",{label:t.label,type:"col",startIndex:n.col1,endIndex:n.col2,span:Us(e.spans,n.label),qualifier:s(t)});break;case Ms.Row:var a=t.ref;r("range",{label:t.label,type:"row",startIndex:a.row1,endIndex:a.row2,span:Us(e.spans,a.label),qualifier:s(t)});break;case Ms.Single:var i=t.ref;r("range",{label:t.label,type:"cell",row:i.row,col:i.col,span:Us(e.spans,i.label),qualifier:s(t)});break;case Ms.Range:var o=t.ref;r("range",{label:t.label,type:"range",top:o.ref1.row,left:o.ref1.col,bottom:o.ref2.row,right:o.ref2.col,topLeftSpan:Us(e.spans,o.ref1.label),bottomRightSpan:Us(e.spans,o.ref2.label),qualifier:s(t)})}}}(e.value,t,r),!0)}var Ps,Gs,Vs={isSuccess:Ds,traverse:xs,extractReferences:function(e){if(Ds(e)){var t=[];return xs(e,["range","namedRange"],(function(r,n){var a={kind:r,ref:n,span:Us(e.value.spans,n.label)};t.push(a)})),t.sort((function(e,t){return e.span.start-t.span.start})),t}}};!function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_operation_argument",e.Bad_node="Bad_node",e.Invalid_binder="Invalid_binder",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unsupported_struct_ref="Unsupported_struct_ref",e.Unsupported_doc_qual="Unsupported_doc_qual"}(Ps||(Ps={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",e.Excess_function_arguments="Excess_function_arguments",e.Insufficient_function_arguments="Insufficient_function_arguments"}(Gs||(Gs={}));var Ws,Bs,js=Ai.ReasonKind,Hs=Ai.FailureError;!function(e){e[e.General=0]="General",e[e.CurrencyDec=11]="CurrencyDec",e[e.CoCurrencyDec=12]="CoCurrencyDec",e[e.Percentage0=13]="Percentage0",e[e.Percentage=14]="Percentage",e[e.MMDDYY=19]="MMDDYY",e[e.HHMMAP=23]="HHMMAP",e[e.MDYHMS=27]="MDYHMS",e[e.AbsHMMSS=31]="AbsHMMSS"}(Ws||(Ws={})),function(e){e.BadOperation="BadOperation",e.BadFormula="BadFormula"}(Bs||(Bs={}));var Ks,qs,Js=Object(P.a)(Object(P.a)({},js),Bs),Qs=Hs;function Xs(e){if(void 0!==e){var t={};return Object.keys(e).forEach((function(r){e[Number(r)].forEach((function(e){var r;t[e]=(null!=(r=t[e])?r:0)+1}))})),t}}function Ys(e,t,r,n,a){return{config:e,getDocumentLoc:t,getSheetIndex:r,getCellFormat:n,getKnownFormat:a}}function zs(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,origin:t,allowRelativeQualifier:!1}}function Zs(e,t){return{config:null!=t?t:void 0,lexicalKind:Vt.NameManager,origin:e,allowRelativeQualifier:!0}}function $s(e,t){var r=At(e.range);return{config:null!=t?t:void 0,lexicalSource:e,originGridCell:ct(r.range),originSheet:ct(r.sheet),wrapCellReferences:!1}}!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(Ks||(Ks={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(qs||(qs={}));var el=Ks.Red,tl=Ks.Black,rl=qs.DoubleBlack,nl={c:tl,l:void 0,r:void 0},al={c:rl,l:void 0,r:void 0};function il(e){return void 0===e.l}function ol(e){return e.c===el}function ul(e){return e.c===tl&&void 0!==e.l}function cl(e){return e.c===tl&&void 0===e.l}var sl=nl;function ll(e,t,r,n,a){return{c:e,l:t,key:r,value:n,r:a}}function fl(e,t){return ll(e,t.l,t.key,t.value,t.r)}function dl(e){return il(e)?nl:fl(tl,e)}function hl(e,t,r){if(!il(r)){var n=e.keyCompare(t,r.key);return n<0?hl(e,t,r.l):n>0?hl(e,t,r.r):r}}function pl(e,t){return!!il(t)||!!pl(e,t.l)&&(!!e(t.key,t.value)&&pl(e,t.r))}function vl(e,t,r,n,a){if(e===tl){if(ol(t)&&ol(t.l))return ll(el,fl(tl,t.l),t.key,t.value,ll(tl,t.r,r,n,a));if(ol(a)&&ol(a.r))return ll(el,ll(tl,t,r,n,a.l),a.key,a.value,fl(tl,a.r));if(ol(t)&&ol(t.r))return ll(el,ll(tl,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,ll(tl,t.r.r,r,n,a));if(ol(a)&&ol(a.l))return ll(el,ll(tl,t,r,n,a.l.l),a.l.key,a.l.value,ll(tl,a.l.r,a.key,a.value,a.r))}if(e===rl){if(ol(a)&&ol(a.l))return ll(tl,ll(tl,t,r,n,a.l.l),a.l.key,a.l.value,ll(tl,a.l.r,a.key,a.value,a.r));if(ol(t)&&ol(t.r))return ll(tl,ll(tl,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,ll(tl,t.r.r,r,n,a))}return ll(e,t,r,n,a)}function ml(e,t,r,n,a){return e===el&&t.c===rl&&ul(a)?vl(tl,ll(el,dl(t),r,n,a.l),a.key,a.value,a.r):e===el&&ul(t)&&a.c===rl?vl(tl,t.l,t.key,t.value,ll(el,t.r,r,n,dl(a))):e===tl&&t.c===rl&&ul(a)?vl(rl,ll(el,dl(t),r,n,a.l),a.key,a.value,a.r):e===tl&&ul(t)&&a.c===rl?vl(rl,t.l,t.key,t.value,ll(el,t.r,r,n,dl(a))):e===tl&&t.c===rl&&ol(a)&&ul(a.l)?ll(tl,vl(tl,ll(el,dl(t),r,n,a.l.l),a.l.key,a.l.value,a.l.r),a.key,a.value,a.r):e===tl&&ol(t)&&ul(t.r)&&a.c===rl?ll(tl,t.l,t.key,t.value,vl(tl,t.r.l,t.r.key,t.r.value,ll(el,t.r.r,r,n,dl(a)))):(b("calc.common.rbTree.rotate: expected R|B",t.c!==rl&&a.c!==rl),ll(e,t,r,n,a))}function gl(e,t,r,n){return function(e){return!ol(e)||e.l.c!==el&&e.r.c!==el?e:fl(tl,e)}(function e(t,r,n,a){if(il(a))return ll(el,nl,r,n,nl);var i=t.keyCompare(r,a.key);return i<0?vl(a.c,e(t,r,n,a.l),a.key,a.value,a.r):i>0?vl(a.c,a.l,a.key,a.value,e(t,r,n,a.r)):ll(a.c,a.l,r,n,a.r)}(e,t,r,n))}function Cl(e,t,r){if(il(r))return r;if(r.c===el&&cl(r.l)&&cl(r.r))return 0===e.keyCompare(t,r.key)?nl:r;if(r.c===tl&&cl(r.l)&&cl(r.r))return 0===e.keyCompare(t,r.key)?al:r;if(r.c===tl&&ol(r.l)&&cl(r.l.l)&&cl(r.l.r)&&cl(r.r)){var n=e.keyCompare(t,r.key);return n<0?ll(tl,Cl(e,t,r.l),r.key,r.value,nl):n>0?r:ll(tl,nl,r.l.key,r.l.value,nl)}var a=e.keyCompare(t,r.key);if(a<0)return ml(r.c,Cl(e,t,r.l),r.key,r.value,r.r);if(a>0)return ml(r.c,r.l,r.key,r.value,Cl(e,t,r.r));b("calc.common.rbTree.rem: expected node",!il(r.r));var i=function e(t){if(t.c===el&&cl(t.l)&&cl(t.r))return[t.key,t.value,nl];if(t.c===tl&&cl(t.l)&&cl(t.r))return[t.key,t.value,al];if(t.c===tl&&cl(t.l)&&ol(t.r))return[t.key,t.value,fl(tl,t.r)];b("calc.common.rbTree.remMin: expected node",!il(t.l));var r=e(t.l),n=r[0],a=r[1],i=r[2];return[n,a,ml(t.c,i,t.key,t.value,t.r)]}(r.r),o=i[0],u=i[1],c=i[2];return ml(r.c,r.l,o,u,c)}function Sl(e,t,r){var n=Cl(e,t,function(e){return ul(e)&&e.l.c===tl&&e.r.c===tl?fl(el,e):e}(r));return b("calc.common.rbTree.remove: expected R|B",n.c===el||n.c===tl),n}var El=function(){function e(e,t,r){this.root=e,this.count=t,this.keyCompare=r}return e.create=function(t){return new e(sl,0,t)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){var t;return null===(t=hl(this,e,this.root))||void 0===t?void 0:t.value},e.prototype.getEntry=function(e){return hl(this,e,this.root)},e.prototype.contains=function(e){return void 0!==this.getValue(e)},e.prototype.forEach=function(e){return pl(e,this.root)},e.prototype.setValue=function(t,r){return new e(gl(this,t,r,this.root),this.contains(t)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(t){return this.contains(t)?new e(Sl(this,t,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(t,r){var n=this.getValue(t);if(void 0!==n)return[this,n];var a=r();return[new e(gl(this,t,a,this.root),this.count+1,this.keyCompare),a]},e.prototype.filter=function(t){var r=this,n=sl,a=0;return this.forEach((function(e,i){return t(e,i)&&(n=gl(r,e,i,n),a+=1),!1})),new e(n,a,this.keyCompare)},e}(),yl=function(){function e(e,t,r){I("calc.common.StrictArray2D",e),I("calc.common.StrictArray2D",t);var n=r.length;n<e&&R("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+n);for(var a=0;a<n;a+=1){var i=r[a].length;i<t&&R("calc.common.StrictArray2D: expected elements["+a+"].length >= "+e+"; given "+i)}this.rows=e,this.cols=t,this.elements=r}return e.prototype.get=function(e,t){return N("calc.common.StrictArray2D.get",e,this.rows),N("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new Al(this.rows,this.cols,(function(r,n){return e(t.elements[r][n])}))},e}();var Ol=function(){function e(e,t,r,n,a,i){I("calc.common.StrictSparseArray2D",e),I("calc.common.StrictSparseArray2D",t),N("calc.common.StrictSparseArray2D",r,e+1),N("calc.common.StrictSparseArray2D",n,t+1);var o=a.length;o<r&&R("calc.common.StrictSparseArray2D: expected elements.length >= "+r+"; given "+o);for(var u=0;u<o;u+=1){var c=a[u].length;c<n&&R("calc.common.StrictSparseArray2D: expected elements["+u+"].length >= "+n+"; given "+c)}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseElements=a,this.sparseElement=i}return e.prototype.get=function(e,t){return N("calc.common.StrictSparseArray2D.get",e,this.rows),N("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new kl(this.rows,this.cols,this.denseRows,this.denseCols,(function(r,n){return e(t.denseElements[r][n])}),(function(){return e(t.sparseElement)}))},e}(),Al=function(){function e(e,t,r){I("calc.common.NonstrictArray2D",e),I("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}return e.prototype.get=function(e,t){return N("calc.common.NonstrictArray2D.get",e,this.rows),N("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=Rl(this.rows,this.cols,this.func);return new yl(this.rows,this.cols,e)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,(function(e,n){return t(r.func(e,n))}))},e}(),kl=function(){function e(e,t,r,n,a,i){I("calc.common.NonstrictSparseArray2D",e),I("calc.common.NonstrictSparseArray2D",t),N("calc.common.NonstrictSparseArray2D",r,e+1),N("calc.common.NonstrictSparseArray2D",n,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseFunc=a,this.sparseFunc=i}return e.prototype.get=function(e,t){return N("calc.common.NonstrictSparseArray2D.get",e,this.rows),N("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=Rl(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new Ol(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,n){return t(r.denseFunc(e,n))}),(function(){return t(r.sparseFunc())}))},e}();function Rl(e,t,r){for(var n=[],a=0;a<e;a+=1){for(var i=[],o=0;o<t;o+=1)i[o]=r(a,o);n[a]=i}return n}function bl(e,t,r){for(var n=[],a=[],i=0;i<t;i+=1)a[i]=r;for(var o=0;o<e;o+=1)n[o]=a;return n}function Il(e,t,r){return new Al(e,t,(function(e,t){return r}))}var Tl,Nl=vi.LexicalKind,Fl=Ai.ResultKind,_l=Ai.isGridCell,Ml=Ai.ReasonKind,wl=Ai.notImplemented,Ll=Ai.unavailable;!function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(Tl||(Tl={}));var Dl=Object(P.a)(Object(P.a)({},Ml),Tl);function Ul(e){return{config:e}}function xl(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,origin:t}}var Pl,Gl,Vl,Wl=function(e,t){return T("calc.runtime.interval: end",t),N("calc.runtime.interval: start",e,t),{start:e,end:t}};function Bl(e,t,r){return{kind:Dl.IllFormedFormula,message:e,mode:t,diagnostics:r}}function jl(e){return{kind:Pl.FinalValue,oper:e}}function Hl(e){return{kind:Pl.PendingValue,anchor:e}}function Kl(e,t,r){return t!==Nl.Cell||_l(e.range)||R("calc.runtime.cellFormula: expected single-cell range; given "+C(e)),{kind:Pl.Formula,range:e,source:t,formula:r}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue",e.Formula="Formula"}(Pl||(Pl={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(Gl||(Gl={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(Vl||(Vl={}));var ql={kind:Dl.Stopped};function Jl(e,t){return{arity:e,func:t}}function Ql(e,t,r,n,a,i,o,u,c,s,l,f,d,h,p,v,m,g,C,S,E){return{config:e,getDocumentLoc:r,getSheetIndex:n,getSheetRangeIndexes:null!=C?C:void 0,getNameLoc:null!=g?g:void 0,getCellValue:a,getCellValues:i,getFirstOrderFunc:o,getNameFormula:u,getCellFormula:c,getUsedRange:function(e){return st(wl(["getUsedRange"]))},interruptToken:[Gl.Continue],getHiddenRows:null!=S?S:void 0,isInFilterMode:null!=E?E:void 0,schedulerInfo:null!=p?p:{},limits:null!=v?v:{},setCellValue:s,setCellValues:l,setCellFailure:f,setDynamicPrecs:d,loadObjects:h}}var Xl,Yl=function(e,t,r,n,a,i,o,u,c){return{lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:a,reflectionSheet:i,implicitIntersect:o,wrapCellReferences:u,followHyperlinks:c}};function zl(e){return{kind:Dl.NameCycle,names:e}}function Zl(e){return{kind:Dl.CellCycle,cells:e}}function $l(e){return{kind:Dl.PreviousFailure,range:e}}function ef(e){return{kind:Dl.LimitExceeded,limit:e}}function tf(e){return{kind:Fl.Paused,reason:Dl.Timeout,resume:e}}function rf(e){if(e.kind===Fl.Failure)return e.reason.kind}function nf(e,t,r){return{kind:e,machine:t,receiver:r}}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine"}(Xl||(Xl={}));var af=nf(Xl.Next,void 0,void 0);function of(e,t){return nf(Xl.CallMachine,e,t)}var uf={receiveResult:function(e){return lt(e)?af:e}};function cf(){return uf}var sf,lf=function(e){function t(t,r){var n=this.constructor,a=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;a.machine=t,a.stackDepth=r;var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}return Object(P.c)(t,e),t}(Error),ff=function(){function e(e){this.numSteps=0,this.stack=[],this.pushFrame(of(e,{receiveResult:function(e){return e}})),this.transition=af}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(t){var r=this.stack.length,n=t.machine;if(n.isRunning)throw e.numCycles+=1,new lf(n,r);n.isRunning=!0,this.stack.push(t),e.maxStackDepth<r+1&&(e.maxStackDepth=r+1)},e.prototype.step=function(){this.numSteps+=1;var e=this.transition;try{switch(e.kind){case Xl.Next:return void(this.transition=this.stack[this.stack.length-1].machine.next());case Xl.CallMachine:return this.pushFrame(e),void(this.transition=e.machine.next());default:var t=this.stack.pop();return t?(t.machine.isRunning=!1,void(this.transition=t.receiver.receiveResult(e))):e}}catch(e){return void(this.transition=st(ft(e)))}},e.prototype.run=function(t){if(void 0===t&&(t=function(){return!1}),this.result)return this.result;try{for(;;){var r=this.step();if(r)return this.result=r;if(t())return void(e.numPauses+=1)}}catch(e){return this.result=st(ft(e))}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}(),df=function(){function e(e){this.machines=e,this.isRunning=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?of(this.machines[this.values.length],this):ct(this.values)},e.prototype.receiveResult=function(e){return lt(e)?(this.values.push(e.value),this.next()):e},e}();function hf(e){return{kind:sf.MachineCall,machine:e}}function pf(e){return"object"==typeof e&&e.kind===sf.MachineCall}!function(e){e.MachineCall="MachineCall"}(sf||(sf={}));var vf=function(){function e(e,t,r,n){this.context=e,this.rows=t,this.cols=r,this.func=n,this.isRunning=!1,this.toDeref=void 0,this.row=[],this.opers=[]}return e.prototype.next=function(){var e;try{if(void 0!==this.toDeref){var t=this.context.coerceOper(xf(this.context,this.toDeref,!0),Of);b("calc.runtime.ArrayMachine.next",!If(t)&&!Tf(t)),bf(t)&&(t=t.opers[0][0]),this.row.push(t),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return ct(Le(this.rows,this.cols,this.opers));var r=this.func(this.opers.length,this.row.length);return pf(r)?of(r.machine,this):(this.toDeref=r,af)}catch(t){return null!=(e=this.context.handleEvaluationError(t))?e:st(ft(t))}},e.prototype.receiveResult=function(e){return lt(e)?(this.toDeref=e.value,this.next()):e},e}(),mf=vi.gridCell,gf=gi.arrayOper,Cf=gi.naErrorOper,Sf=gi.OperKind,Ef=Sf.Number|Sf.String|Sf.Boolean|Sf.Error|Sf.Rich|Sf.Array,yf=Sf.Number|Sf.String|Sf.Boolean|Sf.Error|Sf.Blank|Sf.Rich,Of=yf|Sf.Array;function Af(e,t,r){var n=e+": generated Excel error, type "+t+"; "+r;O.ULS.traceTag(596120270,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Verbose,n)}function kf(e){return"object"==typeof e&&e.kind===Sf.Error}function Rf(e){return"object"==typeof e&&e.kind===Sf.Blank}function bf(e){return"object"==typeof e&&e.kind===Sf.Array}function If(e){return"object"==typeof e&&e.kind===Sf.Missing}function Tf(e){return"object"==typeof e&&e.kind===Sf.Range}function Nf(e){return"object"==typeof e&&e.kind===Sf.Rich}function Ff(e){return e.kind===Ke.Success?e.value:void 0}function _f(e,t){switch(e.kind){case Ke.Success:return ct(jl(e.value));case Ke.Failure:return st($l(t))}}function Mf(e,t,r){var n=bf(r)?function(e,t,r,n,a,i){if(e===r&&t===n)return a;if(1===e&&1===t)return bl(r,n,void 0===a[0]?i:a[0][0]);var o,u=[];o=1===e?function(e,r){return r<t?a[0][r]:i}:1===t?function(t,r){return t<e?a[t][0]:i}:function(r,n){return r<e&&n<t?a[r][n]:i};for(var c=0;c<r;c+=1){u.push([]);for(var s=0;s<n;s+=1)u[c][s]=o(c,s)}return u}(r.rows,r.cols,e,t,r.opers,Cf):bl(e,t,r);return gf(e,t,n)}function wf(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols,l=Cr(r,o),f=Cr(n,u);return $t(l,f,Sr(r+a,o+c)-l,Sr(n+i,u+s)-f)}function Lf(e){return 0===e.length&&R("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(wf)}function Df(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols,l=Sr(r,o),f=Sr(n,u),d=Cr(r+a,o+c)-l,h=Cr(n+i,u+s)-f;if(!(d<=0||h<=0))return $t(l,f,d,h)}function Uf(e){return e.rows*e.cols}function xf(e,t,r){if(!Tf(t))return t;if(!dt(t.sheets))return Re;if(!r)return 1===t.ranges.length&&pt(t.ranges[0])?e.dereferenceOper(t,Y.All&~Sf.Range):e.dereferenceOper(t,Sf.Array);var n=e.dereferenceOper(t,Y.All&~(Sf.Range|Sf.Array));return bf(n)?Cf:n}function Pf(e){var t=function(e){return e&~(Sf.Array|Sf.Range)};return Ce(e.minArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)}function Gf(e,t,r,n,a){if("object"!=typeof n)return Il(t,r,n);switch(n.kind){case Sf.Missing:case Sf.Blank:return Il(t,r,e.zero);case Sf.Array:return 0!=(a&Sf.Array)?Il(t,r,n):function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?Il(e,t,r.get(0,0)):1===r.rows?new Al(e,t,(function(e,t){return t<r.cols?r.get(0,t):n})):1===r.cols?new Al(e,t,(function(e,t){return e<r.rows?r.get(e,0):n})):new Al(e,t,(function(e,t){return e<r.rows&&t<r.cols?r.get(e,t):n}))}(t,r,new yl(n.rows,n.cols,n.opers),Cf);case Sf.Range:default:return Il(t,r,n)}}function Vf(e,t,r,n){for(var a=0,i=0,o=0;o<n.length;o+=1){var u=n[o];bf(u)&&0==(Mt(t,o,n.length)&Sf.Array)?(a=Sr(a,u.rows),i=Sr(i,u.cols)):(a=Sr(a,1),i=Sr(i,1))}var c=n.map((function(r,n,o){return Gf(e.mathpack,a,i,r,Mt(t,n,o.length))}));return hf(new vf(e,a,i,(function(e,t){return r(c.map((function(r){return r.get(e,t)})))})))}var Wf=Si.NodeKind,Bf=Si.QualifierKind,jf=Si.BadType,Hf=gi.OperKind,Kf=gi.ErrorType,qf=yi.SignatureType,Jf=yi.SpecialPrecs,Qf=yi.getOperatorType,Xf=yi.WorksheetFuncId,Yf=yi.getWorksheetFuncType,zf=Ai.operKind,Zf=Ai.getArguments,$f=Ai.getArgType,ed=Ai.defaultLiteralVisitor,td=Ai.defaultFormulaVisitor,rd=Ai.dispatch,nd=Ai.startVisit,ad=Ai.isUnqualifiedNameNode,id={};function od(e,t){return{context:e,result:t}}function ud(e){return function(t){return t.kind===Wf.Literal&&e(t.oper)}}var cd=ud((function(e){return zf(e)===Hf.Missing})),sd=ud((function(e){return 0!=(zf(e)&(Hf.String|Hf.Error|Hf.Boolean))}));function ld(e,t,r,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(t,r,e.errorData))}function fd(e,t){return t!==Hf.Range||0!=(e&Hf.Range)}function dd(e,t){switch(t.type){case jf.Sequence:if(i=e.localeInfo,2===(o=t.contents).length&&ad(o[0])&&Ad(i,o[1]))return ld(e,t,Ps.Unsupported_struct_ref);if(null!=function(e,t){if(2!==t.length)return;var r=t[0],n=t[1];if(Ad(e,r))return function(e){return e.kind===Wf.Name&&null!=e.qualifier&&e.qualifier.kind===Bf.Ident}(n)?Wf.Name:function(e){return e.kind===Wf.CellRef&&null!=e.qualifier&&e.qualifier.kind===Bf.Sheet&&null==e.qualifier.document}(n)?Wf.CellRef:void 0;if(function(e,t){return t.kind===Wf.Bad&&t.type===jf.Qualifier&&t.contents.indexOf(e.leftBracket)>=0}(e,r))return ad(n)?Wf.Name:function(e){return e.kind===Wf.CellRef&&null==e.qualifier}(n)?Wf.CellRef:void 0;return}(e.localeInfo,t.contents))return ld(e,t,Ps.Unsupported_doc_qual);for(var r=0,n=t.contents;r<n.length;r++){var a=n[r];if(a.kind===Wf.Bad)return dd(e,a)}return ld(e,t,Ps.Bad_node);case jf.Unexpected:switch(t.contents){case")":return ld(e,t,Ps.Unexpected_closing_paren);case e.localeInfo.rightBrace:return ld(e,t,Ps.Unexpected_closing_brace);case e.localeInfo.rightBracket:return ld(e,t,Ps.Unexpected_closing_bracket);default:return ld(e,t,Ps.Bad_node)}case jf.CellRef:case jf.Qualifier:return ld(e,t,Ps.Bad_node)}var i,o}function hd(e,t){if(t.kind===Wf.Literal)switch(ld(e,t,Ps.Unclosed_literal,t.isClosed),zf(t.oper)){case Hf.Number:case Hf.Boolean:case Hf.String:case Hf.Error:return;default:return void ld(e,t,Ps.Illegal_array_literal_element)}ld(e,t,Ps.Illegal_array_literal_element)}function pd(e,t,r){ld(e,t,Gs.Types_not_related,fd(Hf.Array,r)),ld(e,t,Ps.Unclosed_array,t.isClosed);var n=t.nodes.length>0;if(ld(e,t,Ps.Empty_array_literal,n),!n)return od(e,r);for(var a=t.nodes[0].length,i=0;i<t.nodes.length;i+=1){var o=t.nodes[i],u=o.length;ld(e,t,Ps.Irregular_array_shape,u===a);for(var c=0;c<u;c+=1)hd(e,o[c])}return od(e,r)}function vd(e,t,r){if(e.earlyExit&&!e.isOk())throw id;switch(t.kind){case Wf.Array:return pd(e,t,r);case Wf.Paren:return ld(e,t,Ps.Unclosed_paren,t.isClosed),ld(e,t,Ps.Empty_parenthesis,!cd(t.node)),vd(e,t.node,r);case Wf.Bad:case Wf.Name:case Wf.CellRef:case Wf.App:case Wf.Literal:var n=Sd(e,t);return ld(e,t,Gs.Types_not_related,fd(n.result,r)),n.result=r,n;default:return k("calc.analyze.checker.check: unhandled formula case",t)}}function md(e,t,r){return ad(r)?(ld(e,r,Ps.Invalid_binder,!t.contains(r.whole)),t.setValue(r.whole,!0)):(ld(e,r,Ps.Invalid_binder),t)}function gd(e,t,r){var n,a=Yf(t),i=a.minArgs,o=a.headTypes,u=a.restTypes,c=a.tailTypes,s=r.args,l=s.length,f=Zf(r),d=f.length;d<i&&ld(e,void 0===(n=s[l-1])?r:n,Gs.Insufficient_function_arguments);0===u.length&&d>o.length&&ld(e,void 0===(n=s[l-1])?r:n,Gs.Excess_function_arguments);u.length>1&&d>o.length&&((d-o.length)%u.length>c.length&&ld(e,void 0===(n=s[l-1])?r:n,Gs.Insufficient_function_arguments));for(var h=0;h<d;h+=1)vd(e,f[h],$f(a,h,d));return e.specialDependencies|=a.staticPrecs,function(e,t,r){switch(t){case Xf.LET:case Xf.LETREC:if(!Rn(t===Xf.LET?gn.CalcLetFunction:gn.CalcLetRecFunction))return;r.length>=3&&r.length%2!=1&&ld(e,r[r.length-1],Gs.Insufficient_function_arguments);for(var n=e.localeInfo,a=El.create(n.stringCompareCI),i=0;i+1<r.length;i+=2)a=md(e,a,r[i]);return;case Xf.FUN:if(!Rn(gn.CalcFunFunctions))return;for(n=e.localeInfo,a=El.create(n.stringCompareCI),i=0;i<r.length-1;i+=1)a=md(e,a,r[i])}}(e,t,s),od(e,a.returnType)}function Cd(e,t){ld(e,t,Ps.Unclosed_application,t.isClosed);var r=t.args;if(Ft(t.head))return function(e,t,r){var n=Qf(t.id),a=r.length,i=a===n.minArgs;ld(e,t,Gs.Incorrect_number_of_operator_arguments,i);for(var o=0;o<a;o+=1){var u=r[o];cd(u)&&(i=!1,ld(e,u,Ps.Missing_operation_argument)),vd(e,u,$f(n,o,a))}return i?(e.specialDependencies|=n.staticPrecs,od(e,n.returnType)):od(e,qf.All)}(e,t.head,r);if(ad(t.head)){var n=jt(e.localeInfo,t.head.whole);if(void 0!==n)return gd(e,n,t)}for(var a=0;a<r.length;a+=1)vd(e,r[a],qf.All);var i=t.head,o=Sd(e,i);return fd(o.result,Hf.Range)||0!=(o.result&(Hf.Array|Hf.Rich))||ld(e,i,sd(i)||i.kind===Wf.Array?Gs.Unexpected_application_head:Gs.Unexpected_application_head_with_fix),od(e,qf.All)}function Sd(e,t){if(e.earlyExit&&!e.isOk())throw id;switch(t.kind){case Wf.App:return Cd(e,t);case Wf.Array:return pd(e,t,Hf.Array);case Wf.Bad:return dd(e,t),od(e,qf.All);case Wf.CellRef:return e.locals.allowRelativeQualifier||void 0===t.qualifier||t.qualifier.kind!==Bf.Relative?od(e,Hf.Range):(ld(e,t,Ps.Invalid_rel_sheet_qualifier_in_cell),od(e,qf.All));case Wf.Literal:return ld(e,t,Ps.Unclosed_literal,t.isClosed),od(e,zf(t.oper)|(kf(t.oper)&&t.oper.type===Kf.REF?Hf.Range:0));case Wf.Name:return e.locals.allowRelativeQualifier||void 0===t.qualifier||t.qualifier.kind!==Bf.Relative||ld(e,t,Ps.Invalid_rel_sheet_qualifier_in_name),od(e,qf.All);case Wf.Paren:return ld(e,t,Ps.Unclosed_paren,t.isClosed),ld(e,t,Ps.Empty_parenthesis,!cd(t.node)),Sd(e,t.node);default:return k("calc.analyze.checker.infer: unhandled formula case",t)}}var Ed={ok:!0,isOk:dr,collect:function(e,t,r){return!1}};function yd(e,t,r,n){var a,i;void 0===n&&(n=!0);var o={globals:e,locals:t,localeInfo:(i=null===(a=t.config)||void 0===a?void 0:a.localeInfo,null!=i?i:e.config.localeInfo),reportError:r.collect,isOk:function(){return r.isOk(o.errorData)},earlyExit:n,specialDependencies:Jf.None,errorData:r.ok};return o}function Od(e,t){try{return ld(e,t.node,Ps.Empty_formula,!cd(t.node)),vd(e,t.node,qf.All)}catch(t){return t!==id&&O.ULS.traceTag(595952020,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.check.runChecker: Exception "+v(t)),od(e,qf.All)}}function Ad(e,t){if(t.kind!==Wf.Bad||t.type!==jf.Sequence||3!==t.contents.length)return!1;var r=t.contents[0],n=t.contents[2];return r.kind===Wf.Bad&&r.type===jf.Unexpected&&r.contents===e.leftBracket&&(n.kind===Wf.Bad&&n.type===jf.Unexpected&&n.contents===e.rightBracket)}function kd(e){if(e.kind===Wf.Literal&&e.isClosed)switch(zf(e.oper)){case Hf.Number:case Hf.Boolean:case Hf.String:case Hf.Error:return!0;default:return!1}return!1}function Rd(e,t,r){var n,a,i=r.head,o=i.kind!==Wf.Operator;if(!r.isClosed||r.args.some((function(r){return!bd(e,t,r,o)})))return!1;if(i.kind===Wf.Operator)return(c=Qf(i.id)).minArgs===r.args.length;if(!bd(e,t,i,!1))return!1;if(ad(i)){var u=jt(null!=(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?a:e.config.localeInfo,i.whole);if(void 0!==u){var c,s=(c=Yf(u)).minArgs,l=c.headTypes,f=c.restTypes,d=c.tailTypes,h=Zf(r).length;if(h<s)return!1;if(0===f.length&&h>l.length)return!1;if(f.length>1&&h>l.length)if((h-l.length)%f.length>d.length)return!1;return function(e,t){switch(e){case Xf.LET:case Xf.LETREC:if(!Rn(e===Xf.LET?gn.CalcLetFunction:gn.CalcLetRecFunction))return!0;if(t.length%2!=1)return!1;for(var r=0;r+1<t.length;r+=2)if(!ad(t[r]))return!1;return!0;case Xf.FUN:return!Rn(gn.CalcFunFunctions)||t.slice(0,t.length-1).every(ad);default:return!0}}(u,r.args)}}return!0}function bd(e,t,r,n){switch(r.kind){case Wf.Literal:return r.isClosed&&(!!n||zf(r.oper)!==Hf.Missing);case Wf.Name:case Wf.CellRef:return t.allowRelativeQualifier||!(void 0!==r.qualifier&&r.qualifier.kind===Bf.Relative);case Wf.Array:return r.isClosed&&r.nodes.length>0&&r.nodes.every((function(e){return t=e,n=r.nodes[0].length,t.length===n&&t.every(kd);var t,n}));case Wf.App:return Rd(e,t,r);case Wf.Paren:return r.isClosed&&bd(e,t,r.node,!1);case Wf.Bad:return!1;default:return k("calc.analyze.isWF",r)}}var Id=td(ed((function(e){return 1})),(function(e){return 1}),{vArray:function(e){var t=-1;return e.nodes.forEach((function(e){e.forEach((function(e){var r=rd(e,Id);t=Math.max(t,r)}))})),1+t},vRange:function(e){var t=rd(e.ref1,Id),r=rd(e.ref2,Id);return 1+Math.max(t,r)},vBad:function(e){if(e.type===jf.Sequence){var t=-1;return e.contents.forEach((function(e){var r=rd(e,Id);t=Math.max(t,r)})),1+t}return 1},vCellRef:function(e){var t=-1;if(void 0!==e.qualifier){var r=rd(e.qualifier,Id);t=Math.max(t,r)}return 1+Math.max(t,rd(e.ref,Id))},vParen:function(e){return 1+rd(e.node,Id)},vApp:function(e){var t=-1;return e.args.forEach((function(e){var r=rd(e,Id);t=Math.max(t,r)})),1+t}});var Td,Nd=[];function Fd(e,t,r,n){if(Rn(gn.CalcStrictFormulaChecking))if(Nd.length<10){var a=(i=r.node,nd(i,Id,-1));Nd.push(a)}else O.ULS.traceTag(595957962,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.checkFormula: 10 tree depths = "+Nd.join("; ")),Nd=[];var i,o=function(e,t,r){var n=Od(yd(e,t,Ed),r).context.errorData;return Object(P.a)(Object(P.a)({},r),{isWellFormed:n})}(e,t,r);if(!Rn(gn.CalcStrictFormulaChecking)){var u=bd(e,t,r.node,!1);if(o.isWellFormed!==u){var c=ir(Zt(Yt(void 0,"Book1"),0),tr(0,0));O.ULS.traceTag(592995977,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.checkFormula: old isWellFormed = "+u+", new isWellFormed = "+o.isWellFormed+"; operation: "+n+"; anonymize: "+pi(r,Kt(c)))}}return o}var _d=Si.NodeKind,Md=gi.OperKind,wd=yi.OperatorId,Ld=yi.getWorksheetFuncType,Dd=yi.WorksheetFuncId,Ud=Ai.success,xd=Ai.failure,Pd=Ai.operKind,Gd=Ai.isSuccess,Vd=Ai.getArguments,Wd=Ai.unavailable,Bd=Ai.sheetGridRangeAnchor,jd=Ai.createResolutionHandler,Hd=Ai.createResolver,Kd=Ai.ResolveReasonKind,qd=Ai.isSheetGridRange,Jd=Ai.isValidArgsLength,Qd={kind:Js.BadOperation},Xd={kind:Js.BadFormula},Yd=function(){},zd=function(){return xd(Wd(["defaultInferenceGlobals getSheetIndex"]))},Zd=function(){return xd(Wd(["defaultInferenceGlobals getNameLoc"]))},$d=function(){return xd(Wd(["defaultInferenceGlobals getCellFormat"]))},eh=function(){return xd(Wd(["defaultInferenceGlobals getKnownFormat"]))};function th(e,t,r){return vr(t)?r:t.bind(e)}function rh(e){return{getDocumentLoc:th(e,e.getDocumentLoc,Yd),getSheetIndex:th(e,e.getSheetIndex,zd),getNameLoc:th(e,e.getNameLoc,Zd)}}function nh(e){return{getDocumentLoc:th(e,e.getDocumentLoc,Yd),getSheetIndex:th(e,e.getSheetIndex,zd),getNameLoc:th(e,e.getNameLoc,Zd),getCellFormat:th(e,e.getCellFormat,$d),getKnownFormat:th(e,e.getKnownFormat,eh)}}function ah(e,t,r,n){return{strongFormat:e,category:t,iformat:r,decimals:n}}var ih,oh={Number:1,Currency:2,Accounting:2,Percentage:3,Date:4,Time:5,Fraction:6,Scientific:7,Text:8,Custom:9,Special:9,General:0};!function(e){e[e.Propagate=-1]="Propagate",e[e.Ignore=-2]="Ignore"}(ih||(ih={}));var uh=((Td={})[Dd.INT]=ih.Propagate,Td[Dd.MOD]=ih.Propagate,Td[Dd.ROUND]=ih.Propagate,Td[Dd.SUM]=ih.Propagate,Td[Dd.TRUNC]=ih.Propagate,Td[Dd.AVERAGE]=ih.Propagate,Td[Dd.MAX]=ih.Propagate,Td[Dd.MEDIAN]=ih.Propagate,Td[Dd.MIN]=ih.Propagate,Td[Dd.ROUNDUP]=ih.Propagate,Td[Dd.ROUNDDOWN]=ih.Propagate,Td[Dd.NPV]=Ws.CoCurrencyDec,Td[Dd.PV]=Ws.CoCurrencyDec,Td[Dd.FV]=Ws.CoCurrencyDec,Td[Dd.PMT]=Ws.CoCurrencyDec,Td[Dd.RATE]=Ws.Percentage0,Td[Dd.MIRR]=Ws.Percentage0,Td[Dd.IRR]=Ws.Percentage0,Td[Dd.DATE]=Ws.MMDDYY,Td[Dd.TIME]=Ws.HHMMAP,Td[Dd.NOW]=Ws.MDYHMS,Td[Dd.SLN]=Ws.CoCurrencyDec,Td[Dd.SYD]=Ws.CoCurrencyDec,Td[Dd.DDB]=Ws.CoCurrencyDec,Td[Dd.IPMT]=Ws.CoCurrencyDec,Td[Dd.PPMT]=Ws.CoCurrencyDec,Td[Dd.TODAY]=Ws.MMDDYY,Td[Dd.VDB]=Ws.CoCurrencyDec,Td[Dd.DB]=Ws.CoCurrencyDec,Td);var ch=[["General","Number","Currency","Percentage","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Percentage","Date","Time","Number","Scientific","Text","Custom"],["General","General","Currency","General","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","General","General","Percentage","Percentage","Text","Custom"],["General","General","General","General","General","Date","General","General","Text","Custom"],["General","General","General","General","General","Time","General","General","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]],sh=[["General","Number","Currency","General","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Number","Date","Time","Fraction","Scientific","Text","Custom"],["General","General","General","Currency","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","Date","Time","Percentage","Scientific","Text","Custom"],["General","General","General","General","General","General","Date","Date","Text","Custom"],["General","General","General","General","General","General","Time","Time","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]];function lh(e,t,r){if(2===t.length)return r(e,Ch(e,t[0]),Ch(e,t[1]));throw new Qs(Xd)}function fh(e,t,r,n){var a=r.iformat,i=n.iformat,o=r.category,u=n.category,c=oh[o],s=oh[u],l=c<=s?t[c][s]:t[s][c],f=oh[l],d=n.decimals>r.decimals?n.decimals:r.decimals;switch(f){case c:return ah(!0,o,a,d);case s:return ah(!0,u,i,d);default:return e.unitlessFormat}}function dh(e,t,r){return fh(e,sh,t,r)}function hh(e,t,r){var n=t.iformat,a=r.iformat,i=t.category,o=r.category;if(n===a&&i===o&&"Time"===i)return ah(!0,i,n,0);if("Date"===i&&"Time"===o||"Time"===i&&"Date"===o){var u=e.globals.getKnownFormat(Ws.MDYHMS);if(!Gd(u))throw new Qs(u.reason);return ah(!0,u.value.category,u.value.iformat,u.value.decimals)}return fh(e,ch,t,r)}var ph=function(e){return e.unitlessFormat};function vh(e,t,r){var n=t.iformat;return n===r.iformat?ah(!0,t.category,n,t.decimals):e.unitlessFormat}function mh(e,t){return oh[t]===oh[e.defaultFormat.category]}var gh=jd(Ud,(function(e){return xd(Wd([e]))}),(function(e,t){return e.kind===Kd.NoOriginSheet?xd(Wd([t])):xd(e)}));function Ch(e,t){switch(t.kind){case _d.App:var r=t.head;if(Ft(r))return function(e,t,r){switch(t){case wd.Mul:case wd.Div:return e.multOrDivTainted=!0,lh(e,r.args,dh);case wd.Pow:return lh(e,r.args,dh);case wd.Add:case wd.Sub:return lh(e,r.args,hh);case wd.Percent:if(1===r.args.length){var n=r.args[0];if(n.kind!==_d.Literal||"number"!=typeof n.oper)return e.defaultFormat;var a=Ch(e,n);return ah(a.strongFormat,"Percentage",Ws.Percentage,a.decimals)}throw new Qs(Xd);case wd.Pound:case wd.At:return e.defaultFormat;case wd.Neg:case wd.Pos:if(1===r.args.length)return Ch(e,r.args[0]);throw new Qs(Xd);case wd.Lt:case wd.Le:case wd.Eq:case wd.Ge:case wd.Gt:case wd.Ne:return lh(e,r.args,ph);case wd.Isect:case wd.Union:case wd.Range:case wd.Concat:return lh(e,r.args,vh);case wd.And:case wd.Or:case wd.Xor:case wd.Min:case wd.Max:case wd.Dot:throw new Qs(Qd);default:return k("calc.analyzer.inferFormat: unexpected operator id",t)}}(e,r.id,t);if(_t(r)){var n=jt(e.localeInfo,r.whole);if(void 0!==n){var a=mr(uh[n],ih.Ignore),i=Ld(n),o=Vd(t);if(!Jd(i,o.length))throw new Qs(Xd);if(n===Dd.HYPERLINK&&(e.hyperlinkTainted=!0),a===ih.Ignore)return e.defaultFormat;if(a===ih.Propagate){if(0===o.length)return e.defaultFormat;var u=Ch(e,o[0]),c=u.iformat,s=u.category,l=u.decimals,f=!mh(e,s);if(!u.strongFormat&&f)return e.unitlessFormat;for(var d=f,h=1;h<o.length;h+=1){var p=Ch(e,o[h]),v=!mh(e,p.category);if(!p.strongFormat&&v)return e.unitlessFormat;d||(c=p.iformat,s=p.category,l=p.decimals,d=v)}return ah(!0,s,c,l)}var m=e.globals.getKnownFormat(a);if(!Gd(m))throw new Qs(m.reason);return ah(!0,m.value.category,a,m.value.decimals)}}return Ch(e,r);case _d.Array:return e.defaultFormat;case _d.CellRef:var g=e.resolver.resolveCellRef(e.locals,t.qualifier,t.ref),C=gh(t.ref,g);if(!Gd(C))throw new Qs(C.reason);var S=C.value;if(!qd(S))return e.unitlessFormat;var E=Bd(S),y=e.globals.getCellFormat(E);if(!Gd(y))throw new Qs(y.reason);var O=y.value.iformat,A=y.value.category;return ah(!0,A,O,"Date"!==A&&"Time"!==A&&"Text"!==A&&"Custom"!==A&&"Special"!==A?y.value.decimals:0);case _d.Literal:var R=Pd(t.oper);switch(R){case Md.String:case Md.Boolean:case Md.Error:case Md.Missing:return e.defaultFormat;case Md.Number:var b=e.mathpack.formatGeneral(e.localeInfo,t.oper,21),I=b.indexOf(".");l=I>=0?b.length-I-1:0;return ah(!1,e.defaultFormat.category,e.defaultFormat.iformat,l);default:return k("calc.analyze.inferFormat: unexpected literal oper",R)}case _d.Name:return e.defaultFormat;case _d.Paren:return Ch(e,t.node);case _d.Bad:throw new Qs(Xd);default:return k("calc.analyzer.inferFormat",t)}}function Sh(e,t,r){try{var n=function(e,t){var r,n;return{globals:nh(e),locals:t,config:e.config,localeInfo:(n=null===(r=t.config)||void 0===r?void 0:r.localeInfo,null!=n?n:e.config.localeInfo),mathpack:e.config.mathpack,defaultFormat:ah(!1,"General",Ws.General,0),unitlessFormat:ah(!0,"General",Ws.General,0),resolver:Hd(rh(e)),multOrDivTainted:!1,hyperlinkTainted:!1}}(e,t),a=Ch(n,r);return O.ULS.traceTag(595948253,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Verbose,"calc.analyze.inferFormat: inferred format info = "+a),Ud(Object(P.a)(Object(P.a)({},a),{multOrDivTainted:n.multOrDivTainted,hyperlinkTainted:n.hyperlinkTainted}))}catch(e){return e instanceof Qs?(O.ULS.traceTag(595948254,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.inferFormat: inference failed = "+C(e.reason)),e.reason):(O.ULS.traceTag(595948255,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.inferFormat: caught exception = "+v(e)),xd(ft(e)))}}var Eh,yh,Oh,Ah,kh=gi.SpecialPrecs,Rh=gi.PrecsBound,bh=gi.precedents;function Ih(e){return{checkFormula:function(t,r,n){return Fd(e,t,r,null!=n?n:"undefined")},checkFormulaWithDiagnostics:function(t,r,n){return function(e,t,r,n){var a=Od(yd(e,t,{ok:void 0,isOk:function(e){return void 0===e},collect:function(e,t,r){var n,a=null!=r?r:[];return(n=a[e.label],null!=n?n:a[e.label]=[]).push(t),a}},!1),r).context.errorData;if(!Rn(gn.CalcStrictFormulaChecking)){var i=void 0===a,o=bd(e,t,r.node,!1);if(i!==o){var u=ir(Zt(Yt(void 0,"Book1"),0),tr(0,0));O.ULS.traceTag(592995976,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.checkFormula: old isWellFormed = "+o+", new isWellFormed = "+i+", new diagnostics = "+JSON.stringify(a)+"; operation: "+n+"; anonymize: "+pi(r,Kt(u)))}}return[Object(P.a)(Object(P.a)({},r),{isWellFormed:void 0===a}),a]}(e,t,r,null!=n?n:"undefined")},findStaticPrecedents:function(e,t){return bh([],[],kh.All,Rh.Upper)},findBestFormat:function(t,r){return Sh(e,t,r.node)}}}function Th(e){return{kind:Eh.RangeValues,arrays:e}}!function(e){e.RangeValues="RangeValues"}(Eh||(Eh={})),function(e){e[e.Array=-2147483648]="Array",e[e.Fun=-2147483647]="Fun",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.ReadClosure=-2147483640]="ReadClosure",e[e.Conditional=-2147483639]="Conditional",e[e.CallLambda=-2147483638]="CallLambda"}(Ah||(Ah={}));var Nh,Fh=(yh=fr(dr,dr)).wrap,_h=yh.unwrap,Mh=(Oh=fr((function(e){return-e}),(function(e){return-e}))).wrap,wh=Oh.unwrap;function Lh(e){return e>0}function Dh(e){return{kind:e,data:void 0,children:void 0}}function Uh(e,t,r){var n=Dh(Ah.Array);return n.children=r,n.data={rows:e,cols:t},n}function xh(e,t,r,n){var a=Dh(Ah.Fun);return a.children=n,a.data={arity:e,closureId:t,closedIdents:r},a}function Ph(e,t,r){var n=Dh(Ah.Let);return n.children=Object(P.f)(e,[r]),n.data={rec:t},n}function Gh(e,t,r,n){var a=Dh(Ah.App);return a.children=n,a.data={funName:e,funType:t,isFormulaRoot:r},a}function Vh(e,t,r){var n=Dh(Ah.Name);return n.data={name:e,qualifier:t},n.children=r,n}function Wh(e,t,r){var n=Dh(Ah.Udf);return n.data={name:e,qualifier:t},n.children=r,n}function Bh(e){var t=Dh(Ah.ReadStack);return t.data=e,t}function jh(e,t,r,n,a){var i=Dh(Ah.Conditional);return i.children=Object(P.f)([n],a),i.data={funName:e,funType:t,isFormulaRoot:r},i}function Hh(e){return"object"!=typeof e||e.kind>0}function Kh(e,t){for(var r,n=0;n<e.length;n+=1){var a=e[n],i=t(a);void 0===r?i!==a&&(r=e.slice(0,n)).push(i):r.push(i)}return void 0!==r?r:e}function qh(e,t){return Kh(e,function(e){return function(t){return Kh(t,e)}}(t))}function Jh(e,t){return t(function(e,t){if(Hh(e))return e;switch(e.kind){case Ah.Let:var r=Kh(e.children,t);return r===e.children?e:Ph(r.slice(0,r.length-1),e.data.rec,r[r.length-1]);case Ah.App:var n=Kh(e.children,t);return n===e.children?e:Gh(e.data.funName,e.data.funType,e.data.isFormulaRoot,n);case Ah.Conditional:var a=e.children,i=a[0],o=a.slice(1),u=t(i),c=Kh(o,t);return i===u&&o===c?e:jh(e.data.funName,e.data.funType,e.data.isFormulaRoot,u,c);case Ah.Fun:var s=t(e.children);return s===e.children?e:xh(e.data.arity,e.data.closureId,e.data.closedIdents,s);case Ah.Array:var l=qh(e.children,t);return l===e.children?e:Uh(e.data.rows,e.data.cols,l);case Ah.Name:return(f=void 0===e.children?void 0:t(e.children))===e.children?e:Vh(e.data.name,e.data.qualifier,f);case Ah.Udf:var f;return(f=void 0===e.children?void 0:t(e.children))===e.children?e:Wh(e.data.name,e.data.qualifier,f);case Ah.CellRef:case Ah.ReadStack:case Ah.ReadClosure:return e}}(e,(function(e){return Jh(e,t)})))}var Qh=P.a,Xh=Si.NodeKind,Yh=Ai.getArguments,zh=gi.arrayOper,Zh=yi.WorksheetFuncId,$h=yi.OperatorId,ep=Ai.success,tp=Ce(1,[X.Number|X.String|X.Boolean|X.Rich|X.Error|X.Blank],[X.Number|X.String|X.Boolean|X.Rich|X.Error|X.Blank|X.Missing|X.Array|X.Range],[],Y.All,z.None,Z.Allow3dRef),rp=Pf(ot(Zh.IF)),np=Pf(ot(Zh.CHOOSE));function ap(e){return"object"!=typeof e||Hh(e)&&("object"!=typeof(t=e)||t.kind===Sf.Error||t.kind===Sf.Array||t.kind===Sf.Rich);var t}var ip=function(){function e(e){this.id=e,this.slots=[],this.idToSlot={}}return e.prototype.mapStackId=function(e){var t=this.idToSlot[e];return null!=t?t:this.idToSlot[e]=this.slots.push(e)-1},e}(),op=El.create((function(e,t){return e-t}));function up(e,t,r,n,a,i,o){switch(void 0===i&&(i=!1),void 0===o&&(o=!1),a.kind){case Xh.Array:var u=a.nodes.map((function(a){return a.map((function(a){return up(e,t,r,n,a)}))}));return N=(T=u).length,F=void 0===T[0]?0:T[0].length,T.every((function(e){return e.every(ap)}))?zh(N,F,T):Uh(N,F,T);case Xh.App:var c=a.head;if(Ft(c)){var s=Yh(a).map((function(a){return up(e,t,r,n,a)})),l=yi.getOperatorType(c.id);return Gh(Fh(c.id),l,o,s)}if(_t(c))if(null!=(S=jt(e.localeInfo,c.whole))){var d=void 0;switch(S){case Zh.LET:case Zh.LETREC:if(!Rn(S===Zh.LET?gn.CalcLetFunction:gn.CalcLetRecFunction))break;d=function(e,t,r,n,a,i){if(a.args.length>=3&&a.args.length%2==1&&a.args.every((function(e,t,r){return t===r.length-1||t%2==1||_t(e)}))){for(var o=t,u=a.args.length>>1,c=[],s=0;s+1<a.args.length;s+=2){var l=a.args[s].whole;e.annotations[a.args[s].label]=se(l)}if(i){for(s=0;s+1<a.args.length;s+=2){l=a.args[s].whole;var f=r+s/2;o=o.setValue(l,[n.getCount(),f])}for(s=0;s+1<a.args.length;s+=2)c.push(up(e,o,r+u,n,a.args[s+1]))}else for(s=0;s+1<a.args.length;s+=2){l=a.args[s].whole,f=r+s/2;c.push(up(e,o,f,n,a.args[s+1])),o=o.setValue(l,[n.getCount(),f])}return Ph(c,i,up(e,o,r+u,n,a.args[a.args.length-1]))}}(e,t,r,n,a,S===Zh.LETREC);break;case Zh.FUN:if(!Rn(gn.CalcFunFunctions))break;d=function(e,t,r,n,a){var i=a.args.slice(0,a.args.length-1);if(a.args.length>0&&i.every(_t)){var o=new ip(n.getCount()+1),u=n.setValue(o.id,o),c=i.reduceRight((function(t,n,a){var i=n.whole;return e.annotations[n.label]=se(i),t.setValue(i,[u.getCount(),r+a])}),t),s=up(e,c,r+i.length,u,a.args[a.args.length-1]),l=o.slots.map((function(e){return r-e-1}));return xh(i.length,o.id,l,s)}}(e,t,r,n,a);break;case Zh.IF:d=function(e,t,r,n,a){var i=a.args;return 3===i.length?jh(Mh(Zh.IF),rp,!1,up(e,t,r,n,i[0]),[up(e,t,r,n,i[1]),up(e,t,r,n,i[2])]):2===i.length?jh(Mh(Zh.IF),rp,!1,up(e,t,r,n,i[0]),[up(e,t,r,n,i[1]),!1]):void 0}(e,t,r,n,a);break;case Zh.CHOOSE:if(Rn(gn.CalcWorksheetFunctions)&&Rn(gn["OfficeVSO:3852168_CalcCGCHOOSE"]))d=function(e,t,r,n,a){var i=a.args;if(i.length>=1)return jh(Mh(Zh.CHOOSE),np,!1,up(e,t,r,n,i[0]),i.slice(1).map((function(a){return up(e,t,r,n,a)})))}(e,t,r,n,a);else{var h=Yh(a).map((function(a){return up(e,t,r,n,a)})),p=yi.getWorksheetFuncType(S);d=Gh(Mh(S),p,!1,h)}break;case Zh.IFERROR:case Zh.IFNA:d=function(e,t,r,n,a,i){var o=a.args;if(2===o.length){var u=Bh(0),c=jh(Mh(Zh.IF),rp,!1,Gh(Mh(i),yi.getWorksheetFuncType(i),!1,[u]),[up(e,t,r+1,n,o[1]),u]);return Ph([up(e,t,r,n,o[0])],!1,c)}}(e,t,r,n,a,S===Zh.IFERROR?Zh.ISERROR:Zh.ISNA);break;default:s=Yh(a).map((function(a){return up(e,t,r,n,a)})),l=yi.getWorksheetFuncType(S);d=Gh(Mh(S),l,!1,s)}if(void 0!==d)return e.annotations[c.label]=ce(S),d}return function(e,t,r,n,a){var i=Yh(a).map((function(a){return up(e,t,r,n,a)}));return Gh(Mh(Zh._UDF),tp,!1,[up(e,t,r,n,a.head,!0)].concat(i))}(e,t,r,n,a);case Xh.Paren:return up(e,t,r,n,a.node);case Xh.Name:if(null==a.qualifier){var v=t.getEntry(a.whole);if(void 0!==v){e.annotations[a.label]=se(v.key);var m=v.value,g=m[0],S=m[1];if(g===n.getCount())return Bh(r-S-1);var E=n.getValue(g+1);return b("calc.runtime.formulaToTermIR: closure",void 0!==E),function(e,t){var r=Dh(Ah.ReadClosure);return r.data=[e,t],r}(E.id,E.mapStackId(S))}}return function(e,t,r,n){return!r||void 0!==t.qualifier&&t.qualifier.kind!==M.Document&&t.qualifier.kind!==M.Ident||(n=Wh(Ht(e,t),t.qualifier,n)),Vh(t.whole,t.qualifier,n)}(e.localeInfo,a,i,void 0);case Xh.CellRef:return A=a.ref,R=a.qualifier,(I=Dh(Ah.CellRef)).data={ref:A,qualifier:R},I;case Xh.Literal:return a.oper;case Xh.Bad:var y="calc.runtime.compile: unexpected bad node "+C(a);return O.ULS.assertTag(595980820,f.LogCategory.msoulscat_ES_EWAJS,!1,y);default:return k("calc.runtime.compile",a)}var A,R,I,T,N,F}var cp=((Nh={})[$h.At]=Zh.SINGLE,Nh[$h.Pound]=Zh.ANCHORARRAY,Nh[$h.Dot]=Zh._FV,Nh);var sp=function(e){if(!Hh(e)&&e.kind===Ah.App&&Lh(e.data.funName)){var t=cp[_h(e.data.funName)];if(void 0!==t)return Gh(Mh(t),yi.getWorksheetFuncType(t),e.data.isFormulaRoot,e.children)}return e};var lp;function fp(e,t){return function(e){return"__compiledFormulaBrand__"===e.kind}(t)?t.term:k(e+": expected known compiled formula type; given "+C(t),t)}function dp(e,t,r){var n,a,i=null!=(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?a:e.config.localeInfo,o=El.create(i.stringCompareCI),u=Qh([],r.annotations),c=up({globals:e,locals:t,localeInfo:i,annotations:u},o,0,op,r.node,void 0,!0),s=Jh(c,sp);return ep(function(e,t,r){return Object(P.a)(Object(P.a)({kind:"__compiledFormulaBrand__"},e),{annotations:t,term:r})}(r,u,s))}function hp(e){return{compileFormula:function(t,r){return dp(e,t,r)}}}function pp(e){return 0===e.length&&R("calc.runtime.unevaluated: expected nonempty array"),{kind:lp.Unevaluated,anchors:e}}!function(e){e.Unevaluated="Unevaluated"}(lp||(lp={}));var vp=Wt;function mp(e){throw new vp(e)}function gp(e,t,r){var n;switch(r.kind){case lp.Unevaluated:if(t.map.getCount()+1>(null!=(n=e.globals.limits.maxCellChain)?n:1/0))return st(ef(Vl.CellChain));var a=r.anchors.map((function(r){return e.createCellEvaluationMachine(e,t,r,!0)}));return of(new df(a),cf());default:return st(r)}}function Cp(){return ye([],[],z.None,ee.Lower)}function Sp(e){var t=At(e.range),r=ct(t.range),n=ct(t.sheet);return Yl(e,r,n,e.kind===Vt.Range,r,n,e.kind===Vt.Cell,!1,ct(!1))}function Ep(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function yp(e,t){return e<t?-1:e===t?0:1}function Op(e,t){return"string"==typeof e?"string"!=typeof t?1:yp(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function Ap(e,t){var r;return 0!==(r=yp(e.name,t.name))?r:Ep(e.path,t.path,yp)}function kp(e,t){return{current:e,map:t}}var Rp=kp(void 0,El.create((function(e,t){var r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=Op(e.sheet.index,t.sheet.index))?r:Ap(e.sheet.document,t.sheet.document)})));function bp(e,t){return{current:e,map:t}}var Ip=bp(void 0,El.create((function(e,t){var r;return 0!==(r=yp(e.name,t.name))||0!==(r=Ep(e.scope.index,t.scope.index,Op))?r:Ap(e.scope.document,t.scope.document)})));var Tp=function(){function e(e,t,r,n){this.context=e,this.previousVisitedCells=t,this.cell=r,this.isPrecedent=n,this.isRunning=!1,this.locals=void 0}return e.prototype.getRealReason=function(e){var t;if(e.kind!==Dl.PreviousFailure)return e;var r=At(e.range);return null!=(t=this.context.realReasonMap[this.realReasonKey(r)])?t:e},e.prototype.realReasonKey=function(e){var t=e.sheet,r=t.index,n=t.document,a=e.range,i=a.row,o=a.col,u=Zt(Yt(null!=n.path?n.path:void 0,n.name),r);return JSON.stringify({sheet:u,row:i,col:o})},e.prototype.visitAnchor=function(e){var t=At(e.range),r=this.previousVisitedCells.map.getValue(t);if(null!=r){var n="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+C(t)+"; given "+C(r));return O.ULS.assertTag(595980812,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=Jt(e.source,e.range);return this.locals={cell:t,cycle:void 0,previous:this.previousVisitedCells.current,source:a,precedents:Cp()},this.locals},e.prototype.unVisitAnchor=function(e){var t=this.locals;if(this.locals=void 0,void 0!==t&&void 0!==e){var r=At(t.source.range);this.context.realReasonMap[this.realReasonKey(r)]=e.reason}return t},e.prototype.next=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===Ke.Failure)return st(this.getRealReason(e.reason));var t=e.value;if(t.kind===Pl.FinalValue)return ct(t.oper);var r=this.context.globals.getCellFormula(t.anchor);if(r.kind===Ke.Failure){var n="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return O.ULS.assertTag(595980813,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=r.value;if(null==a){n="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+C(t.anchor)+") != null");return O.ULS.assertTag(595980814,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}var i,o,u=this.visitAnchor(a);return of(this.context.createFormulaEvaluationMachine(this.context,Sp(u.source),u.precedents,(i=this.previousVisitedCells,b("calc.runtime.appendVisitedCell",(o=u).previous===i.current),kp(o,i.map.setValue(o.cell,o))),a.formula),this)},e.prototype.receiveResult=function(e){return lt(e)?this.receiveSuccess(e):this.receiveFailure(e)},e.prototype.receiveSuccess=function(e){var t=e.value;if("object"==typeof t&&(t.kind===X.Range||t.kind===X.Missing)){var r="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+C(t));return O.ULS.assertTag(595980815,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}var n=this.unVisitAnchor(void 0);if(null==n){r="calc.runtime.CellEvaluationMachine.receiveSuccess: expected this.locals != null";return O.ULS.assertTag(595980816,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}return this.writeResult(n.source,e,n.precedents),e},e.prototype.receiveFailure=function(e){var t=e.reason;if(t.kind===lp.Unevaluated){var r="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+C(t));return O.ULS.assertTag(595980817,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}var n=this.getRealReason(t),a=n===t?e:st(n),i=this.unVisitAnchor(a);if(null==i){r="calc.runtime.CellEvaluationMachine.receiveFailure: expected this.locals != null";return O.ULS.assertTag(595980818,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}var o=t.kind===Dl.PreviousFailure&&void 0!==i.cycle?st(i.cycle):e;return this.writeResult(i.source,o,i.precedents),this.isPrecedent?st($l(i.source.range)):a},e.prototype.writeResult=function(e,t,r){switch(t.kind){case Ke.Success:this.setCellValue(e,t.value,r);break;case Ke.Failure:this.context.globals.setCellFailure(e.range,t.reason,r)}this.context.globals.setDynamicPrecs(e.range,r)},e.prototype.setCellValue=function(e,t,r){var n=this.context.globals.config.mathpack.zero,a=Rf(t)?n:t;if(e.kind===Vt.Cell){if(bf(a)){var i=void 0===a.opers[0]?Ne:a.opers[0][0],o=Rf(i)?n:i;return this.context.globals.setCellValue(e.range,o,r)}return this.context.globals.setCellValue(e.range,a,r)}var u=e.range.range,c=Mf(u.rows,u.cols,a).opers,s=function(e){return Rf(e)?n:e},l=c.map((function(e){return e.map(s)}));return this.context.globals.setCellValues(e.range,l,r)},e}();function Np(e,t,r,n){return new Tp(e,t,r,n)}function Fp(e,t){for(var r=Lp(e),n=[],a=0;a<t.length;a+=1)n.push(Np(r.machineContext,Rp,t[a],!1));return new Up(r,n)}function _p(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:Or()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function Mp(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var t=Or()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:Math.min(e.endTimeMs,t)}}var wp={kind:Dl.Timeout};function Lp(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&Or()>=e}},machineContext:Dp(e)}}function Dp(e){return{globals:e,realReasonMap:hr(),resolver:$a(e),parser:Fs(e),analyzer:Ih(e),createCellEvaluationMachine:Np,createFormulaEvaluationMachine:Wv,createLambdaEvaluationMachine:Bv}}var Up=function(){function e(e,t){T("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((function(e){return new ff(e)})),this.results=[]}return e.prototype.evaluateAsync=function(e){var t=this;if(this.context.globals.interruptToken[0]===Gl.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var r=this.evaluate(Mp(e));return r instanceof Array?Promise.resolve(r):new Promise((function(r){return e.scheduleFunction((function(){return r(t.evaluateAsync(e))}))}))}catch(e){return Promise.reject(st(e))}},e.prototype.evaluateSync=function(e){var t=this,r=function(n){if(t.context.globals.interruptToken[0]===Gl.Stop||t.context.timer.doTimeout(e.endTimeMs))return t.generatePartialResults(),t.results;var a=t.evaluate(n);return a instanceof Array?a:tf((function(t){return r(void 0!==t?t:Mp(e))}))};return r(Mp(e))},e.prototype.evaluate=function(e){var t=this,r=function(){return t.context.timer.doTimeout(e)};try{for(;this.results.length<this.machineRuntimes.length;){var n=this.machineRuntimes[this.results.length].run(r);if(!n)return wp;this.pushResult(n)}return this.results}catch(e){var a="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+v(e);return O.ULS.assertTag(595980807,f.LogCategory.msoulscat_ES_EWAJS,!1,a)}},e.prototype.pushResult=function(e){return this.results.push(e),af},e.prototype.generatePartialResults=function(){for(;this.results.length<this.machineRuntimes.length;)this.results.push(st(ql))},e}(),xp=vi.sheetIndex,Pp=gi.OperKind,Gp=gi.rangeSeqOper,Vp=gi.ErrorType,Wp=gi.valueErrorOper,Bp=gi.nullErrorOper,jp=yi.OperatorId,Hp=Ai.operKind,Kp=Ai.isSheetIndex,qp=Ai.isDocumentLocEqual;function Jp(e,t){switch(e){case jp.Eq:return 0===t;case jp.Ne:return 0!==t;case jp.Lt:return t<0;case jp.Gt:return t>0;case jp.Le:return t<=0;case jp.Ge:return t>=0}}function Qp(e,t,r){return Jp(e,t-r)}function Xp(e,t,r,n){return Jp(t,e.stringCompareCI(r,n))}function Yp(e,t,r,n){return Jp(t,e.compare(r,n))}function zp(e,t,r){if(Kp(t.sheets))if(Kp(r.sheets))if(qp(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return xp(t.sheets.document,t.sheets.index);n="different sheet, range1 = "+C(t)+", range2 = "+C(r);Af(e,Vp.VALUE,n)}else{var n="different document, range1 = "+C(t)+", range2 = "+C(r);Af(e,Vp.VALUE,n)}else Af(e,Vp.VALUE,"3D reference, range2 = "+C(r));else Af(e,Vp.VALUE,"3D reference, range1 = "+C(t))}function Zp(e,t,r,n){void 0===n&&(n=!1);var a,i,o,u=e.config.mathpack;if(1===r.length){var c=r[0];switch(t){case jp.Percent:return u.percent(c);case jp.Neg:return u.neg(c);case jp.Pos:return c;default:var s="calc.runtime.applyOperator: "+("bad application of "+t+" to 1 argument");return O.ULS.assertTag(593372496,f.LogCategory.msoulscat_ES_EWAJS,!1,s)}}if(2===r.length){c=r[0];var l=r[1];switch(t){case jp.Add:var d=u.add(c,l);return n&&"number"==typeof d?u.checkAlmostCancellation(c,d):d;case jp.Sub:d=u.sub(c,l);return n&&"number"==typeof d?u.checkAlmostCancellation(c,d):d;case jp.Mul:return u.mul(c,l);case jp.Div:return u.div(c,l);case jp.Pow:return u.power(c,l);case jp.Concat:return(c+l).substring(0,32767);case jp.Eq:case jp.Ne:case jp.Lt:case jp.Le:case jp.Gt:case jp.Ge:return function(e,t,r,n){var a=e.config,i=a.localeInfo,o=a.mathpack,u=Hp(r),c=Hp(n);if(u!==c){if(u===Pp.Blank)switch(c){case Pp.Number:return Yp(o,t,o.zero,n);case Pp.String:return Xp(i,t,"",n);case Pp.Boolean:return Qp(t,!1,n)}if(c===Pp.Blank)switch(u){case Pp.Number:return Yp(o,t,r,o.zero);case Pp.String:return Xp(i,t,r,"");case Pp.Boolean:return Qp(t,r,!1)}return Jp(t,u-c)}switch(u){case Pp.Number:return Yp(o,t,r,n);case Pp.String:return Xp(i,t,r,n);case Pp.Boolean:return Qp(t,r,n);case Pp.Blank:return Jp(t,0);default:return!1}}(e,t,c,l);case jp.Range:return function(e,t){var r=zp("calc.runtime.applyRangeOp",e,t);if(null==r)return Wp;var n=[wf(Lf(e.ranges),Lf(t.ranges))];return Gp(r,n)}(c,l);case jp.Isect:return function(e,t){var r=zp("calc.runtime.applyIsectOp",e,t);if(null==r)return Wp;for(var n=[],a=0;a<e.ranges.length;a+=1)for(var i=0;i<t.ranges.length;i+=1){var o=Df(e.ranges[a],t.ranges[i]);null!=o&&n.push(o)}if(0===n.length){var u="empty intersection, range1 = "+C(e)+", range2 = "+C(t);return Af("calc.runtime.applyIsectOp",Vp.NULL,u),Bp}return Gp(r,n)}(c,l);case jp.Union:return null==(o=zp("calc.runtime.applyUnionOp",a=c,i=l))?Wp:Gp(o,a.ranges.concat(i.ranges));case jp.And:return c&&l;case jp.Or:return c||l;case jp.Xor:return c!==l;case jp.Min:return u.cond2(c,l)<=0?c:l;case jp.Max:return u.cond2(c,l)>=0?c:l;default:var h="calc.runtime.applyOperator: "+("bad application of "+t+" to 2 arguments");return O.ULS.assertTag(593372497,f.LogCategory.msoulscat_ES_EWAJS,!1,h)}}var p="calc.runtime.applyOperator: "+("bad application of "+t+" to "+r.length+" arguments");return O.ULS.assertTag(593372498,f.LogCategory.msoulscat_ES_EWAJS,!1,p)}function $p(e,t,r,n){if(r.kind===L.Abs)return r;var a=zr(e,r.index,n)-t;return a===r.index?r:J(L.Rel,a)}function ev(e,t,r){var n=$p(e.row,t.row,r.row,1<<20),a=$p(e.col,t.col,r.col,16384);return n===r.row&&a===r.col?r:re(n,a,r.label)}function tv(e,t,r){switch(r.kind){case w.Error:return r;case w.Single:return ev(e,t,r);case w.Range:var n=ev(e,t,r.ref1),a=ev(e,t,r.ref2);return n===r.ref1&&a===r.ref2?r:ne(n,a,r.label);case w.Row:var i=$p(e.row,t.row,r.row1,1<<20),o=$p(e.row,t.row,r.row2,1<<20);return i===r.row1&&o===r.row2?r:ae(i,o,r.label);case w.Col:var u=$p(e.col,t.col,r.col1,16384),c=$p(e.col,t.col,r.col2,16384);return u===r.col1&&c===r.col2?r:ie(u,c,r.label)}}function rv(e,t,r){if(Et(e,t))return r;var n,a,i=(n=r.node,a=tv.bind(void 0,e,t),function e(t){switch(t.kind){case U.Name:case U.Literal:case U.Bad:return t;case U.Array:return fe(r=t.nodes.map((function(t){return t.map(e)})),t.isClosed,t.label);case U.App:return de(t.head.kind===U.Operator?t.head:e(t.head),t.args.map(e),t.isClosed,t.label);case U.Paren:return(r=e(t.node))===t.node?t:pe(r,t.isClosed,t.label);case U.CellRef:var r;return(r=a(t.ref))===t.ref?t:me(r,t.qualifier,t.label)}}(n));return i===r.node?r:Object(P.a)(Object(P.a)({},r),{node:i})}var nv=vi.sheetGridCell,av=vi.sheetGridRange,iv=gi.OperKind,ov=gi.ErrorType,uv=gi.refErrorOper,cv=gi.valueErrorOper,sv=gi.arrayOper,lv=Ai.ResultKind,fv=Ai.isGridCell,dv=Ai.isSheetIndex,hv=Ai.getArgType;function pv(e,t){var r=t.map.getValue(e);if(void 0!==r)return mp(function(e,t){for(var r=[],n=Zl(r),a=t;r.push(a.cell),a.cycle=n,a!==e;a=a.previous);return r.reverse(),n}(r,t.current))}function vv(e,t,r){e.precedents.cells.push(t);var n=e.globals.getCellValue(t);if(n.kind===lv.Failure)return mp(n.reason);var a=n.value;if(a.kind===Pl.FinalValue)return a.oper;pv(a.anchor,e.visitedCells),r.push(a.anchor)}function mv(e,t,r,n){var a;if(e.precedents.cells.push(t),!n||Uf(t.range)<=16||!Rn(gn["OfficeVSO:3832568_CalcCGGetUsedRange"]))a=t;else{var i=e.globals.getUsedRange(t.sheet),o=void 0;lt(i)?o=null==i.value?void 0:i.value.range:i.reason.kind===xt.NotImplemented?o=t.range:mp(i.reason);var u=void 0===o?void 0:Df(t.range,er(0,0,o.row+o.rows,o.col+o.cols));if(void 0===u)return new Ol(t.range.rows,t.range.cols,0,0,[],Ge);a=av(t.sheet,u)}var c=e.globals.getCellValues(a);if(c.kind===lv.Failure)return mp(c.reason);var s=r.length,l=function(e,t,r,n,a){var i=[],o=n.length,u=0;b("calc.runtime.deference: readIntoArray2D number of rows",o===r.rows);for(var c=0;c<o;c+=1){i.push([]);var s=n[c].length;b("calc.runtime.deference: readIntoArray2D number of cols",s===r.cols),u=0===c?s:Cr(s,u);for(var l=0;l<s;l+=1){var f=n[c][l];Pl.FinalValue===f.kind?i[c][l]=f.oper:(pv(f.anchor,e.visitedCells),b("calc.runtime.deference: readIntoArray2D correct sheet",St(f.anchor.sheet,t.sheet)),a.push(f.anchor),i[c][l]=uv)}}return new Ol(t.range.rows,t.range.cols,o,u,i,Ge)}(e,t,a.range,c.value,r);return s===r.length?l:void 0}function gv(e,t,r){var n,a=mv(e,t,r,!1);if(null!=a)return sv(a.rows,a.cols,a.rows===a.denseRows&&a.cols===a.denseCols?a.denseElements:Rl((n=a).rows,n.cols,n.get.bind(n)))}function Cv(e,t,r,n){if(0!=(r&iv.Range))return t;if("object"!=typeof t||t.kind!==iv.Range)return t;var a=t.sheets;if(!dv(a))return Af("calc.runtime.dereference",ov.REF,"3D range, oper = "+C(t)),uv;if(1!==t.ranges.length)return Af("calc.runtime.dereference",ov.VALUE,"union range, oper = "+C(t)),cv;var i=t.ranges[0];if(0!=(r&yf)){if(fv(i))return vv(e,nv(a,i),n);if(e.locals.implicitIntersect&&!Rn(gn.CalcSupportDynamicArrays)&&!Rn(gn.CalcPreventSpillingHack)){var o=e.locals.originGridCell;if(!lt(o))return mp(o.reason);var u=function(e,t){var r=e.row,n=e.col,a=t.row,i=t.col,o=t.rows,u=t.cols,c=a<=r&&r<a+o,s=i<=n&&n<i+u;return c&&s?mf(r,n):c&&1===u?mf(r,i):s&&1===o?mf(a,n):void 0}(o.value,i);return null==u?(Af("calc.runtime.dereference",ov.VALUE,"empty intersection, oper = "+C(t)),cv):vv(e,nv(a,u),n)}return gv(e,av(a,i),n)}return 0!=(r&iv.Array)?gv(e,av(a,i),n):(Af("calc.runtime.dereference",ov.VALUE,"bad target type "+r),cv)}function Sv(e,t,r){var n=[],a=Cv(e,t,r,n);if(null==a){if(n.length>0)return mp(pp(n));var i="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+C(t);return O.ULS.assertTag(595980819,f.LogCategory.msoulscat_ES_EWAJS,!1,i)}return a}function Ev(e,t,r){for(var n=[],a=0;a<t.length;a+=1){var i=Cv(e,t[a],hv(r,a,t.length),n);null!=i&&(t[a]=i)}if(n.length>0)return mp(pp(n))}var yv=gi.OperKind,Ov=gi.valueErrorOper,Av=gi.arrayOper,kv=Ai.operKind,Rv=Ai.notImplemented;function bv(e,t){return 0!=(t&yv.Number)?e.zero:0!=(t&yv.String)?"":0==(t&yv.Boolean)&&Ov}function Iv(e,t,r){var n=function e(t,r,n){var a=t.config,i=a.localeInfo,o=a.mathpack;if("number"==typeof r){if(0!=(n&yv.Number))return r;if(0!=(n&yv.String)){return o.formatGeneral(i,r,20)}return 0!=(n&yv.Boolean)?0!==o.cond(r):0!=(n&yv.Array)?Av(1,1,[[r]]):Ov}if("string"==typeof r){if(0!=(n&yv.String))return r;if(0!=(n&yv.Number)){if(0===r.length)return Ov;var u=i.parseNumber(r);if(Dt(u))return u;throw new vp(Rv(["string -> number coercion: "+Mi(r)]))}return 0!=(n&yv.Boolean)?0===i.stringCompareCI(r,i.trueName)||0!==i.stringCompareCI(r,i.falseName)&&Ov:0!=(n&yv.Array)?Av(1,1,[[r]]):Ov}if("boolean"==typeof r)return 0!=(n&yv.Boolean)?r:0!=(n&yv.Number)?r?o.one:o.zero:0!=(n&yv.String)?r?i.trueName:i.falseName:0!=(n&yv.Array)?Av(1,1,[[r]]):Ov;if(0!=(n&r.kind))return r;switch(r.kind){case yv.Error:return r;case yv.Missing:return 0!=(n&yv.Blank)?gi.blankOper:bv(o,n);case yv.Blank:return bv(o,n);case yv.Rich:return e(t,r.getFallback(),n);default:return Ov}}(e,t,r);return kf(n)&&!kf(t)&&Af("calc.runtime.coerceOper",n.type,"kind = "+kv(t)),n}var Tv,Nv=function(){function e(e,t){void 0===t&&(t=Re),this._fields=e,this._fallback=t,this.kind=X.Rich}return e.prototype.getFallback=function(){return this._fallback},e.prototype.getField=function(e){return this._fields.getValue(e)},e}(),Fv=function(){function e(e,t,r,n){this.arity=e,this.kind=X.Rich,this.locals=t,this.env=r,this.term=n}return e.prototype.getFallback=function(){return Re},e.prototype.getField=function(e){},e}();function _v(e,t){return b("calc.runtime.lambdaCall",t.length===e.arity),{kind:Tv.LambdaCall,lambda:e,args:t}}function Mv(e){return"object"==typeof e&&e.kind===Tv.LambdaCall}!function(e){e.LambdaCall="LambdaCall"}(Tv||(Tv={}));var wv=function(){function e(e){this.kind=X.Rich,this.arity=e.arity,this.func=e.func}return e.prototype.getFallback=function(){return R("calc.runtime.UdfOper.getFallback")},e.prototype.getField=function(e){return R("calc.runtime.UdfOper.getField")},e}(),Lv=function(){function e(e,t,r,n,a,i){this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.usage=i;var o=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return r.special|=z.RefStyle,o},mathpack:e.globals.config.mathpack},this.mathpack=this.config.mathpack}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"calcingArray",{get:function(){return this.locals.calcingArray},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){var e=this.locals.originGridCell;return lt(e)?e.value:mp(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){var e=this.locals.originSheet;return lt(e)?e.value:mp(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){var e=this.locals.reflectionGridCell;return lt(e)?e.value:mp(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){var e=this.locals.reflectionSheet;return lt(e)?e.value:mp(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){var e=this.locals.followHyperlinks;return lt(e)?e.value:mp(e.reason)},enumerable:!0,configurable:!0}),e.prototype.applyFunction=function(e,t){var r=ot(e),n=t.some((function(e){return"object"==typeof e&&e.kind===X.Range}))?t.slice(0):t;return Ev(this,n,r),this.handleLambda(this.dispatchFunction(Mh(e),r,!1,n))},e.prototype.applyLambda=function(e,t){return this.handleLambda(_v(e,t))},e.prototype.handleEvaluationError=function(e){if(e instanceof vp)return gp(this.context,this.visitedCells,e.reason)},e.prototype.applyOperatorOrFunction=function(e,t,r){if(Lh(e))return Zp(this.globals,_h(e),t,r);var n=wh(e);if(n===xe._UDF){if(t[0]instanceof Fv){var a=t[0];return t.length-1!==a.arity?Ne:_v(a,t.slice(1))}if(t[0]instanceof wv){var i=t[0];if(t.length-1!==i.arity)return Re;var o=i.func(this,t.slice(1));if("object"==typeof o&&o.kind===X.Error){var u="UDF function return value";Af("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",o.type,u)}return o}return t.length>0&&kf(t[0])?t[0]:be}var c=this.globals.getFirstOrderFunc(n);if(c.kind===Ke.Failure)return mp(c.reason);var s=c.value;if(null==s){u="nonexistent worksheet function "+n;return Af("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",Se.NAME,u),Ie}var l=s(this,t);if("object"==typeof l&&l.kind===X.Error){u="worksheet function "+n+" return value";Af("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",l.type,u)}return l},e.prototype.handleLambda=function(e){return Mv(e)?hf(this.context.createLambdaEvaluationMachine(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e.lambda,e.args)):e},e.prototype.dispatchFunction=function(e,t,r,n){var a=this;if(!wt(t,n.length)){var i=JSON.stringify(t),o="calc.runtime.FunctionDispatcher.dispatchFunction: "+(m="bad application of "+JSON.stringify(e)+" to "+n.length+" arguments, ftype = "+i);return O.ULS.assertTag(593372499,f.LogCategory.msoulscat_ES_EWAJS,!1,o)}for(var u=n.length,c=Y.None,s=0;s<u;s+=1){var l=n[s],d=Lt(l);0==(d&Mt(t,s,u))&&(c|=d),Tf(l)&&0==(t.flags&Z.Allow3dRef)&&!dt(l.sheets)&&(c|=d)}if(c===Y.None)return this.applyOperatorOrFunction(e,n,r);if(0!=(c&X.Array)){return Vf(this,t,(function(r){return a.handleLambda(a.dispatchFunction(e,t,!1,r))}),n)}c&=~X.Array;var h=[];for(s=0;s<u;s+=1){var p=n[s];if(0!=(c&Lt(p))){var v=Mt(t,s,u);if(Lt(p=this.coerceOper(p,v))===X.Error&&0==(v&X.Error))return p;if(Tf(p)&&0==(t.flags&Z.Allow3dRef)&&!dt(p.sheets)){var m="3D reference, oper = "+C(p);return Af("calc.runtime.FunctionDispatcher.dispatchFunction",Se.VALUE,m),Re}}h[s]=p}return this.applyOperatorOrFunction(e,h,r)},e.prototype.getAvailableFormula=function(e){if(!Rn(gn.CalcWebWorker))return mp(wl(["getCellFormula on non-anchor"]));var t=this.globals.getCellFormula(e);return lt(t)?vr(t.value)?void 0:t.value:mp(t.reason)},e.prototype.getNameFormula=function(e,t){var r=this,n=Xa(dr,(function(e){}),(function(e,t){return e.kind===wa.NoOriginSheet?void 0:mp(e)}))(e,Ya((function(e){r.precedents.names.push(e);var t=r.globals.getNameFormula(e);return lt(t)?t.value:mp(t.reason)}))(this.context.resolver.resolveName(this.locals,e,t)));if(null!=n){var a=n[0],i=n[1];if(null!=i)return[a,i.node]}},e.prototype.getCellRef=function(e,t,r,n){var a={originGridCell:ct(r.range),originSheet:ct(r.sheet),wrapCellReferences:n};return Xa((function(e){return Ue(e.sheet,e.range)}),(function(e){}),(function(e,t){return e.kind===wa.NoOriginSheet?void 0:mp(e)}))(e,this.context.resolver.resolveCellRef(a,e,t))},e.prototype.dereferenceOper=function(e,t){return Sv(this,e,t)},e.prototype.dereferenceOpers=function(e,t){Ev(this,e,t)},e.prototype.getCellFormula=function(e){this.precedents.cells.push(e);var t=this.globals.getCellValue(e);return lt(t)?this.getAvailableFormula(e):mp(t.reason)},e.prototype.getSheetIndex=function(e,t){var r=this.globals.getSheetIndex(e,t);return lt(r)?(this.precedents.special|=z.OwnDocSheets,null==r.value?void 0:Zt(e,r.value)):mp(r.reason)},e.prototype.getSheetRangePosition=function(e){if(this.precedents.special|=z.OwnDocSheets,null==this.globals.getSheetRangeIndexes)return mp(wl(["getSheetRangeIndexes: position"]));var t=this.globals.getSheetRangeIndexes(e);return lt(t)?t.value.position:mp(t.reason)},e.prototype.getSheetRangeIndexes=function(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];if(this.precedents.special|=z.OwnDocSheets,null!=this.globals.getSheetRangeIndexes){var t=this.globals.getSheetRangeIndexes(e);return lt(t)?t.value.sheets:mp(t.reason)}if(void 0===e.index)return mp(wl(["getSheetRangeIndexes: all sheets"]));if("number"!=typeof e.index||"number"!=typeof e.index2)return mp(wl(["getSheetRangeIndexes: string ID"]));for(var r=Cr(e.index,e.index2),n=Sr(e.index,e.index2),a=[],i=r;i<=n;i+=1)a.push(i);return a},e.prototype.dereferenceAllOpersInner=function(e,t,r){var n=this;void 0===r&&(r=!1);for(var a=[],i=[],o=function(o){var c=e[o];if(!Tf(c))return i.push(c),"continue";for(var s=[],l=function(e){var r=mv(n,e,a,!0);void 0!==r&&s.push(t(r,e))},f=u.getSheetRangeIndexes(c.sheets),d=function(e){for(var t=Zt(c.sheets.document,f[e]),n=function(e){var n=c.ranges[e];if(!r)return l(ar(t,n)),"continue";if(null==u.globals.getHiddenRows)return{value:mp(wl(["getHiddenRows"]))};var a=u.globals.getHiddenRows(t,n.row,n.row+n.rows);if(!lt(a))return{value:mp(a.reason)};var i=a.value;if(0===i.length)return l(ar(t,n)),"continue";for(var o=function(e,r){var a=er(e,n.col,r-e,n.cols);l(ar(t,a))},s=0;s<i.length;s+=1){var f=i[s],d=f.start,h=f.end,p=0===s?n.row:i[s-1].end;b("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",p<=d&&d<h&&h<=n.row+n.rows),p!==d&&o(p,d);var v=er(d,n.col,h-d,n.cols);u.precedents.cells.push(ar(t,v))}var m=i[i.length-1].end;m!==n.row+n.rows&&o(m,n.row+n.rows)},a=0;a<c.ranges.length;a+=1){var i=n(a);if("object"==typeof i)return i}},h=0;h<f.length;h+=1){var p=d(h);if("object"==typeof p)return p}i.push({kind:Eh.RangeValues,arrays:s})},u=this,c=0;c<e.length;c+=1){var s=o(c);if("object"==typeof s)return s.value}return a.length>0?mp(pp(a)):i},e.prototype.dereferenceAllOpers=function(e,t){return this.dereferenceAllOpersInner(e,dr,t)},e.prototype.dereferenceAllOpersAndFormulae=function(e,t){var r=this;return this.dereferenceAllOpersInner(e,(function(e,t){return new kl(e.rows,e.cols,e.denseRows,e.denseCols,(function(n,a){var i=e.get(n,a),o=ir(t.sheet,tr(t.range.row+n,t.range.col+a));return[i,r.getAvailableFormula(o)]}),(function(){return[e.getSparse(),void 0]})).strict()}),t)},e.prototype.parseFormula=function(e,t,r,n){var a=this.context.parser.parseFormula(xi(r.lexicalKind,t,{refStyle:e}),n);if(!lt(a))return a;var i=this.context.analyzer.checkFormula(r,a.value,"indirect");return ht(i)?ct(i):st(Bl("ill-formed indirect formula","indirect"))},e.prototype.coerceOper=function(e,t){return Iv(this.globals,e,t)},e.prototype.getBinaryOperator=function(e){var t=this,r=it(e),n=[!1,!1];return function(a,i){n[0]=a,n[1]=i,Ev(t,n,r);var o=t.dispatchFunction(Fh(e),r,!1,n);return b("calc.runtime.FunctionDispatcher.getBinaryOperator",!Mv(o)&&!pf(o)),o}},e.prototype.getUnaryOperator=function(e){var t=this,r=it(e),n=[!1];return function(a){n[0]=a,Ev(t,n,r);var i=t.dispatchFunction(Fh(e),r,!1,n);return b("calc.runtime.FunctionDispatcher.getUnaryOperator",!Mv(i)&&!pf(i)),i}},e.prototype.isInFilterMode=function(e){if(null==this.globals.isInFilterMode)return mp(wl(["isInFilterMode"]));this.precedents.special|=z.InFilterMode;for(var t=0,r=e;t<r.length;t++){var n=r[t];if("object"==typeof n&&n.kind===X.Range)for(var a=0,i=this.getSheetRangeIndexes(n.sheets);a<i.length;a++){var o=i[a],u=this.globals.isInFilterMode(Zt(n.sheets.document,o));if(!lt(u))return mp(u.reason);if(u.value)return!0}}return!1},e.prototype.formatFormula=function(e,t){var r=ir(e.range.sheet,t),n=this.context.parser.formatFormula(Gi(Jt(e.source,e.range),r,{refStyle:this.config.refStyle}),rv(Ot(e.range.range),t,e.formula));return lt(n)?n.value:mp(wl(["prettyPrint failure"]))},e}(),Dv=[void 0,Ie],Uv=[void 0,be],xv=function(){function e(){}return Object.defineProperty(e.prototype,"value",{get:function(){return void 0===this._value?mp(wl(["LETREC cycle"])):this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),e}(),Pv=El.create((function(e,t){return e-t})),Gv={kind:Ah.CallLambda};var Vv=function(){function e(e,t,r,n,a,i,o,u,c,s,l){var f=this;this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.stackEnv=i,this.closureEnv=o,this.usage=u,this.target=c,this.isLambda=s,this.isRunning=!1,this.cellEvaluator=Xa((function(e){return Ue(e.sheet,e.range)}),(function(e){var t="error ref, qualifier = "+C(e.data.qualifier);return Af("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Se.REF,t),be}),(function(e,t){if(e.kind===wa.NoOriginSheet){var r="error ref, no sheet, qualifier = "+C(t.data.qualifier);return Af("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Se.REF,r),be}return mp(e)})),this.udfEvaluator=function(e,t,r){return Xa((function(e){if(e.length>1){return Af("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",Se.NAME,"UDF resolution, ambiguous name"),Ie}if(void 0===f.globals.getUserDefinedFunc)return mp(wl(["getUserDefinedFunc"]));var t=f.globals.getUserDefinedFunc(e[0]);return lt(t)?new wv(t.value):mp(t.reason)}),void 0!==r?function(){return r}:function(e){var t="UDF resolution, qualifier = "+C(e.data.qualifier);return Af("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",Se.NAME,t),Ie},(function(e,t){return mp(e)}))(e,t)},this.term=l,this.continuation=[]}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),e.prototype.next=function(){try{return this.doNext()}catch(e){if(e instanceof vp)return gp(this.context,this.visitedCells,e.reason);throw e}},e.prototype.receiveResult=function(e){return lt(e)?this.updateTermTransition(e.value):e},e.prototype.doNext=function(){if(Hh(this.term)){var e=this.continuation;if(0===e.length){var t=Sv(this,this.term,this.target),r=Iv(this.globals,t,this.target);return this.precedents.bound=ee.Exact,!Rn(gn.CalcPreventSpillingHack)||this.isLambda||this.locals.lexicalSource.kind!==Vt.Cell||!bf(r)||1===r.rows&&1===r.cols?ct(r):st(wl(["spilling"]))}var n=e[e.length-1];return this.applyContinuation(this.term,n)}return this.reduceFormula(this.term)},e.prototype.applyContinuation=function(e,t){var r=t.context;switch(r.kind){case Ah.App:var n=t.holeIndex,a=r.children.length;return(i=t.locals)[n]=e,n+1<a?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(i,i,r.data);case Ah.Conditional:var i;if(0===(n=t.holeIndex)){var o=wh(r.data.funName),u=o===xe.IF?X.Boolean:X.Number,c=Sv(this,e,u);if(bf(c))return t.locals=[c],this.nextHoleTransition(t,r.children[n+1]);if(Nf(c))return st(wl(["IF/CHOOSE with a rich value condition"]));if(c=Iv(this.globals,c,u),o===xe.IF&&"boolean"==typeof c)return this.popContextTransition(r.children[c?1:2]);if(o===xe.CHOOSE&&"number"==typeof c){var s=this.context.globals.config.mathpack.fix(c);if(s<1||s>r.children.length-1){var l="CHOOSE; out of bounds option = "+C(s);return Af("calc.runtime.FormulaEvaluationMachine.applyContinuation",Se.VALUE,l),this.popContextTransition(Re)}return this.popContextTransition(r.children[s])}return b("calc.runtime.FormulaEvaluationMachine.applyContinuation",kf(c)),this.popContextTransition(c)}return(i=t.locals)[n]=e,n+1<r.children.length?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(i,i,r.data);case Ah.Name:var f=this.popContextTransition(e),d=t.locals;return this.locals=d.locals,this.visitedNames=d.visitedNames,f;case Ah.Let:n=t.holeIndex;var h=r.children.length-1;if(n>=h){f=this.popContextTransition(e),d=t.locals;return this.stackEnv.length=d.stackEnvLen,f}if(r.data.rec){var p=this.stackEnv.length-h+n;this.stackEnv[p].value=e,this.stackEnv[p]=e}else this.stackEnv.push(e);return this.nextHoleTransition(t,r.children[n+1]);case Ah.Array:var v=Sv(this,e,Ef),m=r.data,g=m.rows,S=m.cols,E=t.holeIndex,y=E%S,O=S===y+1,A=(E-y)/S,R=t.locals;if(R[A][y]=Iv(this.globals,v,Ef),g===A+1&&O)return this.popContextTransition(Le(g,S,R));var I=O?A+1:A,T=O?0:y+1;return this.nextHoleTransition(t,r.children[I][T]);case Ah.CallLambda:f=this.popContextTransition(e),d=t.locals;return this.locals=d.locals,this.stackEnv.length=d.stackEnvLen,this.closureEnv=d.closureEnv,this.usage.lambdaDepth-=1,f;default:return k("calc.runtime.FormulaEvaluationMachine.applyContinuation",r)}},e.prototype.reduceFormula=function(e){var t=this;switch(e.kind){case Ah.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case Ah.App:var r=e.data.funName;if(!Lh(r)){var n=wh(r);if(n!==xe._UDF){var a=this.globals.getFirstOrderFunc(n);if(a.kind===Ke.Failure)return mp(a.reason)}}return 0===e.children.length?Mv(i=new Lv(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(r,e.data.funType,e.data.isFormulaRoot,[]))?this.evaluateLambdaTransition(void 0,i):pf(i)?this.evaluateMachineTransition(void 0,i):this.updateTermTransition(i):this.pushContextTransition(e,e.children[0],[]);case Ah.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case Ah.Let:return this.evaluateLetTransition(e);case Ah.Name:var i;if(void 0!==(i=this.evalNameTerm(e))[0]){var o=i[0],u=i[1],c=i[2],s=this.pushContextTransition(e,u,{locals:this.locals,visitedNames:this.visitedNames});return this.locals=function(e,t){var r,n=e.name.scope;if(void 0!==n.index)r=ct(n);else{var a=t.originSheet;if(!lt(a))return mp(a.reason);r=Ct(a.value.document,n.document)?a:ct(n)}var i=t.originGridCell;return Yl(e,i,r,t.calcingArray,i,r,!1,!0,ct(!1))}(Qt(o),this.locals),this.visitedNames=c,s}var l=i[1];return this.updateTermTransition(l);case Ah.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case Ah.ReadStack:return b("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(f=this.stackEnv[this.stackEnv.length-1-e.data])),this.updateTermTransition(f instanceof xv?f.value:f);case Ah.ReadClosure:var f;return b("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(h=this.closureEnv.getValue(e.data[0]))),b("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(f=h[e.data[1]])),f instanceof xv&&(f=f.value,h[e.data[1]]=f),this.updateTermTransition(f);case Ah.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case Ah.Fun:var d=e.data.closedIdents.map((function(e){var r=t.stackEnv[t.stackEnv.length-1-e];return b("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==r),r})),h=this.closureEnv.setValue(e.data.closureId,d);return this.updateTermTransition(new Fv(e.data.arity,this.locals,h,e.children));default:return k("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},e.prototype.dispatchFunction=function(e,t,r){var n=r.funName,a=r.funType,i=r.isFormulaRoot;Ev(this,t,a);var o=new Lv(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,a,i,t);return Mv(o)?this.evaluateLambdaTransition(e,o):pf(o)?this.evaluateMachineTransition(e,o):this.popContextTransition(o)},e.prototype.pushContextTransition=function(e,t,r){var n=function(e,t){return{context:e,holeIndex:0,locals:t}}(e,r);return this.continuation[this.continuation.length]=n,this.updateTermTransition(t)},e.prototype.popContextTransition=function(e){return this.continuation.pop(),this.updateTermTransition(e)},e.prototype.evaluateMachineTransition=function(e,t){var r=t.machine;return void 0!==e&&this.continuation.pop(),of(r,this)},e.prototype.evaluateLambdaTransition=function(e,t){var r,n,a,i,o,u=t.lambda,c=t.args,s=this.continuation[this.continuation.length-1-(void 0!==e?1:0)],l=(null===(n=s)||void 0===n?void 0:n.context.kind)===Ah.CallLambda?s:void 0;return this.usage.lambdaCalls[0]+1>(null!=(a=this.globals.limits.maxLambdaCalls)?a:1/0)?mp(ef(Vl.LambdaCalls)):void 0===l&&this.usage.lambdaDepth+1>(null!=(i=this.globals.limits.maxLambdaDepth)?i:1/0)?mp(ef(Vl.LambdaDepth)):(void 0!==e&&this.continuation.pop(),void 0!==l?(o=this.updateTermTransition(u.term),this.stackEnv.length=l.locals.stackEnvLen):(o=this.pushContextTransition(Gv,u.term,{locals:this.locals,stackEnvLen:this.stackEnv.length,closureEnv:this.closureEnv}),this.usage.lambdaDepth+=1),(r=this.stackEnv).push.apply(r,c),this.closureEnv=u.env,this.locals=function(e,t){return Yl(e.locals.lexicalSource,e.locals.originGridCell,e.locals.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.locals.wrapCellReferences,ct(!1))}(u,this.locals),this.usage.lambdaCalls[0]+=1,o)},e.prototype.evaluateLetTransition=function(e){var t=this.pushContextTransition(e,e.children[0],{stackEnvLen:this.stackEnv.length});if(e.data.rec)for(var r=e.children.length-1,n=0;n<r;n+=1)this.stackEnv.push(new xv);return t},e.prototype.nextHoleTransition=function(e,t){return e.holeIndex+=1,this.updateTermTransition(t)},e.prototype.updateTermTransition=function(e){return this.term=e,af},e.prototype.getNameFormulaAsTerm=function(e){this.precedents.names.push(e);var t=this.globals.getNameFormula(e);if(t.kind===Ke.Failure)return mp(t.reason);var r=t.value;return null!=r?fp("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",r):void 0},e.prototype.checkForNameCycle=function(e){var t,r=this.visitedNames,n=r.map.getValue(e);return void 0!==n?mp(function(e,t){for(var r=[],n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),zl(r)}(n,r.current)):this.visitedNames.map.getCount()+1>(null!=(t=this.globals.limits.maxNameChain)?t:1/0)?mp(ef(Vl.NameChain)):function(e,t){var r={name:t,previous:e.current};return bp(r,e.map.setValue(t,r))}(this.visitedNames,e)},e.prototype.nameEvaluator=function(e,t,r){var n=this;return Xa((function(e){var t=e[0];return[t,e[1],n.checkForNameCycle(t)]}),void 0!==r?function(){return[void 0,r]}:function(e){var t="name resolution; qualifier = "+C(e.data.qualifier);return Af("calc.runtime.FormulaEvaluationMachine.evalName",Se.NAME,t),Dv},(function(e,t){if(e.kind===wa.NoOriginSheet){var r="name resolution, no sheet; qualifier = "+C(t.data.qualifier);return Af("calc.runtime.FormulaEvaluationMachine.evalName",Se.REF,r),Uv}return mp(e)}))(e,Ya((function(e){return n.getNameFormulaAsTerm(e)}))(t))},e.prototype.evalNameTerm=function(e){var t=this.context.resolver.resolveName(this.locals,e.data.qualifier,e.data.name);return this.nameEvaluator(e,t,e.children)},e.prototype.evalCellRefTerm=function(e){var t=this.context.resolver.resolveCellRef(this.locals,e.data.qualifier,e.data.ref);return this.cellEvaluator(e,t)},e.prototype.evalUdfTerm=function(e){var t=this.context.resolver.resolveUserDefinedFunc(this.locals,e.data.qualifier,e.data.name);return this.udfEvaluator(e,t,e.children)},e}();function Wv(e,t,r,n,a){return new Vv(e,t,r,n,Ip,[],Pv,{lambdaCalls:[0],lambdaDepth:0},Of,!1,fp("calc.runtime.createFormulaEvaluationMachine",a))}function Bv(e,t,r,n,a,i,o,u){return b("calc.runtime.createLambdaEvaluationMachine",u.length===o.arity),new Vv(e,t,r,n,a,Object(P.f)(u),o.env,i,Y.All,!0,o.term)}function jv(e,t,r){var n,a=Lp(e),i=Cp(),o=Wv(a.machineContext,t,i,Rp,r),u=new Up(a,[o]),c=_p(null!=(n=t.schedulerConfig)?n:e.schedulerInfo);return function e(t){return Array.isArray(t)?t[0]:tf((function(r){return e(t.resume(r))}))}(u.evaluateSync(c))}function Hv(e){return{evalFormula:function(t,r){return jv(e,t,r)},evalCells:function(t){return function(e,t){if(0===t.length)return[];var r=Fp(e,t),n=_p(e.schedulerInfo);return r.evaluateSync(n)}(e,t)},evalCellsAsync:function(t){return function(e,t){if(0===t.length)return Promise.resolve([]);var r=Fp(e,t),n=_p(e.schedulerInfo);return r.evaluateAsync(n)}(e,t)}}}var Kv,qv=Si.formulaSpan,Jv=Si.RefStyle,Qv=vi.LexicalKind,Xv=Ai.getSubExpressionFromPosition,Yv=Ai.isSuccess,zv=Ai.failure,Zv=Ai.ResultKind,$v=Ai.isWellFormed,em=qv(0,0,"","");function tm(e){var t,r,n,a,i=e.config,o=Ui(i),u=Ys(i),c=Ul(i),s=Ih(u),l=hp(c),f=Hv(e),d=Fs(o).parseFormula,h=!1,p=void 0,v=-1,m=!1;function g(){h=!1,n=void 0,v=-1,p=void 0,a=void 0,m=!1}function C(){if(!h){if(h=!0,void 0===t||void 0===r)return;var e=d(Jv.A1,t,Qv.Range,r);Yv(e)&&(n=e.value)}}function S(e){if(C(),void 0!==n&&e!==v){var t=p;p=void 0,e>=0&&e<r.length&&(p=Xv(n,e)),p!==t&&(a=void 0,m=!1),v=e}}function E(){if(void 0!==p&&!m&&void 0!==n){var e=t,r=s.checkFormula(zs(Qv.Cell,e.range),{node:p,spans:n.spans});if($v(r)){var i=l.compileFormula(xl(Qv.Cell,e.range),r);if(Yv(i)){var o=f.evalFormula(Sp(Kt(e)),i.value);o.kind!==Zv.Paused&&(a=o)}}m=!0}}return{setCellAndFormula:function(e,n){t=e,r=n,g()},getSubExpressionSpanFromFormulaCharacterIndex:function(e){if(S(e),void 0!==n&&void 0!==p){var t=n.spans[p.label];if(void 0!==t)return t}return em},evaluateSubExpressionFromFormulaCharacterIndex:function(e){return S(e),E(),void 0!==a?Promise.resolve(a):Promise.resolve(zv(ft("formula Inspector Service.evaluateSubExpressionFromFormulaCharacterIndex : No valid formula to evaluate.")))},evaluateSubExpression:function(){return C(),void 0!==n&&(p=n.node,a=void 0,m=!1),E(),void 0!==a?Promise.resolve(a):Promise.resolve(zv(ft("formula Inspector Service.evaluateSubExpression : No valid formula to evaluate.")))}}}!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(Kv||(Kv={}));var rm=function(){function e(e,t,r){void 0===r&&(r=!1),this.localeInfo=e,this.source=t,this.bytecode=[],this.blocks=[];for(var n="",a=0;a<t.length;a+=1){var i=t.charCodeAt(a);if(126===i&&a+1<t.length){var o=t.charCodeAt(a+1);if(63===o||42===o){n+=t.charAt(a+1),a+=1;continue}}63!==i&&42!==i?n+=t.charAt(a):(this.pushBlock(n),n="",this.pushMeta(i))}this.pushBlock(n),r&&this.pushMeta(42)}return e.prototype.pushBlock=function(e){if(""!==e){var t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(var r=1;r<e.length;r+=1)this.bytecode.push(Kv.OP_DOT)}},e.prototype.pushMeta=function(e){63===e?this.bytecode.push(Kv.OP_DOT):this.bytecode.push(Kv.OP_DOTSTAR)},e.prototype.test=function(e){var t=Object.create(null);this.addState(t,0);for(var r=0;r<e.length;r+=1){var n=Object.keys(t);if(t=Object.create(null),0===n.length)return!1;for(var a=0;a<n.length;a+=1){var i=Number(n[a]);if(i!==this.bytecode.length){var o=this.bytecode[i];switch(o){case Kv.OP_DOT:this.addState(t,i+1);break;case Kv.OP_DOTSTAR:this.addState(t,i);break;default:var u=this.blocks[o];r+u.length<=e.length&&0===this.localeInfo.stringCompareCI(u,e.substring(r,r+u.length))&&this.addState(t,i+1)}}}}return this.bytecode.length in t},e.prototype.addState=function(e,t){e[t]=!0;var r=this.bytecode;t<r.length&&r[t]===Kv.OP_DOTSTAR&&(e[t+1]=!0)},e}(),nm={"=":Ve.Eq,"<":Ve.Lt,">":Ve.Gt},am={"<>":Ve.Ne,"<=":Ve.Le,">=":Ve.Ge};function im(e,t){(function(e,t){for(var r=0;r<t.length;r+=1)if(e.isNumeral(t.charCodeAt(r)))return!0;return!1})(e,t)&&mp(Pt(["potential string -> number coercion: "+Mi(t)]))}function om(e,t){if("string"!=typeof t)return t;var r,n,a=(r=t).length>=2&&void 0!==(n=am[r.substring(0,2)])?[n,r.substring(2)]:r.length>=1&&void 0!==(n=nm[r.substring(0,1)])?[n,r.substring(1)]:[void 0,r];return{kind:"FilterExpression",operator:a[0],operand:function(e,t){if(0===e.stringCompareCI(t,e.trueName))return!0;if(0===e.stringCompareCI(t,e.falseName))return!1;for(var r=1;r<e.errorNames.length;r+=1){var n=e.errorNames[r];if(void 0!==n&&0===e.stringCompareCI(n,t))return Oe(r)}var a=e.parseNumber(t);return Dt(a)?a:(im(e,t),t)}(e,a[1])}}function um(e,t,r,n){var a=function(e,t){var r="object"==typeof t&&"FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:Ve.Eq,operand:t},n=e.config,a=n.mathpack,i=n.localeInfo;if(r.operator===Ve.Ne&&""===r.operand)return function(e){return!Rf(e)};if(r.operator===Ve.Eq&&""===r.operand)return Rf;if(void 0!==r.operator&&""===r.operand)return function(e){return!1};if(void 0===r.operator&&""===r.operand)return function(e){return Rf(e)||""===e};var o,u,c=void 0===r.operator?Ve.Eq:r.operator;switch(typeof r.operand){case"number":return o=c,u=r.operand,function(e){var t=Nf(e)?e.getFallback():e;if("number"==typeof t)return Yp(a,o,t,u);if("string"==typeof t&&o===Ve.Eq){var r=i.parseNumber(t);return Dt(r)?Yp(a,o,r,u):(im(i,t),!1)}return o===Ve.Ne};case"boolean":return function(e,t){return function(r){var n=Nf(r)?r.getFallback():r;return"boolean"==typeof n?Qp(e,n,t):e===Ve.Ne}}(c,r.operand);case"string":return function(e,t){switch(e){case Ve.Eq:case Ve.Ne:var r=new rm(i,t);return function(t){var n=Nf(t)?t.getFallback():t;return"string"!=typeof n?e===Ve.Ne:r.test(n)===(e===Ve.Eq)};case Ve.Lt:case Ve.Gt:case Ve.Le:case Ve.Ge:return function(r){var n=Nf(r)?r.getFallback():r;return"string"==typeof n&&Xp(i,e,n,t)}}}(c,r.operand);case"object":return kf(r.operand)?function(e,t){return function(r){var n=Nf(r)?r.getFallback():r;return kf(n)?Jp(e,n.type-t.type):e===Ve.Ne}}(c,r.operand):k("calc.funcs.criteria.compileCriteria",r.operand)}return k("calc.funcs.criteria.compileCriteria",r.operand)}(e,om(e.config.localeInfo,r)),i=t,o=void 0===n?i:n;return new kl(o.rows,o.cols,Sr(i.denseRows,o.denseRows),Sr(i.denseCols,o.denseCols),(function(e,t){var r=i.get(e,t);return a(r)?o.get(e,t):void 0}),(function(){var e=i.getSparse();return a(e)?o.getSparse():void 0}))}function cm(e,t,r,n,a){var i=function(n,i,u,c){if("object"==typeof i&&i.kind===X.Array){for(var s=new yl(i.rows,i.cols,i.opers),l=n,f=0;f<u;f+=1)l=o(l,s);return l}var d=(c&&void 0!==a?a:r)(e,i);return null==d?n:t(n,d,u)};function o(e,t){for(var r=e,n=0;n<t.rows;n+=1)for(var a=0;a<t.cols;a+=1){var o=t.get(n,a);void 0!==o&&(r=i(r,o,1,!0))}return r}function u(e,t){for(var r=e,n=t.getSparse(),a=t.cols-t.denseCols,o=0;o<t.denseRows;o+=1){for(var u=0;u<t.denseCols;u+=1){var c=t.get(o,u);void 0!==c&&(r=i(r,c,1,!1))}a>0&&void 0!==n&&(r=i(r,n,a,!1))}var s=(t.rows-t.denseRows)*t.cols;return s>0&&void 0!==n&&(r=i(r,n,s,!1)),r}return n.reduce((function(e,t){return"object"==typeof t&&t.kind===Eh.RangeValues?t.arrays.reduce(u,e):i(e,t,1,!1)}),void 0)}function sm(e){return function(t,r){return e(t)(r[0])}}function lm(e){return function(t,r){return e(t)(r[0],r[1])}}var fm=function(e){return"number"==typeof e?e:R("calc.funcs.assertNumber")},dm=function(e){return"string"==typeof e?e:R("calc.funcs.assertString")};function hm(e,t){var r=xf(e,t,!1),n=Nf(r)?r.getFallback():r;switch(typeof n){case"number":return n;case"boolean":return Re;case"string":var a=e.coerceOper(n,X.Number);return"number"==typeof a?a:Re;case"object":switch(n.kind){case X.Error:return n;case X.Array:return Re;case X.Missing:return Ne;case X.Blank:return e.mathpack.zero}}return k("calc.funcs.chkNumOper",n)}function pm(e,t){var r=Nf(t)?t.getFallback():t;switch(typeof r){case"number":return r;case"object":break;default:return}switch(r.kind){case X.Error:return r;case X.Missing:case X.Blank:return;default:return k("calc.funcs.arithmeticOperationCoerce",r)}}function vm(e,t){var r=Nf(t)?t.getFallback():t;switch(typeof r){case"boolean":return r?e.mathpack.one:e.mathpack.zero;case"number":return r;case"string":return e.mathpack.zero;case"object":break;default:return k("calc.funcs.arithmeticAOperationCoerce",r)}switch(r.kind){case X.Error:return r;case X.Missing:case X.Blank:return;default:return k("calc.funcs.arithmeticAOperationCoerce",r)}}function mm(e){return function(t,r,n){if(void 0!==t&&kf(t))return t;if(b("calc.funcs.numberReducer",void 0===t||"number"==typeof t),kf(r))return r;var a,i;b("calc.funcs.numberReducer","number"==typeof r),void 0===t?(a=r,i=n-1):(a=t,i=n);for(var o=0;o<i;o+=1){var u=e(a,r);if(kf(u))return u;a=u}return a}}function gm(e){return function(t,r,n){return e.count+=n,r}}function Cm(e,t,r){if("number"!=typeof r)return r;var n=function(e){for(var t=e.length-1;t>=0;t-=1){var r=e[t];if("object"==typeof r&&r.kind===Eh.RangeValues)for(var n=r.arrays.length-1;n>=0;n-=1){var a=r.arrays[n];if(a.rows>a.denseRows||a.cols>a.denseCols)if("number"==typeof(u=a.getSparse()))return u;for(var i=a.denseRows-1;i>=0;i-=1)for(var o=a.denseCols-1;o>=0;o-=1){var u;if("number"==typeof(u=a.get(i,o)))return u}}}}(t);return"number"!=typeof n?r:e.mathpack.checkAlmostCancellation(n,r)}function Sm(e,t,r){var n=cm(t,mm(t.mathpack.add),pm,r);return null==n?t.mathpack.zero:(e&&(n=Cm(t,r,n)),n)}var Em=Sm.bind(void 0,!1),ym=Sm.bind(void 0,!0);function Om(e,t){var r=e.dereferenceAllOpers(t),n=wg(pm),a=cm(e,mm(e.mathpack.add),n,r);return null==a?e.mathpack.zero:a}function Am(e){return e.kind===X.Range&&1!==e.ranges.length}function km(e,t,r){if(Am(t))return st(Re);if(void 0===r){var n=e.dereferenceAllOpers([t])[0];return ct({values:n,valuesToFilter:n})}if(Am(r))return st(Re);var a=function(e,t){var r=e.ranges[0],n=t.ranges[0],a=Cr(r.cols,16384-n.col),i=Cr(r.rows,(1<<20)-n.row),o=er(r.row,r.col,i,a),u=Ue(e.sheets,o),c=er(n.row,n.col,i,a),s=Ue(t.sheets,c);return{actualEvalRange:u,actualFilterRange:s}}(t,r),i=a.actualEvalRange,o=a.actualFilterRange,u=i.ranges[0],c=o.ranges[0],s=e.dereferenceAllOpers([i])[0];return u.col===c.col&&u.row===c.row?ct({values:s,valuesToFilter:s}):ct({values:s,valuesToFilter:e.dereferenceAllOpers([o])[0]})}function Rm(e,t){var r=t,n=r[0],a=r[1],i=km(e,n,r[2]);if(!lt(i))return i.reason;var o=i.value,u=o.values,c=o.valuesToFilter,s=[Th([um(e,u.arrays[0],a,c.arrays[0])])];return Em(e,s)}function bm(e,t,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var a,i,o=t[0];if(Am(o))return st(Re);if(r){var u=t[1],c=e.dereferenceAllOpers([o])[0];a=um(e,c.arrays[0],u),i=2}else{a=e.dereferenceAllOpers([o])[0].arrays[0],i=1}for(var s=i;s<t.length;s+=2){var l=t[s],f=t[s+1];if(Am(l))return st(Re);if(l.ranges[0].cols!==o.ranges[0].cols||l.ranges[0].rows!==o.ranges[0].rows)return st(Re);c=e.dereferenceAllOpers([l])[0];a=um(e,c.arrays[0],f,a)}return n&&(a=a.strict()),ct(Th([a]))}function Im(e,t){if(3===t.length)return Rm(e,[t[1],t[2],t[0]]);var r=bm(e,t);return lt(r)?Em(e,[r.value]):r.reason}function Tm(e,t){var r=cm(e,mm(e.mathpack.mul),pm,t);return null==r?e.mathpack.zero:r}function Nm(e,t,r,n,a,i){var o=cm(a,mm(a.mathpack.add),e,i,t);if(null==o)return n;if(r&&(o=Cm(a,i,o)),kf(o))return o;var u={count:0},c=cm(a,gm(u),e,i,t);b("calc.funcs.averageCoerceInner","number"==typeof o&&"number"==typeof c&&u.count>0);var s=a.mathpack.div(o,a.mathpack.fromNumber(u.count));return kf(s)?s:[s,u.count]}function Fm(e,t,r,n,a){var i=Nm(e,t,r,ke,n,a);return Array.isArray(i)?i[0]:i}var _m=Fm.bind(void 0,pm,void 0,!1),Mm=Fm.bind(void 0,pm,void 0,!0),wm=Fm.bind(void 0,vm,(function(e,t){var r=Nf(t)?t.getFallback():t;return"string"==typeof r?e.mathpack.zero:pm(0,r)}),!0);function Lm(e,t){var r=t,n=r[0],a=r[1],i=km(e,n,r[2]);if(!lt(i))return i.reason;var o=i.value,u=o.values,c=o.valuesToFilter,s=[Th([um(e,u.arrays[0],a,c.arrays[0]).strict()])];return _m(e,s)}function Dm(e,t){if(3===t.length)return Lm(e,[t[1],t[2],t[0]]);var r=bm(e,t,void 0,!0);return lt(r)?_m(e,[r.value]):r.reason}function Um(e,t){var r=e.dereferenceAllOpers(t);return wm(e,r)}function xm(e,t,r,n,a){for(var i=void 0,o=0,u="",c=function(e,t){return e.coerceOper(t,X.String)},s=function(e,n,a){if(void 0!==e&&kf(e))return e;for(var c=0;c<a;c+=1){if(void 0!==i&&t.length>0&&(!r||i.length>0)){var s=t[o];if(o=(o+1)%t.length,u.length+s.length>32767)return Re;u+=s}if(kf(n))return n;if("string"!=typeof n)return R("calc.funcs.concatInner: expected string in reducer");if(u.length+n.length>32767)return Re;if(u+=n,i=n,""===n&&(0===t.length||r))break}return n},l=0;l<a.length;l+=1){var f=n[l];if(Tf(f)&&f.ranges.length>1)return Re;var d=cm(e,s,c,a.slice(l,l+1));if(void 0!==d&&kf(d))return d;b("calc.funcs.concatInner: expected string from reduce","string"==typeof d)}if(r&&""===i&&t.length>0&&u.length>0){var h=t[(o+t.length-1)%t.length];u=u.substring(0,u.length-h.length)}return u}function Pm(e,t){var r=t,n=e.dereferenceAllOpers(t);return xm(e,[],!0,r,n)}function Gm(e,t){var r=t,n=r[0],a=r[1],i=r.slice(2),o=[];if(!If(n)){if(Tf(n)&&n.ranges.length>1)return Re;var u=cm(e,pg(o,dm),(function(e,t){return e.coerceOper(t,X.String)}),e.dereferenceAllOpers([n]));if(void 0!==u&&kf(u))return u;b("calc.funcs.textjoin: expected string from reduce","string"==typeof u)}return xm(e,o,If(a)||a,i,e.dereferenceAllOpers(i))}function Vm(e,t,r){var n={count:0};return cm(t,gm(n),e,r),t.mathpack.fromNumber(n.count)}var Wm=Vm.bind(void 0,(function(e,t){var r=Nf(t)?t.getFallback():t;return"number"==typeof r?r:void 0}));function Bm(e,t){var r=e.dereferenceAllOpers(t);return Wm(e,r)}var jm=Vm.bind(void 0,(function(e,t){var r=Nf(t)?t.getFallback():t;return Rf(r)||""===r?r:void 0}));var Hm=Vm.bind(void 0,(function(e,t){var r=Nf(t)?t.getFallback():t;return"object"!=typeof r||r.kind===X.Error?r:void 0}));function Km(e,t){var r=e.dereferenceAllOpers(t);return Hm(e,r)}var qm=Vm.bind(void 0,(function(e,t){return t}));function Jm(e,t){var r=t,n=r[0],a=r[1];if(Am(n))return Re;var i=e.dereferenceAllOpers([n])[0],o=[Th([um(e,i.arrays[0],a)])];return qm(e,o)}function Qm(e,t){if(2===t.length)return Jm(e,t);var r=bm(e,t,!0);return lt(r)?qm(e,[r.value]):r.reason}var Xm=function(e,t,r){return e.mathpack.cond2(t,r)>0},Ym=function(e,t,r){return e.mathpack.cond2(t,r)<0};function zm(e,t,r,n,a){var i=cm(n,(function(t,r,a){return void 0===t?r:kf(t)?t:(b("calc.funcs.minMaxCoerceInner","number"==typeof t),kf(r)?r:(b("calc.funcs.minMaxCoerceInner","number"==typeof r),e(n,t,r)?t:r))}),t,a,r);return null==i?n.mathpack.zero:i}var Zm=zm.bind(void 0,Xm,pm,void 0),$m=zm.bind(void 0,Ym,pm,void 0),eg=zm.bind(void 0,Xm,vm,pm),tg=zm.bind(void 0,Ym,vm,pm);function rg(e,t){var r=e.dereferenceAllOpers(t);return eg(e,r)}function ng(e,t){var r=e.dereferenceAllOpers(t);return tg(e,r)}function ag(e,t){var r=bm(e,t);return lt(r)?Zm(e,[r.value]):r.reason}function ig(e,t){var r=bm(e,t);return lt(r)?$m(e,[r.value]):r.reason}function og(e,t){var r=Nf(t)?t.getFallback():t;switch(typeof r){case"boolean":return r;case"number":return 0!==e.mathpack.cond(r);case"object":break;default:return}switch(r.kind){case X.Error:return r;case X.Missing:case X.Blank:return;default:return k("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function ug(e,t,r){var n=cm(t,(function(t,r,n){return void 0!==t&&kf(t)?t:kf(r)?r:(b("calc.funcs.booleanInner",(void 0===t||"boolean"==typeof t)&&"boolean"==typeof r),e(t,r,n))}),og,r);return null==n?Re:n}var cg=ug.bind(void 0,(function(e,t){return!1!==e&&t})),sg=ug.bind(void 0,(function(e,t){return!0===e||t})),lg=ug.bind(void 0,(function(e,t,r){return t?((!0===e?1:0)+r)%2==1:!0===e}));function fg(e,t){var r=e.dereferenceAllOpers(t);return cg(e,r)}function dg(e,t){var r=e.dereferenceAllOpers(t);return sg(e,r)}function hg(e,t){var r=e.dereferenceAllOpers(t);return lg(e,r)}function pg(e,t){return function(r,n,a){if(void 0!==r&&kf(r))return r;if(!kf(n))for(var i=t(n),o=0;o<a;o+=1)e.push(i);return n}}function vg(e,t,r,n){var a=[],i=cm(t,pg(a,fm),pm,[r]);if(null==i)return Te;if(kf(i))return i;var o=t.mathpack;if(o.cond2(n,o.one)<0)return Te;if(o.cond2(n,o.fromNumber(a.length))>0)return Te;var u=a.sort(o.cond2);if(e){var c=fm(o.add(fm(o.sub(o.fromNumber(a.length),n)),o.one));return u[o.lfix(c)-1]}return u[o.lfix(n)-1]}var mg=vg.bind(void 0,!0),gg=vg.bind(void 0,!1);function Cg(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return mg(e,n,a)}function Sg(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return gg(e,n,a)}function Eg(e,t,r,n){var a=e.mathpack,i=[],o=cm(e,pg(i,fm),pm,t);if(null==o)return Te;if(kf(o))return o;if(kf(r))return r;if(a.cond(r)<0)return Te;if(a.cond2(r,a.one)>0)return Te;var u=i.sort(a.cond2),c=fm(a.sub(a.fromNumber(u.length),a.one)),s=fm(a.add(a.fromNumber(u.length),a.one)),l=fm(n?a.mul(c,r):a.sub(fm(a.mul(s,r)),a.one));if(a.cond(l)<0||a.cond2(l,c)>0)return Te;var f=a.lfix(l),d=fm(a.sub(l,a.fromNumber(f)));if(0===a.cond(d))return u[f];var h=a.sub(u[f+1],u[f]);return kf(h)?h:a.add(u[f],fm(a.mul(h,d)))}var yg=function(e,t,r){return Eg(e,[t],r,!0)};function Og(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return yg(e,n,a)}var Ag=function(e,t,r){return Eg(e,[t],r,!1)};function kg(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return Ag(e,n,a)}function Rg(e,t){var r=e.mathpack;if(r.cond(t)<0)return Te;if(r.cond2(t,r.fromNumber(5))>=0)return Te;var n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}var bg=function(e,t,r){return Eg(e,[t],Rg(e,r),!0)};function Ig(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return bg(e,n,a)}var Tg=function(e,t,r){return Eg(e,[t],Rg(e,r),!1)};function Ng(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return Tg(e,n,a)}function Fg(e,t){return Eg(e,t,e.mathpack.fromNumber(.5),!0)}function _g(e,t){var r=e.dereferenceAllOpers(t);return Fg(e,r)}function Mg(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1],i=[],o=cm(e,pg(i,fm),pm,[n]);if(null==o)return Te;if(kf(o))return o;var u=e.mathpack;if(u.cond(a)<0)return Te;if(u.cond2(a,u.one)>=0)return Te;i=i.sort(u.cond2);var c=u.lfix(fm(u.div(fm(u.mul(u.fromNumber(i.length),a)),u.fromNumber(2))));b("calc.funcs.trimmean",c+c<i.length);var s=i[c],l=i[i.length-1-c],f=0,d=0,h=cm(e,mm(e.mathpack.add),(function(e,t){var r=pm(0,t);if(void 0===r)return r;b("calc.funcs.trimmean: unexpected error","number"==typeof r);var n=e.mathpack;if(n.cond2(r,s)<0)f+=1;else{if(!(n.cond2(r,l)>0))return r;d+=1}}),[n]);b("calc.funcs.trimmean: found no elements","number"==typeof h),b("calc.funcs.trimmean: trimmed too many",f<=c&&d<=c);for(var p=h;f<c;f+=1){if(kf(v=u.sub(p,s)))return v;p=v}for(;d<c;d+=1){var v;if(kf(v=u.sub(p,l)))return v;p=v}return u.div(p,u.fromNumber(i.length-c-c))}function wg(e){return function(t,r){var n=e(t,r);return"number"==typeof n?t.mathpack.mul(n,n):n}}function Lg(e,t){return function(r,n){var a=e(r,n);if("number"!=typeof a)return a;var i=r.mathpack,o=i.sub(a,t);return kf(o)?o:i.mul(o,o)}}function Dg(e,t,r,n){var a={count:0};if(null==cm(r,gm(a),e,n,t))return ke;b("calc.funcs.varFirstPass: unexpected count type",a.count>=1);var i=mm(r.mathpack.add),o=cm(r,i,e,n,t),u=cm(r,i,wg(e),n,void 0===t?void 0:wg(t));if(b("calc.funcs.varFirstPass: unexpected sum type",null!=o),kf(o))return o;b("calc.funcs.varFirstPass: unexpected error","number"==typeof o&&"number"==typeof u);var c=r.mathpack,s=c.div(o,c.fromNumber(a.count));return kf(s)?s:[a.count,o,u,s]}function Ug(e,t,r,n,a){var i=cm(r,mm(r.mathpack.add),Lg(e,a),n,void 0===t?void 0:Lg(t,a));return b("calc.funcs.varSecondPass: unexpected error","number"==typeof i),i}function xg(e,t,r,n){var a=Dg(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,o=a[0],u=a[1],c=a[2],s=a[3];if(o<2)return ke;var l=i.mul(u,u);if(kf(l))return l;var f=fm(i.div(l,i.fromNumber(o))),d=fm(i.sub(c,f));if(0===i.cond(s))return i.cond(d)<0?i.zero:i.div(d,i.fromNumber(o-1));if(i.cond(d)>=0){var h=fm(i.div(d,i.fromNumber(o-1)));if(i.cond2(h,i.fromNumber(21219957905e-324))>0){var p=i.div(f,c),v=kf(p)?p:i.sub(p,i.one);if(!kf(v)&&i.cond2(i.abs(v),i.fromNumber(.01))>0){var m=i.div(s,h),g=kf(m)?m:i.sub(i.abs(m),i.fromNumber(1e3));if(!kf(g)&&i.cond(g)<0)return h}}}var C=Ug(e,t,r,n,s);return i.cond(C)<0?i.zero:i.div(C,i.fromNumber(o-1))}function Pg(e,t,r,n){var a=Dg(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,o=a[0],u=a[1],c=a[2],s=a[3];if(o<1)return ke;var l=i.mul(u,u);if(kf(l))return l;var f=i.mul(c,i.fromNumber(o));if(kf(f))return f;var d=fm(i.sub(f,l));if(0===i.cond(s))return i.cond(d)<0?i.zero:i.div(d,i.fromNumber(o*o));if(i.cond(d)>=0){var h=fm(i.div(d,i.fromNumber(o*o)));if(i.cond2(h,i.fromNumber(21219957905e-324))>0){var p=i.div(fm(i.div(l,i.fromNumber(o))),c),v=kf(p)?p:i.sub(p,i.one);if(!kf(v)&&i.cond2(i.abs(v),i.fromNumber(.01))>0){var m=i.div(s,h),g=kf(m)?m:i.sub(i.abs(m),i.fromNumber(1e3));if(!kf(g)&&i.cond(g)<0)return h}}}var C=Ug(e,t,r,n,s);return i.cond(C)<0?i.zero:i.div(C,i.fromNumber(o))}var Gg=xg.bind(void 0,pm,void 0),Vg=Pg.bind(void 0,pm,void 0),Wg=xg.bind(void 0,vm,pm),Bg=Pg.bind(void 0,vm,pm);function jg(e){return function(t,r){var n=e(t,r);return"number"!=typeof n?n:t.mathpack.sqrt(n)}}var Hg=jg(Gg),Kg=jg(Vg),qg=jg(Wg),Jg=jg(Bg);function Qg(e,t){var r=e.dereferenceAllOpers(t);return Hg(e,r)}function Xg(e,t){var r=e.dereferenceAllOpers(t);return Kg(e,r)}function Yg(e,t){var r=e.dereferenceAllOpers(t);return qg(e,r)}function zg(e,t){var r=e.dereferenceAllOpers(t);return Jg(e,r)}function Zg(e,t){var r=e.dereferenceAllOpers(t);return Gg(e,r)}function $g(e,t){var r=e.dereferenceAllOpers(t);return Vg(e,r)}function eC(e,t){var r=e.dereferenceAllOpers(t);return Wg(e,r)}function tC(e,t){var r=e.dereferenceAllOpers(t);return Bg(e,r)}var rC=[Mm,Wm,Hm,Zm,$m,Tm,Hg,Kg,ym,Gg,Vg];function nC(e,t){var r,n=[],a=cm(e,(r=n,function(e,t,n){if(void 0!==e&&kf(e))return e;if("number"==typeof t)for(var a=0;a<n;a+=1)r.push({value:t,index:r.length});return t}),pm,t);if(null==a)return Ne;if(kf(a))return a;var i=e.mathpack,o=n.sort((function(e,t){return i.cond2(e.value,t.value)})),u=1,c=0,s=1/0,l=[];function f(e){u=1,s=e.index}var d,h,p,v=function(e){var t=e.value;u>c?(c=u,l.length=0,l.push({value:t,index:s})):u===c&&l.push({value:t,index:s})};f(o[0]);for(var m=1;m<o.length;m+=1)h=o[m-1],p=o[m],0===i.cond2(h.value,p.value)?((d=o[m]).index<s&&(s=d.index),u+=1):(v(o[m-1]),f(o[m]));return v(o[o.length-1]),c<2?Ne:(b("calc.funcs.modeInner: unexpected error",0!==l.length),l.sort((function(e,t){return e.index-t.index})))}function aC(e,t){var r=nC(e,t);return Array.isArray(r)?r[0].value:r}function iC(e,t){var r=e.dereferenceAllOpers(t);return aC(e,r)}function oC(e,t){var r=e.dereferenceAllOpers(t),n=nC(e,r);return Array.isArray(n)?Le(n.length,1,n.map((function(e){return[e.value]}))):n}function uC(e){return"object"!=typeof e||e.kind!==Eh.RangeValues?e:Th(e.arrays.map((function(e){return e.map((function(e){var t=e[0],r=e[1];return void 0!==r&&function(e){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];if(void 0!==r&&r.kind===D.WorksheetFuncName&&(r.id===xe.SUBTOTAL||r.id===xe.AGGREGATE))return!0}return!1}(r.formula.annotations)?void 0:t}))})))}function cC(e,t){var r=e.mathpack.sfix(t[0]),n=rC.length;if(!(r>=1&&r<=n||r>=101&&r<=n+100))return Re;var a=r>100||e.isInFilterMode(t.slice(1)),i=e.dereferenceAllOpersAndFormulae(t.slice(1),a).map(uC);return(0,rC[r%100-1])(e,i)}var sC=Object(P.f)(rC,[Fg,aC]),lC=[mg,gg,yg,bg,Ag,Tg];function fC(e,t){var r=e.mathpack,n=r.sfix(t[0]),a=r.sfix(t[1]);if(!(n>=1&&n<=sC.length+lC.length&&a>=0&&a<=7))return Re;var i=1==(1&a),o=2==(2&a),u=!(4==(4&a));function c(t){var r=u?e.dereferenceAllOpersAndFormulae(t,i).map(uC):e.dereferenceAllOpers(t,i);return o&&(r=r.map((function(e){if("object"!=typeof e)return e;if(e.kind===Eh.RangeValues)return Th(e.arrays.map((function(e){return e.map((function(e){return void 0===e||kf(e)?void 0:e}))})));if(e.kind===X.Array){var t=e.opers.map((function(e){return e.map((function(e){return void 0===e||kf(e)?void 0:e}))}));return function(e,t,r){return I("calc.runtime.coercedArrayOper",e),I("calc.runtime.coercedArrayOper",t),r.length!==e?R("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:X.Array,rows:e,cols:t,opers:r}}(e.rows,e.cols,t)}return e}))),r}if(n>sC.length){if(4!==t.length)return Re;var s=X.Number,l=e.coerceOper(e.dereferenceOper(t[3],s),s);if(kf(l))return Re;var f=t[2];if(f.kind===X.Range&&!dt(f.sheets))return Re;var d=c([f])[0],h=sC.length;return(0,lC[n-h-1])(e,d,l)}for(var p=2;p<t.length;p+=1){var v=t[p];if(!Tf(v)||!dt(v.sheets))return Re}var m=c(t.slice(2));return b("calc.funcs.aggregate: requested non-array function with unexpected number",n>=1&&n<=sC.length),(0,sC[n-1])(e,m)}function dC(e,t){return pC(e,t,!1)}function hC(e,t){return pC(e,t,!0)}function pC(e,t,r){var n=t[0],a=!0===t[2]?1:-1,i=0,o=0,u=e.mathpack,c=cm(e,(function(e,t,r){if(void 0!==e)return e;if(kf(t))return t;var c=u.cond2(n,fm(t));0===c?i+=r:c===a&&(o+=r)}),pm,e.dereferenceAllOpers([t[1]]));if(void 0!==c)return c;if(0===i)return Ne;var s=u.fromNumber(o+1);if(r){var l=u.div(u.fromNumber(i-1),u.fromNumber(2));return u.add(s,fm(l))}return s}function vC(e){return function(t,r){var n=e(t,r);return"number"==typeof n?t.mathpack.abs(n):n}}function mC(e,t,r){var n=Nm(pm,void 0,!0,Te,t,r);if(!Array.isArray(n))return n;var a=n[0],i=n[1],o=cm(t,mm(t.mathpack.add),e(function(e,t){return function(r,n){var a=e(r,n);return"number"==typeof a?r.mathpack.sub(a,t):a}}(pm,a)),r);return b("calc.funcs.sumDevAndCount",void 0!==o),kf(o)?o:[fm(o),i]}function gC(e,t){var r=e.dereferenceAllOpers(t),n=mC(vC,e,r);if(!Array.isArray(n))return n;var a=n[0],i=n[1];return e.mathpack.div(a,e.mathpack.fromNumber(i))}function CC(e,t){var r=e.dereferenceAllOpers(t),n=mC(wg,e,r);return Array.isArray(n)?n[0]:n}var SC=gi.numErrorOper;function EC(e,t){return e.mathpack.pi}var yC=sm((function(e){return e.mathpack.sqrt})),OC=sm((function(e){return e.mathpack.exp})),AC=lm((function(e){return e.mathpack.power})),kC=sm((function(e){return e.mathpack.ln})),RC=sm((function(e){return e.mathpack.log}));function bC(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack;if(void 0===a)return i.log(n);var o=i.ln(n);if(kf(o))return o;var u=i.ln(a);return kf(u)?u:i.div(o,u)}var IC=sm((function(e){return e.mathpack.sin})),TC=sm((function(e){return e.mathpack.cos})),NC=sm((function(e){return e.mathpack.tan})),FC=sm((function(e){return e.mathpack.asin})),_C=sm((function(e){return e.mathpack.acos})),MC=sm((function(e){return e.mathpack.atan})),wC=lm((function(e){return e.mathpack.atan2}));function LC(e,t){var r=t[0],n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)}var DC=lm((function(e){return e.mathpack.round}));function UC(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack;return i.roundDown(n,null!=a?a:i.zero)}var xC=lm((function(e){return e.mathpack.roundUp})),PC=lm((function(e){return e.mathpack.roundDown}));function GC(e,t){var r=hm(e,t[0]);if(kf(r))return r;var n=hm(e,t[1]);if(kf(n))return n;var a=e.mathpack;if(0===a.cond(n))return a.zero;if(0!==a.cond(r)&&a.cond(r)<0!=a.cond(n)<0)return SC;var i=a.div(r,n);if(kf(i))return SC;var o=a.floor(i),u=fm(a.sub(i,o)),c=a.fromNumber(.5-5e-15);if(a.cond2(u,c)<0)return a.mul(o,n);var s=a.add(o,a.one);return kf(s)?s:a.mul(s,n)}function VC(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return SC;if(0===n||0===a)return e.zero;var i=e.div(t,r);return kf(i)?i:e.mul(e.ceil(e.viewRound(i)),r)}function WC(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return SC;if(0===n&&0===a)return t;var i=e.div(t,r);return kf(i)?i:e.mul(e.floor(e.viewRound(i)),r)}function BC(e,t){return VC(e.mathpack,t[0],t[1])}function jC(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=void 0===a||If(a)?o.one:o.abs(a),c=void 0===i||If(i)?o.zero:i;return 0!==o.cond(c)&&o.cond(n)<0&&(u=o.neg(u)),0===o.cond(u)?o.zero:VC(o,n,u)}function HC(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack,o=void 0===a||If(a)?i.one:i.abs(a);return 0===i.cond(o)?i.zero:VC(i,n,o)}function KC(e,t){return WC(e.mathpack,t[0],t[1])}function qC(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=void 0===a||If(a)?o.one:o.abs(a),c=void 0===i||If(i)?o.zero:i;return 0!==o.cond(c)&&o.cond(n)<0&&(u=o.neg(u)),0===o.cond(u)?o.zero:WC(o,n,u)}function JC(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack,o=void 0===a||If(a)?i.one:i.abs(a);return 0===i.cond(o)?i.zero:WC(i,n,o)}function QC(e,t,r){var n=e.div(t,r);if(kf(n))return n;var a=e.mul(e.trunc(n),r);if(kf(a))return a;var i=e.sub(t,a);return!kf(i)&&e.cond(t)<0?e.abs(i):i}function XC(e,t,r){var n=r[0],a=t.mathpack;if(a.cond(n)>=0){var i=a.ceil(n);return 0===a.cond2(fm(QC(a,i,a.fromNumber(2))),a.one)===e?a.add(i,a.one):i}var o=a.floor(n);return 0===a.cond2(fm(QC(a,o,a.fromNumber(2))),a.one)===e?a.sub(o,a.one):o}var YC=XC.bind(void 0,!0),zC=XC.bind(void 0,!1),ZC=sm((function(e){return e.mathpack.abs}));function $C(e,t){var r=e.mathpack;return r.fromNumber(r.cond(t[0]))}function eS(e,t){var r=e.mathpack,n=fm(r.div(r.fromNumber(180),r.pi));return r.mul(t[0],n)}function tS(e,t){var r=e.mathpack,n=fm(r.div(r.pi,r.fromNumber(180)));return r.mul(t[0],n)}function rS(e,t){var r=hm(e,t[0]);if(kf(r))return r;var n=hm(e,t[1]);if(kf(n))return n;var a=e.mathpack;if(0===a.cond(n))return ke;var i=a.div(r,n);return kf(i)?SC:a.cond(i)>0?a.floor(i):a.ceil(i)}function nS(e,t){var r=t[0],n=e.mathpack,a=n.sfix(r);if(n.cond(r)<0||a>170)return SC;for(var i=n.one,o=a;o>0;o-=1){if(kf(i))return i;i=n.mul(n.fromNumber(o),i)}return i}function aS(e,t){var r=hm(e,t[0]);if(kf(r))return r;var n=e.mathpack,a=n.floor(r);if(n.cond2(a,n.fromNumber(-1))<0||n.cond2(a,n.fromNumber(300))>0)return SC;for(var i=n.one,o=n.toNumber(a);o>1;o-=2){if(kf(i))return i;i=n.mul(n.fromNumber(o),i)}return i}function iS(e,t){var r=hm(e,t[0]);if(kf(r))return r;var n=e.mathpack;if(n.cond(r)<0)return SC;var a=n.mul(n.pi,r);return kf(a)?a:n.sqrt(a)}function oS(e,t){return xf(e,t[0],!0)instanceof Fv}function uS(e,t){var r=hm(e,t[0]);if(kf(r))return r;var n=e.mathpack,a=fm(n.add(n.abs(r),n.fromNumber(1.0000000000000003e-10))),i=fm(n.div(n.floor(a),n.fromNumber(2)));return 0===n.cond2(i,n.floor(i))}function cS(e,t,r){var n=t[0];if(!dt(n.sheets))return Re;var a=n.ranges[0];if(e.calcingArray||!pt(a)){var i=n.sheets;return Le(a.rows,a.cols,Rl(a.rows,a.cols,(function(t,n){var o=ir(i,tr(a.row+t,a.col+n));return r(e.getCellFormula(o),o)})))}var o=At(ar(n.sheets,a));return r(e.getCellFormula(o),o)}function sS(e,t){return cS(e,t,(function(e){return void 0!==e}))}function lS(e,t){return cS(e,t,(function(t,r){if(void 0===t)return Ne;var n=e.formatFormula(t,r.range);return t.source===Vt.Cell?n:"{"+n+"}"}))}function fS(e){return 55296==(64512&e)}function dS(e){return 56320==(64512&e)}function hS(e){return 55296==(63488&e)}function pS(e,t){if(fS(e)&&dS(t))return 65536+((1023&e)<<10|1023&t)}function vS(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n>=e.length)return;fS(e.charCodeAt(n))&&n+1<e.length&&dS(e.charCodeAt(n+1))?n+=2:n+=1}return n}function mS(e,t,r){for(var n=0,a=t;a<r;n+=1){fS(e.charCodeAt(a))&&a+1<r&&dS(e.charCodeAt(a+1))?a+=2:a+=1}return n}var gS=gi.valueErrorOper;function CS(e,t){return void 0===t?1:e.cond(t)<0?gS:e.sfix(t)}function SS(e,t){var r,n=t,a=n[0],i=n[1];if(void 0!==i&&kf(i))return i;var o=CS(e.mathpack,i);if("number"!=typeof o&&kf(o))return gS;var u=null!=(r=function(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n-1<0)return;dS(e.charCodeAt(n-1))&&n-2>=0&&fS(e.charCodeAt(n-2))?n-=2:n-=1}return n}(a,a.length,o))?r:0;return a.substring(u)}function ES(e,t){var r,n=t,a=n[0],i=n[1];if(void 0!==i&&kf(i))return i;var o=CS(e.mathpack,i);if(kf(o))return gS;var u=null!=(r=vS(a,0,o))?r:a.length;return a.substring(0,u)}function yS(e,t){var r,n,a=t,i=a[0],o=a[1],u=a[2],c=e.mathpack,s=c.fix(o)-1,l=c.fix(u);if(c.cond(o)<0||s<0||c.cond(u)<0||l<0)return gS;var f=null!=(r=vS(i,0,s))?r:i.length,d=null!=(n=vS(i,f,l))?n:i.length;return i.substring(f,d)}function OS(e,t){var r=t[0];return e.mathpack.fromNumber(mS(r,0,r.length))}function AS(e,t){for(var r=t,n="",a=0;a<r.length;a+=1){var i=r[a];if(n.length+i.length>32767)return n+i.substring(0,32767-n.length);n+=i}return n}function kS(e,t){var r=t;return r[0]===r[1]}function RS(e,t){var r=t[0],n=t[1],a=e.mathpack,i=a.fix(n);return a.cond(n)<0||i>2147483647?gS:""===r?"":i*r.length>32767?gS:r.repeat(i)}function bS(e,t){for(var r=t[0],n="",a=0;a<r.length;){for(;a<r.length&&32===r.charCodeAt(a);)a+=1;for(var i=a;a<r.length;){var o=32===r.charCodeAt(a);if(a+=1,o)break}n+=r.substring(i,a)}return n.length>0&&32===n.charCodeAt(n.length-1)&&(n=n.substring(0,n.length-1)),n}function IS(e,t){for(var r=t[0],n="",a=0;a<r.length;a+=1){var i=r.charCodeAt(a);(i>=256||(127&i)>=32)&&(n+=r.charAt(a))}return n}function TS(e,t){var r=e.mathpack.sfix(t[0]);return r<1||r>255?gS:String.fromCharCode(r)}function NS(e,t){var r=t[0],n=e.mathpack,a=n.lfix(n.trunc(r));if(n.cond2(r,n.one)<0||a>=1114112)return gS;return a<=65535&&hS(a)||a>=64976&&a<=65007||(65535&a)>=65534?Ne:function(e){if(e<=65535)return String.fromCharCode(e);var t=e-65536;return String.fromCharCode(t>>10|55296,1023&t|56320)}(a)}function FS(e,t){var r=t[0];if(0===r.length)return gS;var n=r.charCodeAt(0);return n>255?mp(wl(["CODE for codepoints > 255"])):e.mathpack.fromNumber(n)}function _S(e,t){var r=t[0];if(0===r.length)return gS;var n=r.charCodeAt(0),a=e.mathpack;if(!hS(n))return a.fromNumber(n);if(1===r.length)return gS;var i=pS(n,r.charCodeAt(1));return void 0===i?gS:a.fromNumber(i)}function MS(e){return e>=65&&e<=90||e>=97&&e<=122}function wS(e,t,r){return""===e?e:function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():mp(wl([t+" for non-ASCII input"]))}function LS(e,t){var r=t[0];return wS(r,"LOWER",r.toLowerCase.bind(r))}function DS(e,t){var r=t[0];return wS(r,"UPPER",r.toUpperCase.bind(r))}function US(e,t){var r=t[0];return wS(r,"PROPER",(function(){for(var e=r.toLowerCase(),t="",n=0;;){for(var a=n;n<e.length&&!MS(e.charCodeAt(n));)n+=1;if(t+=e.substring(a,n),n===e.length)break;var i=n;for(t+=e.charAt(n).toUpperCase(),n+=1;n<e.length&&MS(e.charCodeAt(n));)n+=1;t+=e.substring(i+1,n)}return t}))}function xS(e,t){var r,n=t,a=n[0],i=n[1],o=n[2],u=void 0!==o?e.mathpack.sfix(o)-1:0;if(u<0||u>=2147483647)return gS;var c=null!=(r=vS(i,0,u))?r:i.length,s=i.indexOf(a,c);return s>=0?e.mathpack.fromNumber(mS(i,0,s)+1):gS}function PS(e,t){var r,n,a=t,i=a[0],o=a[1],u=a[2],c=a[3],s=e.mathpack.sfix(o)-1;if(s<0||s>=32767)return gS;var l=e.mathpack.sfix(u);if(l<0||l>32767)return gS;var f=null!=(r=vS(i,0,s))?r:i.length,d=null!=(n=vS(i,f,l))?n:i.length,h=i.slice(0,f),p=i.slice(d);return h.length+c.length+p.length>32767?gS:h+c+p}function GS(e,t){var r,n=t,a=n[0],i=n[1],o=n[2],u=void 0!==o?e.mathpack.sfix(o)-1:0;if(u<0||u>=2147483647)return gS;for(var c=null!=(r=vS(i,0,u))?r:i.length,s=new rm(e.config.localeInfo,a,!0);c<i.length;c+=1)if(s.test(i.slice(c)))return e.mathpack.fromNumber(mS(i,0,c)+1);return gS}function VS(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=1/0;if(void 0!==o){var c=e.coerceOper(o,X.Number);if(kf(c))return c;if((u=e.mathpack.sfix(c))<1||u>2147483646)return gS}var s=a.length;if(s>0){for(var l="",f=0,d=0;u>=0&&-1!==(d=n.indexOf(a,d));)if((u-=1)===1/0||0===u){var h=n.slice(f,d);if(l.length+h.length+i.length>32767)return gS;l+=h,l+=i,f=d+=s}else d+=1;var p=n.slice(f);return l.length+p.length>32767?gS:l+=p}return n}function WS(e,t){var r=t[0],n=t[1];if(Nf(r)){var a=r.getField(n);if(void 0!==a)return a}return _e}function BS(e,t){for(var r=t[0],n=e.config.localeInfo,a=El.create(n.stringCompareCI),i=1;i<t.length;i+=2){var o=t[i],u=t[i+1];a=a.setValue(o,u)}return new Nv(a,r)}function jS(e,t){var r=t[0];return dt(r.sheets)?e.mathpack.fromNumber(r.ranges.length):Re}function HS(e,t){var r=t[0],n=e.mathpack;return bf(r)?n.fromNumber(r.rows):dt(r.sheets)?r.ranges.length>1?be:n.fromNumber(r.ranges[0].rows):Re}function KS(e,t){var r=t[0],n=e.mathpack;return bf(r)?n.fromNumber(r.cols):dt(r.sheets)?r.ranges.length>1?be:n.fromNumber(r.ranges[0].cols):Re}function qS(e,t){if(0===t.length)return[e.reflectionGridCell,!e.calcingArray];var r=t[0];if(!dt(r.sheets))return Re;if(r.ranges.length>1)return be;var n=r.ranges[0];return[n,pt(n)]}function JS(e,t){var r=qS(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.row+1):Le(n.rows,1,Rl(n.rows,1,(function(e){return i.fromNumber(n.row+e+1)})))}function QS(e,t){var r=qS(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.col+1):Le(1,n.cols,Rl(1,n.cols,(function(e,t){return i.fromNumber(n.col+t+1)})))}function XS(e,t){var r=e.mathpack;if(0===t.length)return r.fromNumber(e.getSheetRangeIndexes(function(e){return{document:e,index:void 0,index2:void 0}}(e.reflectionSheet.document)).length);var n=t[0];return bf(n)?Ne:r.fromNumber(e.getSheetRangeIndexes(n.sheets).length)}function YS(e,t){var r=e.mathpack;if(0===t.length){var n=e.reflectionSheet;return void 0===n.index?Ne:r.fromNumber(e.getSheetRangePosition(n)+1)}var a=t[0];if("string"==typeof a){var i=e.getSheetIndex(e.reflectionSheet.document,a);return void 0===i?Ne:r.fromNumber(e.getSheetRangePosition(i)+1)}return a.kind===X.Range?r.fromNumber(e.getSheetRangePosition(a.sheets)+1):a.kind===X.Array?Ne:k("calc.funcs.sheet",a)}function zS(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=r[4];if(!dt(n.sheets))return Re;if(1!==n.ranges.length)return Re;var c=e.mathpack,s=n.ranges[0],l=s.row,f=s.col,d=s.rows,h=s.cols,p=l;"number"==typeof a&&(p+=c.lfix(a));var v=f;"number"==typeof i&&(v+=c.lfix(i));var m=p+d-1;if("number"==typeof o){if(0===(C=c.cond(o)))return be;m=p+c.lfix(o)-(C>0?1:-1)}var g=v+h-1;if("number"==typeof u){var C;if(0===(C=c.cond(u)))return be;g=v+c.lfix(u)-(C>0?1:-1)}var S=Cr(p,m),E=Cr(v,g),y=Sr(p,m)-S+1,O=Sr(v,g)-E+1;return S<0||E<0||S+y>1<<20||E+O>16384?be:De(n.sheets,[er(S,E,y,O)])}function ZS(e,t){var r=t[0];return bf(r)?Le(r.cols,r.rows,Rl(r.cols,r.rows,(function(e,t){return r.opers[t][e]}))):r}function $S(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=r[4],c=e.mathpack,s="number"!=typeof i?0:c.sfix(i)-1;if(s<0||s>3)return Re;var l=0!=(1&s),f=0!=(2&s),d="boolean"!=typeof o||o?_.A1:_.R1C1,h=function(e,t,r){return d===_.R1C1&&e?-t<r&&r<t:1<=r&&r<=t},p=c.sfix(n);if(!h(f,1<<20,p))return Re;if("number"!=typeof a)return Re;var v=c.sfix(a);if(!h(l,16384,v))return Re;var m=tr(p<0?1048575:0,v<0?16383:0),g=J(f?L.Rel:L.Abs,d===_.R1C1&&f?p:p-1),C=J(l?L.Rel:L.Abs,d===_.R1C1&&l?v:v-1),S=sn(e.config.localeInfo,d,m,g,C,!1);return b("calc.funcs.address: cell wrapped",void 0!==S),"string"==typeof u?""===u?"!"+S:u.length>255?Re:vn(e.config.localeInfo,e.config.refStyle,u)+"!"+S:S}function eE(e,t){var r=t,n=r[0],a=r[1],i="boolean"!=typeof a||a?_.A1:_.R1C1;if(n.length>255||n.length>0&&" "===n[0])return Re;var o=or(e.originSheet,e.originGridCell),u={lexicalKind:Vt.Indirect,origin:o.range,allowRelativeQualifier:!1},c=e.parseFormula(i,o.range,u,"="+n);if(!lt(c))return be;for(var s=c.value.node,l=!1,f=!1;;){if(!l&&s.kind===U.App&&s.head.kind===U.Operator&&s.head.id===Ve.Pound&&1===s.args.length&&Rn(gn.CalcDynamicArrayOperators)&&(l=!0,s=s.args[0]),f||s.kind!==U.Name){if(s.kind===U.CellRef){var d=e.getCellRef(s.qualifier,s.ref,o,!0);return void 0===d?be:dt(d.sheets)?l?Zp(e,Ve.Pound,[d]):d:be}return be}var h=e.getNameFormula(s.qualifier,s.whole);if(void 0===h)return be;o=or(o.sheet,tr(0,0)),s=h[1],f=!0}}var tE=Pf(ot(xe.IFS)),rE=Pf(ot(xe.SWITCH));function nE(e,t){var r=t[0];return b("calc.funcs.if","boolean"==typeof r),t[r?1:2]}function aE(e,t){var r=t[0];b("calc.funcs.choose","number"==typeof r);var n=e.mathpack.fix(r);return n<1||n>t.length-1?Re:t[n]}function iE(e,t,r,n){var a=n.slice();return e.dereferenceOpers(a,t),Vf(e,t,(function(n){for(var a=[],i=0;i<n.length;i+=1){var o=Mt(t,i,n.length);a[i]=e.coerceOper(n[i],o)}return r(e,a)}),a)}function oE(e,t){for(var r=0;r<t.length;r+=2){var n=t[r];if(bf(n)){var a=t.slice(r);return iE(e,tE,oE,a)}if(kf(n))return n;if(b("calc.funcs.ifs","boolean"==typeof n),n)return t[r+1]}return Ne}function uE(e,t){var r=t[0];if(bf(r))return iE(e,rE,uE,t);if(kf(r))return r;for(var n=function(e,t){var r=e.mathpack,n=e.localeInfo;switch(typeof t){case"number":return function(e){return Nf(e)?mp(Pt(["SWITCH with a rich value case"])):"number"==typeof e&&0===r.compare(t,e)};case"string":return function(e){return Nf(e)?mp(Pt(["SWITCH with a rich value case"])):"string"==typeof e&&0===n.stringCompareCI(t,e)};case"boolean":return function(e){return Nf(e)?mp(Pt(["SWITCH with a rich value case"])):t===e};default:return Nf(t)?mp(Pt(["SWITCH with a rich value condition"])):k("calc.funcs.makeSwitchComparer",t)}}(e.config,r),a=1;a<t.length-1;a+=2){var i=X.Error|X.Rich|X.Number|X.Boolean|X.String|X.Array,o=e.coerceOper(e.dereferenceOper(t[a],i),i);if(bf(o))return iE(e,rE,uE,t);if(kf(o))return o;if(n(o))return t[a+1]}return t.length%2==0?t[t.length-1]:Ne}function cE(e,t){return!0}function sE(e,t){return!1}function lE(e,t){return!t[0]}function fE(e,t){var r=t,n=r[0],a=r[1];return e.followHyperlinks?n:void 0!==a?a:n}function dE(e,t){return Ne}function hE(e,t){if(Tf(t)){if(dt(t.sheets)){var r=De(t.sheets,[Ot(t.ranges[0])]);return e.dereferenceOper(r,Of)}return Re}return t}function pE(e,t){var r=hE(e,t[0]);return"string"==typeof r||kf(r)?r:""}function vE(e,t){var r=hE(e,t[0]);if("number"==typeof r||kf(r))return r;var n=e.mathpack;return"boolean"==typeof r&&r?n.one:n.zero}function mE(e,t){var r=t[0],n=e.mathpack;switch(typeof r){case"number":return n.fromNumber(1);case"string":return n.fromNumber(2);case"boolean":return n.fromNumber(4)}switch(r.kind){case X.Error:return n.fromNumber(16);case X.Array:return n.fromNumber(64);case X.Rich:return n.fromNumber(128)}return k("calc.funcs.type",r)}function gE(e,t){var r=t[0];return kf(r)?e.mathpack.fromNumber(r.type):Ne}function CE(e,t){return Re}function SE(e,t){var r=t,n=r[0],a=r[1],i=void 0===a||If(a)?e.mathpack.zero:hm(e,a);if(kf(i))return i;var o=hm(e,n);return kf(o)?o:[o,i]}function EE(e,t){var r=SE(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return 0===i.cond2(n,a)?i.one:i.zero}function yE(e,t){var r=SE(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return i.cond2(n,a)>=0?i.one:i.zero}function OE(e,t,r){var n=xf(e,t,!0);return n instanceof Fv?void 0!==r&&n.arity!==r?Ne:n:kf(n)?n:be}function AE(e,t){var r=t,n=r[0],a=r.slice(1),i=OE(e,n,a.length);return kf(i)?i:e.applyLambda(i,a)}function kE(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=OE(e,i,2);if(kf(o))return o;var u=e.mathpack,c=u.fix(n),s=u.fix(a);if(c<1||s<1)return Re;if(c*s>1e6)return mp(Pt(["ARRAY.MAKE with very large size"]));var l=[!1,!1];return hf(new vf(e,c,s,(function(t,r){var n=e.mathpack;return l[0]=n.fromNumber(t+1),l[1]=n.fromNumber(r+1),e.applyLambda(o,l)})))}function RE(e,t){var r=xf(e,t[0],!0);return r instanceof Fv?e.mathpack.fromNumber(r.arity):Ne}var bE=gi.OperKind,IE=gi.rangeSeqOper,TE=gi.valueErrorOper,NE=gi.refErrorOper,FE=gi.arrayOper,_E=vi.gridRange,ME=Ai.isSheetIndex;function wE(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=e.mathpack,c=u.sfix(a);if(c<0)return TE;var s=void 0===i?void 0:u.sfix(i);if(void 0!==s&&s<0)return TE;var l,f,d=void 0===o?0:u.sfix(o)-1;if(d<0)return TE;switch(n.kind){case bE.Range:if(!ME(n.sheets))return TE;if(d>=n.ranges.length)return NE;var h=n.ranges[d];if(void 0===s)if(1===h.rows)l=0,f=c-1;else{if(1!==h.cols)return NE;l=c-1,f=-1}else l=c-1,f=s-1;if(l>=h.rows||f>=h.cols)return NE;var p=_E(h.row+Sr(l,0),h.col+Sr(f,0),-1===l?h.rows:1,-1===f?h.cols:1);return IE(n.sheets,[p]);case bE.Array:return d>0?NE:(void 0===s?1===n.rows?(l=0,f=c-1):(l=c-1,f=-1):(l=c-1,f=s-1),l>=n.rows||f>=n.cols?NE:-1===l&&-1===f?n:-1===l?FE(n.rows,1,n.opers.map((function(e){return[e[f]]}))):-1===f?FE(1,n.cols,[n.opers[l]]):n.opers[l][f]);default:return k("calc.funcs.lookupFuncs: INDEX",n)}}var LE=function(e){return e<0?Ve.Lt:e>0?Ve.Gt:Ve.Eq};function DE(e,t,r){void 0===r&&(r=!1);var n,a=e.config,i=a.localeInfo,o=a.mathpack;switch(typeof t){case"number":n=function(e){return{correctType:!0,sgnT:(r=o,n=e,a=t,LE(r.cond2(n,a)))};var r,n,a};break;case"string":if(r){var u=new rm(i,t);n=function(e){return{correctType:!0,sgnT:u.test(e)?Ve.Eq:Ve.Ne}}}else n=function(e){return{correctType:!0,sgnT:LE(i.stringCompareCI(e,t))}};break;case"boolean":n=function(e){return{correctType:!0,sgnT:(r=e,n=t,LE(r-n))};var r,n};break;case"object":return Nf(t)?mp(Pt(["lookup with rich value condition"])):k("calc.funcs.makeLookupComparer",t)}return function(e){var r=Nf(e)?e.getFallback():e;return typeof t!=typeof r?{correctType:!1,sgnT:Ve.Ne}:n(r)}}function UE(e,t,r){for(var n=!1,a=r.length-1,i=Math.floor((0+a)/2),o=0,u=a,c=DE(e,t);;){var s=c(r.get(i)).sgnT;if(s===Ve.Ne){if(i<u)for(var l=i+1;l<=u;l+=1)if((s=c(r.get(l)).sgnT)!==Ve.Ne){i=l;break}s===Ve.Ne&&(i=Math.floor((o+u)/2),s=Ve.Gt)}if(s===Ve.Eq){if(i<a){n=!0,o=i+=1,u=i;continue}return i}if(s===Ve.Lt?o=i+1:u=i-1,!(o<=u)){if(n)i-=1;else if(s===Ve.Gt&&(i-=1)>=0){o=i,u=i;continue}return i}i=Math.floor((o+u)/2)}}function xE(e,t,r,n){for(var a=-1,i=DE(e,t,n===Ve.Eq),o=0;o<r.length;o+=1){var u=i(r.get(o)),c=u.correctType,s=u.sgnT;if(c){if(s===Ve.Eq)return o;if(s!==Ve.Ne&&s===n)return a;a=o}o===r.denseLength&&(o=Sr(o,r.length-2))}return n!==Ve.Eq?a:r.length}function PE(e){if("number"==typeof e)return Ne;switch(e.kind){case bE.Range:return ME(e.sheets)?e.ranges.length>1?Ne:e:TE;case bE.Array:return e}}function GE(e,t){if("number"==typeof t)return t;var r;switch(t.kind){case Eh.RangeValues:r=t.arrays[0].get(0,0);break;case bE.Array:r=t.opers[0][0];break;default:return k("calc.funcs.lookupFuncs.getNumFromRef",t)}return kf(r=e.coerceOper(r,bE.Number))?NE:r}function VE(e){if("number"==typeof e)return Ne;switch(e.kind){case bE.Rich:return Ne;case bE.Range:if(!ME(e.sheets))return TE;if(e.ranges.length>1)return Ne;var t=e.ranges[0];return 1!==t.rows&&1!==t.cols?Ne:e;case bE.Array:return 1!==e.rows&&1!==e.cols?Ne:e}}function WE(e){switch(e.kind){case Eh.RangeValues:return e.arrays[0];case bE.Array:return new Ol(e.rows,e.cols,e.rows,e.cols,e.opers,Ge)}}function BE(e,t){switch(t.kind){case bE.Range:var r=t.sheets,n=t.ranges[0];return new kl(n.rows,n.cols,n.rows,n.cols,(function(t,a){var i=tr(n.row+t,n.col+a);return e.dereferenceAllOpers([IE(r,[i])])[0].arrays[0].get(0,0)}),(function(){return R("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")}));case bE.Array:return new Ol(t.rows,t.cols,t.rows,t.cols,t.opers,Ge)}}function jE(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=function(e){if("number"==typeof e)return e;switch(e.kind){case bE.Range:if(!ME(e.sheets))return TE;if(e.ranges.length>1)return NE;var t=e.ranges[0];return 1!==t.rows||1!==t.cols?NE:e}}(null!=i?i:o.one);if(kf(u))return u;var c=e.dereferenceAllOpers([u])[0],s=GE(e,c);if(kf(s))return s;var l=VE(a);if(kf(l))return l;var f=WE(e.dereferenceAllOpers([l])[0]),d=XE(f,1===f.rows),h=-1;return(h=o.cond(s)>0?UE(e,n,d):0===o.cond(s)?xE(e,n,d,Ve.Eq):xE(e,n,d,Ve.Lt))<0||h>=d.length?Ne:e.mathpack.fromNumber(h+1)}function HE(e){if(Tf(e)){var t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function KE(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=PE(a);if(kf(o))return o;var u=HE(o),c=YE(o,u),s=XE(WE(e.dereferenceAllOpers([c])[0]),u),l=UE(e,n,s);if(l<0)return Ne;if(void 0!==i){var f=VE(i);if(kf(f))return f;var d=HE(f),h=XE(BE(e,function(e,t,r){if(r.kind===bE.Range){var n=r.ranges[0],a=_E(n.row,n.col,Cr(t?1:e,(1<<20)-n.row),Cr(t?e:1,16384-n.col));return Ue(r.sheets,a)}return r}(s.length,d,f)),d);return l>=h.length?f.kind===bE.Array?Ne:Ge:h.get(l)}var p=BE(e,o);return u?p.get(p.rows-1,l):p.get(l,p.cols-1)}function qE(e,t,r){var n=t,a=n[0],i=n[1],o=n[2],u=n[3],c=PE(i);if(kf(c))return c;var s=YE(c,r),l=XE(WE(e.dereferenceAllOpers([s])[0]),r),f=!(null==u||u)?xE(e,a,l,Ve.Eq):UE(e,a,l);if(f<0||f>=l.length)return Ne;var d=function(e,t){if("number"==typeof t)return t;switch(t.kind){case bE.Range:if(!ME(t.sheets))return TE;if(t.ranges.length>1)return NE;var r=t.ranges;return e.calcingArray?mp(Pt(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?mp(Pt(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case bE.Array:return mp(Pt(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,o);if(kf(d))return d;var h=e.dereferenceAllOpers([d])[0],p=GE(e,h);if(kf(p))return p;var v=e.mathpack.sfix(p)-1,m=BE(e,c);return v<0?TE:v>=(r?m.rows:m.cols)?NE:r?m.get(v,f):m.get(f,v)}function JE(e,t){return qE(e,t,!0)}function QE(e,t){return qE(e,t,!1)}function XE(e,t){var r=e.getSparse.bind(e);return t?{length:e.cols,denseLength:e.denseCols,get:function(t){return e.get(0,t)},getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:function(t){return e.get(t,0)},getSparse:r}}function YE(e,t){if(e.kind===bE.Range){var r=e.ranges[0],n=_E(r.row,r.col,t?1:r.rows,t?r.cols:1);return IE(e.sheets,[n])}return e}var zE={};zE[yi.WorksheetFuncId.SUM]=function(e,t){var r=e.dereferenceAllOpers(t);return ym(e,r)},zE[yi.WorksheetFuncId.PRODUCT]=function(e,t){var r=e.dereferenceAllOpers(t);return Tm(e,r)},zE[yi.WorksheetFuncId.AVERAGE]=function(e,t){var r=e.dereferenceAllOpers(t);return Mm(e,r)},zE[yi.WorksheetFuncId.COUNTBLANK]=function(e,t){var r=t[0];if(!Tf(r)||!dt(r.sheets)||1!==r.ranges.length)return Re;var n=e.dereferenceAllOpers(t);return jm(e,n)},zE[yi.WorksheetFuncId.MAX]=function(e,t){var r=e.dereferenceAllOpers(t);return Zm(e,r)},zE[yi.WorksheetFuncId.MIN]=function(e,t){var r=e.dereferenceAllOpers(t);return $m(e,r)},zE[yi.WorksheetFuncId.ISERROR]=function(e,t){return Ai.operKind(t[0])===gi.OperKind.Error},zE[yi.WorksheetFuncId.ISERR]=function(e,t){var r=t[0];return kf(r)&&r.type!==gi.ErrorType.NA},zE[yi.WorksheetFuncId.ISBLANK]=function(e,t){return Ai.operKind(t[0])===gi.OperKind.Blank},zE[yi.WorksheetFuncId.ISLOGICAL]=function(e,t){return Ai.operKind(t[0])===gi.OperKind.Boolean},zE[yi.WorksheetFuncId.ISNA]=function(e,t){var r=t[0];return kf(r)&&r.type===gi.ErrorType.NA},zE[yi.WorksheetFuncId.ISNONTEXT]=function(e,t){return Ai.operKind(t[0])!==gi.OperKind.String},zE[yi.WorksheetFuncId.ISTEXT]=function(e,t){return Ai.operKind(t[0])===gi.OperKind.String},zE[yi.WorksheetFuncId.ISNUMBER]=function(e,t){return Ai.operKind(t[0])===gi.OperKind.Number},zE[yi.WorksheetFuncId.ISREF]=function(e,t){return Ai.operKind(t[0])===gi.OperKind.Range},zE[yi.WorksheetFuncId.ISEVEN]=uS,zE[yi.WorksheetFuncId.ISODD]=function(e,t){var r=uS(e,t);return"boolean"==typeof r?!r:r};var ZE,$E,ey=!1;function ty(e){return ey||(ey=!0,Rn(gn.CalcNewFunctions)&&(zE[yi.WorksheetFuncId.AND]=fg,zE[yi.WorksheetFuncId.COUNTA]=Km,zE[yi.WorksheetFuncId.OR]=dg,zE[yi.WorksheetFuncId.CONCAT]=Pm,zE[yi.WorksheetFuncId.IF]=nE,zE[yi.WorksheetFuncId.ABS]=ZC,zE[yi.WorksheetFuncId.CEILING]=BC,zE[yi.WorksheetFuncId.ECMA_CEILING]=BC,zE[yi.WorksheetFuncId.DEGREES]=eS,zE[yi.WorksheetFuncId.FLOOR]=KC,zE[yi.WorksheetFuncId.RADIANS]=tS,zE[yi.WorksheetFuncId.ROUND]=DC,zE[yi.WorksheetFuncId.ROUNDUP]=xC,zE[yi.WorksheetFuncId.ROUNDDOWN]=PC,zE[yi.WorksheetFuncId.EVEN]=YC,zE[yi.WorksheetFuncId.SIGN]=$C,zE[yi.WorksheetFuncId.PI]=EC,zE[yi.WorksheetFuncId.SQRT]=yC,zE[yi.WorksheetFuncId.EXP]=OC,zE[yi.WorksheetFuncId.POWER]=AC,zE[yi.WorksheetFuncId.LN]=kC,zE[yi.WorksheetFuncId.LOG10]=RC,zE[yi.WorksheetFuncId.LOG]=bC,zE[yi.WorksheetFuncId.SIN]=IC,zE[yi.WorksheetFuncId.COS]=TC,zE[yi.WorksheetFuncId.TAN]=NC,zE[yi.WorksheetFuncId.ASIN]=FC,zE[yi.WorksheetFuncId.ACOS]=_C,zE[yi.WorksheetFuncId.ATAN]=MC,zE[yi.WorksheetFuncId.ATAN2]=wC,zE[yi.WorksheetFuncId.FACT]=nS,zE[yi.WorksheetFuncId.LEFT]=ES,zE[yi.WorksheetFuncId.RIGHT]=SS,zE[yi.WorksheetFuncId.MID]=yS,zE[yi.WorksheetFuncId.LEN]=OS,zE[yi.WorksheetFuncId.CONCATENATE]=AS),Rn(gn.CalcWorksheetFunctions)&&(Rn(gn["OfficeVSO:3852168_CalcCGIFS"])&&(zE[yi.WorksheetFuncId.IFS]=oE),Rn(gn["OfficeVSO:3852168_CalcCGSWITCH"])&&(zE[yi.WorksheetFuncId.SWITCH]=uE),Rn(gn["OfficeVSO:3852168_CalcCGAVERAGEIF"])&&(zE[yi.WorksheetFuncId.AVERAGEIF]=Lm),Rn(gn["OfficeVSO:3852168_CalcCGAVERAGEIFS"])&&(zE[yi.WorksheetFuncId.AVERAGEIFS]=Dm),Rn(gn["OfficeVSO:3852168_CalcCGCOUNT"])&&(zE[yi.WorksheetFuncId.COUNT]=Bm),Rn(gn["OfficeVSO:3852168_CalcCGCOUNTIF"])&&(zE[yi.WorksheetFuncId.COUNTIF]=Jm),Rn(gn["OfficeVSO:3852168_CalcCGCOUNTIFS"])&&(zE[yi.WorksheetFuncId.COUNTIFS]=Qm),Rn(gn["OfficeVSO:3852168_CalcCGMEDIAN"])&&(zE[yi.WorksheetFuncId.MEDIAN]=_g),Rn(gn["OfficeVSO:3852168_CalcCGSUMSQ"])&&(zE[yi.WorksheetFuncId.SUMSQ]=Om),Rn(gn["OfficeVSO:3852168_CalcCGSUMIF"])&&(zE[yi.WorksheetFuncId.SUMIF]=Rm),Rn(gn["OfficeVSO:3852168_CalcCGSUMIFS"])&&(zE[yi.WorksheetFuncId.SUMIFS]=Im),Rn(gn["OfficeVSO:3852168_CalcCGROWS"])&&(zE[yi.WorksheetFuncId.ROWS]=HS),Rn(gn["OfficeVSO:3852168_CalcCGCOLUMNS"])&&(zE[yi.WorksheetFuncId.COLUMNS]=KS),Rn(gn["OfficeVSO:3852168_CalcCGINDEX"])&&(zE[yi.WorksheetFuncId.INDEX]=wE),Rn(gn["OfficeVSO:3852168_CalcCGMATCH"])&&(zE[yi.WorksheetFuncId.MATCH]=jE),Rn(gn["OfficeVSO:3852168_CalcCGLOOKUP"])&&(zE[yi.WorksheetFuncId.LOOKUP]=KE),Rn(gn["OfficeVSO:3852168_CalcCGHLOOKUP"])&&(zE[yi.WorksheetFuncId.HLOOKUP]=JE),Rn(gn["OfficeVSO:3852168_CalcCGVLOOKUP"])&&(zE[yi.WorksheetFuncId.VLOOKUP]=QE),Rn(gn["OfficeVSO:3852168_CalcCGLARGE"])&&(zE[yi.WorksheetFuncId.LARGE]=Cg),Rn(gn["OfficeVSO:3852168_CalcCGSMALL"])&&(zE[yi.WorksheetFuncId.SMALL]=Sg),Rn(gn["OfficeVSO:3852168_CalcCGRANK"])&&(zE[yi.WorksheetFuncId.RANK]=dC,zE[yi.WorksheetFuncId.RANK_EQ]=dC),Rn(gn["OfficeVSO:3852168_CalcCGRANK_AVG"])&&(zE[yi.WorksheetFuncId.RANK_AVG]=hC),Rn(gn["OfficeVSO:3852168_CalcCGPERCENTILE"])&&(zE[yi.WorksheetFuncId.PERCENTILE]=Og,zE[yi.WorksheetFuncId.PERCENTILE_INC]=Og),Rn(gn["OfficeVSO:3852168_CalcCGPERCENTILE_EXC"])&&(zE[yi.WorksheetFuncId.PERCENTILE_EXC]=kg),Rn(gn["OfficeVSO:3852168_CalcCGQUARTILE"])&&(zE[yi.WorksheetFuncId.QUARTILE]=Ig,zE[yi.WorksheetFuncId.QUARTILE_INC]=Ig),Rn(gn["OfficeVSO:3852168_CalcCGQUARTILE_EXC"])&&(zE[yi.WorksheetFuncId.QUARTILE_EXC]=Ng),Rn(gn["OfficeVSO:3852168_CalcCGTRIMMEAN"])&&(zE[yi.WorksheetFuncId.TRIMMEAN]=Mg),Rn(gn["OfficeVSO:3852168_CalcCGTRUE"])&&(zE[yi.WorksheetFuncId.TRUE]=cE),Rn(gn["OfficeVSO:3852168_CalcCGFALSE"])&&(zE[yi.WorksheetFuncId.FALSE]=sE),Rn(gn["OfficeVSO:3852168_CalcCGNOT"])&&(zE[yi.WorksheetFuncId.NOT]=lE),Rn(gn["OfficeVSO:3852168_CalcCGNA"])&&(zE[yi.WorksheetFuncId.NA]=dE),Rn(gn["OfficeVSO:3852168_CalcCGAVERAGEA"])&&(zE[yi.WorksheetFuncId.AVERAGEA]=Um),Rn(gn["OfficeVSO:3852168_CalcCGMAXA"])&&(zE[yi.WorksheetFuncId.MAXA]=rg),Rn(gn["OfficeVSO:3852168_CalcCGMINA"])&&(zE[yi.WorksheetFuncId.MINA]=ng),Rn(gn["OfficeVSO:3852168_CalcCGMAXIFS"])&&(zE[yi.WorksheetFuncId.MAXIFS]=ag),Rn(gn["OfficeVSO:3852168_CalcCGMINIFS"])&&(zE[yi.WorksheetFuncId.MINIFS]=ig),Rn(gn["OfficeVSO:3852168_CalcCGXOR"])&&(zE[yi.WorksheetFuncId.XOR]=hg),Rn(gn["OfficeVSO:3852168_CalcCGT"])&&(zE[yi.WorksheetFuncId.T]=pE),Rn(gn["OfficeVSO:3852168_CalcCGN"])&&(zE[yi.WorksheetFuncId.N]=vE),Rn(gn["OfficeVSO:3852168_CalcCGHYPERLINK"])&&(zE[yi.WorksheetFuncId.HYPERLINK]=fE),Rn(gn["OfficeVSO:3852168_CalcCGAGGREGATE"])&&(zE[yi.WorksheetFuncId.AGGREGATE]=fC),Rn(gn["OfficeVSO:3852168_CalcCGSUBTOTAL"])&&(zE[yi.WorksheetFuncId.SUBTOTAL]=cC),Rn(gn["OfficeVSO:3852168_CalcCGVAR"])&&(zE[yi.WorksheetFuncId.VAR]=Zg,zE[yi.WorksheetFuncId.VAR_S]=Zg),Rn(gn["OfficeVSO:3852168_CalcCGVARP"])&&(zE[yi.WorksheetFuncId.VARP]=$g,zE[yi.WorksheetFuncId.VAR_P]=$g),Rn(gn["OfficeVSO:3852168_CalcCGSTDEV"])&&(zE[yi.WorksheetFuncId.STDEV]=Qg,zE[yi.WorksheetFuncId.STDEV_S]=Qg),Rn(gn["OfficeVSO:3852168_CalcCGSTDEVP"])&&(zE[yi.WorksheetFuncId.STDEVP]=Xg,zE[yi.WorksheetFuncId.STDEV_P]=Xg),Rn(gn["OfficeVSO:3852168_CalcCGVARA"])&&(zE[yi.WorksheetFuncId.VARA]=eC),Rn(gn["OfficeVSO:3852168_CalcCGVARPA"])&&(zE[yi.WorksheetFuncId.VARPA]=tC),Rn(gn["OfficeVSO:3852168_CalcCGSTDEVA"])&&(zE[yi.WorksheetFuncId.STDEVA]=Yg),Rn(gn["OfficeVSO:3852168_CalcCGSTDEVPA"])&&(zE[yi.WorksheetFuncId.STDEVPA]=zg),Rn(gn["OfficeVSO:3852168_CalcCGAVEDEV"])&&(zE[yi.WorksheetFuncId.AVEDEV]=gC),Rn(gn["OfficeVSO:3852168_CalcCGDEVSQ"])&&(zE[yi.WorksheetFuncId.DEVSQ]=CC),Rn(gn["OfficeVSO:3852168_CalcCGMODE"])&&(zE[yi.WorksheetFuncId.MODE]=iC,zE[yi.WorksheetFuncId.MODE_SNGL]=iC),Rn(gn["OfficeVSO:3852168_CalcCGMODE_MULT"])&&(zE[yi.WorksheetFuncId.MODE_MULT]=oC),Rn(gn["OfficeVSO:3852168_CalcCGTYPE"])&&(zE[yi.WorksheetFuncId.TYPE]=mE),Rn(gn["OfficeVSO:3852168_CalcCGERROR_TYPE"])&&(zE[yi.WorksheetFuncId.ERROR_TYPE]=gE),Rn(gn["OfficeVSO:3852168_CalcCGAREAS"])&&(zE[yi.WorksheetFuncId.AREAS]=jS),Rn(gn["OfficeVSO:3852168_CalcCGSHEETS"])&&(zE[yi.WorksheetFuncId.SHEETS]=XS),Rn(gn["OfficeVSO:3852168_CalcCGROW"])&&(zE[yi.WorksheetFuncId.ROW]=JS),Rn(gn["OfficeVSO:3852168_CalcCGCOLUMN"])&&(zE[yi.WorksheetFuncId.COLUMN]=QS),Rn(gn["OfficeVSO:3852168_CalcCGSHEET"])&&(zE[yi.WorksheetFuncId.SHEET]=YS),Rn(gn["OfficeVSO:3852168_CalcCGOFFSET"])&&(zE[yi.WorksheetFuncId.OFFSET]=zS),Rn(gn["OfficeVSO:3852168_CalcCGEXACT"])&&(zE[yi.WorksheetFuncId.EXACT]=kS),Rn(gn["OfficeVSO:3852168_CalcCGREPT"])&&(zE[yi.WorksheetFuncId.REPT]=RS),Rn(gn["OfficeVSO:3852168_CalcCGTRIM"])&&(zE[yi.WorksheetFuncId.TRIM]=bS),Rn(gn["OfficeVSO:3852168_CalcCGCLEAN"])&&(zE[yi.WorksheetFuncId.CLEAN]=IS),Rn(gn["OfficeVSO:3852168_CalcCGCHAR"])&&(zE[yi.WorksheetFuncId.CHAR]=TS),Rn(gn["OfficeVSO:3852168_CalcCGUNICHAR"])&&(zE[yi.WorksheetFuncId.UNICHAR]=NS),Rn(gn["OfficeVSO:3852168_CalcCGCODE"])&&(zE[yi.WorksheetFuncId.CODE]=FS),Rn(gn["OfficeVSO:3852168_CalcCGUNICODE"])&&(zE[yi.WorksheetFuncId.UNICODE]=_S),Rn(gn["OfficeVSO:3852168_CalcCGLOWER"])&&(zE[yi.WorksheetFuncId.LOWER]=LS),Rn(gn["OfficeVSO:3852168_CalcCGUPPER"])&&(zE[yi.WorksheetFuncId.UPPER]=DS),Rn(gn["OfficeVSO:3852168_CalcCGPROPER"])&&(zE[yi.WorksheetFuncId.PROPER]=US),Rn(gn["OfficeVSO:3852168_CalcCGFIND"])&&(zE[yi.WorksheetFuncId.FIND]=xS),Rn(gn["OfficeVSO:3852168_CalcCGREPLACE"])&&(zE[yi.WorksheetFuncId.REPLACE]=PS),Rn(gn["OfficeVSO:3852168_CalcCGSEARCH"])&&(zE[yi.WorksheetFuncId.SEARCH]=GS),Rn(gn["OfficeVSO:3852168_CalcCGSUBSTITUTE"])&&(zE[yi.WorksheetFuncId.SUBSTITUTE]=VS),Rn(gn["OfficeVSO:3852168_CalcCGISFORMULA"])&&(zE[yi.WorksheetFuncId.ISFORMULA]=sS),Rn(gn["OfficeVSO:3852168_CalcCGFORMULATEXT"])&&(zE[yi.WorksheetFuncId.FORMULATEXT]=lS),Rn(gn["OfficeVSO:3852168_CalcCGINFO"])&&(zE[yi.WorksheetFuncId.INFO]=CE),Rn(gn["OfficeVSO:3852168_CalcCGDELTA"])&&(zE[yi.WorksheetFuncId.DELTA]=EE),Rn(gn["OfficeVSO:3852168_CalcCGGESTEP"])&&(zE[yi.WorksheetFuncId.GESTEP]=yE),Rn(gn["OfficeVSO:3852168_CalcCGTRANSPOSE"])&&(zE[yi.WorksheetFuncId.TRANSPOSE]=ZS),Rn(gn["OfficeVSO:3852168_CalcCGADDRESS"])&&(zE[yi.WorksheetFuncId.ADDRESS]=$S),Rn(gn["OfficeVSO:3852168_CalcCGINDIRECT"])&&(zE[yi.WorksheetFuncId.INDIRECT]=eE),Rn(gn["OfficeVSO:3852168_CalcCGTEXTJOIN"])&&(zE[yi.WorksheetFuncId.TEXTJOIN]=Gm),Rn(gn["OfficeVSO:3852168_CalcCGCHOOSE"])&&(zE[yi.WorksheetFuncId.CHOOSE]=aE),Rn(gn["OfficeVSO:3852168_CalcCGSQRTPI"])&&(zE[yi.WorksheetFuncId.SQRTPI]=iS),Rn(gn["OfficeVSO:3852168_CalcCGFACTDOUBLE"])&&(zE[yi.WorksheetFuncId.FACTDOUBLE]=aS),Rn(gn["OfficeVSO:3852168_CalcCGINT"])&&(zE[yi.WorksheetFuncId.INT]=LC),Rn(gn["OfficeVSO:3852168_CalcCGTRUNC"])&&(zE[yi.WorksheetFuncId.TRUNC]=UC,zE[yi.WorksheetFuncId.ROUNDDOWN]=PC),Rn(gn["OfficeVSO:3852168_CalcCGODD"])&&(zE[yi.WorksheetFuncId.ODD]=zC),Rn(gn["OfficeVSO:3852168_CalcCGMROUND"])&&(zE[yi.WorksheetFuncId.MROUND]=GC),Rn(gn["OfficeVSO:3852168_CalcCGQUOTIENT"])&&(zE[yi.WorksheetFuncId.QUOTIENT]=rS),Rn(gn["OfficeVSO:3852168_CalcCGFLOOR.MATH"])&&(zE[yi.WorksheetFuncId.FLOOR_MATH]=qC),Rn(gn["OfficeVSO:3852168_CalcCGFLOOR.PRECISE"])&&(zE[yi.WorksheetFuncId.FLOOR_PRECISE]=JC),Rn(gn["OfficeVSO:3852168_CalcCGCEILING.MATH"])&&(zE[yi.WorksheetFuncId.CEILING_MATH]=jC),Rn(gn["OfficeVSO:3852168_CalcCGCEILING.PRECISE"])&&(zE[yi.WorksheetFuncId.CEILING_PRECISE]=HC,zE[yi.WorksheetFuncId.ISO_CEILING]=HC)),Rn(gn.CalcFieldValueFunction)&&(zE[yi.WorksheetFuncId.FIELDVALUE]=WS,zE[yi.WorksheetFuncId._FV]=WS),Rn(gn.CalcRecordFunctions)&&(zE[yi.WorksheetFuncId.RECORD]=BS),Rn(gn.CalcFunFunctions)&&(zE[yi.WorksheetFuncId.ARITY]=RE,zE[yi.WorksheetFuncId.APPLY]=AE,zE[yi.WorksheetFuncId.ARRAYMAKE]=kE,zE[yi.WorksheetFuncId.ISFUN]=oS)),zE[e]}($E=ZE||(ZE={})).DerefOperKind=Eh,$E.machine=i;var ry={},ny=0;function ay(e){var t=ry[e];ry[e]=(void 0===t?0:t)+1,(ny+=1)%100==0&&(O.ULS.traceTag(595858520,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.common.hashUtils.logCollision: "+JSON.stringify(ry)+"."),ry={})}function iy(e){if(null==e)return"";var t,r=Bt(e.sheet.document);r===Xt?t="illegalDocument":t=(null==r.path?"":"p:"+r.path.toLocaleUpperCase()+",")+"n:"+r.name.toLocaleUpperCase();return t+",i:"+e.sheet.index+",r:"+e.range.row+",c:"+e.range.col}var oy=function(e){var t=e^e>>16;return t*=2246822507,t^=t>>13,t*=3266489909,t^=t>>16};function uy(e){var t,r=1;return r=31*(r=31*(r=31*(r=31*r+("number"==typeof(t=e.sheet.index)?oy(t):t.charCodeAt(0)))+oy(e.range.col))+oy(e.range.row))+oy(e.sheet.document.name.length),void 0!==e.sheet.document.path&&(r=31*r+oy(e.sheet.document.path.length)),r}function cy(e,t){return yt(e,t)}function sy(){return{map:{},keyToHash:uy,keyEquals:cy,nelements:0,add:function(e){var t=this.keyToHash(e);if(vr(this.map[t]))this.map[t]=[e],this.nelements+=1;else{for(var r=this.map[t],n=0;n<r.length;n+=1)if(this.keyEquals(e,r[n]))return;ay("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),r.push(e),this.nelements+=1}},contains:function(e){var t=this.keyToHash(e),r=this.map[t];if(vr(r))return!1;for(var n=0;n<r.length;n+=1)if(this.keyEquals(e,r[n]))return!0;return ay("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),!1},forEach:function(e){var t=this;Object.keys(this.map).forEach((function(r){t.map[+r].forEach((function(t){e(t)}))}))},size:function(){return this.nelements},remove:function(e){var t=this,r=this.keyToHash(e),n=this.map[r];if(vr(n))return!1;var a=[],i=!1;return n.forEach((function(r){t.keyEquals(e,r)?(t.nelements-=1,i=!0):a.push(r)})),this.map[r]=a,i||ay("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),i}}}var ly=function(){function e(e){this.valueCreationFunc=e}return e.prototype.getValue=function(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value},e.prototype.reset=function(){this.value=void 0},e}(),fy=Ai.createResolutionHandler,dy=Ai.createNameFinder,hy={};function py(e){Rn(gn.CalcLogStopWatch)&&(hy[e]=En(e))}function vy(e){if(Rn(gn.CalcLogStopWatch)){var t=hy[e];void 0!==t&&t.stop()}}function my(e,t){switch(t.ref.kind){case w.Error:e.errRefs+=1}}function gy(e,t,r,n){return fy((function(a){var i,o;dt(a.sheet)||(n.crossSheetRefs+=1),i=e.sheet.document,o=a.sheet.document,void 0===i&&void 0===o||void 0!==i&&void 0!==o&&Ct(i,o)||(n.crossDocRefs+=1),a.sheet.index!==e.sheet.index&&(n.crossSheetRefs+=1),a.range.rows===1<<20&&(n.columnRefs+=1),16384===a.range.cols&&(n.rowRefs+=1),vt(a)&&r.addDependency(a,e,t.maxRangeSize,n)}),(function(e){return my(n,e)}),(function(e,t){e.kind===xt.NotImplemented?my(n,t):n.errRefs+=1}))}function Cy(e,t){var r=t[e];return void 0===r&&(r=0),r}function Sy(){var e={columnRefs:0,crossDocRefs:0,crossSheetRefs:0,dependents:[],errRefs:0,functionsCount:hr(),largeRanges:0,nameRefs:0,operatorsCount:{},parserErrors:0,rowRefs:0,tableRefs:0,merge:function(t){e.columnRefs+=t.columnRefs,e.crossDocRefs+=t.crossDocRefs,e.crossSheetRefs+=t.crossSheetRefs,e.largeRanges+=t.largeRanges,e.nameRefs+=t.nameRefs,e.parserErrors+=t.parserErrors,e.rowRefs+=t.rowRefs,e.tableRefs+=t.tableRefs,e.errRefs+=t.errRefs,function(e,t){py("calc_ts_merge_sets");var r=sy();e.forEach((function(e){r.add(e)})),t.forEach((function(t){r.contains(t)||e.push(t)})),vy("calc_ts_merge_sets")}(e.dependents,t.dependents),Object.keys(t.functionsCount).forEach((function(r){var n=e.functionsCount[r];void 0===n&&(n=0),e.functionsCount[r]=n+t.functionsCount[r]})),Object.keys(t.operatorsCount).forEach((function(r){var n=Number(r),a=e.operatorsCount[n];void 0===a&&(a=0),e.operatorsCount[n]=a+t.operatorsCount[n]}))}};return e}function Ey(e){var t={_logger:e,_dependencyGraph:hr(),haveDependents:function(e){return void 0!==t._dependencyGraph[iy(e)]},directDependents:function(e){var r=[],n=t._dependencyGraph[iy(e)];return void 0!==n&&n.forEach((function(e){r.push(e)})),r},allDependents:function(e){return t.getDependents(e,!1)},rootDependents:function(e){return t.getDependents(e,!0)},reset:function(){t._dependencyGraph=hr()},add:function(e,r,n){var a=Object(P.a)({},e);a.getCurrentDocumentLoc=function(){return Bt(e.getCurrentDocumentLoc())};var i=Sy();if(null==n)return i;var o,u,c,s=function(e,t,r,n){var a=dy((function(a){var i=t.nameRefToSheetGridRange(e,a);return null==i||r.addDependency(i,e,t.maxRangeSize,n),i})),i=fy(dr,dr,(function(){}));return function(e,t){return i(e,a(t))}}(r,a,t,i),l=gy(r,a,t,i),f={originGridCell:ct(r.range),originSheet:ct(r.sheet),wrapCellReferences:!1},d=[];for(d.push(n.node);d.length>0;){var h=d.pop();if(null!=h)switch(h.kind){case U.Literal:break;case U.Array:h.nodes.map((function(e){return e.map((function(e){d.push(e)}))}));break;case U.App:if("object"==typeof h.head){var p=h.head;switch(p.kind){case U.Operator:i.operatorsCount[p.id]=(o=p.id,u=i.operatorsCount,c=void 0,void 0===(c=u[o])&&(c=0),c+1);break;case U.Name:i.functionsCount[p.whole]=Cy(p.whole,i.functionsCount)+1;break;default:d.push(p)}}h.args.map((function(e){d.push(e)}));break;case U.Paren:d.push(h.node);break;case U.Name:i.nameRefs+=1,s(void 0,a.resolver.resolveName(f,h.qualifier,h.whole));break;case U.CellRef:l(h,a.resolver.resolveCellRef(f,h.qualifier,h.ref));break;case U.Bad:i.parserErrors+=1;break;default:return k("calc.calc.recalcMapperImpl",h)}}return i},merge:function(e){t.mergeGraph(e.dependencyGraph())},dependencyGraph:function(){var e=Ey(t._logger);return e.mergeGraph(t._dependencyGraph),e._dependencyGraph},mergeGraph:function(e){py("calc_ts_merge_graph");var r=function(r){var n=t._dependencyGraph[r],a=e[r];void 0===n&&(n=[]);var i=n,o=sy();i.forEach((function(e){o.add(e)})),a.forEach((function(e){o.contains(e)||i.push(e)})),t._dependencyGraph[r]=i};for(var n in e)r(n);vy("calc_ts_merge_graph")},addDependency:function(e,r,n,a){if(mt(e)){var i=iy(e);t.updateDependency(i,r)&&a.dependents.push(e)}else if(Uf(e.range)>n)a.largeRanges+=1;else for(var o=e.range.row;o<e.range.row+e.range.rows;o+=1)for(var u=e.range.col;u<e.range.col+e.range.cols;u+=1){var c=ir(e.sheet,tr(o,u));t.addDependency(c,r,n,a)}},updateDependency:function(e,r){var n=t._dependencyGraph[e];return void 0===n&&(n=[]),!n.some((function(e){return yt(e,r)}))&&(n.push(r),t._dependencyGraph[e]=n,!0)},getDependents:function(e,r){py("calc_ts_get_dependents");for(var n=sy(),a=[],i=t.directDependents(e);i.length>0;){var o=i.shift();if(void 0!==o&&!n.contains(o)){n.add(o);var u=t.directDependents(o);u.length>0&&u.forEach((function(e){i.push(e)})),r&&0!==u.length||a.push(o)}}return a},stats:function(){var e=Object.keys(t._dependencyGraph);if(void 0===e||0===e.length)return yy(0,0);var r=e.length,n=0;return e.forEach((function(e){var r=t._dependencyGraph[e];n+=r.length})),yy(r,n)}};return t}function yy(e,t){return{nodes:e,arcs:t}}var Oy=Ai.createResolver,Ay=Ai.success;function ky(e){return A(e),Ey(e)}function Ry(e,t,r,n,a,i,o,u,c,s){return{maxRangeSize:e,nameRefs:t,rowRefs:r,columnRefs:n,crossSheetRefs:a,crossDocRefs:i,getCurrentDocumentLoc:o,getCurrentSheetIndex:u,getSheetIndex:c,nameRefToSheetGridRange:s,resolver:Oy({getSheetIndex:function(e,t){return Ay(c(e,t))},getDocumentLoc:o})}}var by=vi.LexicalKind,Iy=vi.gridCell,Ty=vi.documentLoc,Ny=Si.RefStyle,Fy=Ai.ResultKind,_y=Ai.failure;function My(e,t){return{}}function wy(e,t,r){return{config:e,mathpack:t,formatInfo:r}}function Ly(e){var t={globals:e,runtime:function(e){var t=e.config,r={config:t},n=Object(P.a)({config:t},e.formatInfo),a={config:t},i=Fs(r),o=Ih(n),u=hp(a);return{parser:i,analyzer:o,compiler:u}}(e),cache:hr(),lazyCreateCacheItem:function(e){var r,n=iy(e),a=t.cache[n];return void 0===a&&(a={cell:e,rawValue:r,formula:void 0,compiledFormula:void 0,evalResult:void 0,format:void 0},t.cache[n]=a),a},size:function(){var e=0;for(var r in t.cache)e+=1;return e},clear:function(){t.cache=hr()},cells:function(){var e=Object.keys(t.cache);return void 0===e||0===e.length?[]:e.map((function(e){return t.cache[e].cell}))},getItem:function(e){var r=iy(e);return t.cache[r]},getValue:function(e){var r=t.getItem(e);if(void 0!==r&&null!==r.rawValue)return r.rawValue},getFormula:function(e,r,n){var a=t.getItem(e);if(void 0!==a&&Dy(t.runtime,a,r,n)&&Uy(a.formula))return a.formula},getFormulaFormat:function(e){var r=t.getItem(e);if(void 0!==r)return r.format},getCompiledFormula:function(e,r){var n=t.getItem(e);if(void 0!==n&&function(e,t,r){if(Uy(t.compiledFormula))return!0;if(!Dy(e,t,r))return!1;if(void 0!==r&&r)return!1;t.compiledFormula=null;try{var n=e.compiler.compileFormula(xl(by.Cell,t.cell.range),t.formula);return n.kind===Fy.Success&&(t.compiledFormula=n.value,!0)}catch(e){return O.ULS.traceTag(595968586,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.calc.formulaCache.lazyCompileFormula: Exception "+C(e)),!1}}(t.runtime,n,r)&&Uy(n.compiledFormula))return n.compiledFormula},getEvalResult:function(e){var r=t.getItem(e);if(void 0!==r)return r.evalResult},isEqualValue:function(e,r){var n=t.getItem(e);return void 0!==n&&n.rawValue===r},updateCellValue:function(e,r,n,a,i){if(!t.isEqualValue(e,r)){var o=t.lazyCreateCacheItem(e);if(o.rawValue=r,o.formula=void 0,o.compiledFormula=void 0,o.evalResult=void 0,o.format=void 0,null!=n){var u=n.getValue(e);void 0!==u&&r===u&&(o.formula=n.getFormula(e,!0),o.compiledFormula=n.getCompiledFormula(e,!0),o.evalResult=void 0,o.format=o.format)}null!=i&&(o.format=i),null!=a&&a.forEach((function(e){var r=t.getItem(e);void 0!==r&&(r.evalResult=void 0)}))}},updateEvalResult:function(e,r,n){var a=t.lazyCreateCacheItem(e);a.evalResult=r,null!=n&&(a.format=n)},merge:function(e,r){e.cells().forEach((function(n){var a=e.getValue(n);void 0===a||!0!==r&&void 0!==t.getItem(n)||t.updateCellValue(n,a,e)}))},parseCompileNameFormula:function(e,r,n){var a=void 0===n?Ny.A1:n,i=Qt(sr(ur(Ty(void 0,"Doc")),"")),o=void 0!==r?Ot(r.range):Iy(0,0),u=t.runtime.parser.parseFormula(a,o,i.kind,e),c=C(e);if(u.kind!==Fy.Success){var s="calc.formulaCache.parseCompileNameFormula: couldn't parse "+c;return O.ULS.traceTag(595969230,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,s),_y(Wi(s))}var l=t.runtime.analyzer.checkFormula(Zs(o),u.value);if(ht(l))return t.runtime.compiler.compileFormula(xl(i.kind,o),l);var d="calc.formulaCache.parseCompileNameFormula: formula "+c+" is not well-formed.";return O.ULS.traceTag(595969231,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,d),_y(Bl(d))}};return t}function Dy(e,t,r,n){if(Uy(t.formula))return!0;if(!Uy(t.rawValue))return!1;if(void 0!==t.formula&&null===t.formula)return!1;if(void 0!==r&&r)return!1;t.formula=null;var a=t.rawValue;try{var i=e.parser.parseFormula(Si.RefStyle.A1,t.cell,by.Cell,a);if(i.kind!==Fy.Success)return!1;var o=e.analyzer.checkFormula(zs(by.Cell,t.cell.range),i.value,n);return!!o.isWellFormed&&(t.formula=o,Rn(gn.CalcFormatCalculations)&&(t.format=void 0),!0)}catch(e){return O.ULS.traceTag(595968585,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.calc.formulaCache.lazyParseFormula: Exception "+C(e)),!1}}function Uy(e){return null!=e}var xy=function(e,t){return{functionId:e,functionName:t}},Py=function(e,t){return{errorType:e,errorName:t}},Gy=function(e,t,r,n,a,i,o,u,c,s,l,f,d,h){var p=[];return t.forEach((function(e,t){"string"==typeof e?p.push(Py(t,e)):pr(e)&&p.push(e)})),{worksheetFunctionNames:e,errorTypeNames:p,errorNames:[],trueName:r,falseName:n,rowLetter:a,columnLetter:i,leftBrace:o,rightBrace:u,leftBracket:c,rightBracket:s,decimalSeparator:l,listSeparator:f,columnSeparator:d,rowSeparator:h}},Vy=function(e,t,r){return{iformat:e,category:t,decimals:r}},Wy=function(e,t){return{sheetId:e,sheetName:t}},By={kind:"Blank"},jy=function(e){return{kind:"Error",type:e}},Hy=function(e){return{kind:"Rich",fields:e}};function Ky(e){return"object"==typeof e?e.kind:typeof e}var qy=function(e,t){return{row:e,column:t}},Jy=function(e,t,r,n){return{row:e,column:t,lastRow:r,lastColumn:n}},Qy=function(e,t,r,n,a){return{sheetId:e,row:t,column:r,lastRow:n,lastColumn:a}},Xy=function(e,t,r,n,a){return void 0===a&&(a="Inferred"),{formulaBarText:e,value:t,iformat:r,failureReason:n,kind:a}};function Yy(e,t,r,n){return Xy(e,t,r,n,"CellFormula")}function zy(e,t,r){return Xy(void 0,e,t,r,"ArrayFormula")}function Zy(e,t,r,n){return Xy(e,t,r,n,"Value")}var $y=function(e,t,r,n,a){return{range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:a}},eO=function(e,t,r,n){return $y(e,t,void 0,r,n)};function tO(e,t,r,n){return $y(e,void 0,t,r,n)}var rO=function(e,t){return{isSpilled:e,formulaBarText:t}},nO=function(e,t,r){return{range:e,data:t,fromStateId:r}};function aO(e,t){return nO(e,t,void 0)}function iO(e,t){return nO(e,void 0,t)}var oO=function(e,t){return{sheetId:e,usedRange:t}},uO=function(e){return{kind:"NamedValue",value:e}},cO=function(e){return{kind:"NamedFormula",formulaBarText:e}},sO=function(e){return{kind:"NamedRange",range:e}},lO=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},fO=function(e,t){return{name:e,data:t}},dO=function(e,t,r){return{scope:e,objects:t,fromStateId:r}};function hO(e,t){return dO(e,t,void 0)}function pO(e){return dO(e,void 0,void 0)}function vO(e,t){return dO(e,void 0,t)}var mO=function(e,t,r,n,a,i){return void 0===i&&(i="Inferred"),{range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:a,kind:i}};function gO(e,t,r,n){return mO(e,t,void 0,r,n,"CellFormula")}function CO(e,t,r,n){return mO(e,t,r,void 0,n,"Value")}function SO(e,t,r,n){return mO(e,t,void 0,r,n,"Inferred")}var EO,yO,OO,AO,kO=function(e,t,r,n){return{range:e,formulaBarText:t,origin:r,viewport:n}},RO=function(e,t,r,n,a){return{isExact:e,iformat:t,hasHyperlink:r,category:n,decimals:a}},bO=function(e,t,r){return{formulaBarText:e,value:t,format:r}},IO=function(e,t){return{range:e,data:t}},TO=function(e,t){return{range:e,data:t}},NO=function(e,t,r){return{range:e,task:t,reason:r}},FO=function(e,t,r,n,a,i){return{stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:a,rangeFailures:[]}},_O=function(e,t,r){return{rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}},MO=function(e,t,r,n,a,i,o,u){return{totalEvalTimeMs:e,samplePrecisionRate:t,sampleRecalcStatisticsRate:u,sampleWorkbookStatisticsRate:n,rngSeed:r,sampleRecalcEditedStopwatchRate:a,sampleRecalcViewportStopwatchRate:i,sampleCellEvalStopwatchRate:o}};function wO(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}function LO(){var e;return[new Promise((function(t,r){return e=[t,r]})),e]}function DO(e,t){var r=LO(),n=r[0],a=r[1],i=a[0],o=a[1],u=setTimeout(t,Math.max(0,e));return[n,[function(e){clearTimeout(u),i(e)},function(e){clearTimeout(u),o(e)}]]}function UO(e,t,r){var n=DO(e,(function(){return s(t())})),a=n[0],i=n[1],o=i[0],u=i[1],c=!1;function s(e){u(e),c=!0}var l=Promise.resolve().then((function(e){return r(s,(function(){return c}))}));return wO(Promise.race([a,l]),o)}function xO(e,t){var r;return new Promise((function(n,a){Promise.resolve(t).then((function t(i){if(void 0!==i){r=i;try{Promise.resolve(e(r)).then(t,a)}catch(e){a(e)}}else n(r)}),a)}))}function PO(e,t){return{setMessageListeners:function(t){e.onmessage=function(e){return t.onMessage(e.data)},e.onmessageerror=function(e){return t.onMessageError(e.data)}},postMessage:e.postMessage.bind(e),close:t.bind(e)}}function GO(e){return null!=e&&(e instanceof Error||"string"==typeof e.name&&"string"==typeof e.message&&(void 0===e.stack||"string"==typeof e.stack))}!function(e){e.FunctionCall="FunctionCall",e.MessageChannel="MessageChannel",e.Dedicated="Dedicated"}(EO||(EO={})),function(e){e.PostCallError="PostCallError",e.PostNotifyError="PostNotifyError",e.PostResultError="PostResultError",e.UnhandledNotifyError="UnhandledNotifyError",e.UnhandledError="UnhandledError"}(yO||(yO={})),function(e){e.App="App",e.Result="Result",e.Close="Close"}(OO||(OO={})),function(e){e[e.Fulfilled=0]="Fulfilled",e[e.Rejected=1]="Rejected"}(AO||(AO={}));var VO,WO={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function BO(e){return[e.name,e.message,e.stack]}function jO(e){var t,r=e[0],n=e[1],a=e[2],i=WO[r];return null!=i?t=new i(n):(t=new Error(n)).name=r,void 0!==a&&(t.stack=a),t}function HO(e){return GO(e)?[VO.Error,BO(e)]:[VO.Unknown,e]}function KO(e,t,r,n){var a=new Error(e);return a.stack=e+"\n    at "+t+":"+r+":"+n,a}!function(e){e[e.Unknown=0]="Unknown",e[e.Error=1]="Error"}(VO||(VO={}));function qO(e){var t=e.message.indexOf("__START_ERROR__"),r=e.message.indexOf("__END_ERROR__");return t>=0&&r>=0?jO(JSON.parse(e.message.substring(t+"__START_ERROR__".length,r))):null!=e.error?e.error:KO(e.message,e.filename,e.lineno,e.colno)}function JO(e,t,r,n,a,i){var o={port:t,callbacks:{},lastAppId:-1,modules:{}};function u(){if(null==o)throw new Error("endpoint is closed");return o}function c(e,t,r){if(null!=o){var n=o.callbacks[e];null!=n&&(delete o.callbacks[e],n[t](r))}}function s(e,t,r,n,a){var i;try{i=u()}catch(e){return Promise.reject(e)}var o=i.lastAppId+1,c=[OO.App,o,e,t,r,a],s=DO(n,(function(){f(c,new Error("exceeded timeout; callTimeout = "+n+"ms"))})),l=s[0],d=s[1];i.callbacks[o]=d,i.lastAppId=o;try{i.port.postMessage(c)}catch(e){f(c,e)}return l}function l(e,t,r,n){var a=u(),i=[OO.App,-1,e,t,r,n];try{a.port.postMessage(i)}catch(e){f(i,e)}}function f(e,t){var r=e[1],n=e[5];null!=o&&(r>=0&&c(r,AO.Rejected,t),n?C(r>=0?yO.PostCallError:yO.PostNotifyError,t,!0):(r<0&&C(yO.PostNotifyError,t,!1),s("","",[],Math.max(S.callTimeout,S.initTimeout),!0).catch((function(e){}))))}function d(e){var t=e[1],r=e[2],n=e[3],a=e[4],i=e[5];if(null!=o)if(""!==r||""!==n){var u=Promise.resolve().then((function(e){if(null!=o){var t=r,i=n,u=o.modules[t],c=null!=u?u[i]:void 0;if(null==c)throw new Error("method "+t+"."+i+" has not been exported");return c.apply(u,a)}}));t>=0?u.then((function(e){return h(t,AO.Fulfilled,e,i)}),(function(e){return h(t,AO.Rejected,e,i)})):u.catch((function(e){C(yO.UnhandledNotifyError,function(e,t,r){var n=t+"."+r+".notify: ";if(GO(e))return e.message=n+e.message,null!=e.stack&&(e.stack=n+e.stack),e;var a=new Error(n+e);return a.stack=void 0,a}(e,r,n),!1)}))}else h(t,AO.Fulfilled,void 0,i)}function h(e,t,r,n){if(null!=o){var a=[OO.Result,e,t,HO(r),n];try{o.port.postMessage(a)}catch(e){p(a,e)}}}function p(e,t){var r=e[1],n=e[4];null!=o&&(n?C(yO.PostResultError,t,!0):h(r,AO.Rejected,HO(t),!0))}function m(e){var t=e[1],r=e[2],n=e[3];null!=o&&c(t,r,function(e){return e[0]===VO.Unknown?e[1]:jO(e[1])}(n))}function g(e){if(void 0===e&&(e=!0),null!=o){var t=o.port,r=o.callbacks;if(o=void 0,e)try{t.postMessage([OO.Close])}catch(e){}var n=new Error((e?"this":"other")+" endpoint closed while waiting for a response");for(var a in r)c(Number(a),AO.Rejected,n);try{t.close()}catch(e){}if(null!=i)try{i(S)}catch(n){var u=v(n);console.log("calc.worker.createPortEndpoint.close: unhandled error: "+u)}}}function C(e,t,r){if(null!=o){var n=void 0;try{a(S,{kind:e,closing:r,error:t})||(n=[t])}catch(t){n=[t]}if(r&&g(),null!=n){var i=v(n[0]);console.log("calc.worker.createPortEndpoint.dispatchError: unhandled error: "+i)}}}var S={workerKind:e,initTimeout:r,callTimeout:n,setExports:function(e,t){return u().modules[e]=t},getImports:function(e,t){var r={};return t.forEach((function(t){return r[t]=function(e,t){var r={callTimeout:void 0,isCritical:!1,call:function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var i=null!=r.callTimeout?r.callTimeout:S.callTimeout;return s(e,t,n,i,r.isCritical)},notify:function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];l(e,t,n,r.isCritical)}};return r}(e,t)})),r},close:g,dispatchError:C};return o.port.setMessageListeners({onMessage:function(e){switch(e[0]){case OO.App:return d(e);case OO.Result:return m(e);case OO.Close:return g(!1);default:return k("calc.worker.createPortEndpoint.onMessage",e)}},onMessageError:function(e){var t=new Error("failed to send "+e[0]+" message");switch(e[0]){case OO.App:return f(e,t);case OO.Result:return p(e,t);case OO.Close:return;default:return k("calc.worker.createPortEndpoint.onMessageError",e)}}}),S}function QO(e,t,r){var n=this,a=null!=t.initTimeout?t.initTimeout:6e4,i=null!=t.callTimeout?t.callTimeout:3e4;return UO(a,(function(){return new Error("exceeded timeout; initTimeout = "+a+"ms")}),(function(o,u){return Object(P.b)(n,void 0,void 0,(function(){function n(e){return function(t,r){return s?null!=e.onError&&(e.onError(t,r),!0):(o(r.error),!0)}}function c(e){return function(t){s&&null!=e.onClosed&&e.onClosed(t)}}var s,l,f;return Object(P.d)(this,(function(o){switch(o.label){case 0:return s=!1,l=JO(e,r.outside,a,i,n(t.outside),c(t.outside)),f=JO(e,r.inside,a,i,n(t.inside),c(t.inside)),u()||null==t.inside.onInit?[3,2]:[4,t.inside.onInit(f)];case 1:o.sent(),o.label=2;case 2:return u()||null==t.outside.onInit?[3,4]:[4,t.outside.onInit(l)];case 3:o.sent(),o.label=4;case 4:return s=!0,[2,l]}}))}))}))}function XO(){return"undefined"!=typeof MessageChannel}var YO=function(){function e(){this.other=void 0}return e.prototype.onMessage=function(e){return R("calc.worker.FunctionCallPort.onMessage: "+("expected onMessage to be set before receiving messages; received "+JSON.stringify(e)))},e.prototype.open=function(e){this.other=e,e.other=this},e.prototype.setMessageListeners=function(e){null!=this.other&&(this.onMessage=e.onMessage)},e.prototype.postMessage=function(e){null!=this.other&&this.other.onMessage(e)},e.prototype.close=function(){if(null!=this.other){var e=this.other;this.other=e.other=void 0,this.onMessage=e.onMessage=function(){}}},e}();var zO,ZO;function $O(){if(null==Ri.getCalcAbsUrl()){return O.ULS.traceTag(595907587,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.worker.isDedicatedWorkerSupported: initCalc was not passed calcAbsUrl"),!1}return"undefined"!=typeof Worker}function eA(e){setTimeout((function(){try{e.terminate()}catch(e){}}),100)}function tA(){var e={};for(var t in gn){var r=gn[t];null!=r&&(e[r]=Rn(r))}return e}var rA=((zO={})[EO.FunctionCall]=function(){return!0},zO[EO.MessageChannel]=XO,zO[EO.Dedicated]=$O,zO);function nA(e){return rA[e]()}var aA=((ZO={})[EO.FunctionCall]=function(e){return QO(EO.FunctionCall,e,(t=new YO,r=new YO,t.open(r),{outside:t,inside:r}));var t,r},ZO[EO.MessageChannel]=function(e){if(!XO())return R("calc.worker.createMessageChannelWorker: expected an execution context where message channel workers are supported");var t=function(){var e=new MessageChannel;return{outside:PO(e.port1,e.port1.close.bind(e.port1)),inside:PO(e.port2,e.port2.close.bind(e.port1))}}();try{return QO(EO.MessageChannel,e,t)}catch(e){try{t.outside.close()}catch(e){}throw e}},ZO[EO.Dedicated]=function(e){var t=this,r=e.outside,n=e.inside,a=e.initTimeout,i=e.callTimeout,o=n.scriptName;if(null==o)return R("calc.worker.createDedicatedWorker: expected workerDef.inside.scriptName to be defined");var u=Ri.getCalcAbsUrl();if(!$O()||null==u)return R("calc.worker.createDedicatedWorker: expected a context where dedicated workers are supported");var c=null!=a?a:6e4,s=null!=i?i:3e4;return UO(c,(function(){return new Error("exceeded timeout; initTimeout = "+c+"ms")}),(function(e,n){return yn("calc.worker.createDedicatedWorker (total)",(function(){return Object(P.b)(t,void 0,void 0,(function(){function t(t){return Object(P.b)(this,void 0,void 0,(function(){function a(t,n){return o?null!=r.onError&&(r.onError(t,n),!0):(e(n.error),!0)}function i(e){o&&null!=r.onClosed&&r.onClosed(e)}var o,l,f,d,h;return Object(P.d)(this,(function(e){switch(e.label){case 0:o=!1,e.label=1;case 1:return e.trys.push([1,6,,7]),l=new Worker(t),d=PO(l,(function(){return eA(l)})),f=JO(EO.Dedicated,d,c,s,a,i),l.onerror=function(e){var r;e.preventDefault(),r=null==e.message?new Error("worker.onerror received non-ErrorEvent (worker script fetch probably failed); url = "+t):qO(e),f.dispatchError(yO.UnhandledError,r,!o)},function(e,t){var r={shipAssertTag:function(e,r,n,a){try{t.ULS.shipAssertTag(e,r,n,a)}catch(e){}},assertTag:function(e,r,n,a){try{t.ULS.assertTag(e,r,n,a)}catch(e){}},traceTag:function(e,r,n,a){try{t.ULS.traceTag(e,r,n,a)}catch(e){}},debugTraceTag:function(e,r,n,a){try{t.ULS.debugTraceTag(e,r,n,a)}catch(e){}}};e.setExports("",r)}(f,O),n()?[3,3]:[4,yn("calc.worker.createDedicatedWorker (inside)",(function(){var e=f.getImports("",["init"]).init;return e.callTimeout=c,e.isCritical=!0,e.call({initTimeout:c,callTimeout:s,calcAbsUrl:u,features:tA()})}))];case 2:e.sent(),e.label=3;case 3:return n()||null==r.onInit?[3,5]:[4,r.onInit(f)];case 4:e.sent(),e.label=5;case 5:return o=!0,[2,f];case 6:throw h=e.sent(),null!=f?f.close():null!=l&&eA(l),h;case 7:return[2]}}))}))}var a,i,l,d;return Object(P.d)(this,(function(e){switch(e.label){case 0:n=o+(/\.min\.js$/.test(r=u)?".min.js":".js"),c=r.lastIndexOf("/"),a=r.substring(0,c+1)+n,i="calc.worker.createDedicatedWorker: workerUrl = "+a,O.ULS.traceTag(595907588,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,i),e.label=1;case 1:e.trys.push([1,6,,7]),l=new Blob(['importScripts("'+encodeURI(a)+'");'],{type:"application/javascript"}),d=URL.createObjectURL(l),e.label=2;case 2:return e.trys.push([2,,4,5]),[4,t(d)];case 3:return[2,e.sent()];case 4:return URL.revokeObjectURL(d),[7];case 5:return[3,7];case 6:return e.sent(),O.ULS.traceTag(595881991,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,"calc.worker.createDedicatedWorker: failed to start worker from blob url for "+a+". Attempting with string url instead..."),[2,t(a)];case 7:return[2]}var r,n,c}))}))}))}))},ZO);function iA(e,t){return aA[e](t)}function oA(e,t){return Object(P.b)(this,void 0,void 0,(function(){var r,n,a,i,o;return Object(P.d)(this,(function(u){switch(u.label){case 0:r=0,u.label=1;case 1:if(!(r<e.length))return[3,6];if(!nA(n=e[r]))return[3,5];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,iA(n,t)];case 3:return[2,u.sent()];case 4:return a=u.sent(),i=v(a),o="calc.worker.tryCreateWorker: starting "+n+" worker threw "+i,O.ULS.traceTag(595907598,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,o),[3,5];case 5:return r+=1,[3,1];case 6:return[2,void 0]}}))}))}function uA(){setTimeout((function(){try{self.close()}catch(e){}}),100)}function cA(e,t,r,n){var a=t.initTimeout,i=t.callTimeout,o=t.calcAbsUrl,u=t.features;return Object(P.b)(this,void 0,void 0,(function(){var t,c,s,l,f=this;return Object(P.d)(this,(function(d){switch(d.label){case 0:return function(){if("undefined"==typeof self||null!=self.document)throw new Error("not in a worker execution context")}(),[4,UO(a,(function(){return new Error("exceeded timeout; initTimeout = "+a+"ms")}),(function(e,t){return Object(P.b)(f,void 0,void 0,(function(){function c(t,r){return l?null!=n.onError&&(n.onError(t,r),!0):(e(r.error),!0)}function s(e){l&&null!=n.onClosed&&n.onClosed(e)}var l,f,d,h,p,v;return Object(P.d)(this,(function(e){switch(e.label){case 0:l=!1,e.label=1;case 1:return e.trys.push([1,4,,5]),d=PO(self,uA),f=JO(EO.Dedicated,d,a,i,c,s),h=function(e){var t=e.getImports("",["shipAssertTag","assertTag","traceTag","debugTraceTag"]);function r(e){return"["+(new Date).toISOString()+"] "+e}return{shipAssertTag:function(e,n,a,i){if(t.shipAssertTag.notify(e,n,a,r(i)),!a)throw new Error("shipAssertTag: "+e+" "+n+" "+i)},assertTag:function(e,n,a,i){if(t.assertTag.notify(e,n,a,r(i)),!a)throw new Error("assertTag: "+e+" "+n+" "+i)},traceTag:function(e,n,a,i){t.traceTag.notify(e,n,a,r(i))},debugTraceTag:function(e,n,a,i){t.debugTraceTag.notify(e,n,a,r(i))}}}(f),p=function(e){return!0===u[e]},r.config.initCalc(h,p,o),t()||null==n.onInit?[3,3]:[4,n.onInit(f)];case 2:e.sent(),e.label=3;case 3:return l=!0,[3,5];case 4:throw v=e.sent(),null!=f?f.close():uA(),v;case 5:return[2]}}))}))})).then((function(e){return[AO.Fulfilled,e]}),(function(e){return[AO.Rejected,e]}))];case 1:t=d.sent(),c=t[0],s=t[1],l=[OO.Result,e,c,HO(s),!0];try{self.postMessage(l)}catch(e){throw uA(),e}return[2]}}))}))}var sA=[{name:"self",test:function(){return"undefined"!=typeof self}},{name:"fetch",test:function(){return"function"==typeof fetch}},{name:"Set",test:function(){return"function"==typeof Set}},{name:"Map",test:function(){return"function"==typeof Map}},{name:"WeakMap",test:function(){return"function"==typeof WeakMap}},{name:"Symbol",test:function(){return"function"==typeof Symbol}},{name:"WebAssembly",test:function(){return"object"==typeof WebAssembly}},{name:"Atomics",test:function(){return"object"==typeof Atomics}},{name:"BigInt",test:function(){return"function"==typeof BigInt}},{name:"String.startsWith",test:function(){return"function"==typeof"".startsWith}},{name:"String.codePointAt",test:function(){return"function"==typeof"".codePointAt}},{name:"Object.assign",test:function(){return"function"==typeof Object.assign}},{name:"Object.setPrototypeOf",test:function(){return"function"==typeof Object.setPrototypeOf}},{name:"Number.EPSILON",test:function(){return"number"==typeof Number.EPSILON}},{name:"Number.isFinite",test:function(){return"function"==typeof Number.isFinite}},{name:"Number.parseInt",test:function(){return"function"==typeof Number.parseInt}},{name:"Math.acosh",test:function(){return"function"==typeof Math.acosh}},{name:"Math.hypot",test:function(){return"function"==typeof Math.hypot}},{name:"Math.log1p",test:function(){return"function"==typeof Math.log1p}},{name:"Math.trunc",test:function(){return"function"==typeof Math.trunc}},{name:"Promise.finally",test:function(){return"function"==typeof Promise.resolve().finally}},{name:"RegExp_flags",test:function(){return new RegExp("x","i")&&!0}},{name:"RegExp.flags",test:function(){return"string"==typeof/x/.flags}},{name:"Array.of",test:function(){return"function"==typeof Array.of}},{name:"Array.entries",test:function(){return"function"==typeof[].entries}},{name:"Array.find",test:function(){return"function"==typeof[].find}},{name:"performance",test:function(){return"object"==typeof performance}},{name:"performance.now",test:function(){return"function"==typeof performance.now}},{name:"performance.timeOrigin",test:function(){return"number"==typeof performance.timeOrigin}},{name:"performance.memory",test:function(){return"object"==typeof performance.memory}}];function lA(){return sA.map((function(e){var t=e.name,r=e.test;try{return r()?"":t}catch(e){return t}})).filter((function(e){return e.length>0}))}function fA(){var e="object"==typeof performance?performance.memory:void 0;return null!=e?{jsHeapSizeLimit:e.jsHeapSizeLimit,totalJSHeapSize:e.totalJSHeapSize,usedJSHeapSize:e.usedJSHeapSize}:void 0}var dA=function(e){var t=e.config,r=e.connection;"Thread"===r.createMode&&Cn.setConfig(t);var n=[];return Cn.Endpoint.createInside(r,(function(){return{startMemoryTest:function(e){var t=fA(),r=0;try{for(;r<e;r+=1){var a=new Uint8Array(1024);a[0]=0,a[1023]=255,n.push(a)}}catch(e){}return[t,r,fA()]},endMemorytest:function(){n=[]},ping:function(e){return e+1},getMissingJSFeatures:lA}}))},hA=!1,pA=void 0;function vA(){null!=pA&&pA.close(),hA=!1}var mA=Promise.resolve();function gA(e,t,r,n){return void 0===n&&(n=0),Rn(gn.CalcWebWorkerTest)?(vA(),mA=mA.then((function(r){return function(e,t,r,n){return Object(P.b)(this,void 0,void 0,(function(){var r,a,i,o,u,c,s,l,d,h,p,v,m,g,C,S,E=this;return Object(P.d)(this,(function(y){switch(y.label){case 0:hA=!0,y.label=1;case 1:if(y.trys.push([1,8,9,10]),S="calc.twSmokeTest.runSmokeTest: starting; duration = "+e+" ms, pingInterval = "+t+" ms",O.ULS.traceTag(593335264,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,S),null==(r=ga()))throw new Error("initCalc was not passed calcAbsUrl");return[4,Cn.createWorker({id:"SmokeTest",createMode:"ThreadOrLocal"},{local:dA,thread:{scriptUrl:r,insideInitName:"excelOnlineCalc.worker.smokeTestInsideInit"}})];case 2:if(pA=y.sent(),!hA)throw a="smoke test canceled during worker creation",O.ULS.traceTag(593335265,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a),new Error(a);return S="calc.twSmokeTest.runSmokeTest: worker created; outside.createMode = "+pA.createMode,O.ULS.traceTag(593335266,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,S),[4,pA.call.ping(-1)];case 3:if(0!==(i=y.sent()))throw new Error("expected 0; got "+i);return n>0&&"Thread"===pA.createMode?(o=fA(),[4,pA.call.startMemoryTest(n)]):[3,5];case 4:u=y.sent(),c=u[0],s=u[1],l=u[2],d=fA(),h={startMain:o,startThread:c,kb:s,endThread:l,endMain:d},p="calc.twSmokeTest.runSmokeTest: memory = "+JSON.stringify(h),O.ULS.traceTag(592488325,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,p),pA.post.endMemorytest(),y.label=5;case 5:return m={main:lA()},[4,pA.call.getMissingJSFeatures()];case 6:return m.worker=y.sent(),v=m,S="calc.twSmokeTest.runSmokeTest: missing = "+JSON.stringify(v),O.ULS.traceTag(593335267,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,S),g=Date.now(),[4,xO((function(r){return Object(P.b)(E,void 0,void 0,(function(){var n;return Object(P.d)(this,(function(a){switch(a.label){case 0:return Date.now()>=g+e||!pA||pA.hasBeenClosed()?[2,void 0]:r%1e3!=0?[3,2]:(n=En("calc.twSmokeTest.runSmokeTest: ping call roundtrip"),[4,pA.call.ping(r)]);case 1:a.sent(),n.stop(),a.label=2;case 2:return[4,new Promise((function(e){return setTimeout((function(){return e()}),t)}))];case 3:return a.sent(),pA.post.ping(r),[2,r+1]}}))}))}),0)];case 7:return y.sent(),S="calc.twSmokeTest.runSmokeTest: success",O.ULS.traceTag(593335296,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,S),[3,10];case 8:return C=y.sent(),hA&&(S="calc.twSmokeTest.runSmokeTest: failure: "+C.message,O.ULS.traceTag(593335297,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,S)),[3,10];case 9:return vA(),pA=void 0,[7];case 10:return[2]}}))}))}(e,t,0,n)}))):Promise.resolve()}var CA={onError:function(e,t){var r=null!=t.error.stack?t.error.stack:t.error.message,n="calc.worker.smokeTestInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:r});O.ULS.traceTag(595908699,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Error,n)},onClosed:function(e){},onInit:function(e){var t=e.getImports("talk",["ping"]);e.setExports("location",vi),e.setExports("talk",{start:function(e,r,n){return Object(P.b)(this,void 0,void 0,(function(){var a,i=this;return Object(P.d)(this,(function(o){switch(o.label){case 0:return a=Date.now(),[4,xO((function(o){return Object(P.b)(i,void 0,void 0,(function(){return Object(P.d)(this,(function(i){switch(i.label){case 0:return Date.now()>=a+e?[2,void 0]:[4,new Promise((function(e){return setTimeout((function(){return e()}),r)}))];case 1:return i.sent(),t.ping.notify(o,n),[2,o+1]}}))}))}),0)];case 1:return o.sent(),[2]}}))}))},memoryTest:function(e){var t=[],r=0;try{for(;r<e;r+=1){var n=new Uint8Array(1024);n[0]=0,n[1023]=255,t.push(n)}}catch(e){}t=[];var a="calc.worker.smokeTestInsideDef.memoryTest: memory allocated = "+r+"KB";O.ULS.traceTag(595906820,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a)},ping:function(e,t){if(t&&e%1e3==0){var r="calc.worker.smokeTestInsideDef.ping: n = "+e;O.ULS.traceTag(595907656,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,r)}return e+1},logMessage:function(e,t){if(t){var r="calc.worker.smokeTestInsideDef.logMessage: msg = "+e;O.ULS.traceTag(595714188,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,r)}}})},scriptName:"excelOnlineCalcSmokeTest.worker"};function SA(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return[Cr(r,a),Sr(n,i)]}function EA(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return[Sr(r,a),Cr(n,i)]}function yA(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return Sr(r,a)<Cr(n,i)}function OA(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r<a&&i>=n?[r,a]:r>=a&&i<n?[i,n]:void 0}function AA(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r===a&&n===i?0:r>=a&&n<=i?-1:r<=a&&n>=i?1:void 0}var kA,RA=P.a;function bA(e){var t,r,n,a=Object(P.a)(Object(P.a)({},e),{split:(t=e.split,r=e.top,void 0===n&&(n=10),function(e){if(void 0!==e.split)return e.split;var a=t(e),i=e===r?0:e.depth;return void 0!==i&&i<n&&(e.split=a,a[0][0].depth=i+1,a[1][0].depth=i+1),a})});return function(e){return IA(a,WA(a,a.top,e))}}function IA(e,t){return t===GA||t===PA?t:{setOperations:e,root:t}}function TA(e,t){return t===GA?e:t===PA||e===GA?t:e===PA?e:IA(e.setOperations,NA(e.setOperations,e.setOperations.top,e.root,t.root))}function NA(e,t,r,n){if(n===GA)return r;if(n===PA)return n;if(r===GA)return n;if(r===PA)return r;if(r.isExact&&n.isExact){var a=function(e,t,r,n){var a=r.key,i=n.key,o=e.compare(a,i);if(void 0!==o)return o<0?n:r;var u=e.union(a,i);if(void 0!==u){var c=e.compare(u,t);return void 0!==c&&0===c?PA:BA(e,t,u,!0)}return}(e,t,r,n);if(void 0!==a)return a}var i=jA(e,t,r),o=jA(e,t,n),u=e.split(t),c=u[0][0],s=u[1][0];return xA(e,c,s,NA(e,c,i.left,o.left),NA(e,s,i.right,o.right))}function FA(e,t){return e===GA?e:t===GA||e===PA?t:t===PA?e:IA(e.setOperations,_A(e.setOperations,e.setOperations.top,e.root,t.root))}function _A(e,t,r,n){if(r===GA)return r;if(n===GA)return n;if(r===PA)return n;if(n===PA)return r;if(r.isExact&&n.isExact){var a=function(e,t,r,n){var a=r.key,i=n.key;if(!e.meets(a,i))return GA;var o=e.compare(a,i);if(void 0!==o)return o<0?r:n;var u=e.intersect(a,i);if(void 0!==u)return BA(e,t,u,!0);return}(e,t,r,n);if(void 0!==a)return a}var i=jA(e,t,r),o=jA(e,t,n),u=e.split(t),c=u[0][0],s=u[1][0];return xA(e,c,s,_A(e,c,i.left,o.left),_A(e,s,i.right,o.right))}function MA(e,t,r,n){if(r===GA||n===GA)return!1;if(r===PA||n===PA)return!0;if(r.isExact&&n.isExact)return e.meets(r.key,n.key);var a=jA(e,t,r),i=jA(e,t,n),o=e.split(t),u=o[0][0],c=o[1][0];return MA(e,u,a.left,i.left)||MA(e,c,a.right,i.right)}function wA(e,t){return e===GA||t===GA?e:t===PA?GA:e===PA?IA(t.setOperations,LA(t.setOperations,t.setOperations.top,e,t.root)):IA(e.setOperations,LA(e.setOperations,e.setOperations.top,e.root,t.root))}function LA(e,t,r,n){if(r===GA)return r;if(n===GA)return r;if(n===PA)return GA;if(r===PA){var a=jA(e,t,n),i=e.split(t),o=i[0][0],u=i[1][0];return xA(e,o,u,LA(e,o,PA,a.left),LA(e,u,PA,a.right))}if(r.isExact&&n.isExact){var c=function(e,t,r,n){var a=r.key,i=n.key;if(!e.meets(a,i))return r;var o=e.except(a,i);if(void 0!==o)return BA(e,t,o,!0);return}(e,t,r,n);if(void 0!==c)return c}var s=jA(e,t,r),l=jA(e,t,n),f=e.split(t),d=f[0][0],h=f[1][0];return xA(e,d,h,LA(e,d,s.left,l.left),LA(e,h,s.right,l.right))}function DA(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function UA(e,t,r,n){if(r===n)return 0;if(r===GA)return-1;if(n===GA)return 1;if(r===PA)return n===PA?0:1;if(n===PA)return-1;if(r.isExact&&n.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,r,n);var a=jA(e,t,r),i=jA(e,t,n),o=e.split(t),u=o[0][0],c=o[1][0],s=UA(e,u,a.left,i.left);if(void 0!==s){var l=UA(e,c,a.right,i.right);if(void 0!==l)return DA(s,l)}}function xA(e,t,r,n,a){return n===GA?a===GA?GA:a===PA?VA(n,a,void 0,!1,e.infimum(r,r),e.supremum(r,r)):VA(n,a,void 0,!1,a.infimum,a.supremum):a===GA?n===PA?VA(n,a,void 0,!1,e.infimum(t,t),e.supremum(t,t)):VA(n,a,void 0,!1,n.infimum,n.supremum):n===PA?a===PA?PA:VA(n,a,void 0,!1,e.combineInfima(e.infimum(t,t),a.infimum),e.combineSuprema(e.supremum(t,t),a.supremum)):a===PA?VA(n,a,void 0,!1,e.combineInfima(n.infimum,e.infimum(r,r)),e.combineSuprema(n.supremum,e.supremum(r,r))):VA(n,a,void 0,!1,e.combineInfima(n.infimum,a.infimum),e.combineSuprema(n.supremum,a.supremum))}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(kA||(kA={}));var PA=kA.Dense,GA=kA.Empty;function VA(e,t,r,n,a,i){return{key:r,left:e,right:t,isExact:n,infimum:a,supremum:i}}function WA(e,t,r){if(!e.meets(t,r))return GA;var n=e.compare(t,r);if(void 0!==n)return n<=0?PA:BA(e,t,r,!0);var a=e.intersect(t,r);return void 0!==a?BA(e,t,a,!0):BA(e,t,r,!1)}function BA(e,t,r,n){return VA(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function jA(e,t,r){if(void 0!==r.left)return r;var n=e.split(t),a=n[0][0],i=n[1][0],o=xA(e,a,i,WA(e,a,r.key),WA(e,i,r.key));if(o===GA||o===PA)throw new Error("incorrect set operations implementation");var u=o;return RA(r,{left:u.left,right:u.right})}function HA(e){return e===GA||e===PA?0:function e(t){if(void 0===t||t===GA||t===PA)return 0;return e(t.left)+e(t.right)+1}(e.root)}function KA(e,t){return e===GA||function(e,t,r){return function t(n,a){if(a===GA)return!0;if(a===PA)return r(n);if(a.isExact)return r(a.key);var i=jA(e,n,a),o=e.split(n),u=o[0][0],c=o[1][0];return t(u,i.left)&&t(c,i.right)}(e.top,t)}(e.setOperations,e.root,t)}function qA(e,t,r){var n=function(e,t,r){var n=Math.pow(t,e),a=1-Math.pow(t/r,e),i=Math.pow(r,e),o=i*n,u=i-n,c=-1/e;return{cdf:1===e?function(e){return(1-n/e)/a}:function(t){return(1-n*Math.pow(t,-e))/a},invCdf:1===e?function(e){return 1/((i-e*u)/o)}:function(e){return Math.pow((i-e*u)/o,c)}}}(e,t,r);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],r=e[1],a=n.cdf(r),i=n.cdf(t+1),o=n.invCdf((a+i)/2),u=Math.min(Math.max(Math.round(o),t+1),r-1);return[[[t,u],n.cdf(u)-n.cdf(t+1)],[[u,r],n.cdf(r)-n.cdf(u)]]}}}function JA(e,t,r,n,a){var i=qA(e,t,r);return{id:a,split:function(e){return i.split(e)},canSplit:function(e){return i.canSplit(e)},meets:yA,intersect:EA,union:function(e,t){return n=t,a=(r=e)[0],i=r[1],o=n[0],u=n[1],Sr(a,o)<=Cr(i,u)?SA(e,t):void 0;var r,n,a,i,o,u},except:OA,compare:AA,top:n,infimum:function(e){return e[0]},supremum:function(e){return e[1]},combineInfima:function(e,t){return Cr(e,t)},combineSuprema:function(e,t){return Sr(e,t)}}}var QA={},XA=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];t.push([a,e[a].id])}var i=JSON.stringify(t.sort()),o=QA[i];return void 0===o&&(o={box:{},probabilities:{},depth:1},QA[i]=o),o};function YA(e){for(var t=!0,r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];if(Object.prototype.hasOwnProperty.call(e,a)){t=!1;break}}return t?PA:{isSubspace:!0,bounds:e}}function zA(e){return e.isSubspace?1:e.subspaceCount}var ZA=function(e,t,r){return{isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:zA(e)+zA(t)}};function $A(e,t){if(t===PA)return t;if(t.isSubspace){for(var r=!1,n=0,a=Object.keys(t.bounds);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){r=!0;break}}if(!r)return PA}return{productOperations:e,root:t}}function ek(e){return void 0===e?PA:e}var tk={unzip:function(e){for(var t={},r={},n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){var o=e[i];if(o===GA)return GA;if(o===PA)continue;t[i]=o.setOperations,r[i]=o.root}}return $A(t,YA(r))},combineProduct:function(e,t,r,n){for(var a={},i=0,o=Object.keys(e);i<o.length;i++){var u=o[i];if(Object.prototype.hasOwnProperty.call(e,u)){var c=n(e[u],e[u].top,ek(t[u]),ek(r[u]));if(c===GA)return c;if(c===PA)continue;a[u]=c}}return a},restrict:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n={},a=0,i=t;a<i.length;a++){var o=i[a];if(Object.prototype.hasOwnProperty.call(e,o)){var u=e[o];n[o]=u}}return n},fromUntypedProduct:function(e,t,r){for(var n={},a=0,i=r;a<i.length;a++){var o=i[a],u=t[o];n[o]=IA(e[o],void 0!==u?u:PA)}return n},denseProduct:function(e){for(var t={},r=0,n=e;r<n.length;r++){t[n[r]]=PA}return t}},rk=tk.unzip.bind(tk);function nk(e,t,r){var n=tk.combineProduct(e,t,r,NA);if(n===GA)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function ak(e,t,r){for(var n=0,a=0,i=Object.keys(e);a<i.length;a++){var o=i[a];if(Object.prototype.hasOwnProperty.call(e,o)){var u=ek(t[o]),c=ek(r[o]),s=e[o];if(void 0===(n=DA(n,UA(s,s.top,u,c))))return}}return n}var ik,ok=(ik={},function(e,t,r){var n;if(t===ik.left&&r===ik.right)return ik.res;ik.left=t,ik.right=r;var a,i=ak(e,t.bounds,r.bounds);if(void 0!==i)return ik.res=i<=0?r:t;for(var o=0,u=Object.keys(e);o<u.length;o++){var c=u[o];if(Object.prototype.hasOwnProperty.call(e,c)&&0!==UA(e[c],e[c].top,ek(t.bounds[c]),ek(r.bounds[c]))){if(void 0!==a)return ik.res=void 0;a=c}}if(void 0!==a){var s=NA(e[a],e[a].top,ek(t.bounds[a]),ek(r.bounds[a]));if(s===GA)return ik.res=GA;if(s===PA){var l=t.bounds,f=a,d=(l[f],Object(P.e)(l,["symbol"==typeof f?f:f+""]));return ik.res=YA(d)}var h=Object(P.a)(Object(P.a)({},t.bounds),((n={})[a]=s,n));return ik.res=YA(h)}return ik.res=void 0});function uk(e,t,r){if(r===GA)return t;if(r===PA)return r;if(t===GA)return r;if(t===PA)return t;if(!t.isSubspace||!r.isSubspace)return ZA(t,r,nk(e,t.bounds,r.bounds));var n=ok(e,t,r);return void 0!==n?n:ZA(t,r,nk(e,t.bounds,r.bounds))}function ck(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=tk.restrict.apply(tk,Object(P.f)([t.bounds],r));if(t.isSubspace)return YA(a);var i=ck.apply(void 0,Object(P.f)([e,t.left],r));if(i===PA)return PA;var o=ck.apply(void 0,Object(P.f)([e,t.right],r));return uk(e,i,o)}function sk(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===PA||e===GA)return e;var n=tk.restrict.apply(tk,Object(P.f)([e.productOperations],t)),a=ck.apply(void 0,Object(P.f)([n,e.root],t));return a===GA?a:$A(n,a)}function lk(e,t){var r,n,a,i;if(void 0!==t.children)return t.children;for(var o,u,c=t.box,s=t.probabilities,l=0,f=0,d=Object.keys(e);f<d.length;f++){var h=d[f];if(Object.prototype.hasOwnProperty.call(e,h)){var p=s[h],v=e[h];if(void 0===p){o=h,u=v.top;break}if(p>l){var m=ek(c[h]);if(m===GA)throw new Error("the key split can never return empty");var g=v.top;if(m!==PA){if(!m.isExact)throw new Error("the key can always be represented exactly");g=m.key}if(!v.canSplit(g))continue;o=h,l=p,u=g}}}if(void 0===o||void 0===u)throw new Error("there has to be at least one dimension");var C=e[o],S=C.split(u),E=S[0],y=E[0],O=E[1],A=S[1],k=A[0],R=A[1],b=[{box:Object(P.a)(Object(P.a)({},c),(r={},r[o]=WA(C,C.top,y),r)),probabilities:Object(P.a)(Object(P.a)({},s),(n={},n[o]=O,n)),depth:t.depth+1},{box:Object(P.a)(Object(P.a)({},c),(a={},a[o]=WA(C,C.top,k),a)),probabilities:Object(P.a)(Object(P.a)({},s),(i={},i[o]=R,i)),depth:t.depth+1}];return t.depth<10&&(t.children=b),b}var fk=function(e,t,r,n){return function e(t,r,n,a){if(r===GA)return[GA,GA];if(r===PA)return[YA(n),YA(a)];var i=ak(t,r.bounds,n);if(void 0!==i&&i<=0)return[r,GA];var o=tk.combineProduct(t,r.bounds,n,_A);if(o===GA)return[GA,r];var u=tk.combineProduct(t,r.bounds,a,_A);if(r.isSubspace)return[YA(o),u===GA?GA:YA(u)];var c=e(t,r.left,n,a),s=c[0],l=c[1],f=e(t,r.right,n,a),d=f[0],h=f[1];return[uk(t,s,d),uk(t,l,h)]}(e,t,r.box,n.box)};function dk(e,t,r,n,a){var i=lk(e,n),o=i[0],u=i[1],c=fk(e,t,o,u),s=c[0],l=c[1],f=fk(e,r,o,u),d=f[0],h=f[1],p=a(e,s,d,o);return p===PA?PA:uk(e,p,a(e,l,h,u))}function hk(e,t,r,n){if(r===GA)return t;if(t===GA)return r;if(t===PA)return t;if(r===PA)return r;if(t.isSubspace&&r.isSubspace){var a=ok(e,t,r);if(void 0!==a)return a}return dk(e,t,r,n,hk)}function pk(e,t){if(t===GA)return e;if(t===PA)return t;if(e===GA)return t;if(e===PA)return e;var r=Object(P.a)(Object(P.a)({},e.productOperations),t.productOperations),n=hk(r,e.root,t.root,XA(r));return n===GA?n:$A(r,n)}function vk(e,t,r,n){if(t===GA||r===GA)return GA;if(t===PA)return r;if(r===PA)return t;if(t.isSubspace&&r.isSubspace){var a=tk.combineProduct(e,t.bounds,r.bounds,_A);return a===GA?GA:YA(a)}return dk(e,t,r,n,vk)}function mk(e,t){if(e===GA)return e;if(t===GA)return t;if(e===PA)return t;if(t===PA)return e;var r=Object(P.a)(Object(P.a)({},e.productOperations),t.productOperations),n=vk(r,e.root,t.root,XA(r));return n===GA?n:$A(r,n)}function gk(e,t,r,n){if(t===GA)return t;if(r===PA)return GA;if(r===GA)return t;if(t===PA)return dk(e,t,r,n,gk);if(t.isSubspace&&r.isSubspace){var a=function(e,t,r){var n,a,i=ak(e,t.bounds,r.bounds);if(0===i||-1===i)return GA;for(var o=0,u=Object.keys(e);o<u.length;o++){var c=u[o];if(Object.prototype.hasOwnProperty.call(e,c)){var s=UA(e[c],e[c].top,ek(t.bounds[c]),ek(r.bounds[c]));if(void 0===s||s>0){if(void 0!==a)return;a=c}}}if(void 0!==a){var l=LA(e[a],e[a].top,ek(t.bounds[a]),ek(r.bounds[a]));if(l===GA)return GA;if(l===PA){var f=t.bounds,d=a;f[d];return YA(Object(P.e)(f,["symbol"==typeof d?d:d+""]))}return YA(Object(P.a)(Object(P.a)({},t.bounds),((n={})[a]=l,n)))}}(e,t,r);if(void 0!==a)return a}return dk(e,t,r,n,gk)}function Ck(e,t){if(e===GA)return e;if(t===GA)return e;if(t===PA)return GA;if(e===PA){var r=gk(t.productOperations,PA,t.root,XA(t.productOperations));return r===GA?r:$A(t.productOperations,r)}var n=Object(P.a)(Object(P.a)({},e.productOperations),t.productOperations),a=gk(n,e.root,t.root,XA(n));return a===GA?a:$A(n,a)}function Sk(e,t){if(e===t)return 0;if(e===GA)return-1;if(t===GA)return 1;if(e===PA)return t===PA?0:1;if(t===PA)return-1;var r=Object(P.a)(Object(P.a)({},e.productOperations),t.productOperations);return function e(t,r,n,a){if(r===n)return 0;if(r===GA)return-1;if(n===GA)return 1;if(r===PA)return n===PA?0:1;if(n===PA)return-1;if(r.isSubspace&&n.isSubspace)return ak(t,r.bounds,n.bounds);var i=lk(t,a),o=i[0],u=i[1],c=fk(t,r,o,u),s=c[0],l=c[1],f=fk(t,n,o,u),d=f[0],h=f[1],p=e(t,s,d,o);return void 0!==p?DA(p,e(t,l,h,u)):void 0}(r,e.root,t.root,XA(r))}function Ek(e,t,r,n){if(t===GA||r===GA)return!1;if(t===PA||r===PA)return!0;if(!function(e,t,r){for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){var o=ek(t[i]),u=ek(r[i]),c=e[i];if(!MA(c,c.top,o,u))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;var a=lk(e,n),i=a[0],o=a[1],u=fk(e,t,i,o),c=u[0],s=u[1],l=fk(e,r,i,o),f=l[0],d=l[1];return Ek(e,c,f,i)||Ek(e,s,d,o)}function yk(e,t){if(e===GA||t===GA)return!1;if(e===PA||t===PA)return!0;var r=Object(P.a)(Object(P.a)({},e.productOperations),t.productOperations);return Ek(r,e.root,t.root,XA(r))}var Ok;function Ak(e){return e===GA||e===PA?0:zA(e.root)}!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(Ok||(Ok={}));var kk=[Ok.AvailableSet,Ok.AvailableRead+1],Rk=[0,1<<20],bk=[0,16384],Ik={availability:JA(1,kk[0]+1,kk[1],kk,"Availability operations, alpha = 1"),row:JA(.2,Rk[0]+1,Rk[1],Rk,"Row operations, alpha = 0.2"),col:JA(.35,bk[0]+1,bk[1],bk,"Col operations, alpha = 0.35")},Tk={availability:bA(Ik.availability),row:bA(Ik.row),col:bA(Ik.col)};function Nk(e){return rk({row:Tk.row([e.row,e.row+e.rows]),col:Tk.col([e.col,e.col+e.cols])})}function Fk(e){if(e!==GA){var t,r,n=e===PA?void 0:e.root.bounds.row,a=e===PA?void 0:e.root.bounds.col,i=void 0===n?Ik.row.top:(t=IA(Ik.row,n),r=[],Lk(t,(function(e){return r.push(e),!0})),r.reduce(SA)),o=i[0],u=i[1],c=void 0===a?Ik.col.top:function(e){var t=[];return Dk(e,(function(e){return t.push(e),!0})),t.reduce(SA)}(IA(Ik.col,a)),s=c[0];return er(o,s,u-o,c[1]-s)}}var _k=rk({availability:Tk.availability([Ok.AvailableSet,Ok.AvailableSet+1])}),Mk=rk({availability:Tk.availability([Ok.AvailableRead,Ok.AvailableRead+1])}),wk=rk({availability:Tk.availability([Ok.AvailableSet,Ok.AvailableRead+1])});function Lk(e,t){return e!==PA?KA(e,t):t(Ik.row.top)}function Dk(e,t){return e!==PA?KA(e,t):t(Ik.col.top)}function Uk(e,t){return function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=sk.apply(void 0,Object(P.f)([e],r));if(a===GA)return!0;if(a===PA)return t(tk.denseProduct(r));var i=a.productOperations,o=a.root;function u(e){return e.isSubspace?t(tk.fromUntypedProduct(i,e.bounds,r)):u(e.left)&&u(e.right)}return u(o)}(e,(function(e){return Lk(e.row,(function(r){var n=r[0],a=r[1];return Dk(e.col,(function(e){var r=e[0],i=e[1];return t(er(n,r,a-n,i-r))}))}))}),"row","col")}function xk(e,t){return Uk(e,(function(e){return gt(e,t)}))}var Pk,Gk,Vk=function(){function e(e){this.items=[],this.cmp=e}return e.prototype.insert=function(e){this.items.push(e);for(var t=this.getCount()-1;t>0;){var r=t-1>>>1,n=this.items[r];if(!(this.cmp(n,e)>0))break;this.items[t]=n,t=r}this.items[t]=e},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var e=this.peek(),t=this.items.pop(),r=this.getCount()-1;if(r<0||void 0===t)return e;var n=0;for(this.items[0]=t;n<r;){var a=n,i=1+(n<<1),o=2+(n<<1);if(i<=r&&this.cmp(this.items[i],t)<0&&(a=i),o<=r&&this.cmp(this.items[o],a===i?this.items[a]:t)<0&&(a=o),n===a)break;this.items[n]=this.items[a],n=a}return this.items[n]=t,e},e.prototype.getCount=function(){return this.items.length},e.prototype.forEach=function(e){for(var t=0,r=this.items;t<r.length;t++){if(!e(r[t]))return}},e}(),Wk=function(){function e(e){this.min=0,this.max=0,this.heap=new Vk((function(t,r){var n=t[0],a=t[1],i=r[0],o=r[1],u=e(n,i);return 0!==u?u:a-o}))}return e.prototype.peek=function(){var e=this.heap.peek();if(void 0!==e)return e[0]},e.prototype.enqueue=function(e){this.max+=1,this.heap.insert([e,this.max])},e.prototype.push=function(e){this.min-=1,this.heap.insert([e,this.min])},e.prototype.pop=function(){var e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]},e.prototype.getCount=function(){return this.heap.getCount()},e}();function Bk(e,t){return{sheet:e,set:t}}!function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula"}(Pk||(Pk={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(Gk||(Gk={}));var jk,Hk={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0};function Kk(e,t){var r;return Object(P.a)(Object(P.a)({},e),((r={})[t]=(e[t]||0)+1,r))}function qk(e,t){switch(t.message){case jk.ChangedCell:return Object(P.a)(Object(P.a)({},e),{changedCellCount:Kk(e.changedCellCount,t.cellKind),calculatedCellCount:Kk(e.calculatedCellCount,t.cellKind)});case jk.UnchangedCell:return Object(P.a)(Object(P.a)({},e),{calculatedCellCount:Kk(e.calculatedCellCount,t.cellKind)});case jk.ContinueComputation:return Object(P.a)(Object(P.a)({},e),{continueCount:e.continueCount+1});case jk.StateTimedOut:return Object(P.a)(Object(P.a)({},e),{stateTimedOut:!0});case jk.EditFinished:return Object(P.a)(Object(P.a)({},e),{editFinishedCount:e.editFinishedCount+1});case jk.RecalcFinished:return Object(P.a)(Object(P.a)({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return k("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}}function Jk(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor(Math.log2(t))}function Qk(e){switch(typeof e){case"number":return{kind:"n",magnitude:Jk(e)};case"string":return{kind:"s"};case"boolean":return{kind:"b"};case"object":switch(e.kind){case X.Error:return{kind:"e",type:(t=e.type,r=Ra[t],void 0===r?"error.type:"+t:r)};case X.Rich:return{kind:"r"};case X.Array:return{kind:"a"};case X.Blank:return{kind:"z"};default:return k("calc.calc.precisionValue",e)}}var t,r}!function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(jk||(jk={}));var Xk,Yk,zk,Zk={samples:[],failures:[]};function $k(e,t){return 0===t.length?e:0===e.length?t:e.concat(t)}!function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ContinueComputation=4]="ContinueComputation",e[e.ComputeCellValue=5]="ComputeCellValue",e[e.AfterCompute=6]="AfterCompute",e[e.EvalFormulaContinue=7]="EvalFormulaContinue",e[e.MaybeCollectGarbage=8]="MaybeCollectGarbage",e[e.PrecisionContinueComputation=9]="PrecisionContinueComputation",e[e.PrecisionComputeCellValue=10]="PrecisionComputeCellValue",e[e.RunExperiment=11]="RunExperiment",e[e.TestAdvanceState=12]="TestAdvanceState"}(Xk||(Xk={})),function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(Yk||(Yk={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.RecalcStatistics="RecalcStatistics",e.PrecisionStatistics="PrecisionStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(zk||(zk={}));var eR=function(){function e(){this.queue=new Wk((function(e,t){return e.kind-t.kind})),this.kindToId=[0,0,0,0,0,0,0,0,0,0,0,0,0],this.onInvalidateMessage=function(e){}}return e.prototype.invalidate=function(e){this.kindToId[e]+=1},e.prototype.isMessageValid=function(e){return e.kindId>=this.kindToId[e.kind]},e.prototype.peek=function(){for(;;){var e=this.queue.peek();if(void 0===e||this.isMessageValid(e))return e;this.onInvalidateMessage(e),this.queue.pop()}},e.prototype.pop=function(){for(;;){var e=this.queue.pop();if(void 0===e||this.isMessageValid(e))return e;this.onInvalidateMessage(e)}},e.prototype.enqueue=function(e,t,r){this.queue.enqueue({kind:e,kindId:this.kindToId[e],stateId:t,message:r})},e.prototype.enqueueRunExperimentMessage=function(e){this.queue.enqueue({kind:Xk.RunExperiment,kindId:this.kindToId[Xk.RunExperiment],message:e})},e.prototype.push=function(e,t,r){this.queue.push({kind:e,kindId:this.kindToId[e],stateId:t,message:r})},e.prototype.pushRunExperimentMessage=function(e){this.queue.push({kind:Xk.RunExperiment,kindId:this.kindToId[Xk.RunExperiment],message:e})},e.prototype.getCountUpperBound=function(){return this.queue.getCount()},e}();function tR(e,t,r){if(void 0!==r){var n=e.slice();return n[t]=r,n}var a=e.slice(0,-1);return t<e.length-1&&(a[t]=e[e.length-1]),a}function rR(e,t,r){return{kind:e,key:t,value:r}}function nR(e,t){return rR(1,e,t)}function aR(e,t){return rR(2,e,t)}function iR(e,t){return rR(3,e,t)}var oR=function(){function e(e,t,r){this.lattice=e,this.root=t,this.count=r}return e.create=function(t,r,n,a,i){void 0===i&&(i=2);var o=i>1?Math.ceil(i):1;return new e({keyJoin:t,keyMeets:r,keyCompare:n,keyDistance:a,minChildren:o,maxChildren:2*o,keyGe:function(e,t){var r=n(e,t);return void 0!==r&&r>=0},keyLe:function(e,t){var r=n(e,t);return void 0!==r&&r<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var e;return null===(e=this.root)||void 0===e?void 0:e.key},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e){if(void 0!==this.root)return function t(r,n){var a=r.keyCompare(n.key,e);if(1===n.kind)return 0===a?n.value:void 0;if(!(void 0===a||a<0))for(var i=0,o=n.value;i<o.length;i++){var u=t(r,o[i]);if(void 0!==u)return u}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:Tn(e,t)},e.prototype.setValue=function(t,r,n){void 0===n&&(n=function(e){return!0});var a=dR(this.lattice,this.root,t,n,r);return void 0!==a?a===this.root?this:new e(this.lattice,a,this.count):new e(this.lattice,fR(this.lattice,this.root,nR(t,r)),this.count+1)},e.prototype.filter=function(t){var r=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return t(e,n)&&(r=r.setValue(e,n)),!0})),r},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==dR(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var r=this.getValue(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,r]},e.prototype.forEach=function(e){return uR(this.root,e)},e.prototype.forEachGe=function(e,t){var r=this;return uR(this.root,t,(function(t){return r.lattice.keyGe(t,e)}),(function(t){return r.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var r=this;return uR(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var r=this;return uR(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var r=this;if(null==this.root)return this;var n=[],a=this.lattice,i=function(e,r){var o=a.keyCompare(e.key,t);if(void 0===o||o<0)return gr(e,1);if(2===e.kind){for(var u=e.value,c=0;c<u.length;c+=1)if(0===a.keyCompare(u[c].key,t)){if((h=tR(u,c)).length<r){var s=aR(e.key,h);return n.push(s),gr(s,3)}return gr(aR(sR(a,h),h),2)}}else for(u=e.value,c=0;c<u.length;c+=1){var l=i(u[c],a.minChildren),f=l[0],d=l[1];if(3===d){var h;if((h=tR(u,c)).length>=r)return gr(iR(sR(a,h),h),2);s=iR(e.key,h);return n.push(s),gr(s,3)}if(2===d)return gr(iR(e.key,tR(u,c,f)),2)}return gr(e,1)},o=2===this.root.kind?1:2,u=i(this.root,o),c=u[0],s=u[1];if(c===this.root)return this;for(var l=3===s?void 0:c,f=0;f<n.length;f+=1)uR(n[f],(function(e,t){return l=fR(r.lattice,l,nR(e,t)),!0}));return new e(this.lattice,l,this.count-1)},e}();function uR(e,t,r,n){var a=void 0!==r?r:function(){return!0},i=void 0!==n?n:function(){return!0};if(null==e)return!0;var o=function(e){if(!a(e.key))return!0;if(2===e.kind)for(var r=e.value,n=0;n<r.length;n+=1){var u=r[n];if(i(u.key)&&!t(u.key,u.value))return!1}else for(r=e.value,n=0;n<r.length;n+=1)if(!o(r[n]))return!1;return!0};return o(e)}function cR(e,t){for(var r=function(e,t){for(var r=0,n=1,a=e.keyDistance(t[0].key,t[1].key),i=2;i<t.length;i+=1)for(var o=0;o<i;o+=1){var u=e.keyDistance(t[o].key,t[i].key);u>a&&(r=o,n=i,a=u)}return gr(r,n)}(e,t),n=r[0],a=r[1],i=t[n].key,o=t[a].key,u=[],c=0;c<t.length;c+=1){var s=t[c];u.push([s,e.keyDistance(i,s.key)-e.keyDistance(o,s.key)])}u.sort((function(e,t){return e[1]-t[1]}));for(var l=e.minChildren;l<t.length-e.minChildren&&u[l][1]<0;l+=1);var f=[],d=[];for(c=0;c<l;c+=1)f.push(u[c][0]);for(c=l;c<t.length;c+=1)d.push(u[c][0]);return gr(f,d)}function sR(e,t){for(var r=t[0].key,n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function lR(e,t,r){var n=cR(e,r),a=n[0],i=n[1];return gr(rR(t,sR(e,a),a),rR(t,sR(e,i),i))}function fR(e,t,r){if(null==t)return aR(r.key,[r]);var n=function t(n){if(2===n.kind){var a=Object(P.f)(n.value,[r]);if(a.length>e.maxChildren){var i=lR(e,n.kind,a),o=i[0],u=i[1];return gr(aR(o.key,o.value),u)}return gr(aR(e.keyJoin(n.key,r.key),a),void 0)}var c=n.value.slice(),s=function(e,t,r){for(var n=0,a=e.keyDistance(t[0].key,r),i=t[0].value.length,o=1;o<t.length;o+=1){var u=t[o],c=e.keyDistance(u.key,r);(c<a||c===a&&u.value.length<i)&&(n=o,a=c,i=u.value.length)}return n}(e,c,r.key),l=t(c[s]),f=l[0],d=l[1];if(c[s]=f,null!=d&&(c.push(d),c.length>e.maxChildren)){var h=lR(e,n.kind,c),p=h[0];u=h[1];return gr(iR(p.key,p.value),u)}return gr(iR(e.keyJoin(n.key,r.key),c),void 0)}(t),a=n[0],i=n[1];return null!=i?iR(e.keyJoin(a.key,i.key),[a,i]):a}function dR(e,t,r,n,a){if(void 0!==t)return function t(n){if(2!==n.kind)for(a=0;a<n.value.length;a+=1){o=n.value[a];if(e.keyMeets(o.key,r))if(void 0!==(u=t(o)))return iR(n.key,tR(n.value,a,u))}else for(var a=0;a<n.value.length;a+=1){var o,u;if(void 0!==(u=i(o=n.value[a])))return aR(n.key,tR(n.value,a,u))}}(t);function i(t){if(0===e.keyCompare(t.key,r))return void 0!==a&&t.value!==a&&n(t.value)?nR(t.key,a):t}}function hR(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols;return Sr(r,o)<Cr(r+a,o+c)&&Sr(n,u)<Cr(n+i,u+s)}function pR(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=r+a,s=o+t.rows,l=n+i,f=u+t.cols;return r===o&&c===s&&n===u&&l===f?0:r<=o&&c>=s&&n<=u&&l>=f?1:r>=o&&c<=s&&n>=u&&l<=f?-1:void 0}function vR(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols;return Er(r-o+.5*(a-c))+Er(n-u+.5*(i-s))}function mR(){return oR.create(wf,hR,pR,vR)}function gR(e){return Array.isArray(e)}var CR=function(e,t,r,n){return{isExact:e,iformat:t,category:r,decimals:n}},SR=CR(!0,Ws.General,"General",0),ER=function(e,t){return e&&t===Ws.General},yR={fmla:"",lexicalKind:Vt.Cell,origin:tr(0,0),compiledFmla:void 0},OR={fmla:"",lexicalKind:Vt.Range,origin:tr(0,0),compiledFmla:void 0},AR=function(e,t){return""===e&&!t},kR={oper:Ge,clientFailure:void 0};function RR(e,t){return Rf(e)&&void 0===t}function bR(e,t,r){return e.setValue(t,r,(function(e){return e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!Et(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)}))}function IR(e,t){return e.forEachMeets(t,(function(t,r){if(r.fmla.length>0){var n=r.lexicalKind===Vt.Cell?yR:OR;e=e.setValue(t,n)}return!0})),e}var TR={values:mR(),formats:mR(),formulae:mR(),dirty:GA},NR={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0};var FR=er(0,0,1<<20,16384);var _R,MR,wR=function(){function e(e){this.sheet=e,this.oldAvailabilities={},this.availabilityHistorySize=0,this.inFilterMode=!1,this.filterModeAvailable=!1,this.serverContents=this.editedContents=TR,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=GA,this.editedTaint=this.recalcTaint=GA,this.serverAvailability=this.editedAvailability=GA,this.serverUsed=this.editedUsed=FR,this.hiddenRows=this.hiddenAvailability=GA}return e.prototype.cloneServer=function(){var t=new e(this.sheet);return t.serverContents=this.serverContents,t.serverAvailability=this.serverAvailability,t.serverUsed=this.serverUsed,t},e.prototype.advanceState=function(e){this.editedContents=this.serverContents,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=GA,this.editedTaint=this.recalcTaint=GA,this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=this.editedAvailability=GA,this.serverUsed=this.editedUsed=FR,this.hiddenRows=this.hiddenAvailability=GA,this.inFilterMode=this.filterModeAvailable=!1},e.prototype.allServerAvailable=function(e){return this.allAvailable(e,this.serverAvailability)},e.prototype.allEditedAvailable=function(e){return this.allAvailable(e,this.editedAvailability)},e.prototype.allAvailable=function(e,t){var r=Sk(t,mk(Nk(e),Mk));return void 0!==r&&r>=0},e.prototype.hasRecalcDirty=function(e){return yk(this.recalcDirty,Nk(e))},e.prototype.hasRecalcFailure=function(e){return yk(this.recalcFailures,Nk(e))},e.prototype.hasEditedEditTaint=function(e){return yk(this.editedTaint,Nk(e))},e.prototype.hasRecalcEditTaint=function(e){return yk(this.recalcTaint,Nk(e))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerUsedRange=function(){return this.serverUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(e,t){var r,n,a=Tk.row(gr(e,t)),i=(r=this.hiddenAvailability)===(n=a)?0:r===GA?-1:n===GA?1:r===PA?n===PA?0:1:n===PA?-1:UA(r.setOperations,r.setOperations.top,r.root,n.root);if(!(void 0!==i&&i>=0))return st({kind:zb.HiddenRows});var o=[];return Lk(FA(this.hiddenRows,a),(function(e){var t=e[0],r=e[1];return o.push(Wl(t,r)),!0})),ct(o)},e.prototype.setHiddenRows=function(e,t){var r=Tk.row(gr(e.row,e.row+e.rows));this.hiddenRows=TA(wA(this.hiddenRows,r),FA(t,r)),this.hiddenAvailability=TA(this.hiddenAvailability,r)},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?ct(this.inFilterMode):st({kind:zb.InFilterMode})},e.prototype.setInFilterMode=function(e){this.inFilterMode=e,this.filterModeAvailable=!0},e.prototype.forEachNonBlankCellInSet=function(e,t,r,n,a){var i=mk(e,n);return Uk(mk(r,i),(function(e){return a.formulae.forEachMeets(e,(function(r,n){return!!AR(n.fmla,void 0!==n.compiledFmla)||gt(Df(e,r),t)}))}))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t){return this.forEachNonBlankCellInSet(e,t,this.editedAvailability,_k,this.editedContents)},e.prototype.forEachServerNonBlankCellInSet=function(e,t){return this.forEachNonBlankCellInSet(e,t,this.serverAvailability,Mk,this.serverContents)},e.prototype.promoteServerAvailability=function(e,t){var r=mk(e,_k),n=this.oldAvailabilities[t];if(void 0===n)return!1;var a=Sk(n,r);return void 0!==a&&a>=0&&(this.unionAvailability(!0,mk(e,wk)),this.unionTaint(!0,GA),this.unionUsed(!0,Fk(e)),!0)},e.prototype.extendServerUnused=function(e){var t=void 0===e?GA:Nk(e),r=Ck(PA,t),n=this.serverContents,a=n.values,i=n.formats,o=n.formulae,u=n.dirty;Uk(r,(function(e){return a.forEachLe(e,(function(e,t){return RR(t.oper,t.clientFailure)||(a=a.setValue(e,kR)),!0})),i.forEachLe(e,(function(e,t){return"object"==typeof t&&ER(t.isExact,t.iformat)||(i=i.setValue(e,SR)),!0})),!0})),Uk(r,(function(e){return o=IR(o,e),!0})),u=Ck(u,r),this.setContents(!0,{values:a,formats:i,formulae:o,dirty:u});var c=this.serverAvailability;c=pk(c=mk(c,t),mk(r,Mk)),this.serverAvailability=this.editedAvailability=c,this.editedTaint=this.recalcTaint=GA;var s,l,f=this.serverUsed;l=e,f=void 0===(s=f)||void 0===l?void 0:Df(s,l),this.serverUsed=this.editedUsed=f},e.prototype.setRecalcFailure=function(e){this.recalcFailures=pk(this.recalcFailures,e)},e.prototype.setRecalcEditTaint=function(e){this.recalcTaint=pk(this.recalcTaint,e)},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this;gt(e,(function(e,n,a){return r.editedContents=Object(P.a)(Object(P.a)({},r.editedContents),{values:r.editedContents.values.setValue(e,{oper:gR(t)?t[n][a]:t,clientFailure:void 0})}),!0})),this.recalcDirty=Ck(this.recalcDirty,Nk(e))},e.prototype.getRecalcValue=function(e){var t=this.editedContents.values.getValue(e);return void 0===t?kR:t},e.prototype.getServerValue=function(e){var t=this.serverContents.values.getValue(e);return void 0===t?kR.oper:t.oper},e.prototype.getServerFormula=function(e){return this.serverContents.formulae.getValue(e)},e.prototype.setEditedFormat=function(e,t){this.editedContents=Object(P.a)(Object(P.a)({},this.editedContents),{formats:this.editedContents.formats.setValue(e,t)})},e.prototype.getEditedFormat=function(e){var t=this.editedContents.formats.getValue(e);return void 0!==t?t:SR},e.prototype.getServerFormat=function(e){var t=this.serverContents.formats.getValue(e);return void 0!==t?t:SR},e.prototype.getEditedFormula=function(e){var t=void 0;return this.editedContents.formulae.forEachGe(e,(function(e,r){return!!AR(r.fmla,void 0!==r.compiledFmla)||(t=[e,r],!1)})),t},e.prototype.setContents=function(e,t){e&&(this.serverContents=t),this.editedContents=t,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=GA},e.prototype.unionAvailability=function(e,t){var r=e?this.serverAvailability:this.editedAvailability;r=pk(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r},e.prototype.unionTaint=function(e,t){this.editedTaint=e?GA:pk(this.editedTaint,t),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(e,t){var r,n,a=e?this.serverUsed:this.editedUsed;n=t,a=void 0===(r=a)?n:void 0===n?r:wf(r,n),e&&(this.serverUsed=a),this.editedUsed=a},e.prototype.setCellContents=function(e,t,r,n,a,i,o){this.setCommon(e,t,void 0,r,n,a,i,o)},e.prototype.setRangeFormula=function(e,t,r,n,a,i){var o=Nk(t);this.setCommon(e,o,t,r,n,void 0,a,i)},e.prototype.setCommon=function(e,t,r,n,a,i,o,u){var c=e?this.serverContents:this.editedContents,s=c.values,l=c.formats,f=c.formulae,d=c.dirty,h=void 0===n||void 0!==n.compiledFmla,p=n;void 0!==n&&(Uk(t,(function(e){return f=IR(f,e),!0})),AR(n.fmla,void 0!==n.compiledFmla)&&(p=void 0));var v=void 0!==p&&void 0===r?n:void 0,m=void 0!==p&&void 0!==r?n:void 0,g=a;void 0!==a&&RR(a,i)&&(Uk(t,(function(e){return s.forEachLe(e,(function(e,t){return RR(t.oper,t.clientFailure)||(s=s.setValue(e,kR)),!0})),!0})),d=Ck(d,t),g=void 0);var C=void 0!==g?{oper:g,clientFailure:i}:void 0,S=o;"object"==typeof o&&ER(o.isExact,o.iformat)&&(Uk(t,(function(e){return l.forEachLe(e,(function(e,t){return"object"==typeof t&&ER(t.isExact,t.iformat)||(l=l.setValue(e,SR)),!0})),!0})),S=void 0);var E=!1===S?void 0:S,y=!1===S?S:void 0,O=t;if(!e){var A=mk(t,_k);O=pk(sk(mk(this.editedAvailability,A),"row","col"),mk(t,void 0!==u?Nk(u):GA))}if(void 0===v&&void 0===E&&void 0===C||(xk(O,(function(e){return void 0!==v&&(f=bR(f,e,v)),void 0!==E&&(l=l.setValue(e,E)),void 0!==C&&(s=s.setValue(e,C)),!0})),void 0===v&&void 0===C||(d=h?pk(d,O):Ck(d,O))),void 0!==m){f=bR(f,r,m);var k=Nk(r);d=h?pk(d,k):Ck(d,k)}void 0!==y&&(l=function(e,t,r){var n=mk(t,Mk);return xk(Ck(t,sk(mk(r,n),"row","col")),(function(t){return e=e.setValue(t,!1),!0})),e}(l,O,e?this.serverAvailability:this.editedAvailability));var R=void 0===a?GA:O;this.setContents(e,{values:s,formats:l,formulae:f,dirty:d}),this.unionAvailability(e,mk(R,wk)),e||(this.editedAvailability=Ck(this.editedAvailability,Ck(t,O))),this.unionTaint(e,R),this.unionUsed(e,Fk(t))},e.prototype.getDirtyEditedCells=function(){return mk(this.recalcDirty,this.editedTaint)},e.prototype.getDirtyDependentCells=function(){return Ck(this.recalcDirty,this.editedTaint)},e.prototype.onCellModified=function(e){var t=e?this.serverContents:this.editedContents;this.setContents(e,t),this.unionAvailability(e,GA),this.unionTaint(e,GA),this.unionUsed(e,void 0)},e.prototype.clearCompiledFormulas=function(){for(var e=0,t=[this.serverContents.formulae,this.editedContents.formulae];e<t.length;e++){t[e].forEach((function(e,t){return void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:Ak(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:Ak(this.editedContents.dirty),recalcDirtySetSubspaceCount:Ak(this.recalcDirty),recalcFailuresSetSubspaceCount:Ak(this.recalcFailures),recalcTaintSetSubspaceCount:Ak(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:Ak(this.editedAvailability),hiddenRowsNodeCount:HA(this.hiddenRows)+HA(this.hiddenAvailability)}},e.prototype.collectGarbage=function(e){var t=GA;for(var r in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(r)){var n=Number(r);if(n>=e){t=pk(t,this.oldAvailabilities[n]);continue}delete this.oldAvailabilities[n],this.availabilityHistorySize-=1}function a(e){return yk(mk(Nk(e),_k),t)}function i(e,t){return!AR(t.fmla,void 0!==t.compiledFmla)&&a(e)}function o(e,t){return("object"!=typeof t||!ER(t.isExact,t.iformat))&&a(e)}function u(e,t){return!RR(t.oper,t.clientFailure)&&a(e)}var c=sk(t,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(i),formats:this.serverContents.formats.filter(o),values:this.serverContents.values.filter(u),dirty:mk(this.serverContents.dirty,c)},this.editedContents={formulae:this.editedContents.formulae.filter(i),formats:this.editedContents.formats.filter(o),values:this.editedContents.values.filter(u),dirty:mk(this.editedContents.dirty,c)},this.recalcDirty=mk(this.recalcDirty,c)},e}();function LR(e,t){e[t]=(e[t]||0)+1}function DR(e,t,r){return e.push(t.join(".")+": expected "+r),!1}function UR(e,t,r){return void 0===r&&(r=!1),function(n,a,i){return pr(n)&&e(n)||DR(a,i,r?t+" (received "+n+")":t)}}function xR(e,t,r,n){for(var a=[],i=t(e,a,[n]),o=0,u=a;o<u.length;o++){LR(r,u[o])}return i}function PR(e,t,r,n){var a=n+".<index>";return e.filter((function(e){return xR(e,t,r,a)}))}function GR(e){return function(t,r,n){return!!vr(t)||e(t,r,n)}}function VR(e){return function(t,r,n){if(vr(t))return DR(r,n,"non-null object");var a=n.length;try{var i=!0;for(var o in e)n[a]=o,i=i&&e[o](t[o],r,n);return i}finally{n.length=a}}}function WR(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,r,n){return e.reduce((function(e,a){return e&&a(t,r,n)}),!0)}}function BR(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r,n,a){return t.reduce((function(e,t){return e&&t(r)(r,n,a)}),e(r,n,a))}}function jR(e){return function(t,r,n){if(!Array.isArray(t))return DR(r,n,"Array");n.push("<index>");try{return t.reduce((function(t,a){return t&&e(a,r,n)}),!0)}finally{n.pop()}}}function HR(e){var t="one of "+JSON.stringify(Object.getOwnPropertyNames(e));return function(r,n,a){if(vr(r))return DR(n,a,"non-null object");var i=a.length;try{var o="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return vr(o)?(a.push("kind"),DR(n,a,t)):o(r,n,a)}finally{a.length=i}}}function KR(e){var t="typeof one of "+JSON.stringify(Object.getOwnPropertyNames(e));return function(r,n,a){var i=e[typeof r];return vr(i)?DR(n,a,t):i(r,n,a)}}function qR(e){return"number"==typeof e&&e>-1/0&&e<1/0}function JR(e){return(0|e)===e||Math.floor(e)===e}function QR(e,t,r){return void 0===t&&(t="natural < "+e),void 0===r&&(r=!1),UR((function(t){return"number"==typeof t&&t>=0&&t<e&&JR(t)}),t,r)}var XR=UR(qR,"finite number"),YR=UR((function(e){return qR(e)&&JR(e)}),"integer"),zR=QR(1/0,"natural"),ZR=UR((function(e){return"string"==typeof e}),"string"),$R=UR((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),eb=UR((function(e){return"boolean"==typeof e}),"boolean"),tb=UR((function(e){return Array.isArray(e)}),"Array");function rb(e){return UR((function(t){return t===e}),JSON.stringify(e))}function nb(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}var ab=UR((function(e){return"string"==typeof e&&nb(e)}),"formula text"),ib=VR({functionId:zR,functionName:$R}),ob=VR({errorType:zR,errorName:UR((function(e){return"string"==typeof e&&e.length>1&&"#"===e[0]}),"error name")}),ub={General:!0,Number:!0,Currency:!0,Accounting:!0,Date:!0,Time:!0,Percentage:!0,Fraction:!0,Scientific:!0,Text:!0,Special:!0,Custom:!0,MaxCategory:!1},cb=VR({iformat:zR,category:UR((function(e){return"string"==typeof e&&!0===ub[e]}),"NumberFormatCategory"),decimals:zR}),sb=UR((function(e){return"string"==typeof e||qR(e)}),"string or finite number"),lb=VR({sheetId:sb,sheetName:ZR}),fb=QR(1<<20,void 0,!0),db=QR(16384,void 0,!0),hb=VR({row:fb,column:db}),pb=WR(hb,VR({lastRow:GR(fb),lastColumn:GR(db)})),vb=WR(pb,VR({sheetId:sb})),mb=VR({kind:rb("Blank")}),gb=VR({kind:rb("Error"),type:zR}),Cb=KR({number:XR,string:ZR,boolean:eb,object:HR({Blank:mb,Error:gb})}),Sb=WR(VR({value:Cb,iformat:zR,failureReason:GR(ZR)}),HR({CellFormula:VR({formulaBarText:ab}),ArrayFormula:VR({formulaBarText:GR(ZR)}),Value:VR({formulaBarText:ZR}),Inferred:VR({formulaBarText:GR(ZR)})})),Eb=VR({range:vb,excludeRows:GR(jR(fb)),excludeColumns:GR(jR(db)),data:GR(Sb),fromStateId:GR(YR)}),yb=VR({isSpilled:eb,formulaBarText:ab}),Ob=VR({range:vb,data:GR(yb),fromStateId:GR(YR)}),Ab=VR({sheetId:sb,usedRange:GR(pb)}),kb=KR({number:XR,string:ZR,boolean:eb,object:HR({Error:gb})}),Rb=VR({kind:rb("NamedValue"),value:kb}),bb=VR({kind:rb("NamedFormula"),formulaBarText:ab}),Ib=VR({kind:rb("NamedRange"),range:vb}),Tb=VR({kind:rb("NamedFailure"),failureReason:ZR,objectKind:GR(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=0,a=e;n<a.length;n++){var i=a[n];r[i]=!0}var o="one of "+JSON.stringify(e);return UR((function(e){return"string"==typeof e&&!0===r[e]}),o)}("NamedValue","NamedFormula","NamedRange","NamedTable"))}),Nb=VR({name:ZR,data:GR(HR({NamedValue:Rb,NamedFormula:bb,NamedRange:Ib,NamedFailure:Tb}))}),Fb=VR({scope:GR(sb),objects:GR(tb),fromStateId:GR(YR)}),_b=VR({value:GR(Cb)}),Mb=VR({value:Cb}),wb=UR((function(e){return e.length>0}),"a non-empty array"),Lb=UR((function(e){return e.every((function(t){return t.sheetId===e[0].sheetId}))}),"ranges on the same sheet"),Db=WR(VR({range:BR(jR(vb),(function(e){return wb}),(function(e){return Lb})),origin:GR(hb),viewport:GR(vb)}),HR({CellFormula:VR({formulaBarText:ab,value:GR(Cb)}),Value:VR({formulaBarText:ZR,value:Cb}),Inferred:BR(VR({formulaBarText:ZR}),(function(e){return t=nb(e.formulaBarText)?_b:Mb,function(e,r,n){return t(e,r,n)};var t}))})),Ub=VR({range:vb,formulaBarText:UR((function(e){return"string"==typeof e&&(0===e.length||nb(e))}),"empty string or text denoting formula"),origin:GR(hb),viewport:GR(vb)}),xb={number:!0,string:!0,boolean:!0},Pb=((_R={})[X.Error]=!0,_R[X.Array]=!1,_R[X.Rich]=!1,_R),Gb=((MR={})[X.Error]=!0,MR[X.Array]=!1,MR[X.Blank]=!0,MR[X.Rich]=!1,MR),Vb=UR((function(e){return!("object"!=typeof e||!Pb[e.kind])||!0===xb[typeof e]}),"supported WriteOper"),Wb=UR((function(e){return!("object"!=typeof e||!Gb[e.kind])||!0===xb[typeof e]}),"supported ReadOper"),Bb=function(e){return{kind:"NamedValue",value:e}},jb=function(e){return{kind:"NamedFormula",fmla:e}},Hb=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},Kb={namesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0};var qb=function(){function e(e,t){this.names=e,this.allAvailable=t}return e.create=function(t){return new e(El.create(t),!1)},e.prototype.update=function(t,r){return t!==this.names||r!==this.allAvailable?new e(t,r):this},e.prototype.getEntry=function(e,t){var r=this.names.getEntry(t);return void 0===r?this.allAvailable?ct(void 0):st({kind:zb.NameLoc,name:sr(e,t)}):ct(!1!==r.value?r:void 0)},e.prototype.setValue=function(e,t){return this.update(this.names.setValue(e,t),this.allAvailable)},e.prototype.remove=function(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable)},e.prototype.setUndefined=function(){return this.update(this.names,!0)},e.prototype.getStatistics=function(e){return{namesCount:this.names.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.allAvailable?this.update(this.names.filter((function(e,t){return!1!==t})),!0):this},e.prototype.clearCompiledFormulas=function(){this.names.forEach((function(e,t){return!1!==t&&t.compiledFmla.reset(),!0}))},e}(),Jb=function(){function e(e,t){this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=qb.create(e),this.emptyRecalcFailures=this.recalcFailures=Nn.create(e)}return e.prototype.advanceState=function(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures},e.prototype.getStatistics=function(){return this.contents.getStatistics(this.recalcFailures.getCount())},e.prototype.collectGarbage=function(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(e){var t=this.contents.getEntry(this.scope,e);return lt(t)?ct(void 0!==t.value?sr(this.scope,t.value.key):void 0):t},e.prototype.getNameFormula=function(e){var t=this.contents.getEntry(this.scope,e);return lt(t)?ct(void 0!==t.value?t.value.value:void 0):t},e.prototype.hasRecalcFailure=function(e){return this.recalcFailures.contains(e)},e.prototype.setRecalcFailure=function(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)},e.prototype.onCellModified=function(e){this.recalcFailures=this.emptyRecalcFailures},e.prototype.clearCompiledFormulas=function(){this.contents.clearCompiledFormulas(),this.oldContents!==this.contents&&this.oldContents.clearCompiledFormulas()},e.prototype.setNamedObject=function(e,t,r){this.contents=void 0===r?this.contents.remove(t):this.contents.setValue(t,r),this.isCurrent=this.isChanged=!0},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(e){return!this.isChanged&&e===this.oldStateId&&(this.contents=this.oldContents,this.isCurrent=!0,!0)},e}(),Qb=function(){function e(e,t,r,n,a,i){void 0===r&&(r={}),void 0===n&&(n=[]),this.document=e,this.stringCompareCI=t,this.sheets=r,this.sheetPosToId=n,this.sheetNameToId=void 0===a?Nn.create(t):a,this.globalNames=void 0===i?new Jb(t,ur(e)):i}return e.prototype.cloneServer=function(){for(var t=Object(P.a)({},this.sheets),r=0,n=this.sheetPosToId;r<n.length;r++){var a=n[r],i=t[a];t[a]=Object(P.a)(Object(P.a)({},i),{grid:i.grid.cloneServer()})}return new e(this.document,this.stringCompareCI,t,this.sheetPosToId,this.sheetNameToId,this.globalNames)},e.prototype.setRecalcFailure=function(e,t){var r=this.getSheetById(e);return r.kind===Ke.Failure?r:ct(r.value.grid.setRecalcFailure(t))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getSheetById(e);return r.kind===Ke.Failure?r:ct(r.value.grid.setRecalcEditTaint(t))},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===Ke.Failure?r:ct(r.value.grid.setEditedAndRecalcValues(e.range,t))},e.prototype.setEditedFormat=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===Ke.Failure?r:ct(r.value.grid.setEditedFormat(e.range,t))},e.prototype.setHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===Ke.Failure?n:ct(n.value.grid.setHiddenRows(t,r))},e.prototype.setInFilterMode=function(e,t){var r=this.getSheetById(e);return r.kind===Ke.Failure?r:ct(r.value.grid.setInFilterMode(t))},e.prototype.setCellContents=function(e,t,r,n,a,i,o){var u=this.getSheetById(t.sheet.index);if(u.kind===Ke.Failure)return u;var c=void 0!==o&&St(t.sheet,o.sheet)?o.range:void 0;return ct(u.value.grid.setCellContents(e,t.set,r,n,a,i,c))},e.prototype.setRangeFormula=function(e,t,r,n,a,i){var o=this.getSheetById(t.sheet.index);if(o.kind===Ke.Failure)return o;var u=void 0!==i&&St(t.sheet,i.sheet)?i.range:void 0;return ct(o.value.grid.setRangeFormula(e,t.range,r,n,a,u))},e.prototype.getDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t){e.push(Bk(t.grid.sheet,t.grid.getDirtyEditedCells()))})),e},e.prototype.getDirtyDependentCells=function(){var e=[];return this.forEachSheet((function(t){e.push(Bk(t.grid.sheet,t.grid.getDirtyDependentCells()))})),e},e.prototype.setNamedObject=function(e,t,r){var n=this.getNameManager(t.scope.index);return n.kind===Ke.Failure?n:ct(n.value.setNamedObject(e,t.name,r))},e.prototype.setUndefinedNames=function(e){var t=this.getNameManager(e.index);return t.kind===Ke.Failure?t:ct(t.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(e,t){var r=this.getNameManager(e.index);return r.kind===Ke.Failure?r:ct(r.value.promoteNamedObjects(t))},e.prototype.setSheetNames=function(t){for(var r,n=[],a={},i=[],o=0;o<t.length;o+=1){var u=t[o],c=u.sheetName,s=u.sheetId;n[o]=s,i.push([c,s]);var l=this.sheets[s];if(void 0===l){var f=Zt(this.document,s);a[s]={grid:new wR(f),names:new Jb(this.stringCompareCI,f),pos:o,name:c}}else a[s]=Object(P.a)(Object(P.a)({},l),{pos:o})}var d=(r=Nn.create(this.stringCompareCI)).setValues.apply(r,i);return new e(this.document,this.stringCompareCI,a,n,d,this.globalNames)},e.prototype.extendServerUnused=function(e,t){var r=this.getSheetById(e);return r.kind===Ke.Failure?r:ct(r.value.grid.extendServerUnused(t))},e.prototype.promoteServerAvailability=function(e,t,r){var n=this.getSheetById(e);return n.kind===Ke.Failure?n:ct(n.value.grid.promoteServerAvailability(t,r))},e.prototype.getNameLoc=function(e,t){var r=this.getNameManager(e);if(r.kind===Ke.Failure)return r;var n=r.value.getNameLoc(t);return n.kind,Ke.Failure,n},e.prototype.getNameFormula=function(e){var t=this.getNameManager(e.scope.index);return t.kind===Ke.Failure?t:t.value.getNameFormula(e.name)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===Ke.Failure?t:ct(t.value.hasRecalcFailure(e.name))},e.prototype.setRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===Ke.Failure?t:ct(t.value.setRecalcFailure(e.name))},e.prototype.getNameManager=function(e){if(void 0===e)return ct(this.globalNames);var t=this.getSheetById(e);return t.kind===Ke.Failure?t:ct(t.value.names)},e.prototype.getEditedFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Ke.Failure?t:ct(t.value.grid.getEditedFormula(e.range))},e.prototype.getEditedFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Ke.Failure?t:ct(t.value.grid.getEditedFormat(e.range))},e.prototype.isInFilterMode=function(e){var t=this.getSheetById(e);return t.kind===Ke.Failure?t:t.value.grid.isInFilterMode()},e.prototype.getHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===Ke.Failure?n:n.value.grid.getHiddenRows(t,r)},e.prototype.getServerFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Ke.Failure?t:ct(t.value.grid.getServerFormat(e.range))},e.prototype.getRecalcValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Ke.Failure?t:ct(t.value.grid.getRecalcValue(e.range))},e.prototype.getServerValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Ke.Failure?t:ct(t.value.grid.getServerValue(e.range))},e.prototype.getServerFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Ke.Failure?t:ct(t.value.grid.getServerFormula(e.range))},e.prototype.getServerUsedRange=function(e){var t=this.getSheetById(e);return t.kind===Ke.Failure?t:ct(t.value.grid.getServerUsedRange())},e.prototype.allServerAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Ke.Failure?t:ct(t.value.grid.allServerAvailable(e.range))},e.prototype.allEditedAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Ke.Failure?t:ct(t.value.grid.allEditedAvailable(e.range))},e.prototype.hasRecalcDirty=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Ke.Failure?t:ct(t.value.grid.hasRecalcDirty(e.range))},e.prototype.hasRecalcFailure=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Ke.Failure?t:ct(t.value.grid.hasRecalcFailure(e.range))},e.prototype.hasEditedEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Ke.Failure?t:ct(t.value.grid.hasEditedEditTaint(e.range))},e.prototype.hasRecalcEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Ke.Failure?t:ct(t.value.grid.hasRecalcEditTaint(e.range))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===Ke.Failure?n:ct(n.value.grid.forEachEditedNonBlankCellInSet(t,r))},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===Ke.Failure?n:ct(n.value.grid.forEachServerNonBlankCellInSet(t,r))},e.prototype.getSheetIndex=function(e){var t=this.getSheetByName(e);return t.kind===Ke.Failure||void 0===t.value?t:ct(t.value.grid.sheet)},e.prototype.getSheetName=function(e){var t=this.getSheetById(e);return t.kind===Ke.Failure?t:ct(t.value.name)},e.prototype.getEditedUsedRange=function(e){var t=this.getSheetById(e);return t.kind===Ke.Failure?t:ct(t.value.grid.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(e){var t,r;if(void 0===e.index)t=0,r=this.sheetPosToId.length;else{var n=this.getSheetById(e.index);if(!lt(n))return n;var a=this.getSheetById(e.index2);if(!lt(a))return a;t=Cr(n.value.pos,a.value.pos),r=Sr(n.value.pos,a.value.pos)+1}for(var i=[],o=t;o<r;o+=1)i.push(this.sheetPosToId[o]);return ct(function(e,t){return{sheets:e,position:t}}(i,t))},e.prototype.onCellModified=function(e){this.forEachSheet((function(t){t.grid.onCellModified(e),t.names.onCellModified(e)})),this.globalNames.onCellModified(e)},e.prototype.collectGarbage=function(e){this.forEachSheet((function(t){t.grid.collectGarbage(e),t.names.collectGarbage(e)})),this.globalNames.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheet((function(t){t.grid.advanceState(e),t.names.advanceState(e)})),this.globalNames.advanceState(e)},e.prototype.clearCompiledFormulas=function(){this.forEachSheet((function(e){e.grid.clearCompiledFormulas(),e.names.clearCompiledFormulas()})),this.globalNames.clearCompiledFormulas()},e.prototype.getGridStatistics=function(){var e=NR;return this.forEachSheet((function(t){return r=e,n=t.grid.getStatistics(),e={serverFormulaeNodeCount:r.serverFormulaeNodeCount+n.serverFormulaeNodeCount,serverFormatsNodeCount:r.serverFormatsNodeCount+n.serverFormatsNodeCount,serverValuesNodeCount:r.serverValuesNodeCount+n.serverValuesNodeCount,serverDirtySetSubspaceCount:r.serverDirtySetSubspaceCount+n.serverDirtySetSubspaceCount,editedFormulaeNodeCount:r.editedFormulaeNodeCount+n.editedFormulaeNodeCount,editedFormatsNodeCount:r.editedFormatsNodeCount+n.editedFormatsNodeCount,editedValuesNodeCount:r.editedValuesNodeCount+n.editedValuesNodeCount,editedDirtySetSubspaceCount:r.editedDirtySetSubspaceCount+n.editedDirtySetSubspaceCount,recalcDirtySetSubspaceCount:r.recalcDirtySetSubspaceCount+n.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:r.recalcFailuresSetSubspaceCount+n.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:r.recalcTaintSetSubspaceCount+n.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:r.availabilitySetSubspaceCount+n.availabilitySetSubspaceCount,availabilityHistorySize:r.availabilityHistorySize+n.availabilityHistorySize,hiddenRowsNodeCount:r.hiddenRowsNodeCount+n.hiddenRowsNodeCount};var r,n})),e},e.prototype.getNameStatistics=function(){var e=this.globalNames.getStatistics();return this.forEachSheet((function(t){return r=e,n=t.names.getStatistics(),e={namesCount:r.namesCount+n.namesCount,recalcFailuresCount:r.recalcFailuresCount+n.recalcFailuresCount,scopes:r.scopes+n.scopes,allAvailableScopes:r.allAvailableScopes+n.allAvailableScopes};var r,n})),e},e.prototype.getAvailableCells=function(){for(var e=[],t=0,r=this.sheetPosToId;t<r.length;t++){var n=r[t],a=this.sheets[n],i=Zt(this.document,n);e.push({sheetIdx:i,availableCells:a.grid.getServerAvailability()})}return e},e.prototype.forEachSheet=function(e){for(var t in this.sheets){if(this.sheets.hasOwnProperty(t))e(this.sheets[t])}},e.prototype.getSheetById=function(e){var t=this.sheets[e];return void 0!==t?ct(t):this.unavailableFailure({kind:zb.SheetId,document:this.document,sheetId:e})},e.prototype.getSheetByName=function(e){var t=this.sheetNameToId.getValue(e);return void 0===t?ct(void 0):this.getSheetById(t)},e.prototype.unavailableFailure=function(e){return st(e)},e}(),Xb=tr(0,0);function Yb(e){var t=[],r=ni(ri((function(){})),(function(){}),{vArray:function(e){e.nodes.forEach((function(e){return e.forEach((function(e){return ti(e,r)}))}))},vApp:function(n){var a;if(Ft(n.head))t.push(function(e){if(e===Ve.Isect)return" ";if(e===Ve.Union)return",";var t=Je[e];return void 0===t?"op:"+e:t}(n.head.id));else{var i=e.annotations[n.head.label];(null===(a=i)||void 0===a?void 0:a.kind)===D.WorksheetFuncName&&t.push(Ia(i.id))}for(var o=0,u=n.args;o<u.length;o++){ti(u[o],r)}},vParen:function(e){ti(e.node,r)}});return ei(e.node,r),t}var zb,Zb=ye([],[],z.None,ee.Exact),$b=function(){function e(e,t,r,n,a,i,o,u,c,s,l){this.onNameFailure=n,this.onRangeFailure=a,this.onUnavailableObject=i,this.onSetCellValue=o,this.onSetCellValues=u,this.schedulerInfo=c,this.limits=s,this.maxDereferenceCells=l,this.iformats=[],this.worksheetFuncOverrides={},this.interruptToken=[Gl.Continue],this.setDynamicPrecs=function(){},this.loadObjects=function(){return!1},this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.config=fa(e,r,t),this.setLocaleInfo(e),this.setRefStyle(r),this.parser=Fs(this),this.analyzer=Ih(this),this.compiler=hp(this),this.evaluator=Hv(this)}return e.prototype.reconfigure=function(e,t,r){this.schedulerInfo=e,this.limits=t,this.maxDereferenceCells=r},e.prototype.setLocaleInfo=function(e){this.stringCompareCI=e.stringCompareCI,this.config=Object(P.a)(Object(P.a)({},this.config),{localeInfo:e})},e.prototype.setRefStyle=function(e){this.config=Object(P.a)(Object(P.a)({},this.config),{refStyle:e})},e.prototype.getDocumentLoc=function(e,t){var r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.stringCompareCI(t,r.name)?Yt(e,t):r},e.prototype.forEachDocument=function(e){void 0!==this.document&&e(this.document)},e.prototype.getNameLoc=function(e,t){var r=this.getDocument(e.document);if(r.kind===Ke.Failure)return st(aI([r.reason]));var n=r.value.getNameLoc(e.index,t);return n.kind===Ke.Failure?st(aI([n.reason])):n},e.prototype.getUserDefinedFuncLoc=function(e,t){return st(Pt(["call UDF"]))},e.prototype.getCellFormat=function(e){var t=this.allEditedAvailable(e);if(t.kind===Ke.Failure)return st(aI([t.reason]));if(!t.value)return st(aI([{kind:zb.GridRange,range:e}]));var r=this.getEditedFormat(e);if(r.kind===Ke.Failure)return st(aI([r.reason]));if(!1===r.value)return st(aI([{kind:zb.CellFormat}]));var n=this.resolveIformat(r.value);return void 0===n.category||void 0===n.decimals?st(aI([{kind:zb.NumberFormat,iformat:n.iformat}])):ct({iformat:n.iformat,category:n.category,decimals:n.decimals})},e.prototype.getNameFormula=function(e){var t=this.getDocument(e.scope.document);if(t.kind===Ke.Failure)return st(aI([t.reason]));var r=t.value.getNameFormula(e);if(r.kind===Ke.Failure)return st(aI([r.reason]));if(void 0===r.value)return ct(void 0);var n=r.value.compiledFmla.getValue();if(lt(n))return n;var a=this.hasRecalcNameFailure(e);return lt(a)?a.value||this.setNameFailure(e,n.reason):this.onUnavailableObject(a.reason),st(function(e){return{kind:Dl.PreviousNameFailure,name:e}}(e))},e.prototype.getCellFormula=function(e){var t=this.getEditedFormula(e);if(t.kind===Ke.Failure)return st(aI([t.reason]));if(void 0===t.value)return ct(void 0);var r=t.value,n=r[0],a=r[1];if(void 0===a.compiledFmla)return ct(void 0);var i=ar(e.sheet,n),o=this.readCompiledFmla(i,a.compiledFmla);return lt(o)?ct(Kl(i,a.lexicalKind,o.value)):o},e.prototype.getKnownFormat=function(e){var t=this.iformats[e];return void 0===t?st(aI([{kind:zb.NumberFormat,iformat:e}])):ct({iformat:e,category:t.category,decimals:t.decimals})},e.prototype.setCellValue=function(e,t,r){var n=this.hasRecalcValueChanged(e,t);if(n.kind===Ke.Failure)return this.onUnavailableObject(n.reason);var a=this.setEditedAndRecalcValues(e,t);if(a.kind===Ke.Failure)return this.onUnavailableObject(a.reason);var i=this.propagateEditTaint(e,r);if(i.kind===Ke.Failure)return this.onUnavailableObject(i.reason);this.onSetCellValue(e,t,r,i.value,this.evalParams,n.value)},e.prototype.setCellValues=function(e,t,r){var n=this.setEditedAndRecalcValues(e,t);if(n.kind===Ke.Failure)return this.onUnavailableObject(n.reason);var a=this.propagateEditTaint(e,r);if(a.kind===Ke.Failure)return this.onUnavailableObject(a.reason);this.onSetCellValues(e,t,r,a.value,this.evalParams)},e.prototype.getFirstOrderFunc=function(e){if(0!=(ot(e).staticPrecs&(z.Time|z.Calc)))return st(aI([{kind:zb.VolatileFunction,name:Ia(e)}]));if(void 0!==this.worksheetFuncOverrides[e])return ct(this.worksheetFuncOverrides[e]);var t=ty(e);return null!=t?ct(t):st(Pt([Ia(e)]))},e.prototype.getUserDefinedFunc=function(e){return st(Pt(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){var t=this.getSheetRangeIds(e);return t.kind===Ke.Failure?st(aI([t.reason])):ct(t.value)},e.prototype.setCellFailure=function(e,t,r){var n=this.setRecalcFailure(e.sheet,Nk(e.range));if(n.kind===Ke.Failure)return this.onUnavailableObject(n.reason);var a=this.setEditedAndRecalcValues(e,Ge);if(a.kind===Ke.Failure)return this.onUnavailableObject(a.reason);var i=this.propagateEditTaint(e,r);if(i.kind===Ke.Failure)return this.onUnavailableObject(i.reason);this.onRangeFailure(e,t,r,i.value,this.evalParams)},e.prototype.getUsedRange=function(e){var t=this.getEditedUsedRange(e);return t.kind===Ke.Failure?st(aI([t.reason])):t},e.prototype.getSheetName=function(e,t){var r=this.getDocument(e);if(r.kind===Ke.Failure)return st(aI([r.reason]));var n=r.value.getSheetName(t);return n.kind===Ke.Failure?st(aI([n.reason])):void 0===n.value?n:ct(n.value)},e.prototype.getSheetIndex=function(e,t){var r=this.getDocument(e);if(r.kind===Ke.Failure)return st(aI([r.reason]));var n=r.value.getSheetIndex(t);return n.kind===Ke.Failure?st(aI([n.reason])):void 0===n.value?n:ct(n.value.index)},e.prototype.getHiddenRows=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===Ke.Failure)return st(aI([n.reason]));var a=n.value.getHiddenRows(e.index,t,r);return a.kind===Ke.Failure?st(aI([a.reason])):a},e.prototype.isInFilterMode=function(e){var t=this.getDocument(e.document);if(t.kind===Ke.Failure)return st(aI([t.reason]));var r=t.value.isInFilterMode(e.index);return r.kind===Ke.Failure?st(aI([r.reason])):r},e.prototype.withEvalParams=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return Array.isArray(a)?a:tf((function(){return r.withEvalParams(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.withEvalParamsEvalFormula=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return a.kind!==Ke.Paused?a:tf((function(){return r.withEvalParamsEvalFormula(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.evaluate=function(e,t){var r=this;return this.withEvalParams({computeKind:e,computeCell:t},(function(){return r.evaluator.evalCells([t])}))},e.prototype.evalFormula=function(e,t){var r=this,n={lexicalKind:Vt.Other,origin:Xb,allowRelativeQualifier:!1},a={lexicalSource:{kind:Vt.Other},originGridCell:ct(Xb),originSheet:ct(t),calcingArray:!1,reflectionGridCell:ct(Xb),reflectionSheet:ct(t),implicitIntersect:!1,wrapCellReferences:!1,followHyperlinks:ct(!1)};return this.withEvalParamsEvalFormula({computeKind:Pk.EvalFormula,computeCell:ir(t,Xb)},(function(){var t=r.parser.parseFormula(n,e),i=r.checkFormula(n,t,e,"eval-formula"),o=r.compileFormula(n,i);return lt(o)?r.evaluator.evalFormula(a,o.value):o}))},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e},e.prototype.setSheetNames=function(e,t){var r=this.ensureDocument(e);return r.kind===Ke.Failure?r:(this.document=r.value.setSheetNames(t),ct(void 0))},e.prototype.advanceState=function(e){void 0!==this.document&&this.document.advanceState(e)},e.prototype.onCellModified=function(e){if(void 0!==this.document)return this.document.onCellModified(e)},e.prototype.allServerAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Ke.Failure?t:t.value.allServerAvailable(e)},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===Ke.Failure?i:i.value.forEachEditedNonBlankCellInSet(n,t,r)},e.prototype.clearCompiledFormulas=function(){if(void 0!==this.document)return this.document.clearCompiledFormulas()},e.prototype.getGridStatistics=function(){return void 0!==this.document?this.document.getGridStatistics():NR},e.prototype.getNameStatistics=function(){return void 0!==this.document?this.document.getNameStatistics():Kb},e.prototype.collectGarbage=function(e){if(void 0!==this.document)return this.document.collectGarbage(e)},e.prototype.getEditedFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Ke.Failure?t:t.value.getEditedFormula(e)},e.prototype.getEditedFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Ke.Failure?t:t.value.getEditedFormat(e)},e.prototype.getServerFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Ke.Failure?t:t.value.getServerFormat(e)},e.prototype.getRecalcValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Ke.Failure?t:t.value.getRecalcValue(e)},e.prototype.getServerValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Ke.Failure?t:t.value.getServerValue(e)},e.prototype.promoteServerAvailability=function(e,t){var r=e.sheet,n=e.set,a=this.getDocument(r.document);return a.kind===Ke.Failure?a:a.value.promoteServerAvailability(r.index,n,t)},e.prototype.extendServerUnused=function(e,t){var r=this.getDocument(e.document);return r.kind===Ke.Failure?r:r.value.extendServerUnused(e.index,t)},e.prototype.setCellContents=function(e,t,r,n,a,i,o,u,c){var s=this.getDocument(t.sheet.document);if(s.kind===Ke.Failure)return s;var l=void 0===r?void 0:n?this.compileFmla(e,Vt.Cell,a,void 0,r):""===r?yR:{fmla:r,lexicalKind:Vt.Cell,origin:a,compiledFmla:void 0};return s.value.setCellContents(e,t,l,i,o,u,c)},e.prototype.setRangeFormula=function(e,t,r,n,a,i,o){var u=this.getDocument(t.sheet.document);if(u.kind===Ke.Failure)return u;var c=""===r?OR:this.compileFmla(e,Vt.Range,n,Ot(t.range),r);return u.value.setRangeFormula(e,t,c,a,i,o)},e.prototype.getDirtyEditedCells=function(){return this.document?this.document.getDirtyEditedCells():[]},e.prototype.getDirtyDependentCells=function(){return this.document?this.document.getDirtyDependentCells():[]},e.prototype.setNamedObject=function(e,t,r){var n=this.getDocument(t.scope.document);if(n.kind===Ke.Failure)return n;var a=Qt(t),i=void 0===r?void 0:this.compileNamedObject(e,a,r);return n.value.setNamedObject(e,t,i)},e.prototype.setUndefinedNames=function(e){var t=this.getDocument(e.document);return t.kind===Ke.Failure?t:t.value.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){var r=this.getDocument(e.document);return r.kind===Ke.Failure?r:r.value.promoteNamedObjects(e,t)},e.prototype.setNumberFormats=function(e,t){var r=this;t||(this.iformats=[]),e.forEach((function(e){r.iformats[e.iformat]=e}))},e.prototype.writeHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===Ke.Failure?n:n.value.setHiddenRows(e.index,t,r)},e.prototype.writeInFilterMode=function(e,t){var r=this.getDocument(e.document);return r.kind===Ke.Failure?r:r.value.setInFilterMode(e.index,t)},e.prototype.resolveIformat=function(e){if(e.isExact&&(void 0===e.category||void 0===e.decimals)){var t=this.iformats[e.iformat];void 0!==t&&(e.category=t.category,e.decimals=t.decimals)}return e},e.prototype.inferRangeFormat=function(e,t){var r,n=this,a=e,i=Sk(Nk(t.range),e);if(void 0!==i&&i<=0){var o=this.inferCellFormat(t);if(!lt(o)||void 0===o.value)return[];a=Ck(a,Nk(t.range)),r=o.value}else{var u=this.getEditedFormat(t);if(!lt(u))return[u.reason];if(!1===u.value)return[];r=this.resolveIformat(u.value)}r=Object(P.a)({},r);var c=[];return this.forEachEditedNonBlankCellInSet(t.sheet,a,(function(e){var a=ir(t.sheet,e),i=n.isFormatGeneral(a);if(!lt(i))return c.push(i.reason),!0;if(!i.value)return!0;var o=n.setEditedFormat(a,r);return lt(o)||c.push(o.reason),!0})),c},e.prototype.inferCellFormat=function(e){var t=this.isFormatGeneral(e);if(!lt(t))return t;if(!t.value)return ct(void 0);var r=this.getEditedFormula(e);if(r.kind===Ke.Failure)return r;if(void 0===r.value||void 0===r.value[1].compiledFmla)return ct(void 0);var n=r.value[1].compiledFmla.getValue();if(!lt(n))return ct(void 0);var a=Jt(r.value[1].lexicalKind,ar(e.sheet,r.value[0])),i=n.value,o=this.analyzer.findBestFormat($s(a),i);if(!lt(o))return ct(void 0);var u=o.value,c=u.category,s=u.iformat,l=u.decimals,f=this.iformats[s],d=void 0!==f&&c===f.category&&l===f.decimals,h=CR(d,s,c,l),p=this.setEditedFormat(e,h);return lt(p)?ct(h):p},e.prototype.isFormatGeneral=function(e){var t=this.getEditedFormat(e);return t.kind===Ke.Failure?t:!1===t.value?ct(!1):ct("General"===this.resolveIformat(t.value).category)},e.prototype.anonymizeFormula=function(e,t){var r,n=null===(r=t.compiledFmla)||void 0===r?void 0:r.getValue();return void 0!==n&&lt(n)?[pi(n.value,e),Yb(n.value)]:[Mi(t.fmla),[]]},e.prototype.compileFmla=function(e,t,r,n,a){var i=this;return{fmla:a,lexicalKind:t,origin:null!=n?n:r,compiledFmla:new ly((function(){var o=i.parser.parseFormula(xi(t,r),a),u=i.checkFormula(zs(t,r),o,a,e?"server-cell-formula":"edit-cell-formula"),c=i.adjustFormulaOrigin(u,r,n);return i.compileFormula(xl(t,r),c)}))}},e.prototype.compileFormula=function(e,t){return lt(t)?this.compiler.compileFormula(e,t.value):t},e.prototype.compileNamedObject=function(e,t,r){var n=this,a=e?"server-named-formula":"edit-named-formula";switch(r.kind){case"NamedFormula":return{obj:r,compiledFmla:new ly((function(){var e=r.fmla,t=n.parser.parseFormula(xi(Vt.NameManager,Xb),e),i=n.checkFormula(Zs(Xb),t,e,a);return n.compileFormula(xl(Vt.NameManager,Xb),i)}))};case"NamedValue":return{obj:r,compiledFmla:new ly((function(){var e;if(Tf(r.value)){b("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",dt(r.value.sheets)&&1===r.value.ranges.length);var i=r.value.sheets,o=n.getDocument(i.document);if(!lt(o))return n.onUnavailableObject(o.reason),st(aI([o.reason]));var u=o.value.getSheetName(i.index);if(!lt(u))return n.onUnavailableObject(u.reason),st(aI([u.reason]));var c=r.value.ranges[0];e=oe(me(ne(re(J(L.Abs,c.row),J(L.Abs,c.col)),re(J(L.Abs,c.row+c.rows-1),J(L.Abs,c.col+c.cols-1))),H(u.value,j(i.document.name,i.document.path))),[])}else e=oe(le(r.value,!0),[]);var s=n.analyzer.checkFormula(Zs(Xb),e,a);return ht(s)?n.compileFormula(xl(Vt.NameManager,Xb),ct(s)):R("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula "+pi(e,t))}))};case"NamedFailure":return{obj:r,compiledFmla:new ly((function(){return st(aI([{kind:zb.ClientFailure,reason:r.failureReason}]))}))};default:return k("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},e.prototype.checkFormula=function(e,t,r,n){if(!lt(t))return t;var a=this.analyzer.checkFormulaWithDiagnostics(e,t.value,n);return ht(a[0])?ct(a[0]):st(Bl("calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+Mi(r),n,Xs(a[1])))},e.prototype.adjustFormulaOrigin=function(e,t,r){return lt(e)&&void 0!==r?ct(rv(t,r,e.value)):e},e.prototype.getDocument=function(e){return void 0!==this.documentLoc&&void 0!==this.document&&Ct(this.documentLoc,e)?ct(this.document):this.unavailableFailure({kind:zb.DocumentLoc,document:e})},e.prototype.ensureDocument=function(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new Qb(e,this.stringCompareCI)),this.getDocument(e)},e.prototype.unavailableFailure=function(e){return st(e)},e.prototype.tryGetCellValues=function(e,t){var r=this,n=new Array(e.rows);return gt(e,(function(a,i,o){var u=r.tryGetCellValue(a,t);return void 0!==u&&((void 0!==n[i]?n[i]:n[i]=new Array(e.cols))[o]=u,!0)}))?n:void 0},e.prototype.tryGetCellValue=function(e,t){var r=ir(t,e),n=this.getRecalcValue(r);if(n.kind!==Ke.Failure){var a=n.value,i=a.oper,o=a.clientFailure;if(void 0===o){var u=this.hasRecalcDirty(r);if(lt(u)){if(!u.value)return jl(i);var c=this.getEditedFormula(r);if(c.kind!==Ke.Failure)if(void 0!==c.value){var s=c.value,l=s[0],f=s[1];if(void 0!==f.compiledFmla){if(lt(this.readCompiledFmla(ar(t,l),f.compiledFmla)))return Hl(ir(t,Ot(l)))}else this.onUnavailableObject({kind:zb.CellEvaluatingValue})}else this.setCellFailure(r,aI([{kind:zb.CellMissingFormula}]),Zb);else this.onUnavailableObject(c.reason)}else this.onUnavailableObject(u.reason)}else{var d={kind:zb.ClientFailure,reason:o};this.setCellFailure(r,aI([d]),Zb)}}else this.onUnavailableObject(n.reason)},e.prototype.makeGetCellValues=function(e){var t=this;return function(r){var n=t.allEditedAvailable(r);if(n.kind===Ke.Failure)return st(aI([n.reason]));if(!n.value)return st(aI([{kind:zb.GridRange,range:r}]));var a=t.hasRecalcFailure(r);if(a.kind===Ke.Failure)return st(aI([a.reason]));if(a.value)return st($l(r));if(Uf(r.range)>t.maxDereferenceCells)return st(aI([{kind:zb.GridRangeSize,range:r}]));var i=e(r.range,r.sheet);return void 0===i?st($l(r)):ct(i)}},e.prototype.readCompiledFmla=function(e,t){var r=t.getValue();return lt(r)?r:(this.setCellFailure(e,r.reason,Zb),st(aI([{kind:zb.CellFormula,reason:r.reason}])))},e.prototype.getEditedUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===Ke.Failure)return t;var r=t.value.getEditedUsedRange(e.index);return r.kind===Ke.Failure||void 0===r.value?r:ct(ar(e,r.value))},e.prototype.getSheetRangeIds=function(e){var t=this.getDocument(e.document);return t.kind===Ke.Failure?t:t.value.getSheetRangeIds(e)},e.prototype.allEditedAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Ke.Failure?t:t.value.allEditedAvailable(e)},e.prototype.hasRecalcDirty=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Ke.Failure?t:t.value.hasRecalcDirty(e)},e.prototype.hasRecalcFailure=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Ke.Failure?t:t.value.hasRecalcFailure(e)},e.prototype.hasEditedEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Ke.Failure?t:t.value.hasEditedEditTaint(e)},e.prototype.hasRecalcEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Ke.Failure?t:t.value.hasRecalcEditTaint(e)},e.prototype.setEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===Ke.Failure?r:r.value.setEditedFormat(e,t)},e.prototype.setRecalcFailure=function(e,t){var r=this.getDocument(e.document);return r.kind===Ke.Failure?r:r.value.setRecalcFailure(e.index,t)},e.prototype.hasRecalcValueChanged=function(e,t){var r=this.hasRecalcFailure(e);if(r.kind===Ke.Failure||r.value)return r;var n=this.getRecalcValue(e);return n.kind===Ke.Failure?n:ct(void 0!==n.value.clientFailure||!Ut(n.value.oper,t,!1))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getDocument(e.document);return r.kind===Ke.Failure?r:r.value.setRecalcEditTaint(e.index,t)},e.prototype.propagateEditTaint=function(e,t){var r=this.hasEditedEditTaint(e);if(r.kind===Ke.Failure)return r;if(r.value)return ct(Gk.EditedCell);for(var n=0,a=t.cells;n<a.length;n++){var i=a[n],o=this.hasRecalcEditTaint(i);if(o.kind===Ke.Failure)return o;if(o.value){var u=this.setRecalcEditTaint(e.sheet,Nk(e.range));return u.kind===Ke.Failure?u:ct(Gk.DependentCell)}}return t.bound===ee.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===Pk.EditedCell?ct(Gk.IndependentCell):ct(Gk.UnknownNonEditedCell)},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===Ke.Failure?r:r.value.setEditedAndRecalcValues(e,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===Ke.Failure?t:t.value.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===Ke.Failure?t:t.value.setRecalcNameFailure(e)},e.prototype.setNameFailure=function(e,t){var r=this.setRecalcNameFailure(e);if(r.kind===Ke.Failure)return this.onUnavailableObject(r.reason);this.onNameFailure(e,t,this.evalParams)},e}(),eI=function(e,t){return(e<<t|e>>>32-t)>>>0},tI=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-eI(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^eI(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}(),rI=er(0,0,1<<20,16384);!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.HiddenRows="HiddenRows",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.PrecisionIncorrect="PrecisionIncorrect",e.PrecisionUnknown="PrecisionUnknown"}(zb||(zb={}));var nI,aI=Ll;!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.ClearCompiledFormulas="ClearCompiledFormulas"}(nI||(nI={}));var iI=function(){function e(e,t,r,n){var a,i=this;void 0===n&&(n={}),this.queue=new eR,this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.recalcStopwatch=void 0,this.docs=new $b(e,t,r,this.onNameFailure.bind(this),this.onRangeFailure.bind(this),this.logUnavailableObject.bind(this),this.onSetCellValue.bind(this),this.onSetCellValues.bind(this),n,n,null!=(a=n.maxDereferenceCells)?a:32768),this.reconfigure(n),this.queue.onInvalidateMessage=function(e){if(e.kind===Xk.PrecisionContinueComputation){var t=e.message.computeMsg;t.stateId>=i.stateId&&i.queue.isMessageValid(t)&&i.queue.push(t.kind,t.stateId,t.message)}e.kind!==Xk.EvalFormula&&e.kind!==Xk.EvalFormulaContinue||e.message.resolve(st(ql))}}return e.prototype.reconfigure=function(e){var t;this.config=e,this.rng=new tI(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,null!=(t=e.maxDereferenceCells)?t:32768)},e.prototype.onNameFailure=function(e,t,r){var n=r.computeKind;n!==Pk.PrecisionTest&&n!==Pk.EvalFormula&&this.outputMessageLog.push({kind:zk.NameFailure,stateId:this.stateId,name:e,reason:t})},e.prototype.onRangeFailure=function(e,t,r,n,a){var i=a,o=i.computeKind,u=i.computeCell;if(o!==Pk.PrecisionTest)o!==Pk.EvalFormula&&this.outputMessageLog.push({kind:zk.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t});else if(St(e.sheet,u.sheet)&&hR(e.range,u.range)){var c={samples:[],failures:[t]};this.outputMessageLog.push({kind:zk.PrecisionStatistics,stateId:this.stateId,stats:c})}},e.prototype.setWorksheetFuncOverrides=function(e){this.docs.setWorksheetFuncOverrides(e)},e.prototype.logUnavailableObject=function(e){var t=aI([e]);this.outputMessageLog.push({kind:zk.UnhandledFailure,stateId:this.stateId,reason:t})},e.prototype.onSetCellValue=function(e,t,r,n,a,i){var o=a,u=o.computeKind,c=o.computeCell;if(u===Pk.PrecisionTest)return this.setPrecisionResult(c,e,t,r);if(u!==Pk.EvalFormula){var s=void 0,l=this.docs.getEditedFormat(e);if(l.kind===Ke.Failure)return this.logUnavailableObject(l.reason);var f=this.docs.getServerFormat(e);if(f.kind===Ke.Failure)return this.logUnavailableObject(f.reason);l.value!==f.value&&"object"==typeof l.value&&(s=this.docs.resolveIformat(l.value)),i||void 0!==s?(this.outputMessageLog.push({kind:zk.RecalcStatistics,message:jk.ChangedCell,stateId:this.stateId,cellKind:n}),n!==Gk.EditedCell&&n!==Gk.DependentCell||this.outputMessageLog.push({kind:zk.CellWrite,stateId:this.stateId,cellKind:n,cell:e,value:t,format:s})):this.outputMessageLog.push({kind:zk.RecalcStatistics,message:jk.UnchangedCell,stateId:this.stateId,cellKind:n})}},e.prototype.onSetCellValues=function(e,t,r,n,a){var i=this,o=a,u=o.computeKind,c=o.computeCell;u!==Pk.PrecisionTest?u!==Pk.EvalFormula&&(n!==Gk.EditedCell&&n!==Gk.DependentCell||this.outputMessageLog.push({kind:zk.RangeWrite,stateId:this.stateId,cellKind:n,range:e,values:t})):gt(e.range,(function(n,a,o){return i.setPrecisionResult(c,ir(e.sheet,n),t[a][o],r),!0}))},e.prototype.setPrecisionResult=function(e,t,r,n){var a=this.docs.allServerAvailable(t);if(a.kind===Ke.Failure)return this.logUnavailableObject(a.reason);if(yt(e,t)){var i=this.docs.getEditedFormula(t);if(i.kind===Ke.Failure)return this.logUnavailableObject(i.reason);if(void 0===i.value)return this.logUnavailableObject({kind:zb.CellMissingFormula});var o=i.value,u=o[0],c=o[1];if(void 0===c.compiledFmla)return this.logUnavailableObject({kind:zb.CellEvaluatingValue});if(!a.value)return this.logUnavailableObject({kind:zb.GridRange,range:t});var s=this.docs.getServerValue(t);if(s.kind===Ke.Failure)return this.logUnavailableObject(s.reason);var l={samples:[this.precisionResult(r,s.value,Jt(c.lexicalKind,ar(t.sheet,u)),c)],failures:[]};this.outputMessageLog.push({kind:zk.PrecisionStatistics,stateId:this.stateId,stats:l})}else if(a.value){var f=this.docs.getServerValue(t);if(f.kind===Ke.Failure)return this.logUnavailableObject(f.reason);Ut(r,f.value,!0)||this.docs.setCellFailure(t,aI([{kind:zb.PrecisionIncorrect}]),n)}else this.docs.setCellFailure(t,aI([{kind:zb.PrecisionUnknown}]),n)},e.prototype.precisionResult=function(e,t,r,n){var a=Qk(t),i=this.docs.anonymizeFormula(r,n),o=i[0],u=i[1];if(Ut(e,t,!0))return{expected:a,formula:o,functions:u};var c=Qk(e);return"number"==typeof t&&"number"==typeof e?{expected:a,sampled:c,relMagnitude:Jk(0===t?e:(e-t)/t),formula:o,functions:u}:{expected:a,sampled:c,formula:o,functions:u}},e.prototype.handleSetCellContents=function(e,t){var r=this,n=t.cells,a=t.isFormula,i=t.fmla,o=t.value,u=t.origin,c=t.format,s=t.clientFailure,l=t.viewport,f=void 0!==a?a:void 0!==i&&nb(i),d=!e&&f?Ge:o,h=this.docs.setCellContents(e,n,i,f,u,d,s,c,l);if(h.kind===Ke.Failure)return this.logUnavailableObject(h.reason);if(this.docs.onCellModified(e),e)void 0!==s||!f&&void 0!==i||xk(n.set,(function(e){return r.shouldSample(r.config.samplePrecisionRate)&&r.computeCellValue(ir(n.sheet,e),Pk.PrecisionTest),!0}));else{if(f){var p=ir(n.sheet,u);this.docs.inferRangeFormat(n.set,p).forEach(this.logUnavailableObject.bind(this))}this.beforeCompute(l)}},e.prototype.handleSetRangeFormula=function(e,t){var r=t.range,n=t.fmla,a=t.origin,i=t.viewport,o=nb(n);b("calc.calc.PartialWorkbook: handleSetRangeFormula",""===n&&!e||o);var u=e?void 0:Ge,c=!!e&&void 0,s=this.docs.setRangeFormula(e,r,n,a,u,c,i);if(s.kind===Ke.Failure)return this.logUnavailableObject(s.reason);this.docs.onCellModified(e),e||this.beforeCompute(i)},e.prototype.handleEvalFormula=function(e){var t=this,r=e.formula,n=e.sheet,a=e.resolve;this.queue.enqueue(Xk.EvalFormulaContinue,this.stateId,{resume:function(){return t.docs.evalFormula(r,n)},resolve:a})},e.prototype.handleBeforeCompute=function(e){var t=e.message.viewport;this.afterCompute(),this.scheduleViewportCells(this.docs.getDirtyEditedCells(),t,Pk.EditedCell),this.scheduleViewportCells(this.docs.getDirtyDependentCells(),t,Pk.DependentCell)},e.prototype.withEvalTiming=function(e){var t=this.docs.schedulerInfo.totalTimeMs;if(void 0===t)return e();var r,n=Or();try{r=e()}finally{this.stateEvalTime+=Sr(1,Or()-n),this.stateEvalTime>=t&&(this.queue.invalidate(Xk.BeforeCompute),this.queue.invalidate(Xk.ContinueComputation),this.queue.invalidate(Xk.ComputeCellValue),this.invalidateAfterCompute(nI.EvalTimedOut),this.queue.invalidate(Xk.PrecisionContinueComputation),this.queue.invalidate(Xk.PrecisionComputeCellValue),this.outputMessageLog.push({kind:zk.RecalcStatistics,stateId:this.stateId,message:jk.StateTimedOut}),r=[])}return r},e.prototype.handleComputeCellValue=function(e){var t,r,n=this,a=e.kind,i=e.kindId,o=e.stateId,u=e.message,c=this.shouldSample(this.config.sampleCellEvalStopwatchRate)?En("calc.calc.PartialWorkbook: cell eval"):void 0,s={kind:a,kindId:i,stateId:o,message:u},l=u.cell;a===Xk.PrecisionComputeCellValue&&this.docs.onCellModified(!0);var f=this.docs.hasRecalcDirty(l);if(!lt(f))return this.logUnavailableObject(f.reason);if(f.value){var d=this.docs.getEditedFormula(l);if(d.kind===Ke.Failure)return this.logUnavailableObject(d.reason);if(void 0!==d.value){var h=this.withEvalTiming((function(){return n.docs.evaluate(u.computeKind,l)}));if(Array.isArray(h))return null===(t=c)||void 0===t||t.stop(),void(null===(r=u.stopwatch)||void 0===r||r.stop());this.continueComputation(h.resume,s,c)}}},e.prototype.handleContinueComputation=function(e){var t,r,n=e.message,a=n.resume,i=n.computeMsg,o=n.stopwatch,u=i.message;this.outputMessageLog.push({kind:zk.RecalcStatistics,stateId:this.stateId,message:jk.ContinueComputation});var c=this.withEvalTiming(a);if(Array.isArray(c))return null===(t=o)||void 0===t||t.stop(),void(null===(r=u.stopwatch)||void 0===r||r.stop());this.continueComputation(c.resume,i,o)},e.prototype.handleEvalFormulaContinue=function(e){var t=e.resume,r=e.resolve,n=t();n.kind===Ke.Paused?this.queue.push(Xk.EvalFormulaContinue,this.stateId,{resume:n.resume,resolve:r}):r(n)},e.prototype.handleAfterCompute=function(e){this.stopRecalcStopwatch(nI.EvalFinished),this.outputMessageLog.push({kind:zk.RecalcStatistics,message:jk.EditFinished,stateId:this.stateId})},e.prototype.handlePromoteCellContents=function(e){var t=e.cells,r=e.range,n=e.fromStateId,a=this.docs.promoteServerAvailability(t,n);if(a.kind===Ke.Failure)return this.logUnavailableObject(a.reason);this.docs.onCellModified(!0),a.value||this.outputMessageLog.push({kind:zk.UpdateRequest,stateId:this.stateId,range:r})},e.prototype.setCellContents=function(e,t,r,n,a,i,o,u,c,s){this.queue.enqueue(e,t,{kind:Yk.SetCellContents,cells:r,fmla:n,isFormula:a,value:i,origin:o,format:u,clientFailure:c,viewport:s})},e.prototype.writeCellContents=function(e,t,r,n,a,i,o,u){var c=void 0!==o?CR(!0,o):void 0;this.setCellContents(Xk.ServerUpdate,e,t,r,n,i,a,c,u,void 0)},e.prototype.editCellContents=function(e,t,r,n,a,i,o){void 0===i&&(i=Ge),void 0===o&&(o=ar(t.sheet,rI));this.setCellContents(Xk.ClientEdit,e,t,r,n,i,a,!1,void 0,o)},e.prototype.setArrayFormula=function(e,t,r,n,a,i){this.queue.enqueue(e,t,{kind:Yk.SetRangeFormula,range:r,fmla:n,origin:a,viewport:i})},e.prototype.writeArrayFormula=function(e,t,r,n,a){void 0===n&&(n=Ot(t.range)),void 0===a&&(a=!1);this.setArrayFormula(Xk.ServerUpdate,e,t,r,n,void 0)},e.prototype.editArrayFormula=function(e,t,r,n,a){void 0===n&&(n=Ot(t.range)),void 0===a&&(a=ar(t.sheet,rI)),this.setArrayFormula(Xk.ClientEdit,e,t,r,n,a)},e.prototype.promoteCellContents=function(e,t,r,n){this.queue.enqueue(Xk.ServerUpdate,e,{kind:Yk.PromoteCellContents,cells:r,fromStateId:n,range:t})},e.prototype.beforeCompute=function(e){this.queue.invalidate(Xk.BeforeCompute),this.queue.enqueue(Xk.BeforeCompute,this.stateId,{viewport:e})},e.prototype.computeCellValue=function(e,t){var r=t===Pk.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?En("calc.calc.PartialWorkbook: recalc edited"):void 0;this.queue.enqueue(t===Pk.PrecisionTest?Xk.PrecisionComputeCellValue:Xk.ComputeCellValue,this.stateId,{cell:e,computeKind:t,stopwatch:r})},e.prototype.continueComputation=function(e,t,r){this.queue.enqueue(t.kind===Xk.PrecisionComputeCellValue?Xk.PrecisionContinueComputation:Xk.ContinueComputation,this.stateId,{resume:e,computeMsg:t,stopwatch:r})},e.prototype.stopRecalcStopwatch=function(e){this.recalcStopwatch&&(this.recalcStopwatch.stop({stateId:this.stateId,stopReason:e}),this.recalcStopwatch=void 0)},e.prototype.invalidateAfterCompute=function(e){this.queue.invalidate(Xk.AfterCompute),this.stopRecalcStopwatch(e)},e.prototype.afterCompute=function(){this.invalidateAfterCompute(nI.EditReceived),this.recalcStopwatch=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?En("calc.calc.PartialWorkbook: recalc viewport"):void 0,this.queue.enqueue(Xk.AfterCompute,this.stateId,{})},e.prototype.testAdvanceState=function(e){this.queue.enqueue(Xk.TestAdvanceState,e,{})},e.prototype.step=function(){var e=this.queue.pop();if(void 0===e)return{queueEmpty:!0,messages:[]};this.trySetStateId(e)?this.handleMessage(e):this.queue.onInvalidateMessage(e);var t=this.queue.peek();e.kind>=Xk.ClientEdit&&e.kind<Xk.MaybeCollectGarbage&&(void 0===t||t.kind>=Xk.MaybeCollectGarbage)&&this.outputMessageLog.push({kind:zk.RecalcStatistics,message:jk.RecalcFinished,stateId:this.stateId});var r=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:0===this.queue.getCountUpperBound(),messages:r}},e.prototype.trySetStateId=function(e){var t=this;if(e.kind===Xk.MaybeCollectGarbage)return!0;if(e.kind===Xk.RunExperiment)return!0;if(e.stateId<this.stateId)return!1;if(e.kind===Xk.ClientEdit&&(this.queue.invalidate(Xk.ContinueComputation),this.queue.invalidate(Xk.PrecisionContinueComputation),this.queue.invalidate(Xk.EvalFormulaContinue),this.queue.invalidate(Xk.PrecisionComputeCellValue),this.stateEvalTime=0),e.stateId>this.stateId){if(this.stateId!==-1/0&&this.shouldSample(this.config.sampleWorkbookStatisticsRate)&&this.outputMessageLog.push({kind:zk.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics()}),2===this.stateChanges&&void 0!==this.config.experimentDefinitions){var r=this.config.experimentDefinitions;this.docs.forEachDocument((function(e){for(var n=e.cloneServer(),a=0,i=r.experiments;a<i.length;a++){var o=i[a];o.setContext(n),t.queue.enqueueRunExperimentMessage({budget:r.budget,experiment:o})}}))}var n=this.stateId;this.stateId=e.stateId,this.docs.advanceState(n),this.outputMessageLog.push({kind:zk.StateAdvanced,stateId:this.stateId}),this.queue.invalidate(Xk.BeforeCompute),this.queue.invalidate(Xk.ComputeCellValue),this.invalidateAfterCompute(nI.StateIdAdvanced),this.queue.invalidate(Xk.PrecisionComputeCellValue),this.queue.invalidate(Xk.ContinueComputation),this.queue.invalidate(Xk.PrecisionContinueComputation),this.queue.invalidate(Xk.EvalFormulaContinue),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.queue.enqueue(Xk.MaybeCollectGarbage,this.stateId,{})}return!0},e.prototype.handleMessage=function(e){switch(e.kind){case Xk.ServerUpdate:case Xk.ClientEdit:switch(e.message.kind){case Yk.SetCellContents:return this.handleSetCellContents(e.kind===Xk.ServerUpdate,e.message);case Yk.SetRangeFormula:return this.handleSetRangeFormula(e.kind===Xk.ServerUpdate,e.message);case Yk.PromoteCellContents:return this.handlePromoteCellContents(e.message);case Yk.SetRefStyle:return this.handleSetRefStyle(e.message.refStyle);case Yk.SetSheetNames:return this.handleSetSheetNames(e.message.document,e.message.sheetNames);case Yk.SetLocaleInfo:return this.handleSetLocaleInfo(e.message.localeInfo);case Yk.SetNumberFormats:return this.handleSetNumberFormats(e.message.numberFormats,e.message.merge);case Yk.ExtendUnusedRange:return this.handleExtendUnusedRange(e.message.range);case Yk.WriteNamedObject:return this.handleWriteNamedObject(e.message.scope,e.message.name,e.message.obj);case Yk.WriteUndefinedNames:return this.handleWriteUndefinedNames(e.message.scope);case Yk.PromoteNamedObjects:return this.handlePromoteNamedObjects(e.message.scope,e.message.fromStateId);case Yk.WriteHiddenRows:return this.handleWriteHiddenRows(e.message.rows);case Yk.WriteInFilterMode:return this.handleWriteInFilterMode(e.message.mode);default:return k("calc.calc.partialWorkbook.handleMessage",e.message)}case Xk.EvalFormula:return this.handleEvalFormula(e.message);case Xk.BeforeCompute:return this.handleBeforeCompute(e);case Xk.ContinueComputation:return this.handleContinueComputation(e);case Xk.ComputeCellValue:return this.handleComputeCellValue(e);case Xk.EvalFormulaContinue:return this.handleEvalFormulaContinue(e.message);case Xk.AfterCompute:return this.handleAfterCompute(e);case Xk.MaybeCollectGarbage:return this.maybeCollectGarbage();case Xk.PrecisionContinueComputation:return this.handleContinueComputation(e);case Xk.PrecisionComputeCellValue:return this.handleComputeCellValue(e);case Xk.RunExperiment:return this.handleRunExperiment(e.message);case Xk.TestAdvanceState:return;default:return k("calc.calc.partialWorkbook.handleMessage",e)}},e.prototype.setSheetNames=function(e,t,r){this.queue.enqueue(Xk.ServerUpdate,r,{kind:Yk.SetSheetNames,document:e,sheetNames:t})},e.prototype.handleRunExperiment=function(e){if(e.experiment.done)this.outputMessageLog.push({kind:zk.ExperimentRunResult,logMessage:e.experiment.resultLogMessage});else{var t=Or();if(e.experiment.step(),Or()-t<e.budget||e.experiment.done)this.queue.pushRunExperimentMessage(e);else{var r=e.experiment.failedLogMessage;void 0!==r&&this.outputMessageLog.push({kind:zk.ExperimentRunResult,logMessage:r})}}},e.prototype.handleSetSheetNames=function(e,t){var r=this.docs.setSheetNames(e,t);r.kind===Ke.Failure&&this.logUnavailableObject(r.reason),this.queue.invalidate(Xk.BeforeCompute),this.queue.invalidate(Xk.ContinueComputation),this.queue.invalidate(Xk.ComputeCellValue),this.invalidateAfterCompute(nI.SetSheetNames),this.queue.invalidate(Xk.PrecisionComputeCellValue),this.queue.invalidate(Xk.PrecisionContinueComputation)},e.prototype.clearCompiledFormulas=function(){this.docs.clearCompiledFormulas(),this.queue.invalidate(Xk.BeforeCompute),this.queue.invalidate(Xk.ContinueComputation),this.queue.invalidate(Xk.ComputeCellValue),this.invalidateAfterCompute(nI.ClearCompiledFormulas),this.queue.invalidate(Xk.PrecisionContinueComputation),this.queue.invalidate(Xk.PrecisionComputeCellValue)},e.prototype.setRefStyle=function(e,t){this.queue.enqueue(Xk.ServerUpdate,t,{kind:Yk.SetRefStyle,refStyle:e})},e.prototype.handleSetRefStyle=function(e){this.docs.setRefStyle(e),this.clearCompiledFormulas()},e.prototype.setLocaleInfo=function(e,t){this.queue.enqueue(Xk.ServerUpdate,t,{kind:Yk.SetLocaleInfo,localeInfo:e})},e.prototype.handleSetLocaleInfo=function(e){this.docs.setLocaleInfo(e),this.clearCompiledFormulas()},e.prototype.setNumberFormats=function(e,t,r){this.queue.enqueue(Xk.ServerUpdate,r,{kind:Yk.SetNumberFormats,numberFormats:e,merge:t})},e.prototype.handleSetNumberFormats=function(e,t){this.docs.setNumberFormats(e,t)},e.prototype.writeNamedObject=function(e,t,r,n){this.queue.enqueue(Xk.ServerUpdate,e,{kind:Yk.WriteNamedObject,scope:t,name:r,obj:n})},e.prototype.handleWriteNamedObject=function(e,t,r){var n=this.docs.setNamedObject(!0,sr(e,t),r);if(n.kind===Ke.Failure)return this.logUnavailableObject(n.reason)},e.prototype.writeUndefinedNames=function(e,t){this.queue.enqueue(Xk.ServerUpdate,e,{kind:Yk.WriteUndefinedNames,scope:t})},e.prototype.handleWriteUndefinedNames=function(e){var t=this.docs.setUndefinedNames(e);if(t.kind===Ke.Failure)return this.logUnavailableObject(t.reason)},e.prototype.promoteNamedObjects=function(e,t,r){this.queue.enqueue(Xk.ServerUpdate,e,{kind:Yk.PromoteNamedObjects,scope:t,fromStateId:r})},e.prototype.handlePromoteNamedObjects=function(e,t){var r=this.docs.promoteNamedObjects(e,t);if(r.kind===Ke.Failure)return this.logUnavailableObject(r.reason);r.value||this.outputMessageLog.push({kind:zk.UpdateNamesRequest,stateId:this.stateId,scope:e})},e.prototype.extendUnusedRange=function(e,t){this.queue.enqueue(Xk.ServerUpdate,t,{kind:Yk.ExtendUnusedRange,range:e})},e.prototype.handleExtendUnusedRange=function(e){var t=this.docs.extendServerUnused(e.sheet,e.range);if(t.kind===Ke.Failure)return this.logUnavailableObject(t.reason);this.docs.onCellModified(!0)},e.prototype.writeHiddenRows=function(e,t){this.queue.enqueue(Xk.ServerUpdate,e,{kind:Yk.WriteHiddenRows,rows:t})},e.prototype.handleWriteHiddenRows=function(e){var t=this.docs.writeHiddenRows(e.sheet,e.range,e.hidden);if(t.kind===Ke.Failure)return this.logUnavailableObject(t.reason)},e.prototype.writeInFilterMode=function(e,t){this.queue.enqueue(Xk.ServerUpdate,e,{kind:Yk.WriteInFilterMode,mode:t})},e.prototype.handleWriteInFilterMode=function(e){var t=this.docs.writeInFilterMode(e.sheet,e.inFilterMode);if(t.kind===Ke.Failure)return this.logUnavailableObject(t.reason)},e.prototype.getStatistics=function(){return{queueSize:this.queue.getCountUpperBound(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.maybeCollectGarbage=function(){if(!(this.stateChangesSinceLastGC<17)){var e=this.stateId-17;this.docs.collectGarbage(e),this.outputMessageLog.push({kind:zk.GarbageCollected,minStateIdKept:e}),this.stateChangesSinceLastGC=0}},e.prototype.shouldSample=function(e){return void 0!==e&&this.rng.next()<=e},e.prototype.scheduleAvailableFormulas=function(e,t){var r=this;return this.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(function(n){var a=ir(e.sheet,n),i=r.docs.getEditedFormula(a);return i.kind===Ke.Failure?(r.logUnavailableObject(i.reason),!0):(void 0!==i.value&&void 0!==i.value[1].compiledFmla&&r.computeCellValue(a,t),!0)}))},e.prototype.scheduleViewportCells=function(e,t,r){if(void 0!==t)for(var n=t.sheet,a=Nk(t.range),i=0,o=e;i<o.length;i++){St(n,(s=o[i]).sheet)&&this.scheduleAvailableFormulas(Bk(n,mk(s.set,a)),r)}else for(var u=0,c=e;u<c.length;u++){var s=c[u];this.scheduleAvailableFormulas(s,r)}},e.prototype.evalFormula=function(e,t,r){var n=this;return new Promise((function(a){n.queue.invalidate(Xk.EvalFormula),n.queue.enqueue(Xk.EvalFormula,e,{formula:t,sheet:r,resolve:a})}))},e}();function oI(e){return new Promise((function(t){return setTimeout(t,e)}))}function uI(e,t){var r=t&&t.timeThreshold||10,n=t&&t.costThreshold||1,a=t&&t.macrotaskDelay||0,i={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},o=LO(),u=o[0],c=o[1],s=c[0],l=c[1];var f=!0;var d=oI(a),h=Or();return function t(){if(!f||!function(){try{for(var t=0;t<n;){i.iterations+=1;var r=e();if(void 0===r)return!1;t+=r}return!0}catch(e){return l(e),!1}}())return s();var o=Or();o-h<r?(Promise.resolve().then(t),i.microtaskContinues+=1):(d.then((function(){d=oI(a),h=Or(),i.macrotaskTotalDelay+=h-o,t()})),i.macrotaskContinues+=1)}(),{promise:u,stop:function(){f=!1},stats:i}}function cI(e,t){var r=yr("en-US"),n=function(e,t,r){var n=Na().slice();return PR(t,ib,r,"localeData.worksheetFunctionNames").forEach((function(e){return n[e.functionId]=e.functionName})),Fa(e,n)}(r,e.worksheetFunctionNames,t),a=n.getWorksheetFuncId,i=n.getWorksheetFuncName,o=function(e,t){var r=Ra.slice();return PR(e,ob,t,"localeData.errorTypeNames").forEach((function(e){return r[e.errorType]=e.errorName})),r}(e.errorTypeNames,t);return Object(P.a)(Object(P.a)({},e),{parseNumber:Ea(la()),getWorksheetFuncId:a,getWorksheetFuncName:i,isNumeral:ya,getOrdinal:Oa,isIdentStart:Aa,isIdentContinue:ka,stringCompareCI:r,errorNames:o})}function sI(e,t){return vr(t)?{index:e,length:1}:{index:e,length:Er(t-e)+1}}function lI(e,t){var r=sI(t.row,t.lastRow),n=r.index,a=r.length,i=sI(t.column,t.lastColumn),o=i.index,u=i.length;return ar(Zt(e,t.sheetId),er(n,o,a,u))}function fI(e,t){var r=t.sheetId,n=t.usedRange;return pr(n)?lI(e,Object(P.a)({sheetId:r},n)):{sheet:Zt(e,r),range:void 0}}function dI(e,t,r){return{sheet:e.sheet,set:function(e,t,r){var n=rk({row:t}),a=rk({col:r}),i=pk(n,a);return Ck(Nk(e),i)}(e.range,t,r)}}function hI(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function pI(e){return mt(e)?Qy(e.sheet.index,e.range.row,e.range.col):Qy(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function vI(e,t,r,n){var a=GA;if(vr(n))return a;for(var i=0;i<n.length;i+=1){var o=n[i];if(e<=o&&o<e+t){for(var u=1;i+u<n.length&&n[i+u]===o+u;)u+=1;i+=u-1,a=TA(a,r(gr(o,o+u)))}}return a}function mI(e,t){switch(typeof t){case"string":case"boolean":return t;case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return Ge;case"Error":return Oe(t.type);default:return}}function gI(e,t){switch(typeof t){case"string":case"boolean":return t;case"number":return e.toNumber(t)}switch(t.kind){case X.Error:return jy(t.type);case X.Blank:return By;default:return}}function CI(e,t,r){if(!vr(r)){switch(r.kind){case"NamedValue":switch(typeof r.value){case"string":case"boolean":return Bb(r.value);case"number":return Bb(e.fromNumber(r.value))}return"Error"===r.value.kind?Bb(Oe(r.value.type)):k("calc.calc.namedObjectDataToNamedObject: NamedValue",r.value.kind);case"NamedFormula":return jb(r.formulaBarText);case"NamedRange":var n=lI(t,r.range);return Bb(Ue(n.sheet,n.range));case"NamedFailure":return Hb(r.failureReason,vr(r.objectKind)?void 0:r.objectKind)}return k("calc.calc.namedObjectDataToNamedObject: kind",r)}}function SI(e,t){var r,n;if(t.kind===Dl.NotImplemented)for(var a=0,i=t.features;a<i.length;a++){var o=i[a];LR(e,Dl.NotImplemented+" "+o)}else if(t.kind===Dl.IllFormedFormula)LR(e,Dl.IllFormedFormula+" "+((null!=(r=t.mode)?r:"")+" ")+JSON.stringify(null!=(n=t.diagnostics)?n:{}));else if(t.kind===Dl.Unavailable)for(var u=0,c=t.objects;u<c.length;u++){var s=c[u],l=[Dl.Unavailable];if("string"==typeof s.kind&&s.kind in zb){var f=s;switch(l.push(f.kind),f.kind){case zb.SheetId:l.push(f.sheetId);break;case zb.NameLoc:l.push(void 0===f.name.scope.index?"global":"sheet");break;case zb.ClientFailure:l.push(f.reason);break;case zb.VolatileFunction:l.push(f.name)}}else l.push(JSON.stringify(s));LR(e,l.join(" "))}else t.kind===Dl.LimitExceeded?LR(e,t.kind+" "+Vl[t.limit]):LR(e,t.kind)}var EI,yI=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.arrayDeltas=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.isRecalcFinished=!1}return e.prototype.setOutputStateId=function(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)},e.prototype.pushCellWrite=function(e,t){(e!==Gk.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)},e.prototype.pushRangeWrite=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];(t=e!==Gk.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push.apply(t,r)},e.prototype.pushUpdateRequest=function(e){this.rangeUpdateRequests.push(e)},e.prototype.pushUpdateNameRequest=function(e){this.namesUpdateRequests.push(e.index)},e.prototype.pushRecalcFinished=function(e){this.isRecalcFinished=this.isRecalcFinished||e},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest(_O(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.arrayDeltas.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,this.arrayDeltas),this.editedRangeDeltas=[],this.arrayDeltas=[]),this.dependentRangeDeltas.length>0&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[]),this.dependentRangeDeltas=[]),this.isRecalcFinished&&(this.onRecalcResults(FO(this.currentOutputStateId,"Dependents",!0,[],[])),this.isRecalcFinished=!1)},e.prototype.sendRecalcResults=function(e,t,r){for(var n=0;n<Math.max(t.length,r.length);n+=10)this.onRecalcResults(FO(this.currentOutputStateId,e,!1,t.slice(n,n+10).filter((function(e){return"object"!=typeof e.data.value})),r.slice(n,n+10)))},e}(),OI=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.document=Yt(void 0,""),this.localeInfo=Ma(),this.mathpack=la(),this.refStyle=_.A1,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.recalcStatistics=Hk,this.precisionStatistics=Zk,this.nameFailures=[],this.rangeFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.setConfig({}),this.dataModel=new iI(this.localeInfo,this.mathpack,this.refStyle,this.config)}return e.prototype.setInputStateId=function(e){var t=e-this.currentInputStateId;return t<0?(this.logInputStateIdDecrease(),!1):(0!==t&&(this.flushInputLogs(),this.currentInputStateId=e),!0)},e.prototype.setOutputStateId=function(e){var t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e=this;return this.clearAsyncResumeRecalc(),this.recalcLoop=uI((function(){var t=e.dataModel.step(),r=t.messages,n=t.queueEmpty;return r.length>0&&e.processRecalcResults(r),n?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs}),wO(this.recalcLoop.promise,(function(){e.recalcLoop=void 0}))},e.prototype.processRecalcResults=function(e){for(var t,r,n=new yI(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),a=0,i=e;a<i.length;a++){var o=i[a];if(o.kind!==zk.GarbageCollected)if(o.kind!==zk.ExperimentRunResult){if(this.setOutputStateId(o.stateId))switch(n.setOutputStateId(o.stateId),o.kind){case zk.CellWrite:var u=o.cell,c=o.value,s=o.format,l=o.cellKind,f=u.sheet,d=u.range,h=this.cellWriteToRangeDelta(f.index,d.row,d.col,c,s,"messages.<index>.value");pr(h)&&n.pushCellWrite(l,h);break;case zk.RangeWrite:var p=o.range,v=o.values;l=o.cellKind,f=p.sheet,d=p.range;n.pushRangeWrite.apply(n,Object(P.f)([l],this.rangeWriteToRangeDeltas(f.index,d,v,"messages.<index>.values")));break;case zk.NameFailure:this.nameFailures.push(o);break;case zk.RangeFailure:this.rangeFailures.push(o);break;case zk.UnhandledFailure:this.unhandledFailures.push(o);break;case zk.UpdateRequest:n.pushUpdateRequest(pI(o.range));break;case zk.UpdateNamesRequest:n.pushUpdateNameRequest(o.scope);break;case zk.RecalcStatistics:n.pushRecalcFinished(o.message===jk.RecalcFinished),this.recalcStatistics=qk(this.recalcStatistics,o);break;case zk.PrecisionStatistics:this.precisionStatistics=(t=this.precisionStatistics,r=o.stats,{samples:$k(t.samples,r.samples),failures:$k(t.failures,r.failures)});break;case zk.WorkbookStatistics:this.logWorkbookStats(o.stateId,o.stats);break;case zk.StateAdvanced:break;default:return k("calc.calc.RecalcServiceImpl.processRecalcResults",o)}}else this.logExperimentRunResult(o.logMessage);else this.onGC(o.minStateIdKept)}n.flush()},e.prototype.logExperimentRunResult=function(e){O.ULS.traceTag(594409422,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.calc.RecalcServiceImpl.ExperimentRunResult: "+e)},e.prototype.logAllFailureStats=function(){var e=this.nameFailures;this.nameFailures=[];var t=this.rangeFailures;this.rangeFailures=[];var r=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",f.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",f.TraceLevel.Info),this.logGenFailureStats(r,595194338,"unhandled",f.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(e,t,r,n){if(0!==e.length){for(var a={},i=0,o=e;i<o.length;i++){SI(a,o[i].reason)}var u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(a);O.ULS.traceTag(t,f.LogCategory.msoulscat_ES_EWAJS,n,u),this.logJavaScriptFailures(e,r)}},e.prototype.logCellFailureStats=function(e,t,r,n){var a=this;if(0!==e.length){for(var i={},o=0,u=e;o<u.length;o++){var c=u[o],s=c.reason,l=c.cellKind;SI(i[l]||(i[l]={}),s)}Object.getOwnPropertyNames(i).sort().forEach((function(e){var o=i[e],u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+a.currentOutputStateId+", cell kind = "+e+", stats = "+JSON.stringify(o);O.ULS.traceTag(t,f.LogCategory.msoulscat_ES_EWAJS,n,u)})),this.logJavaScriptFailures(e,r)}},e.prototype.logJavaScriptFailures=function(e,t){for(var r=0,n=e;r<n.length;r++){var a=n[r].reason;if(a.kind===Dl.JavaScriptError){var i="calc.calc.RecalcService: recalc "+t+" JavaScript error: "+v(a.error);O.ULS.traceTag(595658721,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,i)}}},e.prototype.logIgnoredStats=function(e,t,r,n){if(0!==Object.getOwnPropertyNames(n).length){var a="calc.calc.RecalcService: ignored "+r+" data; "+("stateId = "+t+", stats = "+JSON.stringify(n));O.ULS.traceTag(e,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-1/0){var e=this.recalcStatistics;if(this.recalcStatistics=Hk,this.dataModel.shouldSample(this.config.sampleRecalcStatisticsRate)){var t="calc.calc.RecalcService: recalc statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(e));O.ULS.traceTag(595654593,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,t)}}},e.prototype.logPrecisionStats=function(){if(0!==this.precisionStatistics.samples.length||0!==this.precisionStatistics.failures.length){var e=this.precisionStatistics,t=e.samples,r=e.failures,n={};r.forEach((function(e){return SI(n,e)}));var a="calc.calc.RecalcService: precision statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify({samples:t,failures:n}));O.ULS.traceTag(595645023,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a),this.precisionStatistics=Zk}},e.prototype.logWorkbookStats=function(e,t){var r="calc.calc.RecalcService: workbook statistics; "+("stateId = "+e+", stats = "+JSON.stringify(t));O.ULS.traceTag(595359882,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,r)},e.prototype.logInputStateIdDecrease=function(){LR(this.ignoredInputStats,"stateId went backwards")},e.prototype.logOutputStateIdDecrease=function(){LR(this.ignoredOutputStats,"stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats(),this.logPrecisionStats()},e.prototype.cellWriteToRangeDelta=function(e,t,r,n,a,i){if(xR(n,Vb,this.ignoredOutputStats,i)){var o=gI(this.mathpack,n),u=function(e){if(void 0!==e)return RO(e.isExact,e.iformat,!1,e.category,e.decimals)}(a);return pr(void 0)||pr(o)||pr(u)?IO(Qy(e,t,r),bO(void 0,o,u)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,t,r,n){for(var a=n+".<index>.<index>",i=t.row,o=t.col,u=t.rows,c=t.cols,s=[],l=0;l<u;l+=1)for(var f=0;f<c;f+=1){var d=this.cellWriteToRangeDelta(e,i+l,o+f,r[l][f],void 0,a);pr(d)&&s.push(d)}return s},e.prototype.setA1ReferenceStyle=function(e){this.clearAsyncResumeRecalc(),this.refStyle=e?_.A1:_.R1C1,this.dataModel.setRefStyle(this.refStyle,this.currentInputStateId)},e.prototype.setLocale=function(e){this.clearAsyncResumeRecalc(),this.localeInfo=cI(e,this.ignoredInputStats),this.dataModel.setLocaleInfo(this.localeInfo,this.currentInputStateId)},e.prototype.setNumberFormats=function(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(PR(e,cb,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)},e.prototype.setSheetNames=function(e){this.updateSheetNames(this.currentInputStateId,e)},e.prototype.updateSheetNames=function(e,t){this.setInputStateId(e)&&(this.clearAsyncResumeRecalc(),this.dataModel.setSheetNames(this.document,PR(t,lb,this.ignoredInputStats,"sheetNames"),e))},e.prototype.updateNamedObjects=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=PR(t,Fb,this.ignoredInputStats,"namedObjectsUpdates");r<n.length;r++){var a=n[r],i=a.scope,o=a.objects,u=a.fromStateId,c=cr(this.document,pr(i)?i:void 0);if(pr(o))for(var s=0,l=PR(o,Nb,this.ignoredInputStats,"namedObjectsUpdates.<index>.objects");s<l.length;s++){var f=l[s],d=f.name,h=f.data;this.dataModel.writeNamedObject(e,c,d,CI(this.mathpack,this.document,h))}else pr(u)?this.dataModel.promoteNamedObjects(e,c,u):this.dataModel.writeUndefinedNames(e,c)}}},e.prototype.updateUnusedCells=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=PR(t,Ab,this.ignoredInputStats,"unusedCellsUpdates");r<n.length;r++){var a=n[r];this.dataModel.extendUnusedRange(fI(this.document,a),e)}}},e.prototype.updateRanges=function(e,t){var r,n;if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var a=0,i=PR(t,Eb,this.ignoredInputStats,"rangeUpdates");a<i.length;a++){var o=i[a],u=o.range,c=o.excludeRows,s=o.excludeColumns,l=o.data,f=o.fromStateId,d=lI(this.document,u),h=d.range,p=vI(h.row,h.rows,Tk.row,c),v=dI(d,p,vI(h.col,h.cols,Tk.col,s)),m=pr(l)?mI(this.mathpack,l.value):Ge;if(void 0!==m){var g=Ot(h);if(pr(l)){var C=l.iformat,S="ArrayFormula"===l.kind?void 0:null!=(r=l.formulaBarText)?r:void 0,E=null!=(n=l.failureReason)?n:void 0;if("Inferred"===l.kind)this.dataModel.writeCellContents(e,v,S,void 0,g,m,C,E);else{var y="CellFormula"===l.kind;this.dataModel.writeCellContents(e,v,S,y,g,m,C,E)}}else vr(f)?this.dataModel.writeCellContents(e,v,"",!1,g,Ge,0,void 0):this.dataModel.promoteCellContents(e,d,v,f);this.dataModel.writeHiddenRows(e,hI(d,p))}}}},e.prototype.updateArrays=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=PR(t,Ob,this.ignoredInputStats,"arrayUpdates");r<n.length;r++){var a=n[r],i=a.range,o=a.data,u=a.fromStateId,c=lI(this.document,i);if(pr(o)){var s=o.formulaBarText,l=o.isSpilled,f=Ot(c.range);this.dataModel.writeArrayFormula(e,c,s,f,l)}else pr(u)}}},e.prototype.editRangeFormulas=function(e,t){var r=this;if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var n=PR(t,Db,this.ignoredInputStats,"rangeFormulaEdits"),a=function(t){var n=t.kind,a=t.range,o=t.formulaBarText,u=t.value,c=t.origin,s=t.viewport,l=GA;a.forEach((function(e){l=pk(l,Nk(lI(r.document,e).range))}));var f=lI(i.document,a[0]),d=pr(c)?tr(c.row,c.column):Ot(f.range),h=pr(s)?lI(i.document,s):void 0,p=void 0;if(pr(u)){if(void 0===(p=mI(i.mathpack,u)))return"continue"}else p=void 0;var v="CellFormula"===n||"Value"!==n&&void 0;i.dataModel.editCellContents(e,Bk(f.sheet,l),o,v,d,p,h)},i=this,o=0,u=n;o<u.length;o++){a(u[o])}}},e.prototype.editArrayFormulas=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=PR(t,Ub,this.ignoredInputStats,"arrayFormulaEdits");r<n.length;r++){var a=n[r],i=a.range,o=a.formulaBarText,u=a.origin,c=a.viewport,s=lI(this.document,i),l=pr(u)?tr(u.row,u.column):tr(i.row,i.column),f=pr(c)?lI(this.document,c):void 0;this.dataModel.editArrayFormula(e,s,o,l,f)}}},e.prototype.setConfig=function(e){var t,r,n,a,i,o,u,c;this.config={yieldIntervalMs:10,totalTimeMs:(t=e.totalEvalTimeMs,null!=t?t:1e4),maxCellChain:32768,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionRate:(r=e.samplePrecisionRate,null!=r?r:.02),sampleRecalcStatisticsRate:(n=e.sampleRecalcStatisticsRate,null!=n?n:.2),sampleWorkbookStatisticsRate:(a=e.sampleWorkbookStatisticsRate,null!=a?a:.1),sampleCellEvalStopwatchRate:(i=e.sampleCellEvalStopwatchRate,null!=i?i:.003),sampleRecalcEditedStopwatchRate:(o=e.sampleRecalcEditedStopwatchRate,null!=o?o:1),sampleRecalcViewportStopwatchRate:(u=e.sampleRecalcViewportStopwatchRate,null!=u?u:1),rngSeed:(c=e.rngSeed,null!=c?c:1e3*Date.now())}},e.prototype.reconfigure=function(e){this.setConfig(e),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new iI(this.localeInfo,this.mathpack,this.refStyle,this.config),this.recalcStatistics=Hk,this.precisionStatistics=Zk,this.nameFailures=[],this.rangeFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=-1/0},e.prototype.evalFormula=function(e,t,r){var n=this,a=Zt(this.document,r);return this.dataModel.evalFormula(e,t,a).then((function(e){if(lt(e)){if(!xR(e.value,Wb,n.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");var t=gI(n.mathpack,e.value);return b("calc.calc.RecalcService.evalFormula",void 0!==t),ct(t)}return st(e.reason.kind)}))},e.prototype.testAdvanceState=function(e){this.setInputStateId(e)&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())},e.prototype.testDelay=function(e){return Object(P.b)(this,void 0,void 0,(function(){return Object(P.d)(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){return setTimeout(t,e)}))];case 1:return t.sent(),[2]}}))}))},e}();function AI(){return{onError:function(e,t){var r="calc.calc.recalcServiceInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:v(t.error)});O.ULS.traceTag(595658753,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,r)},onInit:function(e){var t=e.getImports("client",["onRecalcResults","onUpdateRequest","onGC"]),r=t.onRecalcResults,n=t.onUpdateRequest,a=t.onGC;e.setExports("service",new OI(r.notify,n.notify,a.notify))},scriptName:"excelOnlineRecalcService.worker"}}!function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(EI||(EI={}));var kI=function(e){return void 0===e&&(e=EI.Thread),Object(P.b)(this,void 0,void 0,(function(){var t,r,n,a,i,o,u;return Object(P.d)(this,(function(c){switch(c.label){case 0:return t=!1,r={outside:{onError:function(e,r){var n=v(r.error),a="calc.calc.recalcServiceOutsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:n});O.ULS.traceTag(595658719,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a),r.closing&&(t=!0)},onClosed:function(e){var r="calc.calc.recalcServiceOutsideDef.onClosed: recalc service closed "+(t?"because of an error":"normally");O.ULS.traceTag(595658720,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,r)}},inside:AI()},[4,oA(e===EI.Thread?[EO.Dedicated]:e===EI.Local?[EO.FunctionCall]:[EO.Dedicated,EO.FunctionCall],r)];case 1:if(null==(n=c.sent()))throw new Error("could not create recalc service worker");return a="calc.calc.createRecalcService: worker created; outside.workerKind = "+n.workerKind,O.ULS.traceTag(595731987,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a),i=-1/0,o={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){i=e}},n.setExports("client",o),u=n.getImports("service",["setA1ReferenceStyle","setLocale","setNumberFormats","setSheetNames","updateSheetNames","updateUnusedCells","updateNamedObjects","updateRanges","updateArrays","editRangeFormulas","editArrayFormulas","resumeRecalc","reconfigure","clearCache","testAdvanceState","testDelay","evalFormula"]),[2,{setOnRecalcResults:function(e){o.onRecalcResults=e},setOnUpdateRequest:function(e){o.onUpdateRequest=e},setA1ReferenceStyle:function(e){t||u.setA1ReferenceStyle.notify(e)},setLocale:function(e){t||u.setLocale.notify(e)},setNumberFormats:function(e,r){t||u.setNumberFormats.notify(e,r)},setSheetNames:function(e){t||u.setSheetNames.notify(e)},updateSheetNames:function(e,r){t||u.updateSheetNames.notify(e,r)},updateNamedObjects:function(e,r){t||u.updateNamedObjects.notify(e,r)},setUsedRanges:function(e,t){},updateUnusedCells:function(e,r){t||u.updateUnusedCells.notify(e,r)},updateRanges:function(e,r){t||u.updateRanges.notify(e,r)},updateArrays:function(e,r){t||u.updateArrays.notify(e,r)},editRangeFormulas:function(e,r){t||u.editRangeFormulas.notify(e,r)},editArrayFormulas:function(e,r){t||u.editArrayFormulas.notify(e,r)},resumeRecalc:function(){t||u.resumeRecalc.notify()},reconfigure:function(e){t||u.reconfigure.notify(e)},clearCache:function(){t||u.clearCache.notify()},testAdvanceState:function(e){t||u.testAdvanceState.notify(e)},testResumeRecalc:function(){return t?Promise.resolve():u.resumeRecalc.call()},testCrash:function(){return u.testDelay.isCritical=!0,u.testDelay.callTimeout=0,u.testDelay.call(100)},close:function(){n.close()},stateIdAvailable:function(e){return e>=i},evalFormula:function(e,t,r){return u.evalFormula.call(e,t,r)}}]}}))}))};r.d(t,"packageVersion",(function(){return"11.13.0"})),r.d(t,"location",(function(){return vi})),r.d(t,"formula",(function(){return Si})),r.d(t,"value",(function(){return gi})),r.d(t,"signature",(function(){return yi})),r.d(t,"util",(function(){return Ai})),r.d(t,"config",(function(){return Ri})),r.d(t,"math",(function(){return Ii})),r.d(t,"parse",(function(){return n})),r.d(t,"analyze",(function(){return o})),r.d(t,"runtime",(function(){return u})),r.d(t,"calc",(function(){return l})),r.d(t,"funcs",(function(){return s})),r.d(t,"worker",(function(){return c}))}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map